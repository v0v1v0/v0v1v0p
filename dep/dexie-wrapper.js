function e(){e=function(){return n};var t,n={},r=Object.prototype,i=r.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},u=a.iterator||"@@iterator",s=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(t){l=function(e,t,n){return e[t]=n}}function f(e,t,n,r){var i=t&&t.prototype instanceof m?t:m,a=Object.create(i.prototype),u=new N(r||[]);return o(a,"_invoke",{value:A(e,n,u)}),a}function h(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}n.wrap=f;var p="suspendedStart",d="suspendedYield",y="executing",v="completed",b={};function m(){}function g(){}function w(){}var _={};l(_,u,(function(){return this}));var O=Object.getPrototypeOf,E=O&&O(O(I([])));E&&E!==r&&i.call(E,u)&&(_=E);var k=w.prototype=m.prototype=Object.create(_);function x(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,t){function n(r,o,a,u){var s=h(e[r],e,o);if("throw"!==s.type){var c=s.arg,l=c.value;return l&&"object"==typeof l&&i.call(l,"__await")?t.resolve(l.__await).then((function(e){n("next",e,a,u)}),(function(e){n("throw",e,a,u)})):t.resolve(l).then((function(e){c.value=e,a(c)}),(function(e){return n("throw",e,a,u)}))}u(s.arg)}var r;o(this,"_invoke",{value:function(e,i){function o(){return new t((function(t,r){n(e,i,t,r)}))}return r=r?r.then(o,o):o()}})}function A(e,n,r){var i=p;return function(o,a){if(i===y)throw Error("Generator is already running");if(i===v){if("throw"===o)throw a;return{value:t,done:!0}}for(r.method=o,r.arg=a;;){var u=r.delegate;if(u){var s=T(u,r);if(s){if(s===b)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===p)throw i=v,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=y;var c=h(e,n,r);if("normal"===c.type){if(i=r.done?v:d,c.arg===b)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i=v,r.method="throw",r.arg=c.arg)}}}function T(e,n){var r=n.method,i=e.iterator[r];if(i===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,T(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),b;var o=h(i,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,b;var a=o.arg;return a?a.done?(n[e.resultName]=a.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,b):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,b)}function j(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function N(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(j,this),this.reset(!0)}function I(e){if(e||""===e){var n=e[u];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,o=function n(){for(;++r<e.length;)if(i.call(e,r))return n.value=e[r],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}throw new TypeError(typeof e+" is not iterable")}return g.prototype=w,o(k,"constructor",{value:w,configurable:!0}),o(w,"constructor",{value:g,configurable:!0}),g.displayName=l(w,c,"GeneratorFunction"),n.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},n.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,l(e,c,"GeneratorFunction")),e.prototype=Object.create(k),e},n.awrap=function(e){return{__await:e}},x(S.prototype),l(S.prototype,s,(function(){return this})),n.AsyncIterator=S,n.async=function(e,t,r,i,o){void 0===o&&(o=Promise);var a=new S(f(e,t,r,i),o);return n.isGeneratorFunction(t)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},x(k),l(k,c,"Generator"),l(k,u,(function(){return this})),l(k,"toString",(function(){return"[object Generator]"})),n.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},n.values=I,N.prototype={constructor:N,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!e)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(r,i){return u.type="throw",u.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],u=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var s=i.call(a,"catchLoc"),c=i.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,b):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),b},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),P(n),b}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;P(n)}return i}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:I(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),b}},n}function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function r(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var i={exports:{}};i.exports=function(){
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.
    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.
    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */
var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};function r(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}var i=function(){return i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},i.apply(this,arguments)};function o(e,t,n){for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}var a="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:n,u=Object.keys,s=Array.isArray;function c(e,n){return"object"!==t(n)||u(n).forEach((function(t){e[t]=n[t]})),e}"undefined"==typeof Promise||a.Promise||(a.Promise=Promise);var l=Object.getPrototypeOf,f={}.hasOwnProperty;function h(e,t){return f.call(e,t)}function p(e,t){"function"==typeof t&&(t=t(l(e))),("undefined"==typeof Reflect?u:Reflect.ownKeys)(t).forEach((function(n){y(e,n,t[n])}))}var d=Object.defineProperty;function y(e,t,n,r){d(e,t,c(n&&h(n,"get")&&"function"==typeof n.get?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},r))}function v(e){return{from:function(t){return e.prototype=Object.create(t.prototype),y(e.prototype,"constructor",e),{extend:p.bind(null,e.prototype)}}}}var b=Object.getOwnPropertyDescriptor;function m(e,t){var n;return b(e,t)||(n=l(e))&&m(n,t)}var g=[].slice;function w(e,t,n){return g.call(e,t,n)}function _(e,t){return t(e)}function O(e){if(!e)throw new Error("Assertion Failed")}function E(e){a.setImmediate?setImmediate(e):setTimeout(e,0)}function k(e,t){return e.reduce((function(e,n,r){var i=t(n,r);return i&&(e[i[0]]=i[1]),e}),{})}function x(e,t){if("string"==typeof t&&h(e,t))return e[t];if(!t)return e;if("string"!=typeof t){for(var n=[],r=0,i=t.length;r<i;++r){var o=x(e,t[r]);n.push(o)}return n}var a=t.indexOf(".");if(-1!==a){var u=e[t.substr(0,a)];return null==u?void 0:x(u,t.substr(a+1))}}function S(e,t,n){if(e&&void 0!==t&&(!("isFrozen"in Object)||!Object.isFrozen(e)))if("string"!=typeof t&&"length"in t){O("string"!=typeof n&&"length"in n);for(var r=0,i=t.length;r<i;++r)S(e,t[r],n[r])}else{var o=t.indexOf(".");if(-1!==o){var a=t.substr(0,o),u=t.substr(o+1);if(""===u)void 0===n?s(e)&&!isNaN(parseInt(a))?e.splice(a,1):delete e[a]:e[a]=n;else{var c=e[a];c&&h(e,a)||(c=e[a]={}),S(c,u,n)}}else void 0===n?s(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=n}}function A(e,t){"string"==typeof t?S(e,t,void 0):"length"in t&&[].map.call(t,(function(t){S(e,t,void 0)}))}function T(e){var t={};for(var n in e)h(e,n)&&(t[n]=e[n]);return t}var j=[].concat;function P(e){return j.apply([],e)}var N="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(P([8,16,32,64].map((function(e){return["Int","Uint","Float"].map((function(t){return t+e+"Array"}))})))).filter((function(e){return a[e]})),I=new Set(N.map((function(e){return a[e]})));function C(e){var n={};for(var r in e)if(h(e,r)){var i=e[r];n[r]=!i||"object"!==t(i)||I.has(i.constructor)?i:C(i)}return n}function B(e){for(var t in e)if(h(e,t))return!1;return!0}var K=null;function R(e){K=new WeakMap;var t=D(e);return K=null,t}function D(e){if(!e||"object"!==t(e))return e;var n=K.get(e);if(n)return n;if(s(e)){n=[],K.set(e,n);for(var r=0,i=e.length;r<i;++r)n.push(D(e[r]))}else if(I.has(e.constructor))n=e;else{var o=l(e);for(var a in n=o===Object.prototype?{}:Object.create(o),K.set(e,n),e)h(e,a)&&(n[a]=D(e[a]))}return n}var L={}.toString;function F(e){return L.call(e).slice(8,-1)}var q="undefined"!=typeof Symbol?Symbol.iterator:"@@iterator",U="symbol"===t(q)?function(e){var t;return null!=e&&(t=e[q])&&t.apply(e)}:function(){return null};function M(e,t){var n=e.indexOf(t);return n>=0&&e.splice(n,1),n>=0}var V={};function $(e){var t,n,r,i;if(1===arguments.length){if(s(e))return e.slice();if(this===V&&"string"==typeof e)return[e];if(i=U(e)){for(n=[];!(r=i.next()).done;)n.push(r.value);return n}if(null==e)return[e];if("number"==typeof(t=e.length)){for(n=new Array(t);t--;)n[t]=e[t];return n}return[e]}for(t=arguments.length,n=new Array(t);t--;)n[t]=arguments[t];return n}var G="undefined"!=typeof Symbol?function(e){return"AsyncFunction"===e[Symbol.toStringTag]}:function(){return!1},Y=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],z=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(Y),J={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function W(e,t){this.name=e,this.message=t}function Q(e,t){return e+". Errors: "+Object.keys(t).map((function(e){return t[e].toString()})).filter((function(e,t,n){return n.indexOf(e)===t})).join("\n")}function X(e,t,n,r){this.failures=t,this.failedKeys=r,this.successCount=n,this.message=Q(e,t)}function H(e,t){this.name="BulkError",this.failures=Object.keys(t).map((function(e){return t[e]})),this.failuresByPos=t,this.message=Q(e,this.failures)}v(W).from(Error).extend({toString:function(){return this.name+": "+this.message}}),v(X).from(W),v(H).from(W);var Z=z.reduce((function(e,t){return e[t]=t+"Error",e}),{}),ee=W,te=z.reduce((function(e,n){var r=n+"Error";function i(e,i){this.name=r,e?"string"==typeof e?(this.message="".concat(e).concat(i?"\n "+i:""),this.inner=i||null):"object"===t(e)&&(this.message="".concat(e.name," ").concat(e.message),this.inner=e):(this.message=J[n]||r,this.inner=null)}return v(i).from(ee),e[n]=i,e}),{});te.Syntax=SyntaxError,te.Type=TypeError,te.Range=RangeError;var ne=Y.reduce((function(e,t){return e[t+"Error"]=te[t],e}),{});function re(e,t){if(!e||e instanceof W||e instanceof TypeError||e instanceof SyntaxError||!e.name||!ne[e.name])return e;var n=new ne[e.name](t||e.message,e);return"stack"in e&&y(n,"stack",{get:function(){return this.inner.stack}}),n}var ie=z.reduce((function(e,t){return-1===["Syntax","Type","Range"].indexOf(t)&&(e[t+"Error"]=te[t]),e}),{});function oe(){}function ae(e){return e}function ue(e,t){return null==e||e===ae?t:function(n){return t(e(n))}}function se(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function ce(e,t){return e===oe?t:function(){var n=e.apply(this,arguments);void 0!==n&&(arguments[0]=n);var r=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var o=t.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?se(r,this.onsuccess):r),i&&(this.onerror=this.onerror?se(i,this.onerror):i),void 0!==o?o:n}}function le(e,t){return e===oe?t:function(){e.apply(this,arguments);var n=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?se(n,this.onsuccess):n),r&&(this.onerror=this.onerror?se(r,this.onerror):r)}}function fe(e,t){return e===oe?t:function(n){var r=e.apply(this,arguments);c(n,r);var i=this.onsuccess,o=this.onerror;this.onsuccess=null,this.onerror=null;var a=t.apply(this,arguments);return i&&(this.onsuccess=this.onsuccess?se(i,this.onsuccess):i),o&&(this.onerror=this.onerror?se(o,this.onerror):o),void 0===r?void 0===a?void 0:a:c(r,a)}}function he(e,t){return e===oe?t:function(){return!1!==t.apply(this,arguments)&&e.apply(this,arguments)}}function pe(e,t){return e===oe?t:function(){var n=e.apply(this,arguments);if(n&&"function"==typeof n.then){for(var r=this,i=arguments.length,o=new Array(i);i--;)o[i]=arguments[i];return n.then((function(){return t.apply(r,o)}))}return t.apply(this,arguments)}}ie.ModifyError=X,ie.DexieError=W,ie.BulkError=H;var de="undefined"!=typeof location&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function ye(e,t){de=e}var ve={},be=100,me="undefined"==typeof Promise?[]:function(){var e=Promise.resolve();if("undefined"==typeof crypto||!crypto.subtle)return[e,l(e),e];var t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,l(t),e]}(),ge=me[0],we=me[1],_e=me[2],Oe=we&&we.then,Ee=ge&&ge.constructor,ke=!!_e;function xe(){queueMicrotask(Ge)}var Se=function(e,t){Be.push([e,t]),Te&&(xe(),Te=!1)},Ae=!0,Te=!0,je=[],Pe=[],Ne=ae,Ie={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:oe,pgp:!1,env:{},finalize:oe},Ce=Ie,Be=[],Ke=0,Re=[];function De(e){if("object"!==t(this))throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var n=this._PSD=Ce;if("function"!=typeof e){if(e!==ve)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(!1===this._state&&Ue(this,this._value))}this._state=null,this._value=null,++n.ref,qe(this,e)}var Le={get:function(){var e=Ce,t=it;function n(n,r){var i=this,o=!e.global&&(e!==Ce||t!==it),a=o&&!st(),u=new De((function(t,u){Ve(i,new Fe(yt(n,e,o,a),yt(r,e,o,a),t,u,e))}));return this._consoleTask&&(u._consoleTask=this._consoleTask),u}return n.prototype=ve,n},set:function(e){y(this,"then",e&&e.prototype===ve?Le:{get:function(){return e},set:Le.set})}};function Fe(e,t,n,r,i){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.resolve=n,this.reject=r,this.psd=i}function qe(e,t){try{t((function(t){if(null===e._state){if(t===e)throw new TypeError("A promise cannot be resolved with itself.");var n=e._lib&&Ye();t&&"function"==typeof t.then?qe(e,(function(e,n){t instanceof De?t._then(e,n):t.then(e,n)})):(e._state=!0,e._value=t,Me(e)),n&&ze()}}),Ue.bind(null,e))}catch(t){Ue(e,t)}}function Ue(e,t){if(Pe.push(t),null===e._state){var n=e._lib&&Ye();t=Ne(t),e._state=!1,e._value=t,Qe(e),Me(e),n&&ze()}}function Me(e){var t=e._listeners;e._listeners=[];for(var n=0,r=t.length;n<r;++n)Ve(e,t[n]);var i=e._PSD;--i.ref||i.finalize(),0===Ke&&(++Ke,Se((function(){0==--Ke&&Je()}),[]))}function Ve(e,t){if(null!==e._state){var n=e._state?t.onFulfilled:t.onRejected;if(null===n)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++Ke,Se($e,[n,e,t])}else e._listeners.push(t)}function $e(e,t,n){try{var r,i=t._value;!t._state&&Pe.length&&(Pe=[]),r=de&&t._consoleTask?t._consoleTask.run((function(){return e(i)})):e(i),t._state||-1!==Pe.indexOf(i)||Xe(t),n.resolve(r)}catch(e){n.reject(e)}finally{0==--Ke&&Je(),--n.psd.ref||n.psd.finalize()}}function Ge(){dt(Ie,(function(){Ye()&&ze()}))}function Ye(){var e=Ae;return Ae=!1,Te=!1,e}function ze(){var e,t,n;do{for(;Be.length>0;)for(e=Be,Be=[],n=e.length,t=0;t<n;++t){var r=e[t];r[0].apply(null,r[1])}}while(Be.length>0);Ae=!0,Te=!0}function Je(){var e=je;je=[],e.forEach((function(e){e._PSD.onunhandled.call(null,e._value,e)}));for(var t=Re.slice(0),n=t.length;n;)t[--n]()}function We(e){function t(){e(),Re.splice(Re.indexOf(t),1)}Re.push(t),++Ke,Se((function(){0==--Ke&&Je()}),[])}function Qe(e){je.some((function(t){return t._value===e._value}))||je.push(e)}function Xe(e){for(var t=je.length;t;)if(je[--t]._value===e._value)return void je.splice(t,1)}function He(e){return new De(ve,!1,e)}function Ze(e,t){var n=Ce;return function(){var r=Ye(),i=Ce;try{return ht(n,!0),e.apply(this,arguments)}catch(e){t&&t(e)}finally{ht(i,!1),r&&ze()}}}p(De.prototype,{then:Le,_then:function(e,t){Ve(this,new Fe(null,null,e,t,Ce))},catch:function(e){if(1===arguments.length)return this.then(null,e);var t=arguments[0],n=arguments[1];return"function"==typeof t?this.then(null,(function(e){return e instanceof t?n(e):He(e)})):this.then(null,(function(e){return e&&e.name===t?n(e):He(e)}))},finally:function(e){return this.then((function(t){return De.resolve(e()).then((function(){return t}))}),(function(t){return De.resolve(e()).then((function(){return He(t)}))}))},timeout:function(e,t){var n=this;return e<1/0?new De((function(r,i){var o=setTimeout((function(){return i(new te.Timeout(t))}),e);n.then(r,i).finally(clearTimeout.bind(null,o))})):this}}),"undefined"!=typeof Symbol&&Symbol.toStringTag&&y(De.prototype,Symbol.toStringTag,"Dexie.Promise"),Ie.env=pt(),p(De,{all:function(){var e=$.apply(null,arguments).map(ct);return new De((function(t,n){0===e.length&&t([]);var r=e.length;e.forEach((function(i,o){return De.resolve(i).then((function(n){e[o]=n,--r||t(e)}),n)}))}))},resolve:function(e){return e instanceof De?e:e&&"function"==typeof e.then?new De((function(t,n){e.then(t,n)})):new De(ve,!0,e)},reject:He,race:function(){var e=$.apply(null,arguments).map(ct);return new De((function(t,n){e.map((function(e){return De.resolve(e).then(t,n)}))}))},PSD:{get:function(){return Ce},set:function(e){return Ce=e}},totalEchoes:{get:function(){return it}},newPSD:at,usePSD:dt,scheduler:{get:function(){return Se},set:function(e){Se=e}},rejectionMapper:{get:function(){return Ne},set:function(e){Ne=e}},follow:function(e,t){return new De((function(n,r){return at((function(t,n){var r=Ce;r.unhandleds=[],r.onunhandled=n,r.finalize=se((function(){var e=this;We((function(){0===e.unhandleds.length?t():n(e.unhandleds[0])}))}),r.finalize),e()}),t,n,r)}))}}),Ee&&(Ee.allSettled&&y(De,"allSettled",(function(){var e=$.apply(null,arguments).map(ct);return new De((function(t){0===e.length&&t([]);var n=e.length,r=new Array(n);e.forEach((function(e,i){return De.resolve(e).then((function(e){return r[i]={status:"fulfilled",value:e}}),(function(e){return r[i]={status:"rejected",reason:e}})).then((function(){return--n||t(r)}))}))}))})),Ee.any&&"undefined"!=typeof AggregateError&&y(De,"any",(function(){var e=$.apply(null,arguments).map(ct);return new De((function(t,n){0===e.length&&n(new AggregateError([]));var r=e.length,i=new Array(r);e.forEach((function(e,o){return De.resolve(e).then((function(e){return t(e)}),(function(e){i[o]=e,--r||n(new AggregateError(i))}))}))}))})));var et={awaits:0,echoes:0,id:0},tt=0,nt=[],rt=0,it=0,ot=0;function at(e,t,n,r){var i=Ce,o=Object.create(i);o.parent=i,o.ref=0,o.global=!1,o.id=++ot,Ie.env,o.env=ke?{Promise:De,PromiseProp:{value:De,configurable:!0,writable:!0},all:De.all,race:De.race,allSettled:De.allSettled,any:De.any,resolve:De.resolve,reject:De.reject}:{},t&&c(o,t),++i.ref,o.finalize=function(){--this.parent.ref||this.parent.finalize()};var a=dt(o,e,n,r);return 0===o.ref&&o.finalize(),a}function ut(){return et.id||(et.id=++tt),++et.awaits,et.echoes+=be,et.id}function st(){return!!et.awaits&&(0==--et.awaits&&(et.id=0),et.echoes=et.awaits*be,!0)}function ct(e){return et.echoes&&e&&e.constructor===Ee?(ut(),e.then((function(e){return st(),e}),(function(e){return st(),bt(e)}))):e}function lt(e){++it,et.echoes&&0!=--et.echoes||(et.echoes=et.awaits=et.id=0),nt.push(Ce),ht(e,!0)}function ft(){var e=nt[nt.length-1];nt.pop(),ht(e,!1)}function ht(e,t){var n=Ce;if((t?!et.echoes||rt++&&e===Ce:!rt||--rt&&e===Ce)||queueMicrotask(t?lt.bind(null,e):ft),e!==Ce&&(Ce=e,n===Ie&&(Ie.env=pt()),ke)){var r=Ie.env.Promise,i=e.env;(n.global||e.global)&&(Object.defineProperty(a,"Promise",i.PromiseProp),r.all=i.all,r.race=i.race,r.resolve=i.resolve,r.reject=i.reject,i.allSettled&&(r.allSettled=i.allSettled),i.any&&(r.any=i.any))}}function pt(){var e=a.Promise;return ke?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(a,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject}:{}}function dt(e,t,n,r,i){var o=Ce;try{return ht(e,!0),t(n,r,i)}finally{ht(o,!1)}}function yt(e,t,n,r){return"function"!=typeof e?e:function(){var i=Ce;n&&ut(),ht(t,!0);try{return e.apply(this,arguments)}finally{ht(i,!1),r&&queueMicrotask(st)}}}function vt(e){Promise===Ee&&0===et.echoes?0===rt?e():enqueueNativeMicroTask(e):setTimeout(e,0)}-1===(""+Oe).indexOf("[native code]")&&(ut=st=oe);var bt=De.reject;function mt(e,t,n,r){if(e.idbdb&&(e._state.openComplete||Ce.letThrough||e._vip)){var i=e._createTransaction(t,n,e._dbSchema);try{i.create(),e._state.PR1398_maxLoop=3}catch(i){return i.name===Z.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e.close({disableAutoOpen:!1}),e.open().then((function(){return mt(e,t,n,r)}))):bt(i)}return i._promise(t,(function(e,t){return at((function(){return Ce.trans=i,r(e,t,i)}))})).then((function(e){if("readwrite"===t)try{i.idbtrans.commit()}catch(e){}return"readonly"===t?e:i._completion.then((function(){return e}))}))}if(e._state.openComplete)return bt(new te.DatabaseClosed(e._state.dbOpenError));if(!e._state.isBeingOpened){if(!e._state.autoOpen)return bt(new te.DatabaseClosed);e.open().catch(oe)}return e._state.dbReadyPromise.then((function(){return mt(e,t,n,r)}))}var gt="4.0.8",wt=String.fromCharCode(65535),_t=-1/0,Ot="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Et="String expected.",kt=[],xt="__dbnames",St="readonly",At="readwrite";function Tt(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}var jt={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Pt(e){return"string"!=typeof e||/\./.test(e)?function(e){return e}:function(t){return void 0===t[e]&&e in t&&delete(t=R(t))[e],t}}function Nt(){throw te.Type()}function It(e,t){try{var n=Kt(e),r=Kt(t);if(n!==r)return"Array"===n?1:"Array"===r?-1:"binary"===n?1:"binary"===r?-1:"string"===n?1:"string"===r?-1:"Date"===n?1:"Date"!==r?NaN:-1;switch(n){case"number":case"Date":case"string":return e>t?1:e<t?-1:0;case"binary":return Bt(Rt(e),Rt(t));case"Array":return Ct(e,t)}}catch(e){}return NaN}function Ct(e,t){for(var n=e.length,r=t.length,i=n<r?n:r,o=0;o<i;++o){var a=It(e[o],t[o]);if(0!==a)return a}return n===r?0:n<r?-1:1}function Bt(e,t){for(var n=e.length,r=t.length,i=n<r?n:r,o=0;o<i;++o)if(e[o]!==t[o])return e[o]<t[o]?-1:1;return n===r?0:n<r?-1:1}function Kt(e){var n=t(e);if("object"!==n)return n;if(ArrayBuffer.isView(e))return"binary";var r=F(e);return"ArrayBuffer"===r?"binary":r}function Rt(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}var Dt=function(){function e(){}return e.prototype._trans=function(e,t,n){var r=this._tx||Ce.trans,i=this.name,o=de&&"undefined"!=typeof console&&console.createTask&&console.createTask("Dexie: ".concat("readonly"===e?"read":"write"," ").concat(this.name));function a(e,n,r){if(!r.schema[i])throw new te.NotFound("Table "+i+" not part of transaction");return t(r.idbtrans,r)}var u=Ye();try{var s=r&&r.db._novip===this.db._novip?r===Ce.trans?r._promise(e,a,n):at((function(){return r._promise(e,a,n)}),{trans:r,transless:Ce.transless||Ce}):mt(this.db,e,[this.name],a);return o&&(s._consoleTask=o,s=s.catch((function(e){return console.trace(e),bt(e)}))),s}finally{u&&ze()}},e.prototype.get=function(e,t){var n=this;return e&&e.constructor===Object?this.where(e).first(t):null==e?bt(new te.Type("Invalid argument to Table.get()")):this._trans("readonly",(function(t){return n.core.get({trans:t,key:e}).then((function(e){return n.hook.reading.fire(e)}))})).then(t)},e.prototype.where=function(e){if("string"==typeof e)return new this.db.WhereClause(this,e);if(s(e))return new this.db.WhereClause(this,"[".concat(e.join("+"),"]"));var t=u(e);if(1===t.length)return this.where(t[0]).equals(e[t[0]]);var n=this.schema.indexes.concat(this.schema.primKey).filter((function(e){if(e.compound&&t.every((function(t){return e.keyPath.indexOf(t)>=0}))){for(var n=0;n<t.length;++n)if(-1===t.indexOf(e.keyPath[n]))return!1;return!0}return!1})).sort((function(e,t){return e.keyPath.length-t.keyPath.length}))[0];if(n&&this.db._maxKey!==wt){var r=n.keyPath.slice(0,t.length);return this.where(r).equals(r.map((function(t){return e[t]})))}!n&&de&&console.warn("The query ".concat(JSON.stringify(e)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(t.join("+"),"]"));var i=this.schema.idxByName,o=this.db._deps.indexedDB;function a(e,t){return 0===o.cmp(e,t)}var c=t.reduce((function(t,n){var r=t[0],o=t[1],u=i[n],c=e[n];return[r||u,r||!u?Tt(o,u&&u.multi?function(e){var t=x(e,n);return s(t)&&t.some((function(e){return a(c,e)}))}:function(e){return a(c,x(e,n))}):o]}),[null,null]),l=c[0],f=c[1];return l?this.where(l.name).equals(e[l.keyPath]).filter(f):n?this.filter(f):this.where(t).equals("")},e.prototype.filter=function(e){return this.toCollection().and(e)},e.prototype.count=function(e){return this.toCollection().count(e)},e.prototype.offset=function(e){return this.toCollection().offset(e)},e.prototype.limit=function(e){return this.toCollection().limit(e)},e.prototype.each=function(e){return this.toCollection().each(e)},e.prototype.toArray=function(e){return this.toCollection().toArray(e)},e.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},e.prototype.orderBy=function(e){return new this.db.Collection(new this.db.WhereClause(this,s(e)?"[".concat(e.join("+"),"]"):e))},e.prototype.reverse=function(){return this.toCollection().reverse()},e.prototype.mapToClass=function(e){var t=this,n=t.db,i=t.name;this.schema.mappedClass=e,e.prototype instanceof Nt&&(e=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),Object.defineProperty(t.prototype,"db",{get:function(){return n},enumerable:!1,configurable:!0}),t.prototype.table=function(){return i},t}(e));for(var o=new Set,a=e.prototype;a;a=l(a))Object.getOwnPropertyNames(a).forEach((function(e){return o.add(e)}));var u=function(t){if(!t)return t;var n=Object.create(e.prototype);for(var r in t)if(!o.has(r))try{n[r]=t[r]}catch(e){}return n};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=u,this.hook("reading",u),e},e.prototype.defineClass=function(){function e(e){c(this,e)}return this.mapToClass(e)},e.prototype.add=function(e,t){var n=this,r=this.schema.primKey,i=r.auto,o=r.keyPath,a=e;return o&&i&&(a=Pt(o)(e)),this._trans("readwrite",(function(e){return n.core.mutate({trans:e,type:"add",keys:null!=t?[t]:null,values:[a]})})).then((function(e){return e.numFailures?De.reject(e.failures[0]):e.lastResult})).then((function(t){if(o)try{S(e,o,t)}catch(e){}return t}))},e.prototype.update=function(e,n){if("object"!==t(e)||s(e))return this.where(":id").equals(e).modify(n);var r=x(e,this.schema.primKey.keyPath);return void 0===r?bt(new te.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(r).modify(n)},e.prototype.put=function(e,t){var n=this,r=this.schema.primKey,i=r.auto,o=r.keyPath,a=e;return o&&i&&(a=Pt(o)(e)),this._trans("readwrite",(function(e){return n.core.mutate({trans:e,type:"put",values:[a],keys:null!=t?[t]:null})})).then((function(e){return e.numFailures?De.reject(e.failures[0]):e.lastResult})).then((function(t){if(o)try{S(e,o,t)}catch(e){}return t}))},e.prototype.delete=function(e){var t=this;return this._trans("readwrite",(function(n){return t.core.mutate({trans:n,type:"delete",keys:[e]})})).then((function(e){return e.numFailures?De.reject(e.failures[0]):void 0}))},e.prototype.clear=function(){var e=this;return this._trans("readwrite",(function(t){return e.core.mutate({trans:t,type:"deleteRange",range:jt})})).then((function(e){return e.numFailures?De.reject(e.failures[0]):void 0}))},e.prototype.bulkGet=function(e){var t=this;return this._trans("readonly",(function(n){return t.core.getMany({keys:e,trans:n}).then((function(e){return e.map((function(e){return t.hook.reading.fire(e)}))}))}))},e.prototype.bulkAdd=function(e,t,n){var r=this,i=Array.isArray(t)?t:void 0,o=(n=n||(i?void 0:t))?n.allKeys:void 0;return this._trans("readwrite",(function(t){var n=r.schema.primKey,a=n.auto,u=n.keyPath;if(u&&i)throw new te.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(i&&i.length!==e.length)throw new te.InvalidArgument("Arguments objects and keys must have the same length");var s=e.length,c=u&&a?e.map(Pt(u)):e;return r.core.mutate({trans:t,type:"add",keys:i,values:c,wantResults:o}).then((function(e){var t=e.numFailures,n=e.results,i=e.lastResult,a=e.failures;if(0===t)return o?n:i;throw new H("".concat(r.name,".bulkAdd(): ").concat(t," of ").concat(s," operations failed"),a)}))}))},e.prototype.bulkPut=function(e,t,n){var r=this,i=Array.isArray(t)?t:void 0,o=(n=n||(i?void 0:t))?n.allKeys:void 0;return this._trans("readwrite",(function(t){var n=r.schema.primKey,a=n.auto,u=n.keyPath;if(u&&i)throw new te.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(i&&i.length!==e.length)throw new te.InvalidArgument("Arguments objects and keys must have the same length");var s=e.length,c=u&&a?e.map(Pt(u)):e;return r.core.mutate({trans:t,type:"put",keys:i,values:c,wantResults:o}).then((function(e){var t=e.numFailures,n=e.results,i=e.lastResult,a=e.failures;if(0===t)return o?n:i;throw new H("".concat(r.name,".bulkPut(): ").concat(t," of ").concat(s," operations failed"),a)}))}))},e.prototype.bulkUpdate=function(e){var t=this,n=this.core,r=e.map((function(e){return e.key})),i=e.map((function(e){return e.changes})),o=[];return this._trans("readwrite",(function(a){return n.getMany({trans:a,keys:r,cache:"clone"}).then((function(u){var s=[],c=[];e.forEach((function(e,n){var r=e.key,i=e.changes,a=u[n];if(a){for(var l=0,f=Object.keys(i);l<f.length;l++){var h=f[l],p=i[h];if(h===t.schema.primKey.keyPath){if(0!==It(p,r))throw new te.Constraint("Cannot update primary key in bulkUpdate()")}else S(a,h,p)}o.push(n),s.push(r),c.push(a)}}));var l=s.length;return n.mutate({trans:a,type:"put",keys:s,values:c,updates:{keys:r,changeSpecs:i}}).then((function(e){var n=e.numFailures,r=e.failures;if(0===n)return l;for(var i=0,a=Object.keys(r);i<a.length;i++){var u=a[i],s=o[Number(u)];if(null!=s){var c=r[u];delete r[u],r[s]=c}}throw new H("".concat(t.name,".bulkUpdate(): ").concat(n," of ").concat(l," operations failed"),r)}))}))}))},e.prototype.bulkDelete=function(e){var t=this,n=e.length;return this._trans("readwrite",(function(n){return t.core.mutate({trans:n,type:"delete",keys:e})})).then((function(e){var r=e.numFailures,i=e.lastResult,o=e.failures;if(0===r)return i;throw new H("".concat(t.name,".bulkDelete(): ").concat(r," of ").concat(n," operations failed"),o)}))},e}();function Lt(e){var n={},r=function(t,r){if(r){for(var i=arguments.length,o=new Array(i-1);--i;)o[i-1]=arguments[i];return n[t].subscribe.apply(null,o),e}if("string"==typeof t)return n[t]};r.addEventType=a;for(var i=1,o=arguments.length;i<o;++i)a(arguments[i]);return r;function a(e,i,o){if("object"===t(e))return c(e);i||(i=he),o||(o=oe);var a={subscribers:[],fire:o,subscribe:function(e){-1===a.subscribers.indexOf(e)&&(a.subscribers.push(e),a.fire=i(a.fire,e))},unsubscribe:function(e){a.subscribers=a.subscribers.filter((function(t){return t!==e})),a.fire=a.subscribers.reduce(i,o)}};return n[e]=r[e]=a,a}function c(e){u(e).forEach((function(t){var n=e[t];if(s(n))a(t,e[t][0],e[t][1]);else{if("asap"!==n)throw new te.InvalidArgument("Invalid event config");var r=a(t,ae,(function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];r.subscribers.forEach((function(e){E((function(){e.apply(null,t)}))}))}))}}))}}function Ft(e,t){return v(t).from({prototype:e}),t}function qt(e){return Ft(Dt.prototype,(function(t,n,r){this.db=e,this._tx=r,this.name=t,this.schema=n,this.hook=e._allTables[t]?e._allTables[t].hook:Lt(null,{creating:[ce,oe],reading:[ue,ae],updating:[fe,oe],deleting:[le,oe]})}))}function Ut(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function Mt(e,t){e.filter=Tt(e.filter,t)}function Vt(e,t,n){var r=e.replayFilter;e.replayFilter=r?function(){return Tt(r(),t())}:t,e.justLimit=n&&!r}function $t(e,t){e.isMatch=Tt(e.isMatch,t)}function Gt(e,t){if(e.isPrimKey)return t.primaryKey;var n=t.getIndexByKeyPath(e.index);if(!n)throw new te.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return n}function Yt(e,t,n){var r=Gt(e,t.schema);return t.openCursor({trans:n,values:!e.keysOnly,reverse:"prev"===e.dir,unique:!!e.unique,query:{index:r,range:e.range}})}function zt(e,t,n,r){var i=e.replayFilter?Tt(e.filter,e.replayFilter()):e.filter;if(e.or){var o={},a=function(e,n,r){if(!i||i(n,r,(function(e){return n.stop(e)}),(function(e){return n.fail(e)}))){var a=n.primaryKey,u=""+a;"[object ArrayBuffer]"===u&&(u=""+new Uint8Array(a)),h(o,u)||(o[u]=!0,t(e,n,r))}};return Promise.all([e.or._iterate(a,n),Jt(Yt(e,r,n),e.algorithm,a,!e.keysOnly&&e.valueMapper)])}return Jt(Yt(e,r,n),Tt(e.algorithm,i),t,!e.keysOnly&&e.valueMapper)}function Jt(e,t,n,r){var i=Ze(r?function(e,t,i){return n(r(e),t,i)}:n);return e.then((function(e){if(e)return e.start((function(){var n=function(){return e.continue()};t&&!t(e,(function(e){return n=e}),(function(t){e.stop(t),n=oe}),(function(t){e.fail(t),n=oe}))||i(e.value,e,(function(e){return n=e})),n()}))}))}var Wt=Symbol(),Qt=function(){function e(e){Object.assign(this,e)}return e.prototype.execute=function(e){var t;if(void 0!==this.add){var n=this.add;if(s(n))return o(o([],s(e)?e:[],!0),n).sort();if("number"==typeof n)return(Number(e)||0)+n;if("bigint"==typeof n)try{return BigInt(e)+n}catch(e){return BigInt(0)+n}throw new TypeError("Invalid term ".concat(n))}if(void 0!==this.remove){var r=this.remove;if(s(r))return s(e)?e.filter((function(e){return!r.includes(e)})).sort():[];if("number"==typeof r)return Number(e)-r;if("bigint"==typeof r)try{return BigInt(e)-r}catch(e){return BigInt(0)-r}throw new TypeError("Invalid subtrahend ".concat(r))}var i=null===(t=this.replacePrefix)||void 0===t?void 0:t[0];return i&&"string"==typeof e&&e.startsWith(i)?this.replacePrefix[1]+e.substring(i.length):e},e}(),Xt=function(){function e(){}return e.prototype._read=function(e,t){var n=this._ctx;return n.error?n.table._trans(null,bt.bind(null,n.error)):n.table._trans("readonly",e).then(t)},e.prototype._write=function(e){var t=this._ctx;return t.error?t.table._trans(null,bt.bind(null,t.error)):t.table._trans("readwrite",e,"locked")},e.prototype._addAlgorithm=function(e){var t=this._ctx;t.algorithm=Tt(t.algorithm,e)},e.prototype._iterate=function(e,t){return zt(this._ctx,e,t,this._ctx.table.core)},e.prototype.clone=function(e){var t=Object.create(this.constructor.prototype),n=Object.create(this._ctx);return e&&c(n,e),t._ctx=n,t},e.prototype.raw=function(){return this._ctx.valueMapper=null,this},e.prototype.each=function(e){var t=this._ctx;return this._read((function(n){return zt(t,e,n,t.table.core)}))},e.prototype.count=function(e){var t=this;return this._read((function(e){var n=t._ctx,r=n.table.core;if(Ut(n,!0))return r.count({trans:e,query:{index:Gt(n,r.schema),range:n.range}}).then((function(e){return Math.min(e,n.limit)}));var i=0;return zt(n,(function(){return++i,!1}),e,r).then((function(){return i}))})).then(e)},e.prototype.sortBy=function(e,t){var n=e.split(".").reverse(),r=n[0],i=n.length-1;function o(e,t){return t?o(e[n[t]],t-1):e[r]}var a="next"===this._ctx.dir?1:-1;function u(e,t){var n=o(e,i),r=o(t,i);return n<r?-a:n>r?a:0}return this.toArray((function(e){return e.sort(u)})).then(t)},e.prototype.toArray=function(e){var t=this;return this._read((function(e){var n=t._ctx;if("next"===n.dir&&Ut(n,!0)&&n.limit>0){var r=n.valueMapper,i=Gt(n,n.table.core.schema);return n.table.core.query({trans:e,limit:n.limit,values:!0,query:{index:i,range:n.range}}).then((function(e){var t=e.result;return r?t.map(r):t}))}var o=[];return zt(n,(function(e){return o.push(e)}),e,n.table.core).then((function(){return o}))}),e)},e.prototype.offset=function(e){var t=this._ctx;return e<=0||(t.offset+=e,Ut(t)?Vt(t,(function(){var t=e;return function(e,n){return 0===t||(1===t?(--t,!1):(n((function(){e.advance(t),t=0})),!1))}})):Vt(t,(function(){var t=e;return function(){return--t<0}}))),this},e.prototype.limit=function(e){return this._ctx.limit=Math.min(this._ctx.limit,e),Vt(this._ctx,(function(){var t=e;return function(e,n,r){return--t<=0&&n(r),t>=0}}),!0),this},e.prototype.until=function(e,t){return Mt(this._ctx,(function(n,r,i){return!e(n.value)||(r(i),t)})),this},e.prototype.first=function(e){return this.limit(1).toArray((function(e){return e[0]})).then(e)},e.prototype.last=function(e){return this.reverse().first(e)},e.prototype.filter=function(e){return Mt(this._ctx,(function(t){return e(t.value)})),$t(this._ctx,e),this},e.prototype.and=function(e){return this.filter(e)},e.prototype.or=function(e){return new this.db.WhereClause(this._ctx.table,e,this)},e.prototype.reverse=function(){return this._ctx.dir="prev"===this._ctx.dir?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},e.prototype.desc=function(){return this.reverse()},e.prototype.eachKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each((function(t,n){e(n.key,n)}))},e.prototype.eachUniqueKey=function(e){return this._ctx.unique="unique",this.eachKey(e)},e.prototype.eachPrimaryKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each((function(t,n){e(n.primaryKey,n)}))},e.prototype.keys=function(e){var t=this._ctx;t.keysOnly=!t.isMatch;var n=[];return this.each((function(e,t){n.push(t.key)})).then((function(){return n})).then(e)},e.prototype.primaryKeys=function(e){var t=this._ctx;if("next"===t.dir&&Ut(t,!0)&&t.limit>0)return this._read((function(e){var n=Gt(t,t.table.core.schema);return t.table.core.query({trans:e,values:!1,limit:t.limit,query:{index:n,range:t.range}})})).then((function(e){return e.result})).then(e);t.keysOnly=!t.isMatch;var n=[];return this.each((function(e,t){n.push(t.primaryKey)})).then((function(){return n})).then(e)},e.prototype.uniqueKeys=function(e){return this._ctx.unique="unique",this.keys(e)},e.prototype.firstKey=function(e){return this.limit(1).keys((function(e){return e[0]})).then(e)},e.prototype.lastKey=function(e){return this.reverse().firstKey(e)},e.prototype.distinct=function(){var e=this._ctx,t=e.index&&e.table.schema.idxByName[e.index];if(!t||!t.multi)return this;var n={};return Mt(this._ctx,(function(e){var t=e.primaryKey.toString(),r=h(n,t);return n[t]=!0,!r})),this},e.prototype.modify=function(e){var n=this,r=this._ctx;return this._write((function(i){var o;if("function"==typeof e)o=e;else{var a=u(e),s=a.length;o=function(t){for(var n=!1,r=0;r<s;++r){var i=a[r],o=e[i],u=x(t,i);o instanceof Qt?(S(t,i,o.execute(u)),n=!0):u!==o&&(S(t,i,o),n=!0)}return n}}var c=r.table.core,l=c.schema.primaryKey,f=l.outbound,h=l.extractKey,p=n.db._options.modifyChunkSize||200,d=[],y=0,v=[],b=function(e,t){var n=t.failures,r=t.numFailures;y+=e-r;for(var i=0,o=u(n);i<o.length;i++){var a=o[i];d.push(n[a])}};return n.clone().primaryKeys().then((function(n){var a=Ut(r)&&r.limit===1/0&&("function"!=typeof e||e===Ht)&&{index:r.index,range:r.range},u=function r(u){var s=Math.min(p,n.length-u);return c.getMany({trans:i,keys:n.slice(u,u+s),cache:"immutable"}).then((function(l){for(var d=[],y=[],v=f?[]:null,m=[],g=0;g<s;++g){var w=l[g],_={value:R(w),primKey:n[u+g]};!1!==o.call(_,_.value,_)&&(null==_.value?m.push(n[u+g]):f||0===It(h(w),h(_.value))?(y.push(_.value),f&&v.push(n[u+g])):(m.push(n[u+g]),d.push(_.value)))}return Promise.resolve(d.length>0&&c.mutate({trans:i,type:"add",values:d}).then((function(e){for(var t in e.failures)m.splice(parseInt(t),1);b(d.length,e)}))).then((function(){return(y.length>0||a&&"object"===t(e))&&c.mutate({trans:i,type:"put",keys:v,values:y,criteria:a,changeSpec:"function"!=typeof e&&e,isAdditionalChunk:u>0}).then((function(e){return b(y.length,e)}))})).then((function(){return(m.length>0||a&&e===Ht)&&c.mutate({trans:i,type:"delete",keys:m,criteria:a,isAdditionalChunk:u>0}).then((function(e){return b(m.length,e)}))})).then((function(){return n.length>u+s&&r(u+p)}))}))};return u(0).then((function(){if(d.length>0)throw new X("Error modifying one or more objects",d,y,v);return n.length}))}))}))},e.prototype.delete=function(){var e=this._ctx,t=e.range;return Ut(e)&&(e.isPrimKey||3===t.type)?this._write((function(n){var r=e.table.core.schema.primaryKey,i=t;return e.table.core.count({trans:n,query:{index:r,range:i}}).then((function(t){return e.table.core.mutate({trans:n,type:"deleteRange",range:i}).then((function(e){var n=e.failures;e.lastResult,e.results;var r=e.numFailures;if(r)throw new X("Could not delete some values",Object.keys(n).map((function(e){return n[e]})),t-r);return t-r}))}))})):this.modify(Ht)},e}(),Ht=function(e,t){return t.value=null};function Zt(e){return Ft(Xt.prototype,(function(t,n){this.db=e;var r=jt,i=null;if(n)try{r=n()}catch(e){i=e}var o=t._ctx,a=o.table,u=a.hook.reading.fire;this._ctx={table:a,index:o.index,isPrimKey:!o.index||a.schema.primKey.keyPath&&o.index===a.schema.primKey.name,range:r,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:i,or:o.or,valueMapper:u!==ae?u:null}}))}function en(e,t){return e<t?-1:e===t?0:1}function tn(e,t){return e>t?-1:e===t?0:1}function nn(e,t,n){var r=e instanceof fn?new e.Collection(e):e;return r._ctx.error=n?new n(t):new TypeError(t),r}function rn(e){return new e.Collection(e,(function(){return ln("")})).limit(0)}function on(e){return"next"===e?function(e){return e.toUpperCase()}:function(e){return e.toLowerCase()}}function an(e){return"next"===e?function(e){return e.toLowerCase()}:function(e){return e.toUpperCase()}}function un(e,t,n,r,i,o){for(var a=Math.min(e.length,r.length),u=-1,s=0;s<a;++s){var c=t[s];if(c!==r[s])return i(e[s],n[s])<0?e.substr(0,s)+n[s]+n.substr(s+1):i(e[s],r[s])<0?e.substr(0,s)+r[s]+n.substr(s+1):u>=0?e.substr(0,u)+t[u]+n.substr(u+1):null;i(e[s],c)<0&&(u=s)}return a<r.length&&"next"===o?e+n.substr(e.length):a<e.length&&"prev"===o?e.substr(0,n.length):u<0?null:e.substr(0,u)+r[u]+n.substr(u+1)}function sn(e,t,n,r){var i,o,a,u,s,c,l,f=n.length;if(!n.every((function(e){return"string"==typeof e})))return nn(e,Et);function h(e){i=on(e),o=an(e),a="next"===e?en:tn;var t=n.map((function(e){return{lower:o(e),upper:i(e)}})).sort((function(e,t){return a(e.lower,t.lower)}));u=t.map((function(e){return e.upper})),s=t.map((function(e){return e.lower})),c=e,l="next"===e?"":r}h("next");var p=new e.Collection(e,(function(){return cn(u[0],s[f-1]+r)}));p._ondirectionchange=function(e){h(e)};var d=0;return p._addAlgorithm((function(e,n,r){var i=e.key;if("string"!=typeof i)return!1;var h=o(i);if(t(h,s,d))return!0;for(var p=null,y=d;y<f;++y){var v=un(i,h,u[y],s[y],a,c);null===v&&null===p?d=y+1:(null===p||a(p,v)>0)&&(p=v)}return n(null!==p?function(){e.continue(p+l)}:r),!1})),p}function cn(e,t,n,r){return{type:2,lower:e,upper:t,lowerOpen:n,upperOpen:r}}function ln(e){return{type:1,lower:e,upper:e}}var fn=function(){function e(){}return Object.defineProperty(e.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),e.prototype.between=function(e,t,n,r){n=!1!==n,r=!0===r;try{return this._cmp(e,t)>0||0===this._cmp(e,t)&&(n||r)&&(!n||!r)?rn(this):new this.Collection(this,(function(){return cn(e,t,!n,!r)}))}catch(e){return nn(this,Ot)}},e.prototype.equals=function(e){return null==e?nn(this,Ot):new this.Collection(this,(function(){return ln(e)}))},e.prototype.above=function(e){return null==e?nn(this,Ot):new this.Collection(this,(function(){return cn(e,void 0,!0)}))},e.prototype.aboveOrEqual=function(e){return null==e?nn(this,Ot):new this.Collection(this,(function(){return cn(e,void 0,!1)}))},e.prototype.below=function(e){return null==e?nn(this,Ot):new this.Collection(this,(function(){return cn(void 0,e,!1,!0)}))},e.prototype.belowOrEqual=function(e){return null==e?nn(this,Ot):new this.Collection(this,(function(){return cn(void 0,e)}))},e.prototype.startsWith=function(e){return"string"!=typeof e?nn(this,Et):this.between(e,e+wt,!0,!0)},e.prototype.startsWithIgnoreCase=function(e){return""===e?this.startsWith(e):sn(this,(function(e,t){return 0===e.indexOf(t[0])}),[e],wt)},e.prototype.equalsIgnoreCase=function(e){return sn(this,(function(e,t){return e===t[0]}),[e],"")},e.prototype.anyOfIgnoreCase=function(){var e=$.apply(V,arguments);return 0===e.length?rn(this):sn(this,(function(e,t){return-1!==t.indexOf(e)}),e,"")},e.prototype.startsWithAnyOfIgnoreCase=function(){var e=$.apply(V,arguments);return 0===e.length?rn(this):sn(this,(function(e,t){return t.some((function(t){return 0===e.indexOf(t)}))}),e,wt)},e.prototype.anyOf=function(){var e=this,t=$.apply(V,arguments),n=this._cmp;try{t.sort(n)}catch(e){return nn(this,Ot)}if(0===t.length)return rn(this);var r=new this.Collection(this,(function(){return cn(t[0],t[t.length-1])}));r._ondirectionchange=function(r){n="next"===r?e._ascending:e._descending,t.sort(n)};var i=0;return r._addAlgorithm((function(e,r,o){for(var a=e.key;n(a,t[i])>0;)if(++i===t.length)return r(o),!1;return 0===n(a,t[i])||(r((function(){e.continue(t[i])})),!1)})),r},e.prototype.notEqual=function(e){return this.inAnyRange([[_t,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},e.prototype.noneOf=function(){var e=$.apply(V,arguments);if(0===e.length)return new this.Collection(this);try{e.sort(this._ascending)}catch(e){return nn(this,Ot)}var t=e.reduce((function(e,t){return e?e.concat([[e[e.length-1][1],t]]):[[_t,t]]}),null);return t.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(t,{includeLowers:!1,includeUppers:!1})},e.prototype.inAnyRange=function(e,t){var n=this,r=this._cmp,i=this._ascending,o=this._descending,a=this._min,u=this._max;if(0===e.length)return rn(this);if(!e.every((function(e){return void 0!==e[0]&&void 0!==e[1]&&i(e[0],e[1])<=0})))return nn(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",te.InvalidArgument);var s=!t||!1!==t.includeLowers,c=t&&!0===t.includeUppers;function l(e,t){for(var n=0,i=e.length;n<i;++n){var o=e[n];if(r(t[0],o[1])<0&&r(t[1],o[0])>0){o[0]=a(o[0],t[0]),o[1]=u(o[1],t[1]);break}}return n===i&&e.push(t),e}var f,h=i;function p(e,t){return h(e[0],t[0])}try{(f=e.reduce(l,[])).sort(p)}catch(e){return nn(this,Ot)}var d=0,y=c?function(e){return i(e,f[d][1])>0}:function(e){return i(e,f[d][1])>=0},v=s?function(e){return o(e,f[d][0])>0}:function(e){return o(e,f[d][0])>=0};function b(e){return!y(e)&&!v(e)}var m=y,g=new this.Collection(this,(function(){return cn(f[0][0],f[f.length-1][1],!s,!c)}));return g._ondirectionchange=function(e){"next"===e?(m=y,h=i):(m=v,h=o),f.sort(p)},g._addAlgorithm((function(e,t,r){for(var o=e.key;m(o);)if(++d===f.length)return t(r),!1;return!!b(o)||(0===n._cmp(o,f[d][1])||0===n._cmp(o,f[d][0])||t((function(){h===i?e.continue(f[d][0]):e.continue(f[d][1])})),!1)})),g},e.prototype.startsWithAnyOf=function(){var e=$.apply(V,arguments);return e.every((function(e){return"string"==typeof e}))?0===e.length?rn(this):this.inAnyRange(e.map((function(e){return[e,e+wt]}))):nn(this,"startsWithAnyOf() only works with strings")},e}();function hn(e){return Ft(fn.prototype,(function(t,n,r){if(this.db=e,this._ctx={table:t,index:":id"===n?null:n,or:r},this._cmp=this._ascending=It,this._descending=function(e,t){return It(t,e)},this._max=function(e,t){return It(e,t)>0?e:t},this._min=function(e,t){return It(e,t)<0?e:t},this._IDBKeyRange=e._deps.IDBKeyRange,!this._IDBKeyRange)throw new te.MissingAPI}))}function pn(e){return Ze((function(t){return dn(t),e(t.target.error),!1}))}function dn(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}var yn="storagemutated",vn="x-storagemutated-1",bn=Lt(null,yn),mn=function(){function e(){}return e.prototype._lock=function(){return O(!Ce.global),++this._reculock,1!==this._reculock||Ce.global||(Ce.lockOwnerFor=this),this},e.prototype._unlock=function(){if(O(!Ce.global),0==--this._reculock)for(Ce.global||(Ce.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var e=this._blockedFuncs.shift();try{dt(e[1],e[0])}catch(e){}}return this},e.prototype._locked=function(){return this._reculock&&Ce.lockOwnerFor!==this},e.prototype.create=function(e){var t=this;if(!this.mode)return this;var n=this.db.idbdb,r=this.db._state.dbOpenError;if(O(!this.idbtrans),!e&&!n)switch(r&&r.name){case"DatabaseClosedError":throw new te.DatabaseClosed(r);case"MissingAPIError":throw new te.MissingAPI(r.message,r);default:throw new te.OpenFailed(r)}if(!this.active)throw new te.TransactionInactive;return O(null===this._completion._state),(e=this.idbtrans=e||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):n.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}))).onerror=Ze((function(n){dn(n),t._reject(e.error)})),e.onabort=Ze((function(n){dn(n),t.active&&t._reject(new te.Abort(e.error)),t.active=!1,t.on("abort").fire(n)})),e.oncomplete=Ze((function(){t.active=!1,t._resolve(),"mutatedParts"in e&&bn.storagemutated.fire(e.mutatedParts)})),this},e.prototype._promise=function(e,t,n){var r=this;if("readwrite"===e&&"readwrite"!==this.mode)return bt(new te.ReadOnly("Transaction is readonly"));if(!this.active)return bt(new te.TransactionInactive);if(this._locked())return new De((function(i,o){r._blockedFuncs.push([function(){r._promise(e,t,n).then(i,o)},Ce])}));if(n)return at((function(){var e=new De((function(e,n){r._lock();var i=t(e,n,r);i&&i.then&&i.then(e,n)}));return e.finally((function(){return r._unlock()})),e._lib=!0,e}));var i=new De((function(e,n){var i=t(e,n,r);i&&i.then&&i.then(e,n)}));return i._lib=!0,i},e.prototype._root=function(){return this.parent?this.parent._root():this},e.prototype.waitFor=function(e){var t=this._root(),n=De.resolve(e);if(t._waitingFor)t._waitingFor=t._waitingFor.then((function(){return n}));else{t._waitingFor=n,t._waitingQueue=[];var r=t.idbtrans.objectStore(t.storeNames[0]);!function e(){for(++t._spinCount;t._waitingQueue.length;)t._waitingQueue.shift()();t._waitingFor&&(r.get(-1/0).onsuccess=e)}()}var i=t._waitingFor;return new De((function(e,r){n.then((function(n){return t._waitingQueue.push(Ze(e.bind(null,n)))}),(function(e){return t._waitingQueue.push(Ze(r.bind(null,e)))})).finally((function(){t._waitingFor===i&&(t._waitingFor=null)}))}))},e.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new te.Abort))},e.prototype.table=function(e){var t=this._memoizedTables||(this._memoizedTables={});if(h(t,e))return t[e];var n=this.schema[e];if(!n)throw new te.NotFound("Table "+e+" not part of transaction");var r=new this.db.Table(e,n,this);return r.core=this.db.core.table(e),t[e]=r,r},e}();function gn(e){return Ft(mn.prototype,(function(t,n,r,i,o){var a=this;this.db=e,this.mode=t,this.storeNames=n,this.schema=r,this.chromeTransactionDurability=i,this.idbtrans=null,this.on=Lt(this,"complete","error","abort"),this.parent=o||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new De((function(e,t){a._resolve=e,a._reject=t})),this._completion.then((function(){a.active=!1,a.on.complete.fire()}),(function(e){var t=a.active;return a.active=!1,a.on.error.fire(e),a.parent?a.parent._reject(e):t&&a.idbtrans&&a.idbtrans.abort(),bt(e)}))}))}function wn(e,t,n,r,i,o,a){return{name:e,keyPath:t,unique:n,multi:r,auto:i,compound:o,src:(n&&!a?"&":"")+(r?"*":"")+(i?"++":"")+_n(t)}}function _n(e){return"string"==typeof e?e:e?"["+[].join.call(e,"+")+"]":""}function On(e,t,n){return{name:e,primKey:t,indexes:n,mappedClass:null,idxByName:k(n,(function(e){return[e.name,e]}))}}function En(e){return 1===e.length?e[0]:e}var kn=function(e){try{return e.only([[]]),kn=function(){return[[]]},[[]]}catch(e){return kn=function(){return wt},wt}};function xn(e){return null==e?function(){}:"string"==typeof e?Sn(e):function(t){return x(t,e)}}function Sn(e){return 1===e.split(".").length?function(t){return t[e]}:function(t){return x(t,e)}}function An(e){return[].slice.call(e)}var Tn=0;function jn(e){return null==e?":id":"string"==typeof e?e:"[".concat(e.join("+"),"]")}function Pn(e,t,n){function r(e,t){var n=An(e.objectStoreNames);return{schema:{name:e.name,tables:n.map((function(e){return t.objectStore(e)})).map((function(e){var t=e.keyPath,n=e.autoIncrement,r=s(t),i=null==t,o={},a={name:e.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:i,compound:r,keyPath:t,autoIncrement:n,unique:!0,extractKey:xn(t)},indexes:An(e.indexNames).map((function(t){return e.index(t)})).map((function(e){var t=e.name,n=e.unique,r=e.multiEntry,i=e.keyPath,a={name:t,compound:s(i),keyPath:i,unique:n,multiEntry:r,extractKey:xn(i)};return o[jn(i)]=a,a})),getIndexByKeyPath:function(e){return o[jn(e)]}};return o[":id"]=a.primaryKey,null!=t&&(o[jn(t)]=a.primaryKey),a}))},hasGetAll:n.length>0&&"getAll"in t.objectStore(n[0])&&!("undefined"!=typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}function i(e){if(3===e.type)return null;if(4===e.type)throw new Error("Cannot convert never type to IDBKeyRange");var n=e.lower,r=e.upper,i=e.lowerOpen,o=e.upperOpen;return void 0===n?void 0===r?null:t.upperBound(r,!!o):void 0===r?t.lowerBound(n,!!i):t.bound(n,r,!!i,!!o)}function o(e){var t=e.name;function n(e){var n=e.trans,r=e.type,o=e.keys,a=e.values,u=e.range;return new Promise((function(e,s){e=Ze(e);var c=n.objectStore(t),l=null==c.keyPath,f="put"===r||"add"===r;if(!f&&"delete"!==r&&"deleteRange"!==r)throw new Error("Invalid operation type: "+r);var h,p=(o||a||{length:1}).length;if(o&&a&&o.length!==a.length)throw new Error("Given keys array must have same length as given values array.");if(0===p)return e({numFailures:0,failures:{},results:[],lastResult:void 0});var d=[],y=[],v=0,b=function(e){++v,dn(e)};if("deleteRange"===r){if(4===u.type)return e({numFailures:v,failures:y,results:[],lastResult:void 0});3===u.type?d.push(h=c.clear()):d.push(h=c.delete(i(u)))}else{var m=f?l?[a,o]:[a,null]:[o,null],g=m[0],w=m[1];if(f)for(var _=0;_<p;++_)d.push(h=w&&void 0!==w[_]?c[r](g[_],w[_]):c[r](g[_])),h.onerror=b;else for(_=0;_<p;++_)d.push(h=c[r](g[_])),h.onerror=b}var O=function(t){var n=t.target.result;d.forEach((function(e,t){return null!=e.error&&(y[t]=e.error)})),e({numFailures:v,failures:y,results:"delete"===r?o:d.map((function(e){return e.result})),lastResult:n})};h.onerror=function(e){b(e),O(e)},h.onsuccess=O}))}function r(e){var n=e.trans,r=e.values,o=e.query,a=e.reverse,u=e.unique;return new Promise((function(e,s){e=Ze(e);var c=o.index,l=o.range,f=n.objectStore(t),h=c.isPrimaryKey?f:f.index(c.name),p=a?u?"prevunique":"prev":u?"nextunique":"next",d=r||!("openKeyCursor"in h)?h.openCursor(i(l),p):h.openKeyCursor(i(l),p);d.onerror=pn(s),d.onsuccess=Ze((function(t){var r=d.result;if(r){r.___id=++Tn,r.done=!1;var i=r.continue.bind(r),o=r.continuePrimaryKey;o&&(o=o.bind(r));var a=r.advance.bind(r),u=function(){throw new Error("Cursor not started")},c=function(){throw new Error("Cursor not stopped")};r.trans=n,r.stop=r.continue=r.continuePrimaryKey=r.advance=u,r.fail=Ze(s),r.next=function(){var e=this,t=1;return this.start((function(){return t--?e.continue():e.stop()})).then((function(){return e}))},r.start=function(e){var t=new Promise((function(e,t){e=Ze(e),d.onerror=pn(t),r.fail=t,r.stop=function(t){r.stop=r.continue=r.continuePrimaryKey=r.advance=c,e(t)}})),n=function(){if(d.result)try{e()}catch(e){r.fail(e)}else r.done=!0,r.start=function(){throw new Error("Cursor behind last entry")},r.stop()};return d.onsuccess=Ze((function(e){d.onsuccess=n,n()})),r.continue=i,r.continuePrimaryKey=o,r.advance=a,n(),t},e(r)}else e(null)}),s)}))}function o(e){return function(n){return new Promise((function(r,o){r=Ze(r);var a=n.trans,u=n.values,s=n.limit,c=n.query,l=s===1/0?void 0:s,f=c.index,h=c.range,p=a.objectStore(t),d=f.isPrimaryKey?p:p.index(f.name),y=i(h);if(0===s)return r({result:[]});if(e){var v=u?d.getAll(y,l):d.getAllKeys(y,l);v.onsuccess=function(e){return r({result:e.target.result})},v.onerror=pn(o)}else{var b=0,m=u||!("openKeyCursor"in d)?d.openCursor(y):d.openKeyCursor(y),g=[];m.onsuccess=function(e){var t=m.result;return t?(g.push(u?t.value:t.primaryKey),++b===s?r({result:g}):void t.continue()):r({result:g})},m.onerror=pn(o)}}))}}return{name:t,schema:e,mutate:n,getMany:function(e){var n=e.trans,r=e.keys;return new Promise((function(e,i){e=Ze(e);for(var o,a=n.objectStore(t),u=r.length,s=new Array(u),c=0,l=0,f=function(t){var n=t.target;s[n._pos]=n.result,++l===c&&e(s)},h=pn(i),p=0;p<u;++p)null!=r[p]&&((o=a.get(r[p]))._pos=p,o.onsuccess=f,o.onerror=h,++c);0===c&&e(s)}))},get:function(e){var n=e.trans,r=e.key;return new Promise((function(e,i){e=Ze(e);var o=n.objectStore(t).get(r);o.onsuccess=function(t){return e(t.target.result)},o.onerror=pn(i)}))},query:o(c),openCursor:r,count:function(e){var n=e.query,r=e.trans,o=n.index,a=n.range;return new Promise((function(e,n){var u=r.objectStore(t),s=o.isPrimaryKey?u:u.index(o.name),c=i(a),l=c?s.count(c):s.count();l.onsuccess=Ze((function(t){return e(t.target.result)})),l.onerror=pn(n)}))}}}var a=r(e,n),u=a.schema,c=a.hasGetAll,l=u.tables.map((function(e){return o(e)})),f={};return l.forEach((function(e){return f[e.name]=e})),{stack:"dbcore",transaction:e.transaction.bind(e),table:function(e){if(!f[e])throw new Error("Table '".concat(e,"' not found"));return f[e]},MIN_KEY:-1/0,MAX_KEY:kn(t),schema:u}}function Nn(e,t){return t.reduce((function(e,t){var n=t.create;return i(i({},e),n(e))}),e)}function In(e,t,n,r){var i=n.IDBKeyRange;return n.indexedDB,{dbcore:Nn(Pn(t,i,r),e.dbcore)}}function Cn(e,t){var n=t.db,r=In(e._middlewares,n,e._deps,t);e.core=r.dbcore,e.tables.forEach((function(t){var n=t.name;e.core.schema.tables.some((function(e){return e.name===n}))&&(t.core=e.core.table(n),e[n]instanceof e.Table&&(e[n].core=t.core))}))}function Bn(e,t,n,r){n.forEach((function(n){var i=r[n];t.forEach((function(t){var r=m(t,n);(!r||"value"in r&&void 0===r.value)&&(t===e.Transaction.prototype||t instanceof e.Transaction?y(t,n,{get:function(){return this.table(n)},set:function(e){d(this,n,{value:e,writable:!0,configurable:!0,enumerable:!0})}}):t[n]=new e.Table(n,i))}))}))}function Kn(e,t){t.forEach((function(t){for(var n in t)t[n]instanceof e.Table&&delete t[n]}))}function Rn(e,t){return e._cfg.version-t._cfg.version}function Dn(e,t,n,r){var i=e._dbSchema;n.objectStoreNames.contains("$meta")&&!i.$meta&&(i.$meta=On("$meta",Qn("")[0],[]),e._storeNames.push("$meta"));var o=e._createTransaction("readwrite",e._storeNames,i);o.create(n),o._completion.catch(r);var a=o._reject.bind(o),s=Ce.transless||Ce;at((function(){if(Ce.trans=o,Ce.transless=s,0!==t)return Cn(e,n),Fn(e,o,t).then((function(t){return qn(e,t,o,n)})).catch(a);u(i).forEach((function(e){Mn(n,e,i[e].primKey,i[e].indexes)})),Cn(e,n),De.follow((function(){return e.on.populate.fire(o)})).catch(a)}))}function Ln(e,n){Vn(e._dbSchema,n),n.db.version%10!=0||n.objectStoreNames.contains("$meta")||n.db.createObjectStore("$meta").add(Math.ceil(n.db.version/10-1),"version");var r=Yn(e,e.idbdb,n);Wn(e,e._dbSchema,n);for(var i=function(e){if(e.change.length||e.recreate)return console.warn("Unable to patch indexes of table ".concat(e.name," because it has changes on the type of index or primary key.")),{value:void 0};var t=n.objectStore(e.name);e.add.forEach((function(n){de&&console.debug("Dexie upgrade patch: Creating missing index ".concat(e.name,".").concat(n.src)),Gn(t,n)}))},o=0,a=Un(r,e._dbSchema).change;o<a.length;o++){var u=i(a[o]);if("object"===t(u))return u.value}}function Fn(e,t,n){return t.storeNames.includes("$meta")?t.table("$meta").get("version").then((function(e){return null!=e?e:n})):De.resolve(n)}function qn(e,t,n,r){var i=[],o=e._versions,a=e._dbSchema=Yn(e,e.idbdb,r),s=o.filter((function(e){return e._cfg.version>=t}));if(0===s.length)return De.resolve();function c(){return i.length?De.resolve(i.shift()(n.idbtrans)).then(c):De.resolve()}return s.forEach((function(o){i.push((function(){var i=a,s=o._cfg.dbschema;Wn(e,i,r),Wn(e,s,r),a=e._dbSchema=s;var c=Un(i,s);c.add.forEach((function(e){Mn(r,e[0],e[1].primKey,e[1].indexes)})),c.change.forEach((function(e){if(e.recreate)throw new te.Upgrade("Not yet support for changing primary key");var t=r.objectStore(e.name);e.add.forEach((function(e){return Gn(t,e)})),e.change.forEach((function(e){t.deleteIndex(e.name),Gn(t,e)})),e.del.forEach((function(e){return t.deleteIndex(e)}))}));var l=o._cfg.contentUpgrade;if(l&&o._cfg.version>t){Cn(e,r),n._memoizedTables={};var f=T(s);c.del.forEach((function(e){f[e]=i[e]})),Kn(e,[e.Transaction.prototype]),Bn(e,[e.Transaction.prototype],u(f),f),n.schema=f;var h,p=G(l);p&&ut();var d=De.follow((function(){if((h=l(n))&&p){var e=st.bind(null,null);h.then(e,e)}}));return h&&"function"==typeof h.then?De.resolve(h):d.then((function(){return h}))}})),i.push((function(t){$n(o._cfg.dbschema,t),Kn(e,[e.Transaction.prototype]),Bn(e,[e.Transaction.prototype],e._storeNames,e._dbSchema),n.schema=e._dbSchema})),i.push((function(t){e.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(e.idbdb.version/10)===o._cfg.version?(e.idbdb.deleteObjectStore("$meta"),delete e._dbSchema.$meta,e._storeNames=e._storeNames.filter((function(e){return"$meta"!==e}))):t.objectStore("$meta").put(o._cfg.version,"version"))}))})),c().then((function(){Vn(a,r)}))}function Un(e,t){var n,r={del:[],add:[],change:[]};for(n in e)t[n]||r.del.push(n);for(n in t){var i=e[n],o=t[n];if(i){var a={name:n,def:o,recreate:!1,del:[],add:[],change:[]};if(""+(i.primKey.keyPath||"")!=""+(o.primKey.keyPath||"")||i.primKey.auto!==o.primKey.auto)a.recreate=!0,r.change.push(a);else{var u=i.idxByName,s=o.idxByName,c=void 0;for(c in u)s[c]||a.del.push(c);for(c in s){var l=u[c],f=s[c];l?l.src!==f.src&&a.change.push(f):a.add.push(f)}(a.del.length>0||a.add.length>0||a.change.length>0)&&r.change.push(a)}}else r.add.push([n,o])}return r}function Mn(e,t,n,r){var i=e.db.createObjectStore(t,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return r.forEach((function(e){return Gn(i,e)})),i}function Vn(e,t){u(e).forEach((function(n){t.db.objectStoreNames.contains(n)||(de&&console.debug("Dexie: Creating missing table",n),Mn(t,n,e[n].primKey,e[n].indexes))}))}function $n(e,t){[].slice.call(t.db.objectStoreNames).forEach((function(n){return null==e[n]&&t.db.deleteObjectStore(n)}))}function Gn(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function Yn(e,t,n){var r={};return w(t.objectStoreNames,0).forEach((function(e){for(var t=n.objectStore(e),i=t.keyPath,o=wn(_n(i),i||"",!0,!1,!!t.autoIncrement,i&&"string"!=typeof i,!0),a=[],u=0;u<t.indexNames.length;++u){var s=t.index(t.indexNames[u]);i=s.keyPath;var c=wn(s.name,i,!!s.unique,!!s.multiEntry,!1,i&&"string"!=typeof i,!1);a.push(c)}r[e]=On(e,o,a)})),r}function zn(e,t,n){e.verno=t.version/10;var r=e._dbSchema=Yn(e,t,n);e._storeNames=w(t.objectStoreNames,0),Bn(e,[e._allTables],u(r),r)}function Jn(e,t){var n=Un(Yn(e,e.idbdb,t),e._dbSchema);return!(n.add.length||n.change.some((function(e){return e.add.length||e.change.length})))}function Wn(e,t,n){for(var r=n.db.objectStoreNames,i=0;i<r.length;++i){var o=r[i],u=n.objectStore(o);e._hasGetAll="getAll"in u;for(var s=0;s<u.indexNames.length;++s){var c=u.indexNames[s],l=u.index(c).keyPath,f="string"==typeof l?l:"["+w(l).join("+")+"]";if(t[o]){var h=t[o].idxByName[f];h&&(h.name=c,delete t[o].idxByName[f],t[o].idxByName[c]=h)}}}"undefined"!=typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&a.WorkerGlobalScope&&a instanceof a.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}function Qn(e){return e.split(",").map((function(e,t){var n=(e=e.trim()).replace(/([&*]|\+\+)/g,""),r=/^\[/.test(n)?n.match(/^\[(.*)\]$/)[1].split("+"):n;return wn(n,r||null,/\&/.test(e),/\*/.test(e),/\+\+/.test(e),s(r),0===t)}))}var Xn,Hn=function(){function e(){}return e.prototype._parseStoresSpec=function(e,t){u(e).forEach((function(n){if(null!==e[n]){var r=Qn(e[n]),i=r.shift();if(i.unique=!0,i.multi)throw new te.Schema("Primary key cannot be multi-valued");r.forEach((function(e){if(e.auto)throw new te.Schema("Only primary key can be marked as autoIncrement (++)");if(!e.keyPath)throw new te.Schema("Index must have a name and cannot be an empty string")})),t[n]=On(n,i,r)}}))},e.prototype.stores=function(e){var t=this.db;this._cfg.storesSource=this._cfg.storesSource?c(this._cfg.storesSource,e):e;var n=t._versions,r={},i={};return n.forEach((function(e){c(r,e._cfg.storesSource),i=e._cfg.dbschema={},e._parseStoresSpec(r,i)})),t._dbSchema=i,Kn(t,[t._allTables,t,t.Transaction.prototype]),Bn(t,[t._allTables,t,t.Transaction.prototype,this._cfg.tables],u(i),i),t._storeNames=u(i),this},e.prototype.upgrade=function(e){return this._cfg.contentUpgrade=pe(this._cfg.contentUpgrade||oe,e),this},e}();function Zn(e){return Ft(Hn.prototype,(function(t){this.db=e,this._cfg={version:t,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}}))}function er(e,t){var n=e._dbNamesDB;return n||(n=e._dbNamesDB=new ti(xt,{addons:[],indexedDB:e,IDBKeyRange:t})).version(1).stores({dbnames:"name"}),n.table("dbnames")}function tr(e){return e&&"function"==typeof e.databases}function nr(e){var t=e.indexedDB,n=e.IDBKeyRange;return tr(t)?Promise.resolve(t.databases()).then((function(e){return e.map((function(e){return e.name})).filter((function(e){return e!==xt}))})):er(t,n).toCollection().primaryKeys()}function rr(e,t){var n=e.indexedDB,r=e.IDBKeyRange;!tr(n)&&t!==xt&&er(n,r).put({name:t}).catch(oe)}function ir(e,t){var n=e.indexedDB,r=e.IDBKeyRange;!tr(n)&&t!==xt&&er(n,r).delete(t).catch(oe)}function or(e){return at((function(){return Ce.letThrough=!0,e()}))}function ar(){var e;return!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise((function(t){var n=function(){return indexedDB.databases().finally(t)};e=setInterval(n,100),n()})).finally((function(){return clearInterval(e)})):Promise.resolve()}function ur(e){return!("from"in e)}var sr=function e(t,n){if(!this){var r=new e;return t&&"d"in t&&c(r,t),r}c(this,arguments.length?{d:1,from:t,to:arguments.length>1?n:t}:{d:0})};function cr(e,t,n){var r=It(t,n);if(!isNaN(r)){if(r>0)throw RangeError();if(ur(e))return c(e,{from:t,to:n,d:1});var i=e.l,o=e.r;if(It(n,e.from)<0)return i?cr(i,t,n):e.l={from:t,to:n,d:1,l:null,r:null},pr(e);if(It(t,e.to)>0)return o?cr(o,t,n):e.r={from:t,to:n,d:1,l:null,r:null},pr(e);It(t,e.from)<0&&(e.from=t,e.l=null,e.d=o?o.d+1:1),It(n,e.to)>0&&(e.to=n,e.r=null,e.d=e.l?e.l.d+1:1);var a=!e.r;i&&!e.l&&lr(e,i),o&&a&&lr(e,o)}}function lr(e,t){function n(e,t){var r=t.from,i=t.to,o=t.l,a=t.r;cr(e,r,i),o&&n(e,o),a&&n(e,a)}ur(t)||n(e,t)}function fr(e,t){var n=hr(t),r=n.next();if(r.done)return!1;for(var i=r.value,o=hr(e),a=o.next(i.from),u=a.value;!r.done&&!a.done;){if(It(u.from,i.to)<=0&&It(u.to,i.from)>=0)return!0;It(i.from,u.from)<0?i=(r=n.next(u.from)).value:u=(a=o.next(i.from)).value}return!1}function hr(e){var t=ur(e)?null:{s:0,n:e};return{next:function(e){for(var n=arguments.length>0;t;)switch(t.s){case 0:if(t.s=1,n)for(;t.n.l&&It(e,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!n||It(e,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function pr(e){var t,n,r=((null===(t=e.r)||void 0===t?void 0:t.d)||0)-((null===(n=e.l)||void 0===n?void 0:n.d)||0),o=r>1?"r":r<-1?"l":"";if(o){var a="r"===o?"l":"r",u=i({},e),s=e[o];e.from=s.from,e.to=s.to,e[o]=s[o],u[o]=s[a],e[a]=u,u.d=dr(u)}e.d=dr(e)}function dr(e){var t=e.r,n=e.l;return(t?n?Math.max(t.d,n.d):t.d:n?n.d:0)+1}function yr(e,t){return u(t).forEach((function(n){e[n]?lr(e[n],t[n]):e[n]=C(t[n])})),e}function vr(e,t){return e.all||t.all||Object.keys(e).some((function(n){return t[n]&&fr(t[n],e[n])}))}p(sr.prototype,((Xn={add:function(e){return lr(this,e),this},addKey:function(e){return cr(this,e,e),this},addKeys:function(e){var t=this;return e.forEach((function(e){return cr(t,e,e)})),this},hasKey:function(e){var t=hr(this).next(e).value;return t&&It(t.from,e)<=0&&It(t.to,e)>=0}})[q]=function(){return hr(this)},Xn));var br={},mr={},gr=!1;function wr(e,t){yr(mr,e),gr||(gr=!0,setTimeout((function(){gr=!1;var e=mr;mr={},_r(e,!1)}),0))}function _r(e,t){void 0===t&&(t=!1);var n=new Set;if(e.all)for(var r=0,i=Object.values(br);r<i.length;r++)Or(u=i[r],e,n,t);else for(var o in e){var a=/^idb\:\/\/(.*)\/(.*)\//.exec(o);if(a){var u,s=a[1],c=a[2];(u=br["idb://".concat(s,"/").concat(c)])&&Or(u,e,n,t)}}n.forEach((function(e){return e()}))}function Or(e,t,n,r){for(var i=[],o=0,a=Object.entries(e.queries.query);o<a.length;o++){for(var u=a[o],s=u[0],c=[],l=0,f=u[1];l<f.length;l++){var h=f[l];vr(t,h.obsSet)?h.subscribers.forEach((function(e){return n.add(e)})):r&&c.push(h)}r&&i.push([s,c])}if(r)for(var p=0,d=i;p<d.length;p++){var y=d[p];s=y[0],c=y[1],e.queries.query[s]=c}}function Er(e){var t=e._state,n=e._deps.indexedDB;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then((function(){return t.dbOpenError?bt(t.dbOpenError):e}));t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;var r=t.openCanceller,i=Math.round(10*e.verno),o=!1;function a(){if(t.openCanceller!==r)throw new te.DatabaseClosed("db.open() was cancelled")}var u=t.dbReadyResolve,s=null,c=!1,l=function r(){return new De((function(u,l){if(a(),!n)throw new te.MissingAPI;var f=e.name,h=t.autoSchema||!i?n.open(f):n.open(f,i);if(!h)throw new te.MissingAPI;h.onerror=pn(l),h.onblocked=Ze(e._fireOnBlocked),h.onupgradeneeded=Ze((function(r){if(s=h.transaction,t.autoSchema&&!e._options.allowEmptyDB){h.onerror=dn,s.abort(),h.result.close();var i=n.deleteDatabase(f);i.onsuccess=i.onerror=Ze((function(){l(new te.NoSuchDatabase("Database ".concat(f," doesnt exist")))}))}else{s.onerror=pn(l);var a=r.oldVersion>Math.pow(2,62)?0:r.oldVersion;c=a<1,e.idbdb=h.result,o&&Ln(e,s),Dn(e,a/10,s,l)}}),l),h.onsuccess=Ze((function(){s=null;var n=e.idbdb=h.result,a=w(n.objectStoreNames);if(a.length>0)try{var l=n.transaction(En(a),"readonly");if(t.autoSchema)zn(e,n,l);else if(Wn(e,e._dbSchema,l),!Jn(e,l)&&!o)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),n.close(),i=n.version+1,o=!0,u(r());Cn(e,l)}catch(e){}kt.push(e),n.onversionchange=Ze((function(n){t.vcFired=!0,e.on("versionchange").fire(n)})),n.onclose=Ze((function(t){e.on("close").fire(t)})),c&&rr(e._deps,f),u()}),l)})).catch((function(e){switch(null==e?void 0:e.name){case"UnknownError":if(t.PR1398_maxLoop>0)return t.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),r();break;case"VersionError":if(i>0)return i=0,r()}return De.reject(e)}))};return De.race([r,("undefined"==typeof navigator?De.resolve():ar()).then(l)]).then((function(){return a(),t.onReadyBeingFired=[],De.resolve(or((function(){return e.on.ready.fire(e.vip)}))).then((function n(){if(t.onReadyBeingFired.length>0){var r=t.onReadyBeingFired.reduce(pe,oe);return t.onReadyBeingFired=[],De.resolve(or((function(){return r(e.vip)}))).then(n)}}))})).finally((function(){t.openCanceller===r&&(t.onReadyBeingFired=null,t.isBeingOpened=!1)})).catch((function(n){t.dbOpenError=n;try{s&&s.abort()}catch(e){}return r===t.openCanceller&&e._close(),bt(n)})).finally((function(){t.openComplete=!0,u()})).then((function(){if(c){var t={};e.tables.forEach((function(n){n.schema.indexes.forEach((function(r){r.name&&(t["idb://".concat(e.name,"/").concat(n.name,"/").concat(r.name)]=new sr(-1/0,[[[]]]))})),t["idb://".concat(e.name,"/").concat(n.name,"/")]=t["idb://".concat(e.name,"/").concat(n.name,"/:dels")]=new sr(-1/0,[[[]]])})),bn(yn).fire(t),_r(t,!0)}return e}))}function kr(e){var t=function(t){return e.next(t)},n=function(t){return e.throw(t)},r=o(t),i=o(n);function o(e){return function(t){var n=e(t),o=n.value;return n.done?o:o&&"function"==typeof o.then?o.then(r,i):s(o)?Promise.all(o).then(r,i):r(o)}}return o(t)()}function xr(e,t,n){var r=arguments.length;if(r<2)throw new te.InvalidArgument("Too few arguments");for(var i=new Array(r-1);--r;)i[r-1]=arguments[r];return n=i.pop(),[e,P(i),n]}function Sr(e,t,n,r,i){return De.resolve().then((function(){var o=Ce.transless||Ce,a=e._createTransaction(t,n,e._dbSchema,r);a.explicit=!0;var u={trans:a,transless:o};if(r)a.idbtrans=r.idbtrans;else try{a.create(),a.idbtrans._explicit=!0,e._state.PR1398_maxLoop=3}catch(r){return r.name===Z.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e.close({disableAutoOpen:!1}),e.open().then((function(){return Sr(e,t,n,null,i)}))):bt(r)}var s,c=G(i);c&&ut();var l=De.follow((function(){if(s=i.call(a,a))if(c){var e=st.bind(null,null);s.then(e,e)}else"function"==typeof s.next&&"function"==typeof s.throw&&(s=kr(s))}),u);return(s&&"function"==typeof s.then?De.resolve(s).then((function(e){return a.active?e:bt(new te.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))})):l.then((function(){return s}))).then((function(e){return r&&a._resolve(),a._completion.then((function(){return e}))})).catch((function(e){return a._reject(e),bt(e)}))}))}function Ar(e,t,n){for(var r=s(e)?e.slice():[e],i=0;i<n;++i)r.push(t);return r}function Tr(e){return i(i({},e),{table:function(t){var n=e.table(t),r=n.schema,o={},a=[];function u(e,t,n){var r=jn(e),s=o[r]=o[r]||[],c=null==e?0:"string"==typeof e?1:e.length,l=t>0,f=i(i({},n),{name:l?"".concat(r,"(virtual-from:").concat(n.name,")"):n.name,lowLevelIndex:n,isVirtual:l,keyTail:t,keyLength:c,extractKey:xn(e),unique:!l&&n.unique});return s.push(f),f.isPrimaryKey||a.push(f),c>1&&u(2===c?e[0]:e.slice(0,c-1),t+1,n),s.sort((function(e,t){return e.keyTail-t.keyTail})),f}var s=u(r.primaryKey.keyPath,0,r.primaryKey);o[":id"]=[s];for(var c=0,l=r.indexes;c<l.length;c++){var f=l[c];u(f.keyPath,0,f)}function h(e){var t=o[jn(e)];return t&&t[0]}function p(t,n){return{type:1===t.type?2:t.type,lower:Ar(t.lower,t.lowerOpen?e.MAX_KEY:e.MIN_KEY,n),lowerOpen:!0,upper:Ar(t.upper,t.upperOpen?e.MIN_KEY:e.MAX_KEY,n),upperOpen:!0}}function d(e){var t=e.query.index;return t.isVirtual?i(i({},e),{query:{index:t.lowLevelIndex,range:p(e.query.range,t.keyTail)}}):e}var y=i(i({},n),{schema:i(i({},r),{primaryKey:s,indexes:a,getIndexByKeyPath:h}),count:function(e){return n.count(d(e))},query:function(e){return n.query(d(e))},openCursor:function(t){var r=t.query.index,i=r.keyTail,o=r.isVirtual,a=r.keyLength;if(!o)return n.openCursor(t);function u(n){function r(r){null!=r?n.continue(Ar(r,t.reverse?e.MAX_KEY:e.MIN_KEY,i)):t.unique?n.continue(n.key.slice(0,a).concat(t.reverse?e.MIN_KEY:e.MAX_KEY,i)):n.continue()}var o=Object.create(n,{continue:{value:r},continuePrimaryKey:{value:function(t,r){n.continuePrimaryKey(Ar(t,e.MAX_KEY,i),r)}},primaryKey:{get:function(){return n.primaryKey}},key:{get:function(){var e=n.key;return 1===a?e[0]:e.slice(0,a)}},value:{get:function(){return n.value}}});return o}return n.openCursor(d(t)).then((function(e){return e&&u(e)}))}});return y}})}var jr={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:Tr};function Pr(e,n,r,i){return r=r||{},i=i||"",u(e).forEach((function(o){if(h(n,o)){var a=e[o],u=n[o];if("object"===t(a)&&"object"===t(u)&&a&&u){var s=F(a);s!==F(u)?r[i+o]=n[o]:"Object"===s?Pr(a,u,r,i+o+"."):a!==u&&(r[i+o]=n[o])}else a!==u&&(r[i+o]=n[o])}else r[i+o]=void 0})),u(n).forEach((function(t){h(e,t)||(r[i+t]=n[t])})),r}function Nr(e,t){return"delete"===t.type?t.keys:t.keys||t.values.map(e.extractKey)}var Ir={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(e){return i(i({},e),{table:function(t){var n=e.table(t),r=n.schema.primaryKey,a=i(i({},n),{mutate:function(e){var a=Ce.trans,u=a.table(t).hook,s=u.deleting,c=u.creating,l=u.updating;switch(e.type){case"add":if(c.fire===oe)break;return a._promise("readwrite",(function(){return f(e)}),!0);case"put":if(c.fire===oe&&l.fire===oe)break;return a._promise("readwrite",(function(){return f(e)}),!0);case"delete":if(s.fire===oe)break;return a._promise("readwrite",(function(){return f(e)}),!0);case"deleteRange":if(s.fire===oe)break;return a._promise("readwrite",(function(){return p(e)}),!0)}return n.mutate(e);function f(e){var t=Ce.trans,a=e.keys||Nr(r,e);if(!a)throw new Error("Keys missing");return"delete"!==(e="add"===e.type||"put"===e.type?i(i({},e),{keys:a}):i({},e)).type&&(e.values=o([],e.values)),e.keys&&(e.keys=o([],e.keys)),Cr(n,e,a).then((function(i){var o=a.map((function(n,o){var a=i[o],u={onerror:null,onsuccess:null};if("delete"===e.type)s.fire.call(u,n,a,t);else if("add"===e.type||void 0===a){var f=c.fire.call(u,n,e.values[o],t);null==n&&null!=f&&(n=f,e.keys[o]=n,r.outbound||S(e.values[o],r.keyPath,n))}else{var p=Pr(a,e.values[o]),d=l.fire.call(u,p,n,a,t);if(d){var y=e.values[o];Object.keys(d).forEach((function(e){h(y,e)?y[e]=d[e]:S(y,e,d[e])}))}}return u}));return n.mutate(e).then((function(t){for(var n=t.failures,r=t.results,u=t.numFailures,s=t.lastResult,c=0;c<a.length;++c){var l=r?r[c]:a[c],f=o[c];null==l?f.onerror&&f.onerror(n[c]):f.onsuccess&&f.onsuccess("put"===e.type&&i[c]?e.values[c]:l)}return{failures:n,results:r,numFailures:u,lastResult:s}})).catch((function(e){return o.forEach((function(t){return t.onerror&&t.onerror(e)})),Promise.reject(e)}))}))}function p(e){return d(e.trans,e.range,1e4)}function d(e,t,o){return n.query({trans:e,values:!1,query:{index:r,range:t},limit:o}).then((function(n){var r=n.result;return f({type:"delete",keys:r,trans:e}).then((function(n){return n.numFailures>0?Promise.reject(n.failures[0]):r.length<o?{failures:[],numFailures:0,lastResult:void 0}:d(e,i(i({},t),{lower:r[r.length-1],lowerOpen:!0}),o)}))}))}}});return a}})}};function Cr(e,t,n){return"add"===t.type?Promise.resolve([]):e.getMany({trans:t.trans,keys:n,cache:"immutable"})}function Br(e,t,n){try{if(!t)return null;if(t.keys.length<e.length)return null;for(var r=[],i=0,o=0;i<t.keys.length&&o<e.length;++i)0===It(t.keys[i],e[o])&&(r.push(n?R(t.values[i]):t.values[i]),++o);return r.length===e.length?r:null}catch(e){return null}}var Kr={stack:"dbcore",level:-1,create:function(e){return{table:function(t){var n=e.table(t);return i(i({},n),{getMany:function(e){if(!e.cache)return n.getMany(e);var t=Br(e.keys,e.trans._cache,"clone"===e.cache);return t?De.resolve(t):n.getMany(e).then((function(t){return e.trans._cache={keys:e.keys,values:"clone"===e.cache?R(t):t},t}))},mutate:function(e){return"add"!==e.type&&(e.trans._cache=null),n.mutate(e)}})}}}};function Rr(e,t){return"readonly"===e.trans.mode&&!!e.subscr&&!e.trans.explicit&&"disabled"!==e.trans.db._options.cache&&!t.schema.primaryKey.outbound}function Dr(e,t){switch(e){case"query":return t.values&&!t.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var Lr={stack:"dbcore",level:0,name:"Observability",create:function(e){var t=e.schema.name,n=new sr(e.MIN_KEY,e.MAX_KEY);return i(i({},e),{transaction:function(t,n,r){if(Ce.subscr&&"readonly"!==n)throw new te.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(Ce.querier));return e.transaction(t,n,r)},table:function(r){var o=e.table(r),a=o.schema,c=a.primaryKey,l=a.indexes,f=c.extractKey,h=c.outbound,p=c.autoIncrement&&l.filter((function(e){return e.compound&&e.keyPath.includes(c.keyPath)})),d=i(i({},o),{mutate:function(e){var i=e.trans,u=e.mutatedParts||(e.mutatedParts={}),l=function(e){var n="idb://".concat(t,"/").concat(r,"/").concat(e);return u[n]||(u[n]=new sr)},f=l(""),h=l(":dels"),d=e.type,y="deleteRange"===e.type?[e.range]:"delete"===e.type?[e.keys]:e.values.length<50?[Nr(c,e).filter((function(e){return e})),e.values]:[],v=y[0],b=y[1],m=e.trans._cache;if(s(v)){f.addKeys(v);var g="delete"===d||v.length===b.length?Br(v,m):null;g||h.addKeys(v),(g||b)&&Fr(l,a,g,b)}else if(v){var w={from:v.lower,to:v.upper};h.add(w),f.add(w)}else f.add(n),h.add(n),a.indexes.forEach((function(e){return l(e.name).add(n)}));return o.mutate(e).then((function(t){return!v||"add"!==e.type&&"put"!==e.type||(f.addKeys(t.results),p&&p.forEach((function(n){var r=e.values.map((function(e){return n.extractKey(e)})),i=n.keyPath.findIndex((function(e){return e===c.keyPath}));t.results.forEach((function(e){return r[i]=e})),l(n.name).addKeys(r)}))),i.mutatedParts=yr(i.mutatedParts||{},u),t}))}}),y=function(t){var n,r,i=t.query,o=i.index,a=i.range;return[o,new sr(null!==(n=a.lower)&&void 0!==n?n:e.MIN_KEY,null!==(r=a.upper)&&void 0!==r?r:e.MAX_KEY)]},v={get:function(e){return[c,new sr(e.key)]},getMany:function(e){return[c,(new sr).addKeys(e.keys)]},count:y,query:y,openCursor:y};return u(v).forEach((function(e){d[e]=function(a){var u=Ce.subscr,s=!!u,c=Rr(Ce,o)&&Dr(e,a)?a.obsSet={}:u;if(s){var l=function(e){var n="idb://".concat(t,"/").concat(r,"/").concat(e);return c[n]||(c[n]=new sr)},p=l(""),d=l(":dels"),y=v[e](a),b=y[0],m=y[1];if("query"===e&&b.isPrimaryKey&&!a.values?d.add(m):l(b.name||"").add(m),!b.isPrimaryKey){if("count"!==e){var g="query"===e&&h&&a.values&&o.query(i(i({},a),{values:!1}));return o[e].apply(this,arguments).then((function(t){if("query"===e){if(h&&a.values)return g.then((function(e){var n=e.result;return p.addKeys(n),t}));var n=a.values?t.result.map(f):t.result;a.values?p.addKeys(n):d.addKeys(n)}else if("openCursor"===e){var r=t,i=a.values;return r&&Object.create(r,{key:{get:function(){return d.addKey(r.primaryKey),r.key}},primaryKey:{get:function(){var e=r.primaryKey;return d.addKey(e),e}},value:{get:function(){return i&&p.addKey(r.primaryKey),r.value}}})}return t}))}d.add(n)}}return o[e].apply(this,arguments)}})),d}})}};function Fr(e,t,n,r){function i(t){var i=e(t.name||"");function o(e){return null!=e?t.extractKey(e):null}var a=function(e){return t.multiEntry&&s(e)?e.forEach((function(e){return i.addKey(e)})):i.addKey(e)};(n||r).forEach((function(e,t){var i=n&&o(n[t]),u=r&&o(r[t]);0!==It(i,u)&&(null!=i&&a(i),null!=u&&a(u))}))}t.indexes.forEach(i)}function qr(e,t,n){if(0===n.numFailures)return t;if("deleteRange"===t.type)return null;var r=t.keys?t.keys.length:"values"in t&&t.values?t.values.length:1;if(n.numFailures===r)return null;var o=i({},t);return s(o.keys)&&(o.keys=o.keys.filter((function(e,t){return!(t in n.failures)}))),"values"in o&&s(o.values)&&(o.values=o.values.filter((function(e,t){return!(t in n.failures)}))),o}function Ur(e,t){return void 0===t.lower||(t.lowerOpen?It(e,t.lower)>0:It(e,t.lower)>=0)}function Mr(e,t){return void 0===t.upper||(t.upperOpen?It(e,t.upper)<0:It(e,t.upper)<=0)}function Vr(e,t){return Ur(e,t)&&Mr(e,t)}function $r(e,t,n,r,i,o){if(!n||0===n.length)return e;var a=t.query.index,u=a.multiEntry,c=t.query.range,l=r.schema.primaryKey.extractKey,f=a.extractKey,h=(a.lowLevelIndex||a).extractKey,p=n.reduce((function(e,n){var r=e,i=[];if("add"===n.type||"put"===n.type)for(var o=new sr,a=n.values.length-1;a>=0;--a){var h=n.values[a],p=l(h);if(!o.hasKey(p)){var d=f(h);(u&&s(d)?d.some((function(e){return Vr(e,c)})):Vr(d,c))&&(o.addKey(p),i.push(h))}}switch(n.type){case"add":r=e.concat(t.values?i:i.map((function(e){return l(e)})));break;case"put":var y=(new sr).addKeys(n.values.map((function(e){return l(e)})));r=e.filter((function(e){return!y.hasKey(t.values?l(e):e)})).concat(t.values?i:i.map((function(e){return l(e)})));break;case"delete":var v=(new sr).addKeys(n.keys);r=e.filter((function(e){return!v.hasKey(t.values?l(e):e)}));break;case"deleteRange":var b=n.range;r=e.filter((function(e){return!Vr(l(e),b)}))}return r}),e);return p===e?e:(p.sort((function(e,t){return It(h(e),h(t))||It(l(e),l(t))})),t.limit&&t.limit<1/0&&(p.length>t.limit?p.length=t.limit:e.length===t.limit&&p.length<t.limit&&(i.dirty=!0)),o?Object.freeze(p):p)}function Gr(e,t){return 0===It(e.lower,t.lower)&&0===It(e.upper,t.upper)&&!!e.lowerOpen==!!t.lowerOpen&&!!e.upperOpen==!!t.upperOpen}function Yr(e,t,n,r){if(void 0===e)return void 0!==t?-1:0;if(void 0===t)return 1;var i=It(e,t);if(0===i){if(n&&r)return 0;if(n)return 1;if(r)return-1}return i}function zr(e,t,n,r){if(void 0===e)return void 0!==t?1:0;if(void 0===t)return-1;var i=It(e,t);if(0===i){if(n&&r)return 0;if(n)return-1;if(r)return 1}return i}function Jr(e,t){return Yr(e.lower,t.lower,e.lowerOpen,t.lowerOpen)<=0&&zr(e.upper,t.upper,e.upperOpen,t.upperOpen)>=0}function Wr(e,t,n,r){var i=br["idb://".concat(e,"/").concat(t)];if(!i)return[];var o=i.queries[n];if(!o)return[null,!1,i,null];var a=o[(r.query?r.query.index.name:null)||""];if(!a)return[null,!1,i,null];switch(n){case"query":var u=a.find((function(e){return e.req.limit===r.limit&&e.req.values===r.values&&Gr(e.req.query.range,r.query.range)}));return u?[u,!0,i,a]:[a.find((function(e){return("limit"in e.req?e.req.limit:1/0)>=r.limit&&(!r.values||e.req.values)&&Jr(e.req.query.range,r.query.range)})),!1,i,a];case"count":var s=a.find((function(e){return Gr(e.req.query.range,r.query.range)}));return[s,!!s,i,a]}}function Qr(e,t,n,r){e.subscribers.add(n),r.addEventListener("abort",(function(){e.subscribers.delete(n),0===e.subscribers.size&&Xr(e,t)}))}function Xr(e,t){setTimeout((function(){0===e.subscribers.size&&M(t,e)}),3e3)}var Hr={stack:"dbcore",level:0,name:"Cache",create:function(e){var t=e.schema.name,n=i(i({},e),{transaction:function(n,r,i){var o=e.transaction(n,r,i);if("readwrite"===r){var a=new AbortController,u=a.signal,s=function(i){return function(){if(a.abort(),"readwrite"===r){for(var u=new Set,s=0,c=n;s<c.length;s++){var l=c[s],f=br["idb://".concat(t,"/").concat(l)];if(f){var h=e.table(l),p=f.optimisticOps.filter((function(e){return e.trans===o}));if(o._explicit&&i&&o.mutatedParts)for(var d=0,y=Object.values(f.queries.query);d<y.length;d++)for(var v=0,b=(w=y[d]).slice();v<b.length;v++)vr((E=b[v]).obsSet,o.mutatedParts)&&(M(w,E),E.subscribers.forEach((function(e){return u.add(e)})));else if(p.length>0){f.optimisticOps=f.optimisticOps.filter((function(e){return e.trans!==o}));for(var m=0,g=Object.values(f.queries.query);m<g.length;m++)for(var w,_=0,O=(w=g[m]).slice();_<O.length;_++){var E;if(null!=(E=O[_]).res&&o.mutatedParts)if(i&&!E.dirty){var k=Object.isFrozen(E.res),x=$r(E.res,E.req,p,h,E,k);E.dirty?(M(w,E),E.subscribers.forEach((function(e){return u.add(e)}))):x!==E.res&&(E.res=x,E.promise=De.resolve({result:x}))}else E.dirty&&M(w,E),E.subscribers.forEach((function(e){return u.add(e)}))}}}}u.forEach((function(e){return e()}))}}};o.addEventListener("abort",s(!1),{signal:u}),o.addEventListener("error",s(!1),{signal:u}),o.addEventListener("complete",s(!0),{signal:u})}return o},table:function(n){var r=e.table(n),o=r.schema.primaryKey,a=i(i({},r),{mutate:function(e){var a=Ce.trans;if(o.outbound||"disabled"===a.db._options.cache||a.explicit)return r.mutate(e);var u=br["idb://".concat(t,"/").concat(n)];if(!u)return r.mutate(e);var s=r.mutate(e);return"add"!==e.type&&"put"!==e.type||!(e.values.length>=50||Nr(o,e).some((function(e){return null==e})))?(u.optimisticOps.push(e),e.mutatedParts&&wr(e.mutatedParts),s.then((function(t){if(t.numFailures>0){M(u.optimisticOps,e);var n=qr(u,e,t);n&&u.optimisticOps.push(n),e.mutatedParts&&wr(e.mutatedParts)}})),s.catch((function(){M(u.optimisticOps,e),e.mutatedParts&&wr(e.mutatedParts)}))):s.then((function(t){var n=i(i({},e),{values:e.values.map((function(e,n){var r,a=(null===(r=o.keyPath)||void 0===r?void 0:r.includes("."))?R(e):i({},e);return S(a,o.keyPath,t.results[n]),a}))}),r=qr(u,n,t);u.optimisticOps.push(r),queueMicrotask((function(){return e.mutatedParts&&wr(e.mutatedParts)}))})),s},query:function(e){var i;if(!Rr(Ce,r)||!Dr("query",e))return r.query(e);var o="immutable"===(null===(i=Ce.trans)||void 0===i?void 0:i.db._options.cache),a=Ce,u=a.requery,s=a.signal,c=Wr(t,n,"query",e),l=c[0],f=c[1],h=c[2],p=c[3];if(l&&f)l.obsSet=e.obsSet;else{var d=r.query(e).then((function(e){var t=e.result;if(l&&(l.res=t),o){for(var n=0,r=t.length;n<r;++n)Object.freeze(t[n]);Object.freeze(t)}else e.result=R(t);return e})).catch((function(e){return p&&l&&M(p,l),Promise.reject(e)}));l={obsSet:e.obsSet,promise:d,subscribers:new Set,type:"query",req:e,dirty:!1},p?p.push(l):(p=[l],h||(h=br["idb://".concat(t,"/").concat(n)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}}),h.queries.query[e.query.index.name||""]=p)}return Qr(l,p,u,s),l.promise.then((function(t){return{result:$r(t.result,e,null==h?void 0:h.optimisticOps,r,l,o)}}))}});return a}});return n}};function Zr(e,t){return new Proxy(e,{get:function(e,n,r){return"db"===n?t:Reflect.get(e,n,r)}})}var ei,ti=function(){function e(t,n){var r=this;this._middlewares={},this.verno=0;var o=e.dependencies;this._options=n=i({addons:e.addons,autoOpen:!0,indexedDB:o.indexedDB,IDBKeyRange:o.IDBKeyRange,cache:"cloned"},n),this._deps={indexedDB:n.indexedDB,IDBKeyRange:n.IDBKeyRange};var a=n.addons;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var u={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:oe,dbReadyPromise:null,cancelOpen:oe,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:n.autoOpen};u.dbReadyPromise=new De((function(e){u.dbReadyResolve=e})),u.openCanceller=new De((function(e,t){u.cancelOpen=t})),this._state=u,this.name=t,this.on=Lt(this,"populate","blocked","versionchange","close",{ready:[pe,oe]}),this.on.ready.subscribe=_(this.on.ready.subscribe,(function(t){return function(n,i){e.vip((function(){var e=r._state;if(e.openComplete)e.dbOpenError||De.resolve().then(n),i&&t(n);else if(e.onReadyBeingFired)e.onReadyBeingFired.push(n),i&&t(n);else{t(n);var o=r;i||t((function e(){o.on.ready.unsubscribe(n),o.on.ready.unsubscribe(e)}))}}))}})),this.Collection=Zt(this),this.Table=qt(this),this.Transaction=gn(this),this.Version=Zn(this),this.WhereClause=hn(this),this.on("versionchange",(function(e){e.newVersion>0?console.warn("Another connection wants to upgrade database '".concat(r.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(r.name,"'. Closing db now to resume the delete request.")),r.close({disableAutoOpen:!1})})),this.on("blocked",(function(e){!e.newVersion||e.newVersion<e.oldVersion?console.warn("Dexie.delete('".concat(r.name,"') was blocked")):console.warn("Upgrade '".concat(r.name,"' blocked by other connection holding version ").concat(e.oldVersion/10))})),this._maxKey=kn(n.IDBKeyRange),this._createTransaction=function(e,t,n,i){return new r.Transaction(e,t,n,r._options.chromeTransactionDurability,i)},this._fireOnBlocked=function(e){r.on("blocked").fire(e),kt.filter((function(e){return e.name===r.name&&e!==r&&!e._state.vcFired})).map((function(t){return t.on("versionchange").fire(e)}))},this.use(Kr),this.use(Hr),this.use(Lr),this.use(jr),this.use(Ir);var s=new Proxy(this,{get:function(e,t,n){if("_vip"===t)return!0;if("table"===t)return function(e){return Zr(r.table(e),s)};var i=Reflect.get(e,t,n);return i instanceof Dt?Zr(i,s):"tables"===t?i.map((function(e){return Zr(e,s)})):"_createTransaction"===t?function(){return Zr(i.apply(this,arguments),s)}:i}});this.vip=s,a.forEach((function(e){return e(r)}))}return e.prototype.version=function(e){if(isNaN(e)||e<.1)throw new te.Type("Given version is not a positive number");if(e=Math.round(10*e)/10,this.idbdb||this._state.isBeingOpened)throw new te.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);var t=this._versions,n=t.filter((function(t){return t._cfg.version===e}))[0];return n||(n=new this.Version(e),t.push(n),t.sort(Rn),n.stores({}),this._state.autoSchema=!1,n)},e.prototype._whenReady=function(e){var t=this;return this.idbdb&&(this._state.openComplete||Ce.letThrough||this._vip)?e():new De((function(e,n){if(t._state.openComplete)return n(new te.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._state.autoOpen)return void n(new te.DatabaseClosed);t.open().catch(oe)}t._state.dbReadyPromise.then(e,n)})).then(e)},e.prototype.use=function(e){var t=e.stack,n=e.create,r=e.level,i=e.name;i&&this.unuse({stack:t,name:i});var o=this._middlewares[t]||(this._middlewares[t]=[]);return o.push({stack:t,create:n,level:null==r?10:r,name:i}),o.sort((function(e,t){return e.level-t.level})),this},e.prototype.unuse=function(e){var t=e.stack,n=e.name,r=e.create;return t&&this._middlewares[t]&&(this._middlewares[t]=this._middlewares[t].filter((function(e){return r?e.create!==r:!!n&&e.name!==n}))),this},e.prototype.open=function(){var e=this;return dt(Ie,(function(){return Er(e)}))},e.prototype._close=function(){var e=this._state,t=kt.indexOf(this);if(t>=0&&kt.splice(t,1),this.idbdb){try{this.idbdb.close()}catch(e){}this.idbdb=null}e.isBeingOpened||(e.dbReadyPromise=new De((function(t){e.dbReadyResolve=t})),e.openCanceller=new De((function(t,n){e.cancelOpen=n})))},e.prototype.close=function(e){var t=(void 0===e?{disableAutoOpen:!0}:e).disableAutoOpen,n=this._state;t?(n.isBeingOpened&&n.cancelOpen(new te.DatabaseClosed),this._close(),n.autoOpen=!1,n.dbOpenError=new te.DatabaseClosed):(this._close(),n.autoOpen=this._options.autoOpen||n.isBeingOpened,n.openComplete=!1,n.dbOpenError=null)},e.prototype.delete=function(e){var n=this;void 0===e&&(e={disableAutoOpen:!0});var r=arguments.length>0&&"object"!==t(arguments[0]),i=this._state;return new De((function(t,o){var a=function(){n.close(e);var r=n._deps.indexedDB.deleteDatabase(n.name);r.onsuccess=Ze((function(){ir(n._deps,n.name),t()})),r.onerror=pn(o),r.onblocked=n._fireOnBlocked};if(r)throw new te.InvalidArgument("Invalid closeOptions argument to db.delete()");i.isBeingOpened?i.dbReadyPromise.then(a):a()}))},e.prototype.backendDB=function(){return this.idbdb},e.prototype.isOpen=function(){return null!==this.idbdb},e.prototype.hasBeenClosed=function(){var e=this._state.dbOpenError;return e&&"DatabaseClosed"===e.name},e.prototype.hasFailed=function(){return null!==this._state.dbOpenError},e.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(e.prototype,"tables",{get:function(){var e=this;return u(this._allTables).map((function(t){return e._allTables[t]}))},enumerable:!1,configurable:!0}),e.prototype.transaction=function(){var e=xr.apply(this,arguments);return this._transaction.apply(this,e)},e.prototype._transaction=function(e,t,n){var r=this,i=Ce.trans;i&&i.db===this&&-1===e.indexOf("!")||(i=null);var o,a,u=-1!==e.indexOf("?");e=e.replace("!","").replace("?","");try{if(a=t.map((function(e){var t=e instanceof r.Table?e.name:e;if("string"!=typeof t)throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return t})),"r"==e||e===St)o=St;else{if("rw"!=e&&e!=At)throw new te.InvalidArgument("Invalid transaction mode: "+e);o=At}if(i){if(i.mode===St&&o===At){if(!u)throw new te.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");i=null}i&&a.forEach((function(e){if(i&&-1===i.storeNames.indexOf(e)){if(!u)throw new te.SubTransaction("Table "+e+" not included in parent transaction.");i=null}})),u&&i&&!i.active&&(i=null)}}catch(e){return i?i._promise(null,(function(t,n){n(e)})):bt(e)}var s=Sr.bind(null,this,o,a,i,n);return i?i._promise(o,s,"lock"):Ce.trans?dt(Ce.transless,(function(){return r._whenReady(s)})):this._whenReady(s)},e.prototype.table=function(e){if(!h(this._allTables,e))throw new te.InvalidTable("Table ".concat(e," does not exist"));return this._allTables[e]},e}(),ni="undefined"!=typeof Symbol&&"observable"in Symbol?Symbol.observable:"@@observable",ri=function(){function e(e){this._subscribe=e}return e.prototype.subscribe=function(e,t,n){return this._subscribe(e&&"function"!=typeof e?e:{next:e,error:t,complete:n})},e.prototype[ni]=function(){return this},e}();try{ei={indexedDB:a.indexedDB||a.mozIndexedDB||a.webkitIndexedDB||a.msIndexedDB,IDBKeyRange:a.IDBKeyRange||a.webkitIDBKeyRange}}catch(e){ei={indexedDB:null,IDBKeyRange:null}}function ii(e){var t,n=!1,r=new ri((function(r){var i=G(e);function o(t){var n=Ye();try{i&&ut();var r=at(e,t);return i&&(r=r.finally(st)),r}finally{n&&ze()}}var a,u=!1,s={},c={},l={get closed(){return u},unsubscribe:function(){u||(u=!0,a&&a.abort(),f&&bn.storagemutated.unsubscribe(d))}};r.start&&r.start(l);var f=!1,h=function(){return vt(y)};function p(){return vr(c,s)}var d=function(e){yr(s,e),p()&&h()},y=function(){if(!u&&ei.indexedDB){s={};var i={};a&&a.abort(),a=new AbortController;var l={subscr:i,signal:a.signal,requery:h,querier:e,trans:null},p=o(l);Promise.resolve(p).then((function(e){n=!0,t=e,u||l.signal.aborted||(s={},B(c=i)||f||(bn(yn,d),f=!0),vt((function(){return!u&&r.next&&r.next(e)})))}),(function(e){n=!1,["DatabaseClosedError","AbortError"].includes(null==e?void 0:e.name)||u||vt((function(){u||r.error&&r.error(e)}))}))}};return setTimeout(h,0),l}));return r.hasValue=function(){return n},r.getValue=function(){return t},r}var oi=ti;function ai(e){var t=si;try{si=!0,bn.storagemutated.fire(e),_r(e,!0)}finally{si=t}}p(oi,i(i({},ie),{delete:function(e){return new oi(e,{addons:[]}).delete()},exists:function(e){return new oi(e,{addons:[]}).open().then((function(e){return e.close(),!0})).catch("NoSuchDatabaseError",(function(){return!1}))},getDatabaseNames:function(e){try{return nr(oi.dependencies).then(e)}catch(e){return bt(new te.MissingAPI)}},defineClass:function(){function e(e){c(this,e)}return e},ignoreTransaction:function(e){return Ce.trans?dt(Ce.transless,e):e()},vip:or,async:function(e){return function(){try{var t=kr(e.apply(this,arguments));return t&&"function"==typeof t.then?t:De.resolve(t)}catch(e){return bt(e)}}},spawn:function(e,t,n){try{var r=kr(e.apply(n,t||[]));return r&&"function"==typeof r.then?r:De.resolve(r)}catch(e){return bt(e)}},currentTransaction:{get:function(){return Ce.trans||null}},waitFor:function(e,t){var n=De.resolve("function"==typeof e?oi.ignoreTransaction(e):e).timeout(t||6e4);return Ce.trans?Ce.trans.waitFor(n):n},Promise:De,debug:{get:function(){return de},set:function(e){ye(e)}},derive:v,extend:c,props:p,override:_,Events:Lt,on:bn,liveQuery:ii,extendObservabilitySet:yr,getByKeyPath:x,setByKeyPath:S,delByKeyPath:A,shallowClone:T,deepClone:R,getObjectDiff:Pr,cmp:It,asap:E,minKey:_t,addons:[],connections:kt,errnames:Z,dependencies:ei,cache:br,semVer:gt,version:gt.split(".").map((function(e){return parseInt(e)})).reduce((function(e,t,n){return e+t/Math.pow(10,2*n)}))})),oi.maxKey=kn(oi.dependencies.IDBKeyRange),"undefined"!=typeof dispatchEvent&&"undefined"!=typeof addEventListener&&(bn(yn,(function(e){var t;si||(t=new CustomEvent(vn,{detail:e}),si=!0,dispatchEvent(t),si=!1)})),addEventListener(vn,(function(e){var t=e.detail;si||ai(t)})));var ui,si=!1,ci=function(){};function li(e){return new Qt({add:e})}function fi(e){return new Qt({remove:e})}function hi(e,t){return new Qt({replacePrefix:[e,t]})}return"undefined"!=typeof BroadcastChannel&&((ci=function(){(ui=new BroadcastChannel(vn)).onmessage=function(e){return e.data&&ai(e.data)}})(),"function"==typeof ui.unref&&ui.unref(),bn(yn,(function(e){si||ui.postMessage(e)}))),"undefined"!=typeof addEventListener&&(addEventListener("pagehide",(function(e){if(!ti.disableBfCache&&e.persisted){de&&console.debug("Dexie: handling persisted pagehide"),null==ui||ui.close();for(var t=0,n=kt;t<n.length;t++)n[t].close({disableAutoOpen:!1})}})),addEventListener("pageshow",(function(e){!ti.disableBfCache&&e.persisted&&(de&&console.debug("Dexie: handling persisted pageshow"),ci(),ai({all:new sr(-1/0,[[]])}))}))),De.rejectionMapper=re,ye(de),i(ti,Object.freeze({__proto__:null,Dexie:ti,liveQuery:ii,Entity:Nt,cmp:It,PropModSymbol:Wt,PropModification:Qt,replacePrefix:hi,add:li,remove:fi,default:ti,RangeSet:sr,mergeRanges:lr,rangesOverlap:fr}),{default:ti}),ti}();var o=r(i.exports),a=Symbol.for("Dexie"),u=globalThis[a]||(globalThis[a]=o);if(o.semVer!==u.semVer)throw new Error("Two different versions of Dexie loaded in the same app: ".concat(o.semVer," and ").concat(u.semVer));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
function s(e,t,n,r){return new(n||(n=Promise))((function(t,i){function o(e){try{u(r.next(e))}catch(e){i(e)}}function a(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var r;e.done?t(e.value):(r=e.value,r instanceof n?r:new n((function(e){e(r)}))).then(o,a)}u((r=r.apply(e,[])).next())}))}function c(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}}function l(e){return[e.schema.primKey].concat(e.schema.indexes).map((function(e){return e.src})).join(",")}function f(e,t){return new Promise((function(n,r){var i=new FileReader;i.onabort=function(e){return r(new Error("file read aborted"))},i.onerror=function(e){return r(e.target.error)},i.onload=function(e){return n(e.target.result)},"binary"===t?i.readAsArrayBuffer(e):i.readAsText(e)}))}function h(e,t){if("undefined"==typeof FileReaderSync)throw new Error("FileReaderSync missing. Reading blobs synchronously requires code to run from within a web worker. Use TSON.encapsulateAsync() to do it from the main thread.");var n=new FileReaderSync;return"binary"===t?n.readAsArrayBuffer(e):n.readAsText(e)}u.liveQuery,u.mergeRanges,u.rangesOverlap,u.RangeSet,u.cmp,u.Entity,u.PropModSymbol,u.PropModification,u.replacePrefix,u.add,u.remove;var p="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function d(e,t){return e(t={exports:{}},t.exports),t.exports}for(var y=d((function(n,r){n.exports=function(){function n(e){return n="function"==typeof Symbol&&"symbol"===t(Symbol.iterator)?function(e){return t(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":t(e)},n(e)}function r(e,t,n,r,i,o,a){try{var u=e[o](a),s=u.value}catch(e){return void n(e)}u.done?t(s):Promise.resolve(s).then(r,i)}function i(e){return function(){var t=this,n=arguments;return new Promise((function(i,o){var a=e.apply(t,n);function u(e){r(a,i,o,u,s,"next",e)}function s(e){r(a,i,o,u,s,"throw",e)}u(void 0)}))}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t,n){return t&&a(e.prototype,t),e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function f(e,t){return d(e)||v(e,t)||m()}function h(e){return p(e)||y(e)||b()}function p(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}function d(e){if(Array.isArray(e))return e}function y(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function v(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var n=[],r=!0,i=!1,o=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw o}}return n}}function b(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function m(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}var g=function e(t){o(this,e),this.p=new Promise(t)};g.__typeson__type__="TypesonPromise","undefined"!=typeof Symbol&&(g.prototype[Symbol.toStringTag]="TypesonPromise"),g.prototype.then=function(e,t){var n=this;return new g((function(r,i){n.p.then((function(t){r(e?e(t):t)})).catch((function(e){return t?t(e):Promise.reject(e)})).then(r,i)}))},g.prototype.catch=function(e){return this.then(null,e)},g.resolve=function(e){return new g((function(t){t(e)}))},g.reject=function(e){return new g((function(t,n){n(e)}))},["all","race"].forEach((function(e){g[e]=function(t){return new g((function(n,r){Promise[e](t.map((function(e){return e&&e.constructor&&"TypesonPromise"===e.constructor.__typeson__type__?e.p:e}))).then(n,r)}))}}));var w={}.toString,_={}.hasOwnProperty,O=Object.getPrototypeOf,E=_.toString;function k(e,t){return j(e)&&"function"==typeof e.then&&(!t||"function"==typeof e.catch)}function x(e){return w.call(e).slice(8,-1)}function S(e,t){if(!e||"object"!==n(e))return!1;var r=O(e);if(!r)return null===t;var i=_.call(r,"constructor")&&r.constructor;return"function"!=typeof i?null===t:t===i||null!==t&&E.call(i)===E.call(t)||"function"==typeof t&&"string"==typeof i.__typeson__type__&&i.__typeson__type__===t.__typeson__type__}function A(e){return!(!e||"Object"!==x(e))&&(!O(e)||S(e,Object))}function T(e){if(!e||"Object"!==x(e))return!1;var t=O(e);return!t||S(e,Object)||T(t)}function j(e){return e&&"object"===n(e)}function P(e){return e.replace(/~/g,"~0").replace(/\./g,"~1")}function N(e){return e.replace(/~1/g,".").replace(/~0/g,"~")}function I(e,t){if(""===t)return e;var n=t.indexOf(".");if(n>-1){var r=e[N(t.slice(0,n))];return void 0===r?void 0:I(r,t.slice(n+1))}return e[N(t)]}function C(e,t,n){if(""===t)return n;var r=t.indexOf(".");return r>-1?C(e[N(t.slice(0,r))],t.slice(r+1),n):(e[N(t)]=n,e)}function B(e){return null===e?"null":Array.isArray(e)?"array":n(e)}var K=Object.keys,R=Array.isArray,D={}.hasOwnProperty,L=["type","replaced","iterateIn","iterateUnsetNumeric"];function F(e,t){if(""===e.keypath)return-1;var n=e.keypath.match(/\./g)||0,r=t.keypath.match(/\./g)||0;return n&&(n=n.length),r&&(r=r.length),n>r?-1:n<r?1:e.keypath<t.keypath?-1:e.keypath>t.keypath}var q=function(){function t(e){o(this,t),this.options=e,this.plainObjectReplacers=[],this.nonplainObjectReplacers=[],this.revivers={},this.types={}}return u(t,[{key:"stringify",value:function(e,t,n,r){r=l({},this.options,{},r,{stringification:!0});var i=this.encapsulate(e,null,r);return R(i)?JSON.stringify(i[0],t,n):i.then((function(e){return JSON.stringify(e,t,n)}))}},{key:"stringifySync",value:function(e,t,n,r){return this.stringify(e,t,n,l({throwOnBadSyncType:!0},r,{sync:!0}))}},{key:"stringifyAsync",value:function(e,t,n,r){return this.stringify(e,t,n,l({throwOnBadSyncType:!0},r,{sync:!1}))}},{key:"parse",value:function(e,t,n){return n=l({},this.options,{},n,{parse:!0}),this.revive(JSON.parse(e,t),n)}},{key:"parseSync",value:function(e,t,n){return this.parse(e,t,l({throwOnBadSyncType:!0},n,{sync:!0}))}},{key:"parseAsync",value:function(e,t,n){return this.parse(e,t,l({throwOnBadSyncType:!0},n,{sync:!1}))}},{key:"specialTypeNames",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return n.returnTypeNames=!0,this.encapsulate(e,t,n)}},{key:"rootTypeName",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return n.iterateNone=!0,this.encapsulate(e,t,n)}},{key:"encapsulate",value:function(r,o,a){var u=(a=l({sync:!0},this.options,{},a)).sync,s=this,c={},p=[],d=[],y=[],v=!("cyclic"in a)||a.cyclic,b=a.encapsulateObserver,m=k("",r,v,o||{},y);function w(e){var n=Object.values(c);if(a.iterateNone)return n.length?n[0]:t.getJSONType(e);if(n.length){if(a.returnTypeNames)return h(new Set(n));e&&A(e)&&!D.call(e,"$types")?e.$types=c:e={$:e,$types:{$:c}}}else j(e)&&D.call(e,"$types")&&(e={$:e,$types:!0});return!a.returnTypeNames&&e}function _(e,t){return O.apply(this,arguments)}function O(){return O=i(e().mark((function t(n,r){var o;return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all(r.map((function(e){return e[1].p})));case 2:return o=t.sent,t.next=5,Promise.all(o.map(function(){var t=i(e().mark((function t(i){var o,a,u,s,c,l,h,p,d,y,v,b,m,w;return e().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=[],a=r.splice(0,1),u=f(a,1),s=u[0],c=f(s,7),l=c[0],h=c[2],p=c[3],d=c[4],y=c[5],v=c[6],b=k(l,i,h,p,o,!0,v),m=S(b,g),!l||!m){e.next=11;break}return e.next=8,b.p;case 8:return w=e.sent,d[y]=w,e.abrupt("return",_(n,o));case 11:return l?d[y]=b:n=m?b.p:b,e.abrupt("return",_(n,o));case 13:case"end":return e.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 5:return t.abrupt("return",n);case 6:case"end":return t.stop()}}),t)}))),O.apply(this,arguments)}function E(e,t,n){Object.assign(e,t);var r=L.map((function(t){var n=e[t];return delete e[t],n}));n(),L.forEach((function(t,n){e[t]=r[n]}))}function k(e,r,i,o,u,l,f){var h,y={},v=n(r),m=b?function(n){var a=f||o.type||t.getJSONType(r);b(Object.assign(n||y,{keypath:e,value:r,cyclic:i,stateObj:o,promisesData:u,resolvingTypesonPromise:l,awaitingTypesonPromise:S(r,g)},{type:a}))}:null;if(["string","boolean","number","undefined"].includes(v))return void 0===r||"number"===v&&(isNaN(r)||r===-1/0||r===1/0)?(h=o.replaced?r:x(e,r,o,u,!1,l,m))!==r&&(y={replaced:h}):h=r,m&&m(),h;if(null===r)return m&&m(),r;if(i&&!o.iterateIn&&!o.iterateUnsetNumeric&&r&&"object"===n(r)){var w=p.indexOf(r);if(!(w<0))return c[e]="#",m&&m({cyclicKeypath:d[w]}),"#"+d[w];!0===i&&(p.push(r),d.push(e))}var _,O=A(r),T=R(r),j=(O||T)&&(!s.plainObjectReplacers.length||o.replaced)||o.iterateIn?r:x(e,r,o,u,O||T,null,m);if(j!==r?(h=j,y={replaced:j}):""===e&&S(r,g)?(u.push([e,r,i,o,void 0,void 0,o.type]),h=r):T&&"object"!==o.iterateIn||"array"===o.iterateIn?(_=new Array(r.length),y={clone:_}):(["function","symbol"].includes(n(r))||"toJSON"in r||S(r,g)||S(r,Promise)||S(r,ArrayBuffer))&&!O&&"object"!==o.iterateIn?h=r:(_={},o.addLength&&(_.length=r.length),y={clone:_}),m&&m(),a.iterateNone)return _||h;if(!_)return h;if(o.iterateIn){var N=function(t){var n={ownKeys:D.call(r,t)};E(o,n,(function(){var n=e+(e?".":"")+P(t),a=k(n,r[t],Boolean(i),o,u,l);S(a,g)?u.push([n,a,Boolean(i),o,_,t,o.type]):void 0!==a&&(_[t]=a)}))};for(var I in r)N(I);m&&m({endIterateIn:!0,end:!0})}else K(r).forEach((function(t){var n=e+(e?".":"")+P(t);E(o,{ownKeys:!0},(function(){var e=k(n,r[t],Boolean(i),o,u,l);S(e,g)?u.push([n,e,Boolean(i),o,_,t,o.type]):void 0!==e&&(_[t]=e)}))})),m&&m({endIterateOwn:!0,end:!0});if(o.iterateUnsetNumeric){for(var C=r.length,B=function(t){if(!(t in r)){var n=e+(e?".":"")+t;E(o,{ownKeys:!1},(function(){var e=k(n,void 0,Boolean(i),o,u,l);S(e,g)?u.push([n,e,Boolean(i),o,_,t,o.type]):void 0!==e&&(_[t]=e)}))}},L=0;L<C;L++)B(L);m&&m({endIterateUnsetNumeric:!0,end:!0})}return _}function x(e,t,n,r,i,o,a){for(var l=i?s.plainObjectReplacers:s.nonplainObjectReplacers,f=l.length;f--;){var h=l[f];if(h.test(t,n)){var p=h.type;if(s.revivers[p]){var d=c[e];c[e]=d?[p].concat(d):p}return Object.assign(n,{type:p,replaced:!0}),!u&&h.replaceAsync||h.replace?(a&&a({replacing:!0}),k(e,h[u||!h.replaceAsync?"replace":"replaceAsync"](t,n),v&&"readonly",n,r,o,p)):(a&&a({typeDetected:!0}),k(e,t,v&&"readonly",n,r,o,p))}}return t}return y.length?u&&a.throwOnBadSyncType?function(){throw new TypeError("Sync method requested but async result obtained")}():Promise.resolve(_(m,y)).then(w):!u&&a.throwOnBadSyncType?function(){throw new TypeError("Async method requested but sync result obtained")}():a.stringification&&u?[w(m)]:u?w(m):Promise.resolve(w(m))}},{key:"encapsulateSync",value:function(e,t,n){return this.encapsulate(e,t,l({throwOnBadSyncType:!0},n,{sync:!0}))}},{key:"encapsulateAsync",value:function(e,t,n){return this.encapsulate(e,t,l({throwOnBadSyncType:!0},n,{sync:!1}))}},{key:"revive",value:function(e,t){var n=e&&e.$types;if(!n)return e;if(!0===n)return e.$;var r=(t=l({sync:!0},this.options,{},t)).sync,i=[],o={},a=!0;n.$&&A(n.$)&&(e=e.$,n=n.$,a=!1);var u=this;function s(e,t){var n=f(u.revivers[e]||[],1)[0];if(!n)throw new Error("Unregistered type: "+e);return r&&!("revive"in n)?t:n[r&&n.revive?"revive":!r&&n.reviveAsync?"reviveAsync":"revive"](t,o)}function c(){var t=[];if(Object.entries(n).forEach((function(e){var r=f(e,2),i=r[0],o=r[1];"#"!==o&&[].concat(o).forEach((function(e){f(u.revivers[e]||[null,{}],2)[1].plain&&(t.push({keypath:i,type:e}),delete n[i])}))})),t.length)return t.sort(F).reduce((function t(n,r){var i=r.keypath,o=r.type;if(k(n))return n.then((function(e){return t(e,{keypath:i,type:o})}));var a=I(e,i);if(S(a=s(o,a),g))return a.then((function(t){var n=C(e,i,t);n===t&&(e=n)}));var u=C(e,i,a);u===a&&(e=u)}),void 0)}var h=[];function p(e,t,r,o,u){if(!a||"$types"!==e){var c=n[e],l=R(t);if(l||A(t)){var d=l?new Array(t.length):{};for(K(t).forEach((function(n){var i=p(e+(e?".":"")+P(n),t[n],r||d,d,n),o=function(e){return S(e,U)?d[n]=void 0:void 0!==e&&(d[n]=e),e};S(i,g)?h.push(i.then((function(e){return o(e)}))):o(i)})),t=d;i.length;){var y=f(i[0],4),v=y[0],b=y[1],m=y[2],w=y[3],_=I(v,b);if(void 0===_)break;m[w]=_,i.splice(0,1)}}if(!c)return t;if("#"===c){var O=I(r,t.slice(1));return void 0===O&&i.push([r,t.slice(1),o,u]),O}return[].concat(c).reduce((function e(t,n){return S(t,g)?t.then((function(t){return e(t,n)})):s(n,t)}),t)}}function d(e){return S(e,U)?void 0:e}var y,v=c();return S(v,g)?y=v.then((function(){return e})):(y=p("",e,null),h.length&&(y=g.resolve(y).then((function(e){return g.all([e].concat(h))})).then((function(e){return f(e,1)[0]})))),k(y)?r&&t.throwOnBadSyncType?function(){throw new TypeError("Sync method requested but async result obtained")}():S(y,g)?y.p.then(d):y:!r&&t.throwOnBadSyncType?function(){throw new TypeError("Async method requested but sync result obtained")}():r?d(y):Promise.resolve(d(y))}},{key:"reviveSync",value:function(e,t){return this.revive(e,l({throwOnBadSyncType:!0},t,{sync:!0}))}},{key:"reviveAsync",value:function(e,t){return this.revive(e,l({throwOnBadSyncType:!0},t,{sync:!1}))}},{key:"register",value:function(e,n){return n=n||{},[].concat(e).forEach((function e(r){var i=this;if(R(r))return r.map((function(t){return e.call(i,t)}));r&&K(r).forEach((function(e){if("#"===e)throw new TypeError("# cannot be used as a type name as it is reserved for cyclic objects");if(t.JSON_TYPES.includes(e))throw new TypeError("Plain JSON object types are reserved as type names");var i=r[e],o=i&&i.testPlainObjects?this.plainObjectReplacers:this.nonplainObjectReplacers,a=o.filter((function(t){return t.type===e}));if(a.length&&(o.splice(o.indexOf(a[0]),1),delete this.revivers[e],delete this.types[e]),"function"==typeof i){var u=i;i={test:function(e){return e&&e.constructor===u},replace:function(e){return l({},e)},revive:function(e){return Object.assign(Object.create(u.prototype),e)}}}else if(R(i)){var s=f(i,3);i={test:s[0],replace:s[1],revive:s[2]}}if(i&&i.test){var c={type:e,test:i.test.bind(i)};i.replace&&(c.replace=i.replace.bind(i)),i.replaceAsync&&(c.replaceAsync=i.replaceAsync.bind(i));var h="number"==typeof n.fallback?n.fallback:n.fallback?0:1/0;if(i.testPlainObjects?this.plainObjectReplacers.splice(h,0,c):this.nonplainObjectReplacers.splice(h,0,c),i.revive||i.reviveAsync){var p={};i.revive&&(p.revive=i.revive.bind(i)),i.reviveAsync&&(p.reviveAsync=i.reviveAsync.bind(i)),this.revivers[e]=[p,{plain:i.testPlainObjects}]}this.types[e]=i}}),this)}),this),this}}]),t}(),U=function e(){o(this,e)};return U.__typeson__type__="TypesonUndefined",q.Undefined=U,q.Promise=g,q.isThenable=k,q.toStringTag=x,q.hasConstructorOf=S,q.isObject=j,q.isPlainObject=A,q.isUserObject=T,q.escapeKeyPathComponent=P,q.unescapeKeyPathComponent=N,q.getByKeyPath=I,q.getJSONType=B,q.JSON_TYPES=["null","boolean","number","string","array","object"],q}()})),v=d((function(e,n){e.exports=function(){function e(n){return(e="function"==typeof Symbol&&"symbol"==t(Symbol.iterator)?function(e){return t(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":t(e)})(n)}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){return function(e){if(Array.isArray(e))return u(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function s(e){return(s="function"==typeof Symbol&&"symbol"==t(Symbol.iterator)?function(e){return t(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":t(e)})(e)}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){f(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,i=!1,o=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw o}}return n}}(e,t)||b(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(e){return function(e){if(Array.isArray(e))return m(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||b(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(e,t){if(e){if("string"==typeof e)return m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?m(e,t):void 0}}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var g=function e(t){c(this,e),this.p=new Promise(t)};g.__typeson__type__="TypesonPromise","undefined"!=typeof Symbol&&(g.prototype[Symbol.toStringTag]="TypesonPromise"),g.prototype.then=function(e,t){var n=this;return new g((function(r,i){n.p.then((function(t){r(e?e(t):t)})).catch((function(e){return t?t(e):Promise.reject(e)})).then(r,i)}))},g.prototype.catch=function(e){return this.then(null,e)},g.resolve=function(e){return new g((function(t){t(e)}))},g.reject=function(e){return new g((function(t,n){n(e)}))},["all","race"].forEach((function(e){g[e]=function(t){return new g((function(n,r){Promise[e](t.map((function(e){return e&&e.constructor&&"TypesonPromise"===e.constructor.__typeson__type__?e.p:e}))).then(n,r)}))}}));var w={}.toString,_={}.hasOwnProperty,O=Object.getPrototypeOf,E=_.toString;function k(e,t){return T(e)&&"function"==typeof e.then&&(!t||"function"==typeof e.catch)}function x(e){return w.call(e).slice(8,-1)}function S(e,t){if(!e||"object"!==s(e))return!1;var n=O(e);if(!n)return null===t;var r=_.call(n,"constructor")&&n.constructor;return"function"!=typeof r?null===t:t===r||null!==t&&E.call(r)===E.call(t)||"function"==typeof t&&"string"==typeof r.__typeson__type__&&r.__typeson__type__===t.__typeson__type__}function A(e){return!(!e||"Object"!==x(e))&&(!O(e)||S(e,Object))}function T(e){return e&&"object"===s(e)}function j(e){return e.replace(/~/g,"~0").replace(/\./g,"~1")}function P(e){return e.replace(/~1/g,".").replace(/~0/g,"~")}function N(e,t){if(""===t)return e;var n=t.indexOf(".");if(n>-1){var r=e[P(t.slice(0,n))];return void 0===r?void 0:N(r,t.slice(n+1))}return e[P(t)]}function I(e,t,n){if(""===t)return n;var r=t.indexOf(".");return r>-1?I(e[P(t.slice(0,r))],t.slice(r+1),n):(e[P(t)]=n,e)}function C(e,t,n){return e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e}var B=Object.keys,K=Array.isArray,R={}.hasOwnProperty,D=["type","replaced","iterateIn","iterateUnsetNumeric"];function L(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(e){return Promise.reject(e)}}}function F(e,t){if(""===e.keypath)return-1;var n=e.keypath.match(/\./g)||0,r=t.keypath.match(/\./g)||0;return n&&(n=n.length),r&&(r=r.length),n>r?-1:n<r?1:e.keypath<t.keypath?-1:e.keypath>t.keypath}var q=function(){function e(t){c(this,e),this.options=t,this.plainObjectReplacers=[],this.nonplainObjectReplacers=[],this.revivers={},this.types={}}return function(e,t){t&&l(e.prototype,t)}(e,[{key:"stringify",value:function(e,t,n,r){r=d(d(d({},this.options),r),{},{stringification:!0});var i=this.encapsulate(e,null,r);return K(i)?JSON.stringify(i[0],t,n):i.then((function(e){return JSON.stringify(e,t,n)}))}},{key:"stringifySync",value:function(e,t,n,r){return this.stringify(e,t,n,d(d({throwOnBadSyncType:!0},r),{},{sync:!0}))}},{key:"stringifyAsync",value:function(e,t,n,r){return this.stringify(e,t,n,d(d({throwOnBadSyncType:!0},r),{},{sync:!1}))}},{key:"parse",value:function(e,t,n){return n=d(d(d({},this.options),n),{},{parse:!0}),this.revive(JSON.parse(e,t),n)}},{key:"parseSync",value:function(e,t,n){return this.parse(e,t,d(d({throwOnBadSyncType:!0},n),{},{sync:!0}))}},{key:"parseAsync",value:function(e,t,n){return this.parse(e,t,d(d({throwOnBadSyncType:!0},n),{},{sync:!1}))}},{key:"specialTypeNames",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return n.returnTypeNames=!0,this.encapsulate(e,t,n)}},{key:"rootTypeName",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return n.iterateNone=!0,this.encapsulate(e,t,n)}},{key:"encapsulate",value:function(t,n,r){var i=L((function(e,t){return C(Promise.all(t.map((function(e){return e[1].p}))),(function(n){return C(Promise.all(n.map(L((function(n){var r=!1,o=[],a=y(t.splice(0,1),1),u=y(a[0],7),s=u[0],c=u[2],l=u[3],f=u[4],h=u[5],p=u[6],d=_(s,n,c,l,o,!0,p),v=S(d,g);return function(e,t){var n=e();return n&&n.then?n.then(t):t(n)}((function(){if(s&&v)return C(d.p,(function(t){return f[h]=t,r=!0,i(e,o)}))}),(function(t){return r?t:(s?f[h]=d:e=v?d.p:d,i(e,o))}))})))),(function(){return e}))}))})),o=(r=d(d({sync:!0},this.options),r)).sync,a=this,u={},c=[],l=[],f=[],h=!("cyclic"in r)||r.cyclic,p=r.encapsulateObserver,b=_("",t,h,n||{},f);function m(t){var n=Object.values(u);if(r.iterateNone)return n.length?n[0]:e.getJSONType(t);if(n.length){if(r.returnTypeNames)return v(new Set(n));t&&A(t)&&!R.call(t,"$types")?t.$types=u:t={$:t,$types:{$:u}}}else T(t)&&R.call(t,"$types")&&(t={$:t,$types:!0});return!r.returnTypeNames&&t}function w(e,t,n){Object.assign(e,t);var r=D.map((function(t){var n=e[t];return delete e[t],n}));n(),D.forEach((function(t,n){e[t]=r[n]}))}function _(t,n,i,o,f,h,d){var y,v={},b=s(n),m=p?function(r){var a=d||o.type||e.getJSONType(n);p(Object.assign(r||v,{keypath:t,value:n,cyclic:i,stateObj:o,promisesData:f,resolvingTypesonPromise:h,awaitingTypesonPromise:S(n,g)},{type:a}))}:null;if(["string","boolean","number","undefined"].includes(b))return void 0===n||Number.isNaN(n)||n===Number.NEGATIVE_INFINITY||n===Number.POSITIVE_INFINITY?(y=o.replaced?n:O(t,n,o,f,!1,h,m))!==n&&(v={replaced:y}):y=n,m&&m(),y;if(null===n)return m&&m(),n;if(i&&!o.iterateIn&&!o.iterateUnsetNumeric&&n&&"object"===s(n)){var E=c.indexOf(n);if(!(E<0))return u[t]="#",m&&m({cyclicKeypath:l[E]}),"#"+l[E];!0===i&&(c.push(n),l.push(t))}var k,x=A(n),T=K(n),P=(x||T)&&(!a.plainObjectReplacers.length||o.replaced)||o.iterateIn?n:O(t,n,o,f,x||T,null,m);if(P!==n?(y=P,v={replaced:P}):""===t&&S(n,g)?(f.push([t,n,i,o,void 0,void 0,o.type]),y=n):T&&"object"!==o.iterateIn||"array"===o.iterateIn?(k=new Array(n.length),v={clone:k}):(["function","symbol"].includes(s(n))||"toJSON"in n||S(n,g)||S(n,Promise)||S(n,ArrayBuffer))&&!x&&"object"!==o.iterateIn?y=n:(k={},o.addLength&&(k.length=n.length),v={clone:k}),m&&m(),r.iterateNone)return k||y;if(!k)return y;if(o.iterateIn){var N=function(e){var r={ownKeys:R.call(n,e)};w(o,r,(function(){var r=t+(t?".":"")+j(e),a=_(r,n[e],Boolean(i),o,f,h);S(a,g)?f.push([r,a,Boolean(i),o,k,e,o.type]):void 0!==a&&(k[e]=a)}))};for(var I in n)N(I);m&&m({endIterateIn:!0,end:!0})}else B(n).forEach((function(e){var r=t+(t?".":"")+j(e);w(o,{ownKeys:!0},(function(){var t=_(r,n[e],Boolean(i),o,f,h);S(t,g)?f.push([r,t,Boolean(i),o,k,e,o.type]):void 0!==t&&(k[e]=t)}))})),m&&m({endIterateOwn:!0,end:!0});if(o.iterateUnsetNumeric){for(var C=n.length,D=function(e){if(!(e in n)){var r=t+(t?".":"")+e;w(o,{ownKeys:!1},(function(){var t=_(r,void 0,Boolean(i),o,f,h);S(t,g)?f.push([r,t,Boolean(i),o,k,e,o.type]):void 0!==t&&(k[e]=t)}))}},L=0;L<C;L++)D(L);m&&m({endIterateUnsetNumeric:!0,end:!0})}return k}function O(e,t,n,r,i,s,c){for(var l=i?a.plainObjectReplacers:a.nonplainObjectReplacers,f=l.length;f--;){var p=l[f];if(p.test(t,n)){var d=p.type;if(a.revivers[d]){var y=u[e];u[e]=y?[d].concat(y):d}return Object.assign(n,{type:d,replaced:!0}),!o&&p.replaceAsync||p.replace?(c&&c({replacing:!0}),_(e,p[o||!p.replaceAsync?"replace":"replaceAsync"](t,n),h&&"readonly",n,r,s,d)):(c&&c({typeDetected:!0}),_(e,t,h&&"readonly",n,r,s,d))}}return t}return f.length?o&&r.throwOnBadSyncType?function(){throw new TypeError("Sync method requested but async result obtained")}():Promise.resolve(i(b,f)).then(m):!o&&r.throwOnBadSyncType?function(){throw new TypeError("Async method requested but sync result obtained")}():r.stringification&&o?[m(b)]:o?m(b):Promise.resolve(m(b))}},{key:"encapsulateSync",value:function(e,t,n){return this.encapsulate(e,t,d(d({throwOnBadSyncType:!0},n),{},{sync:!0}))}},{key:"encapsulateAsync",value:function(e,t,n){return this.encapsulate(e,t,d(d({throwOnBadSyncType:!0},n),{},{sync:!1}))}},{key:"revive",value:function(e,t){var n=e&&e.$types;if(!n)return e;if(!0===n)return e.$;var r=(t=d(d({sync:!0},this.options),t)).sync,i=[],o={},a=!0;n.$&&A(n.$)&&(e=e.$,n=n.$,a=!1);var u=this;function s(e,t){var n=y(u.revivers[e]||[],1)[0];if(!n)throw new Error("Unregistered type: "+e);return r&&!("revive"in n)?t:n[r&&n.revive?"revive":!r&&n.reviveAsync?"reviveAsync":"revive"](t,o)}var c=[];function l(e){return S(e,U)?void 0:e}var f,h=function(){var t=[];if(Object.entries(n).forEach((function(e){var r=y(e,2),i=r[0],o=r[1];"#"!==o&&[].concat(o).forEach((function(e){y(u.revivers[e]||[null,{}],2)[1].plain&&(t.push({keypath:i,type:e}),delete n[i])}))})),t.length)return t.sort(F).reduce((function t(n,r){var i=r.keypath,o=r.type;if(k(n))return n.then((function(e){return t(e,{keypath:i,type:o})}));var a=N(e,i);if(S(a=s(o,a),g))return a.then((function(t){var n=I(e,i,t);n===t&&(e=n)}));var u=I(e,i,a);u===a&&(e=u)}),void 0)}();return S(h,g)?f=h.then((function(){return e})):(f=function e(t,r,o,u,l){if(!a||"$types"!==t){var f=n[t],h=K(r);if(h||A(r)){var p=h?new Array(r.length):{};for(B(r).forEach((function(n){var i=e(t+(t?".":"")+j(n),r[n],o||p,p,n),a=function(e){return S(e,U)?p[n]=void 0:void 0!==e&&(p[n]=e),e};S(i,g)?c.push(i.then((function(e){return a(e)}))):a(i)})),r=p;i.length;){var d=y(i[0],4),v=d[0],b=d[1],m=d[2],w=d[3],_=N(v,b);if(void 0===_)break;m[w]=_,i.splice(0,1)}}if(!f)return r;if("#"===f){var O=N(o,r.slice(1));return void 0===O&&i.push([o,r.slice(1),u,l]),O}return[].concat(f).reduce((function e(t,n){return S(t,g)?t.then((function(t){return e(t,n)})):s(n,t)}),r)}}("",e,null),c.length&&(f=g.resolve(f).then((function(e){return g.all([e].concat(c))})).then((function(e){return y(e,1)[0]})))),k(f)?r&&t.throwOnBadSyncType?function(){throw new TypeError("Sync method requested but async result obtained")}():S(f,g)?f.p.then(l):f:!r&&t.throwOnBadSyncType?function(){throw new TypeError("Async method requested but sync result obtained")}():r?l(f):Promise.resolve(l(f))}},{key:"reviveSync",value:function(e,t){return this.revive(e,d(d({throwOnBadSyncType:!0},t),{},{sync:!0}))}},{key:"reviveAsync",value:function(e,t){return this.revive(e,d(d({throwOnBadSyncType:!0},t),{},{sync:!1}))}},{key:"register",value:function(t,n){return n=n||{},[].concat(t).forEach((function t(r){var i=this;if(K(r))return r.map((function(e){return t.call(i,e)}));r&&B(r).forEach((function(t){if("#"===t)throw new TypeError("# cannot be used as a type name as it is reserved for cyclic objects");if(e.JSON_TYPES.includes(t))throw new TypeError("Plain JSON object types are reserved as type names");var i=r[t],o=i&&i.testPlainObjects?this.plainObjectReplacers:this.nonplainObjectReplacers,a=o.filter((function(e){return e.type===t}));if(a.length&&(o.splice(o.indexOf(a[0]),1),delete this.revivers[t],delete this.types[t]),"function"==typeof i){var u=i;i={test:function(e){return e&&e.constructor===u},replace:function(e){return d({},e)},revive:function(e){return Object.assign(Object.create(u.prototype),e)}}}else if(K(i)){var s=y(i,3);i={test:s[0],replace:s[1],revive:s[2]}}if(i&&i.test){var c={type:t,test:i.test.bind(i)};i.replace&&(c.replace=i.replace.bind(i)),i.replaceAsync&&(c.replaceAsync=i.replaceAsync.bind(i));var l="number"==typeof n.fallback?n.fallback:n.fallback?0:Number.POSITIVE_INFINITY;if(i.testPlainObjects?this.plainObjectReplacers.splice(l,0,c):this.nonplainObjectReplacers.splice(l,0,c),i.revive||i.reviveAsync){var f={};i.revive&&(f.revive=i.revive.bind(i)),i.reviveAsync&&(f.reviveAsync=i.reviveAsync.bind(i)),this.revivers[t]=[f,{plain:i.testPlainObjects}]}this.types[t]=i}}),this)}),this),this}}]),e}(),U=function e(){c(this,e)};U.__typeson__type__="TypesonUndefined",q.Undefined=U,q.Promise=g,q.isThenable=k,q.toStringTag=x,q.hasConstructorOf=S,q.isObject=T,q.isPlainObject=A,q.isUserObject=function e(t){if(!t||"Object"!==x(t))return!1;var n=O(t);return!n||S(t,Object)||e(n)},q.escapeKeyPathComponent=j,q.unescapeKeyPathComponent=P,q.getByKeyPath=N,q.getJSONType=function(e){return null===e?"null":Array.isArray(e)?"array":s(e)},q.JSON_TYPES=["null","boolean","number","string","array","object"];for(var M={userObject:{test:function(e,t){return q.isUserObject(e)},replace:function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e)},revive:function(e){return e}}},V=[{arrayNonindexKeys:{testPlainObjects:!0,test:function(e,t){return!!Array.isArray(e)&&(Object.keys(e).some((function(e){return String(Number.parseInt(e))!==e}))&&(t.iterateIn="object",t.addLength=!0),!0)},replace:function(e,t){return t.iterateUnsetNumeric=!0,e},revive:function(e){if(Array.isArray(e))return e;var t=[];return Object.keys(e).forEach((function(n){var r=e[n];t[n]=r})),t}}},{sparseUndefined:{test:function(e,t){return void 0===e&&!1===t.ownKeys},replace:function(e){return 0},revive:function(e){}}}],$={undef:{test:function(e,t){return void 0===e&&(t.ownKeys||!("ownKeys"in t))},replace:function(e){return 0},revive:function(e){return new q.Undefined}}},G={StringObject:{test:function(t){return"String"===q.toStringTag(t)&&"object"===e(t)},replace:function(e){return String(e)},revive:function(e){return new String(e)}},BooleanObject:{test:function(t){return"Boolean"===q.toStringTag(t)&&"object"===e(t)},replace:function(e){return Boolean(e)},revive:function(e){return new Boolean(e)}},NumberObject:{test:function(t){return"Number"===q.toStringTag(t)&&"object"===e(t)},replace:function(e){return Number(e)},revive:function(e){return new Number(e)}}},Y=[{nan:{test:function(e){return Number.isNaN(e)},replace:function(e){return"NaN"},revive:function(e){return Number.NaN}}},{infinity:{test:function(e){return e===Number.POSITIVE_INFINITY},replace:function(e){return"Infinity"},revive:function(e){return Number.POSITIVE_INFINITY}}},{negativeInfinity:{test:function(e){return e===Number.NEGATIVE_INFINITY},replace:function(e){return"-Infinity"},revive:function(e){return Number.NEGATIVE_INFINITY}}}],z={date:{test:function(e){return"Date"===q.toStringTag(e)},replace:function(e){var t=e.getTime();return Number.isNaN(t)?"NaN":t},revive:function(e){return"NaN"===e?new Date(Number.NaN):new Date(e)}}},J={regexp:{test:function(e){return"RegExp"===q.toStringTag(e)},replace:function(e){return{source:e.source,flags:(e.global?"g":"")+(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.sticky?"y":"")+(e.unicode?"u":"")}},revive:function(e){var t=e.source,n=e.flags;return new RegExp(t,n)}}},W={map:{test:function(e){return"Map"===q.toStringTag(e)},replace:function(e){return a(e.entries())},revive:function(e){return new Map(e)}}},Q={set:{test:function(e){return"Set"===q.toStringTag(e)},replace:function(e){return a(e.values())},revive:function(e){return new Set(e)}}},X="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",H=new Uint8Array(256),Z=0;Z<X.length;Z++)H[X.charCodeAt(Z)]=Z;var ee=function(e,t,n){null==n&&(n=e.byteLength);for(var r=new Uint8Array(e,0,n),i=r.length,o="",a=0;a<i;a+=3)o+=X[r[a]>>2],o+=X[(3&r[a])<<4|r[a+1]>>4],o+=X[(15&r[a+1])<<2|r[a+2]>>6],o+=X[63&r[a+2]];return i%3==2?o=o.slice(0,-1)+"=":i%3==1&&(o=o.slice(0,-2)+"=="),o},te=function(e){var t,n,r,i,o=e.length,a=.75*e.length,u=0;"="===e[e.length-1]&&(a--,"="===e[e.length-2]&&a--);for(var s=new ArrayBuffer(a),c=new Uint8Array(s),l=0;l<o;l+=4)t=H[e.charCodeAt(l)],n=H[e.charCodeAt(l+1)],r=H[e.charCodeAt(l+2)],i=H[e.charCodeAt(l+3)],c[u++]=t<<2|n>>4,c[u++]=(15&n)<<4|r>>2,c[u++]=(3&r)<<6|63&i;return s},ne={arraybuffer:{test:function(e){return"ArrayBuffer"===q.toStringTag(e)},replace:function(e,t){t.buffers||(t.buffers=[]);var n=t.buffers.indexOf(e);return n>-1?{index:n}:(t.buffers.push(e),ee(e))},revive:function(t,n){if(n.buffers||(n.buffers=[]),"object"===e(t))return n.buffers[t.index];var r=te(t);return n.buffers.push(r),r}}},re="undefined"==typeof self?p:self,ie={};["Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array"].forEach((function(e){var t=e,n=re[t];n&&(ie[e.toLowerCase()]={test:function(e){return q.toStringTag(e)===t},replace:function(e,t){var n=e.buffer,r=e.byteOffset,i=e.length;t.buffers||(t.buffers=[]);var o=t.buffers.indexOf(n);return o>-1?{index:o,byteOffset:r,length:i}:(t.buffers.push(n),{encoded:ee(n),byteOffset:r,length:i})},revive:function(e,t){t.buffers||(t.buffers=[]);var r,i=e.byteOffset,o=e.length,a=e.encoded,u=e.index;return"index"in e?r=t.buffers[u]:(r=te(a),t.buffers.push(r)),new n(r,i,o)}})}));var oe={dataview:{test:function(e){return"DataView"===q.toStringTag(e)},replace:function(e,t){var n=e.buffer,r=e.byteOffset,i=e.byteLength;t.buffers||(t.buffers=[]);var o=t.buffers.indexOf(n);return o>-1?{index:o,byteOffset:r,byteLength:i}:(t.buffers.push(n),{encoded:ee(n),byteOffset:r,byteLength:i})},revive:function(e,t){t.buffers||(t.buffers=[]);var n,r=e.byteOffset,i=e.byteLength,o=e.encoded,a=e.index;return"index"in e?n=t.buffers[a]:(n=te(o),t.buffers.push(n)),new DataView(n,r,i)}}},ae={IntlCollator:{test:function(e){return q.hasConstructorOf(e,Intl.Collator)},replace:function(e){return e.resolvedOptions()},revive:function(e){return new Intl.Collator(e.locale,e)}},IntlDateTimeFormat:{test:function(e){return q.hasConstructorOf(e,Intl.DateTimeFormat)},replace:function(e){return e.resolvedOptions()},revive:function(e){return new Intl.DateTimeFormat(e.locale,e)}},IntlNumberFormat:{test:function(e){return q.hasConstructorOf(e,Intl.NumberFormat)},replace:function(e){return e.resolvedOptions()},revive:function(e){return new Intl.NumberFormat(e.locale,e)}}};function ue(e){for(var t=new Uint8Array(e.length),n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t.buffer}var se={file:{test:function(e){return"File"===q.toStringTag(e)},replace:function(e){var t=new XMLHttpRequest;if(t.overrideMimeType("text/plain; charset=x-user-defined"),t.open("GET",URL.createObjectURL(e),!1),t.send(),200!==t.status&&0!==t.status)throw new Error("Bad File access: "+t.status);return{type:e.type,stringContents:t.responseText,name:e.name,lastModified:e.lastModified}},revive:function(e){var t=e.name,n=e.type,r=e.stringContents,i=e.lastModified;return new File([ue(r)],t,{type:n,lastModified:i})},replaceAsync:function(e){return new q.Promise((function(t,n){var r=new FileReader;r.addEventListener("load",(function(){t({type:e.type,stringContents:r.result,name:e.name,lastModified:e.lastModified})})),r.addEventListener("error",(function(){n(r.error)})),r.readAsBinaryString(e)}))}}},ce={bigint:{test:function(e){return"bigint"==typeof e},replace:function(e){return String(e)},revive:function(e){return BigInt(e)}}},le={bigintObject:{test:function(t){return"object"===e(t)&&q.hasConstructorOf(t,BigInt)},replace:function(e){return String(e)},revive:function(e){return new Object(BigInt(e))}}},fe={cryptokey:{test:function(e){return"CryptoKey"===q.toStringTag(e)&&e.extractable},replaceAsync:function(e){return new q.Promise((function(t,n){crypto.subtle.exportKey("jwk",e).catch((function(e){n(e)})).then((function(n){t({jwk:n,algorithm:e.algorithm,usages:e.usages})}))}))},revive:function(e){var t=e.jwk,n=e.algorithm,r=e.usages;return crypto.subtle.importKey("jwk",t,n,!0,r)}}};return[M,$,V,G,Y,z,J,{imagedata:{test:function(e){return"ImageData"===q.toStringTag(e)},replace:function(e){return{array:a(e.data),width:e.width,height:e.height}},revive:function(e){return new ImageData(new Uint8ClampedArray(e.array),e.width,e.height)}}},{imagebitmap:{test:function(e){return"ImageBitmap"===q.toStringTag(e)||e&&e.dataset&&"ImageBitmap"===e.dataset.toStringTag},replace:function(e){var t=document.createElement("canvas");return t.getContext("2d").drawImage(e,0,0),t.toDataURL()},revive:function(e){var t=document.createElement("canvas"),n=t.getContext("2d"),r=document.createElement("img");return r.addEventListener("load",(function(){n.drawImage(r,0,0)})),r.src=e,t},reviveAsync:function(e){var t=document.createElement("canvas"),n=t.getContext("2d"),r=document.createElement("img");return r.addEventListener("load",(function(){n.drawImage(r,0,0)})),r.src=e,createImageBitmap(t)}}},se,{file:se.file,filelist:{test:function(e){return"FileList"===q.toStringTag(e)},replace:function(e){for(var t=[],n=0;n<e.length;n++)t[n]=e.item(n);return t},revive:function(e){return new(function(){function e(){n(this,e),this._files=arguments[0],this.length=this._files.length}return function(e,t){t&&r(e.prototype,t)}(e,[{key:"item",value:function(e){return this._files[e]}},{key:Symbol.toStringTag,get:function(){return"FileList"}}]),e}())(e)}}},{blob:{test:function(e){return"Blob"===q.toStringTag(e)},replace:function(e){var t=new XMLHttpRequest;if(t.overrideMimeType("text/plain; charset=x-user-defined"),t.open("GET",URL.createObjectURL(e),!1),t.send(),200!==t.status&&0!==t.status)throw new Error("Bad Blob access: "+t.status);return{type:e.type,stringContents:t.responseText}},revive:function(e){var t=e.type,n=e.stringContents;return new Blob([ue(n)],{type:t})},replaceAsync:function(e){return new q.Promise((function(t,n){var r=new FileReader;r.addEventListener("load",(function(){t({type:e.type,stringContents:r.result})})),r.addEventListener("error",(function(){n(r.error)})),r.readAsBinaryString(e)}))}}}].concat("function"==typeof Map?W:[],"function"==typeof Set?Q:[],"function"==typeof ArrayBuffer?ne:[],"function"==typeof Uint8Array?ie:[],"function"==typeof DataView?oe:[],"undefined"!=typeof Intl?ae:[],"undefined"!=typeof crypto?fe:[],"undefined"!=typeof BigInt?[ce,le]:[])}()})),b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",m=new Uint8Array(256),g=0;g<64;g++)m[b.codePointAt(g)]=g;var w=function(e,t,n){null==n&&(n=e.byteLength);for(var r=new Uint8Array(e,0,n),i=r.length,o="",a=0;a<i;a+=3)o+=b[r[a]>>2],o+=b[(3&r[a])<<4|r[a+1]>>4],o+=b[(15&r[a+1])<<2|r[a+2]>>6],o+=b[63&r[a+2]];return i%3==2?o=o.slice(0,-1)+"=":i%3==1&&(o=o.slice(0,-2)+"=="),o},_=function(e){var t,n,r,i,o=e.length,a=.75*e.length,u=0;"="===e[e.length-1]&&(a--,"="===e[e.length-2]&&a--);for(var s=new ArrayBuffer(a),c=new Uint8Array(s),l=0;l<o;l+=4)t=m[e.codePointAt(l)],n=m[e.codePointAt(l+1)],r=m[e.codePointAt(l+2)],i=m[e.codePointAt(l+3)],c[u++]=t<<2|n>>4,c[u++]=(15&n)<<4|r>>2,c[u++]=(3&r)<<6|63&i;return s},O="undefined"==typeof self?global:self,E={};["Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array"].forEach((function(e){var t=e,n=O[t];n&&(E[e.toLowerCase()+"2"]={test:function(e){return y.toStringTag(e)===t},replace:function(e){return{buffer:e.buffer,byteOffset:e.byteOffset,length:e.length}},revive:function(e){var t=e.buffer,r=e.byteOffset,i=e.length;return new n(t,r,i)}})}));var k={arraybuffer:{test:function(e){return"ArrayBuffer"===y.toStringTag(e)},replace:function(e){return w(e,0,e.byteLength)},revive:function(e){return _(e)}}},x=(new y).register(v),S="FileReaderSync"in self,A=[],T=0;x.register([k,E,{blob2:{test:function(e){return"Blob"===y.toStringTag(e)},replace:function(e){if(e.isClosed)throw new Error("The Blob is closed");if(S){var t=h(e,"binary"),n=w(t,0,t.byteLength);return{type:e.type,data:n}}A.push(e);var r={type:e.type,data:{start:T,end:T+e.size}};return T+=e.size,r},finalize:function(e,t){e.data=w(t,0,t.byteLength)},revive:function(e){var t=e.type,n=e.data;return new Blob([_(n)],{type:t})}}}]),x.mustFinalize=function(){return A.length>0},x.finalize=function(e){return s(void 0,0,void 0,(function(){var t,n,r,i,o,a,s,l,h,p;return c(this,(function(c){switch(c.label){case 0:return[4,f(new Blob(A),"binary")];case 1:if(t=c.sent(),e)for(n=0,r=e;n<r.length;n++)if((i=r[n]).$types)for(s in o=i.$types,(a=o.$)&&(o=o.$),o)l=o[s],(h=x.types[l])&&h.finalize&&(p=u.getByKeyPath(i,a?"$."+s:s),h.finalize(p,t.slice(p.start,p.end)));return A=[],[2]}}))}))};function j(e,t){return s(this,0,void 0,(function(){function n(){return s(this,0,void 0,(function(){var n,r,s,l,y,v,b,m,g,w;return c(this,(function(_){switch(_.label){case 0:return[4,Promise.all(i.map((function(e){return e.count()})))];case 1:(n=_.sent()).forEach((function(e,t){return a[t].rowCount=e})),d.totalRows=n.reduce((function(e,t){return e+t})),r=JSON.stringify(h,void 0,f?2:void 0),s=r.lastIndexOf("]"),l=r.substring(0,s),o.push(l),y=t.filter,v=t.transform,b=function(n){var r,i,a,s,l,h,b,m,g,w,_;return c(this,(function(O){switch(O.label){case 0:r=e.table(n),i=r.schema.primKey,a=!!i.keyPath,s=t.numRowsPerChunk||2e3,l=a?{tableName:r.name,inbound:!0,rows:[]}:{tableName:r.name,inbound:!1,rows:[]},h=JSON.stringify(l,void 0,f?2:void 0),f&&(h=h.split("\n").join("\n    ")),b=h.lastIndexOf("]"),o.push(h.substring(0,b)),m=null,g=0,w=!0,_=function(){var e,t,l,h,b,_,O,E,k;return c(this,(function(c){switch(c.label){case 0:return p&&u.ignoreTransaction((function(){return p(d)})),[4,(e=null==m?r.limit(s):r.where(":id").above(m).limit(s)).toArray()];case 1:return 0===(t=c.sent()).length?[2,"break"]:(null!=m&&g>0&&(o.push(","),f&&o.push("\n      ")),w=t.length===s,a?(l=y?t.filter((function(e){return y(n,e)})):t,h=v?l.map((function(e){return v(n,e).value})):l,b=h.map((function(e){return x.encapsulate(e)})),x.mustFinalize()?[4,u.waitFor(x.finalize(b))]:[3,3]):[3,4]);case 2:c.sent(),c.label=3;case 3:return k=JSON.stringify(b,void 0,f?2:void 0),f&&(k=k.split("\n").join("\n      ")),o.push(new Blob([k.substring(1,k.length-1)])),g=h.length,m=t.length>0?u.getByKeyPath(t[t.length-1],i.keyPath):null,[3,8];case 4:return[4,e.primaryKeys()];case 5:return _=c.sent(),O=_.map((function(e,n){return[e,t[n]]})),y&&(O=O.filter((function(e){var t=e[0],r=e[1];return y(n,r,t)}))),v&&(O=O.map((function(e){var t=e[0],r=e[1],i=v(n,r,t);return[i.key,i.value]}))),E=O.map((function(e){return x.encapsulate(e)})),x.mustFinalize()?[4,u.waitFor(x.finalize(E))]:[3,7];case 6:c.sent(),c.label=7;case 7:k=JSON.stringify(E,void 0,f?2:void 0),f&&(k=k.split("\n").join("\n      ")),o.push(new Blob([k.substring(1,k.length-1)])),g=O.length,m=_.length>0?_[_.length-1]:null,c.label=8;case 8:return d.completedRows+=t.length,[2]}}))},O.label=1;case 1:return w?[5,_()]:[3,3];case 2:return"break"===O.sent()?[3,3]:[3,1];case 3:return o.push(h.substr(b)),d.completedTables+=1,d.completedTables<d.totalTables&&o.push(","),[2]}}))},m=0,g=a,_.label=2;case 2:return m<g.length?(w=g[m].name,[5,b(w)]):[3,5];case 3:_.sent(),_.label=4;case 4:return m++,[3,2];case 5:return o.push(r.substr(s)),d.done=!0,p&&u.ignoreTransaction((function(){return p(d)})),[2]}}))}))}var r,i,o,a,f,h,p,d;return c(this,(function(u){switch(u.label){case 0:r=(t=t||{}).skipTables?t.skipTables:[],i=e.tables.filter((function(e){return!r.includes(e.name)})),o=[],a=i.map((function(e){return{name:e.name,schema:l(e),rowCount:0}})),f=t.prettyJson,h={formatName:"dexie",formatVersion:1,data:{databaseName:e.name,databaseVersion:e.verno,tables:a,data:[]}},p=t.progressCallback,d={done:!1,completedRows:0,completedTables:0,totalRows:NaN,totalTables:a.length},u.label=1;case 1:return u.trys.push([1,,6,7]),t.noTransaction?[4,n()]:[3,3];case 2:return u.sent(),[3,5];case 3:return[4,e.transaction("r",e.tables,n)];case 4:u.sent(),u.label=5;case 5:return[3,7];case 6:return x.finalize(),[7];case 7:return[2,new Blob(o,{type:"text/json"})]}}))}))}var P=1,N=function(){},I=d((function(e,n){!function(e){var n="object"===("undefined"==typeof process?"undefined":t(process))&&process.env?process.env:self;e.parser=function(e){return new f(e)},e.CParser=f,e.CStream=h,e.createStream=function(e){return new h(e)},e.MAX_BUFFER_LENGTH=10485760,e.DEBUG="debug"===n.CDEBUG,e.INFO="debug"===n.CDEBUG||"info"===n.CDEBUG,e.EVENTS=["value","string","key","openobject","closeobject","openarray","closearray","error","end","ready"];var r,i={textNode:void 0,numberNode:""},o=e.EVENTS.filter((function(e){return"error"!==e&&"end"!==e})),a=0;for(var u in e.STATE={BEGIN:a++,VALUE:a++,OPEN_OBJECT:a++,CLOSE_OBJECT:a++,OPEN_ARRAY:a++,CLOSE_ARRAY:a++,TEXT_ESCAPE:a++,STRING:a++,BACKSLASH:a++,END:a++,OPEN_KEY:a++,CLOSE_KEY:a++,TRUE:a++,TRUE2:a++,TRUE3:a++,FALSE:a++,FALSE2:a++,FALSE3:a++,FALSE4:a++,NULL:a++,NULL2:a++,NULL3:a++,NUMBER_DECIMAL_POINT:a++,NUMBER_DIGIT:a++},e.STATE)e.STATE[e.STATE[u]]=u;a=e.STATE;var s={tab:9,lineFeed:10,carriageReturn:13,space:32,doubleQuote:34,plus:43,comma:44,minus:45,period:46,_0:48,_9:57,colon:58,E:69,openBracket:91,backslash:92,closeBracket:93,a:97,b:98,e:101,f:102,l:108,n:110,r:114,s:115,t:116,u:117,openBrace:123,closeBrace:125};function c(e){for(var t in i)e[t]=i[t]}Object.create||(Object.create=function(e){function t(){this.__proto__=e}return t.prototype=e,new t}),Object.getPrototypeOf||(Object.getPrototypeOf=function(e){return e.__proto__}),Object.keys||(Object.keys=function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t});var l=/[\\"\n]/g;function f(t){if(!(this instanceof f))return new f(t);var n=this;c(n),n.bufferCheckPosition=e.MAX_BUFFER_LENGTH,n.q=n.c=n.p="",n.opt=t||{},n.closed=n.closedRoot=n.sawRoot=!1,n.tag=n.error=null,n.state=a.BEGIN,n.stack=new Array,n.position=n.column=0,n.line=1,n.slashed=!1,n.unicodeI=0,n.unicodeS=null,n.depth=0,p(n,"onready")}f.prototype={end:function(){m(this)},write:function(t){var n=this;if(this.error)throw this.error;if(n.closed)return b(n,"Cannot write after close. Assign an onready handler.");if(null===t)return m(n);var r=0,o=t.charCodeAt(0),u=n.p;e.DEBUG&&console.log("write -> ["+t+"]");for(;o&&(u=o,n.c=o=t.charCodeAt(r++),u!==o?n.p=u:u=n.p,o);)switch(e.DEBUG&&console.log(r,o,e.STATE[n.state]),n.position++,o===s.lineFeed?(n.line++,n.column=0):n.column++,n.state){case a.BEGIN:o===s.openBrace?n.state=a.OPEN_OBJECT:o===s.openBracket?n.state=a.OPEN_ARRAY:g(o)||b(n,"Non-whitespace before {[.");continue;case a.OPEN_KEY:case a.OPEN_OBJECT:if(g(o))continue;if(n.state===a.OPEN_KEY)n.stack.push(a.CLOSE_KEY);else{if(o===s.closeBrace){p(n,"onopenobject"),this.depth++,p(n,"oncloseobject"),this.depth--,n.state=n.stack.pop()||a.VALUE;continue}n.stack.push(a.CLOSE_OBJECT)}o===s.doubleQuote?n.state=a.STRING:b(n,'Malformed object key should start with "');continue;case a.CLOSE_KEY:case a.CLOSE_OBJECT:if(g(o))continue;n.state,a.CLOSE_KEY,o===s.colon?(n.state===a.CLOSE_OBJECT?(n.stack.push(a.CLOSE_OBJECT),y(n,"onopenobject"),this.depth++):y(n,"onkey"),n.state=a.VALUE):o===s.closeBrace?(d(n,"oncloseobject"),this.depth--,n.state=n.stack.pop()||a.VALUE):o===s.comma?(n.state===a.CLOSE_OBJECT&&n.stack.push(a.CLOSE_OBJECT),y(n),n.state=a.OPEN_KEY):b(n,"Bad object");continue;case a.OPEN_ARRAY:case a.VALUE:if(g(o))continue;if(n.state===a.OPEN_ARRAY){if(p(n,"onopenarray"),this.depth++,n.state=a.VALUE,o===s.closeBracket){p(n,"onclosearray"),this.depth--,n.state=n.stack.pop()||a.VALUE;continue}n.stack.push(a.CLOSE_ARRAY)}o===s.doubleQuote?n.state=a.STRING:o===s.openBrace?n.state=a.OPEN_OBJECT:o===s.openBracket?n.state=a.OPEN_ARRAY:o===s.t?n.state=a.TRUE:o===s.f?n.state=a.FALSE:o===s.n?n.state=a.NULL:o===s.minus?n.numberNode+="-":s._0<=o&&o<=s._9?(n.numberNode+=String.fromCharCode(o),n.state=a.NUMBER_DIGIT):b(n,"Bad value");continue;case a.CLOSE_ARRAY:if(o===s.comma)n.stack.push(a.CLOSE_ARRAY),y(n,"onvalue"),n.state=a.VALUE;else if(o===s.closeBracket)d(n,"onclosearray"),this.depth--,n.state=n.stack.pop()||a.VALUE;else{if(g(o))continue;b(n,"Bad array")}continue;case a.STRING:void 0===n.textNode&&(n.textNode="");var c=r-1,f=n.slashed,h=n.unicodeI;e:for(;;){for(e.DEBUG&&console.log(r,o,e.STATE[n.state],f);h>0;)if(n.unicodeS+=String.fromCharCode(o),o=t.charCodeAt(r++),n.position++,4===h?(n.textNode+=String.fromCharCode(parseInt(n.unicodeS,16)),h=0,c=r-1):h++,!o)break e;if(o===s.doubleQuote&&!f){n.state=n.stack.pop()||a.VALUE,n.textNode+=t.substring(c,r-1),n.position+=r-1-c;break}if(o===s.backslash&&!f&&(f=!0,n.textNode+=t.substring(c,r-1),n.position+=r-1-c,o=t.charCodeAt(r++),n.position++,!o))break;if(f){if(f=!1,o===s.n?n.textNode+="\n":o===s.r?n.textNode+="\r":o===s.t?n.textNode+="\t":o===s.f?n.textNode+="\f":o===s.b?n.textNode+="\b":o===s.u?(h=1,n.unicodeS=""):n.textNode+=String.fromCharCode(o),o=t.charCodeAt(r++),n.position++,c=r-1,o)continue;break}l.lastIndex=r;var w=l.exec(t);if(null===w){r=t.length+1,n.textNode+=t.substring(c,r-1),n.position+=r-1-c;break}if(r=w.index+1,!(o=t.charCodeAt(w.index))){n.textNode+=t.substring(c,r-1),n.position+=r-1-c;break}}n.slashed=f,n.unicodeI=h;continue;case a.TRUE:o===s.r?n.state=a.TRUE2:b(n,"Invalid true started with t"+o);continue;case a.TRUE2:o===s.u?n.state=a.TRUE3:b(n,"Invalid true started with tr"+o);continue;case a.TRUE3:o===s.e?(p(n,"onvalue",!0),n.state=n.stack.pop()||a.VALUE):b(n,"Invalid true started with tru"+o);continue;case a.FALSE:o===s.a?n.state=a.FALSE2:b(n,"Invalid false started with f"+o);continue;case a.FALSE2:o===s.l?n.state=a.FALSE3:b(n,"Invalid false started with fa"+o);continue;case a.FALSE3:o===s.s?n.state=a.FALSE4:b(n,"Invalid false started with fal"+o);continue;case a.FALSE4:o===s.e?(p(n,"onvalue",!1),n.state=n.stack.pop()||a.VALUE):b(n,"Invalid false started with fals"+o);continue;case a.NULL:o===s.u?n.state=a.NULL2:b(n,"Invalid null started with n"+o);continue;case a.NULL2:o===s.l?n.state=a.NULL3:b(n,"Invalid null started with nu"+o);continue;case a.NULL3:o===s.l?(p(n,"onvalue",null),n.state=n.stack.pop()||a.VALUE):b(n,"Invalid null started with nul"+o);continue;case a.NUMBER_DECIMAL_POINT:o===s.period?(n.numberNode+=".",n.state=a.NUMBER_DIGIT):b(n,"Leading zero not followed by .");continue;case a.NUMBER_DIGIT:s._0<=o&&o<=s._9?n.numberNode+=String.fromCharCode(o):o===s.period?(-1!==n.numberNode.indexOf(".")&&b(n,"Invalid number has two dots"),n.numberNode+="."):o===s.e||o===s.E?(-1===n.numberNode.indexOf("e")&&-1===n.numberNode.indexOf("E")||b(n,"Invalid number has two exponential"),n.numberNode+="e"):o===s.plus||o===s.minus?(u!==s.e&&u!==s.E&&b(n,"Invalid symbol in number"),n.numberNode+=String.fromCharCode(o)):(v(n),r--,n.state=n.stack.pop()||a.VALUE);continue;default:b(n,"Unknown state: "+n.state)}n.position>=n.bufferCheckPosition&&function(t){var n=Math.max(e.MAX_BUFFER_LENGTH,10),r=0;for(var o in i){var a=void 0===t[o]?0:t[o].length;a>n&&("text"===o?closeText(t):b(t,"Max buffer length exceeded: "+o)),r=Math.max(r,a)}t.bufferCheckPosition=e.MAX_BUFFER_LENGTH-r+t.position}(n);return n},resume:function(){return this.error=null,this},close:function(){return this.write(null)}};try{r=N}catch(e){r=function(){}}function h(e){if(!(this instanceof h))return new h(e);this._parser=new f(e),this.writable=!0,this.readable=!0,this.bytes_remaining=0,this.bytes_in_sequence=0,this.temp_buffs={2:new Buffer(2),3:new Buffer(3),4:new Buffer(4)},this.string="";var t=this;r.apply(t),this._parser.onend=function(){t.emit("end")},this._parser.onerror=function(e){t.emit("error",e),t._parser.error=null},o.forEach((function(e){Object.defineProperty(t,"on"+e,{get:function(){return t._parser["on"+e]},set:function(n){if(!n)return t.removeAllListeners(e),t._parser["on"+e]=n,n;t.on(e,n)},enumerable:!0,configurable:!1})}))}function p(t,n,r){e.INFO&&console.log("-- emit",n,r),t[n]&&t[n](r)}function d(e,t,n){y(e),p(e,t,n)}function y(e,t){e.textNode=function(e,t){if(void 0===t)return t;e.trim&&(t=t.trim());e.normalize&&(t=t.replace(/\s+/g," "));return t}(e.opt,e.textNode),void 0!==e.textNode&&p(e,t||"onvalue",e.textNode),e.textNode=void 0}function v(e){e.numberNode&&p(e,"onvalue",parseFloat(e.numberNode)),e.numberNode=""}function b(e,t){return y(e),t+="\nLine: "+e.line+"\nColumn: "+e.column+"\nChar: "+e.c,t=new Error(t),e.error=t,p(e,"onerror",t),e}function m(e){return e.state===a.VALUE&&0===e.depth||b(e,"Unexpected end"),y(e),e.c="",e.closed=!0,p(e,"onend"),f.call(e,e.opt),e}function g(e){return e===s.carriageReturn||e===s.lineFeed||e===s.space||e===s.tab}h.prototype=Object.create(r.prototype,{constructor:{value:h}}),h.prototype.write=function(e){e=new Buffer(e);for(var t=0;t<e.length;t++){var n=e[t];if(this.bytes_remaining>0){for(var r=0;r<this.bytes_remaining;r++)this.temp_buffs[this.bytes_in_sequence][this.bytes_in_sequence-this.bytes_remaining+r]=e[r];this.string=this.temp_buffs[this.bytes_in_sequence].toString(),this.bytes_in_sequence=this.bytes_remaining=0,t=t+r-1,this._parser.write(this.string),this.emit("data",this.string)}else if(0===this.bytes_remaining&&n>=128){if(n>=194&&n<=223&&(this.bytes_in_sequence=2),n>=224&&n<=239&&(this.bytes_in_sequence=3),n>=240&&n<=244&&(this.bytes_in_sequence=4),this.bytes_in_sequence+t>e.length){for(var i=0;i<=e.length-1-t;i++)this.temp_buffs[this.bytes_in_sequence][i]=e[t+i];return this.bytes_remaining=t+this.bytes_in_sequence-e.length,!0}this.string=e.slice(t,t+this.bytes_in_sequence).toString(),t=t+this.bytes_in_sequence-1,this._parser.write(this.string),this.emit("data",this.string)}else{for(var o=t;o<e.length&&!(e[o]>=128);o++);this.string=e.slice(t,o).toString(),this._parser.write(this.string),this.emit("data",this.string),t=o-1}}},h.prototype.end=function(e){return e&&e.length&&this._parser.write(e.toString()),this._parser.end(),!0},h.prototype.on=function(e,t){var n=this;return n._parser["on"+e]||-1===o.indexOf(e)||(n._parser["on"+e]=function(){var t=1===arguments.length?[arguments[0]]:Array.apply(null,arguments);t.splice(0,0,e),n.emit.apply(n,t)}),r.prototype.on.call(n,e,t)},h.prototype.destroy=function(){c(this._parser),this.emit("close")}}(n)}));function C(e){var t=0,n=function(){var e,t,n,r=I.parser(),i=0,o=[],a=!1,u=!1;return r.onopenobject=function(r){var a={incomplete:!0};e||(e=a),t&&(o.push([n,t,u]),u?t.push(a):t[n]=a),t=a,n=r,u=!1,++i},r.onkey=function(e){return n=e},r.onvalue=function(e){return u?t.push(e):t[n]=e},r.oncloseobject=function(){var e;delete t.incomplete,n=null,0==--i?a=!0:(e=o.pop(),n=e[0],t=e[1],u=e[2])},r.onopenarray=function(){var r=[];r.incomplete=!0,e||(e=r),t&&(o.push([n,t,u]),u?t.push(r):t[n]=r),t=r,u=!0,n=null,++i},r.onclosearray=function(){var e;delete t.incomplete,n=null,0==--i?a=!0:(e=o.pop(),n=e[0],t=e[1],u=e[2])},{write:function(t){return r.write(t),e},done:function(){return a}}}(),r={pullAsync:function(i){return s(this,0,void 0,(function(){var o,a,u;return c(this,(function(s){switch(s.label){case 0:return o=e.slice(t,t+i),t+=i,[4,f(o,"text")];case 1:return a=s.sent(),u=n.write(a),r.result=u||{},[2,u]}}))}))},pullSync:function(i){var o=e.slice(t,t+i);t+=i;var a=h(o,"text"),u=n.write(a);return r.result=u||{},u},done:function(){return n.done()},eof:function(){return t>=e.size},result:{}};return r}var B=1024;function K(e,t){return s(this,0,void 0,(function(){var n,r,i,o;return c(this,(function(a){switch(a.label){case 0:return n=(t=t||{}).chunkSizeBytes||1024*B,[4,D(e,n)];case 1:return r=a.sent(),i=r.result.data,(o=new u(i.databaseName)).version(i.databaseVersion).stores(function(e){for(var t={},n=0,r=e.tables;n<r.length;n++){var i=r[n];t[i.name]=i.schema}return t}(i)),[4,R(o,r,t)];case 2:return a.sent(),[2,o]}}))}))}function R(e,t,n){return s(this,0,void 0,(function(){function r(){return s(this,0,void 0,(function(){var t,r,a,s;return c(this,(function(y){switch(y.label){case 0:t=function(t){var r,i,o,a,s,l,y,v,b,m,g,w,_;return c(this,(function(c){switch(c.label){case 0:if(h.includes(t.tableName))return[2,"continue"];if(!t.rows)return[2,"break"];if(!t.rows.incomplete&&0===t.rows.length)return[2,"continue"];if(p&&u.ignoreTransaction((function(){return p(d)})),r=t.tableName,i=e.table(r),o=f.tables.filter((function(e){return e.name===r}))[0].schema,!i){if(n.acceptMissingTables)return[2,"continue"];throw new Error("Exported table ".concat(t.tableName," is missing in installed database"))}if(!n.acceptChangedPrimaryKey&&o.split(",")[0]!=i.schema.primKey.src)throw new Error("Primary key differs for table ".concat(t.tableName,". "));for(a=t.rows,s=[],l=0;l<a.length&&!(y=a[l]).incomplete;l++)s.push(x.revive(y));return v=n.filter,b=n.transform,m=v?t.inbound?s.filter((function(e){return v(r,e)})):s.filter((function(e){var t=e[0],n=e[1];return v(r,n,t)})):s,b&&(m=m.map(t.inbound?function(e){return b(r,e).value}:function(e){var t=e[0],n=e[1],i=b(r,n,t);return[i.key,i.value]})),g=t.inbound?[void 0,m]:[m.map((function(e){return e[0]})),s.map((function(e){return e[1]}))],w=g[0],_=g[1],n.overwriteValues?[4,i.bulkPut(_,w)]:[3,2];case 1:return c.sent(),[3,4];case 2:return[4,i.bulkAdd(_,w)];case 3:c.sent(),c.label=4;case 4:return d.completedRows+=s.length,s.incomplete||(d.completedTables+=1),a.splice(0,s.length),[2]}}))},r=0,a=f.data,y.label=1;case 1:return r<a.length?(s=a[r],[5,t(s)]):[3,4];case 2:if("break"===y.sent())return[3,4];y.label=3;case 3:return r++,[3,1];case 4:for(;f.data.length>0&&f.data[0].rows&&!f.data[0].rows.incomplete;)f.data.splice(0,1);return o.done()||o.eof()?[3,8]:l?(o.pullSync(i),[3,7]):[3,5];case 5:return[4,u.waitFor(o.pullAsync(i))];case 6:y.sent(),y.label=7;case 7:return[3,9];case 8:return[3,10];case 9:return[3,0];case 10:return[2]}}))}))}var i,o,a,l,f,h,p,d,y,v,b;return c(this,(function(s){switch(s.label){case 0:return i=(n=n||{}).chunkSizeBytes||1024*B,[4,D(t,i)];case 1:if(o=s.sent(),a=o.result,l="FileReaderSync"in self,f=a.data,h=n.skipTables?n.skipTables:[],!n.acceptNameDiff&&e.name!==f.databaseName)throw new Error("Name differs. Current database name is ".concat(e.name," but export is ").concat(f.databaseName));if(!n.acceptVersionDiff&&e.verno!==f.databaseVersion)throw new Error("Database version differs. Current database is in version ".concat(e.verno," but export is ").concat(f.databaseVersion));if(p=n.progressCallback,d={done:!1,completedRows:0,completedTables:0,totalRows:f.tables.reduce((function(e,t){return e+t.rowCount}),0),totalTables:f.tables.length},p&&u.ignoreTransaction((function(){return p(d)})),!n.clearTablesBeforeImport)return[3,5];y=0,v=e.tables,s.label=2;case 2:return y<v.length?(b=v[y],h.includes(b.name)?[3,4]:[4,b.clear()]):[3,5];case 3:s.sent(),s.label=4;case 4:return y++,[3,2];case 5:return n.noTransaction?[4,r()]:[3,7];case 6:return s.sent(),[3,9];case 7:return[4,e.transaction("rw",e.tables,r)];case 8:s.sent(),s.label=9;case 9:return d.done=!0,p&&u.ignoreTransaction((function(){return p(d)})),[2]}}))}))}function D(e,t){return s(this,0,void 0,(function(){var n,r;return c(this,(function(i){switch(i.label){case 0:n="slice"in e?C(e):e,i.label=1;case 1:return n.eof()?[3,3]:[4,n.pullAsync(t)];case 2:return i.sent(),n.result.data&&n.result.data.data?[3,3]:[3,1];case 3:if(!(r=n.result)||"dexie"!=r.formatName)throw new Error("Given file is not a dexie export");if(r.formatVersion>P)throw new Error("Format version ".concat(r.formatVersion," not supported"));if(!r.data)throw new Error("No data in export file");if(!r.data.databaseName)throw new Error("Missing databaseName in export file");if(!r.data.databaseVersion)throw new Error("Missing databaseVersion in export file");if(!r.data.tables)throw new Error("Missing tables in export file");return[2,n]}}))}))}u.prototype.export=function(e){return j(this,e)},u.prototype.import=function(e,t){return R(this,e,t)},u.import=function(e,t){return K(e,t)},window.dexieIO={Dexie:u,importDB:K,exportDB:j,importInto:R,peakImportFile:function(e){return s(this,0,void 0,(function(){var t;return c(this,(function(n){switch(n.label){case 0:t=C(e),n.label=1;case 1:return t.eof()?[3,3]:[4,t.pullAsync(5120)];case 2:return n.sent(),t.result.data&&t.result.data.data?(delete t.result.data.data,[3,3]):[3,1];case 3:return[2,t.result]}}))}))}};
