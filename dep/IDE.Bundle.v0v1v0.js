/*! For license information please see IDE.Bundle.v0v1v0.js.LICENSE.txt */
(()=>{var e={616:e=>{var t;self,t=()=>(()=>{"use strict";var e,t={};return e=t,Object.defineProperty(e,"__esModule",{value:!0}),e.FitAddon=void 0,e.FitAddon=class{activate(e){this._terminal=e}dispose(){}fit(){const e=this.proposeDimensions();if(!e||!this._terminal||isNaN(e.cols)||isNaN(e.rows))return;const t=this._terminal._core;this._terminal.rows===e.rows&&this._terminal.cols===e.cols||(t._renderService.clear(),this._terminal.resize(e.cols,e.rows))}proposeDimensions(){if(!this._terminal)return;if(!this._terminal.element||!this._terminal.element.parentElement)return;const e=this._terminal._core,t=e._renderService.dimensions;if(0===t.css.cell.width||0===t.css.cell.height)return;const i=0===this._terminal.options.scrollback?0:e.viewport.scrollBarWidth,s=window.getComputedStyle(this._terminal.element.parentElement),n=parseInt(s.getPropertyValue("height")),r=Math.max(0,parseInt(s.getPropertyValue("width"))),o=window.getComputedStyle(this._terminal.element),a=n-(parseInt(o.getPropertyValue("padding-top"))+parseInt(o.getPropertyValue("padding-bottom"))),l=r-(parseInt(o.getPropertyValue("padding-right"))+parseInt(o.getPropertyValue("padding-left")))-i;return{cols:Math.max(2,Math.floor(l/t.css.cell.width)),rows:Math.max(1,Math.floor(a/t.css.cell.height))}}},t})(),e.exports=t()},856:e=>{var t;globalThis,t=()=>(()=>{"use strict";var e={4567:function(e,t,i){var s=this&&this.__decorate||function(e,t,i,s){var n,r=arguments.length,o=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,s);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(r<3?n(o):r>3?n(t,i,o):n(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},n=this&&this.__param||function(e,t){return function(i,s){t(i,s,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.AccessibilityManager=void 0;const r=i(9042),o=i(9924),a=i(844),l=i(4725),h=i(2585),c=i(3656);let d=t.AccessibilityManager=class extends a.Disposable{constructor(e,t,i,s){super(),this._terminal=e,this._coreBrowserService=i,this._renderService=s,this._rowColumns=new WeakMap,this._liveRegionLineCount=0,this._charsToConsume=[],this._charsToAnnounce="",this._accessibilityContainer=this._coreBrowserService.mainDocument.createElement("div"),this._accessibilityContainer.classList.add("xterm-accessibility"),this._rowContainer=this._coreBrowserService.mainDocument.createElement("div"),this._rowContainer.setAttribute("role","list"),this._rowContainer.classList.add("xterm-accessibility-tree"),this._rowElements=[];for(let e=0;e<this._terminal.rows;e++)this._rowElements[e]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[e]);if(this._topBoundaryFocusListener=e=>this._handleBoundaryFocus(e,0),this._bottomBoundaryFocusListener=e=>this._handleBoundaryFocus(e,1),this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions(),this._accessibilityContainer.appendChild(this._rowContainer),this._liveRegion=this._coreBrowserService.mainDocument.createElement("div"),this._liveRegion.classList.add("live-region"),this._liveRegion.setAttribute("aria-live","assertive"),this._accessibilityContainer.appendChild(this._liveRegion),this._liveRegionDebouncer=this.register(new o.TimeBasedDebouncer(this._renderRows.bind(this))),!this._terminal.element)throw new Error("Cannot enable accessibility before Terminal.open");this._terminal.element.insertAdjacentElement("afterbegin",this._accessibilityContainer),this.register(this._terminal.onResize((e=>this._handleResize(e.rows)))),this.register(this._terminal.onRender((e=>this._refreshRows(e.start,e.end)))),this.register(this._terminal.onScroll((()=>this._refreshRows()))),this.register(this._terminal.onA11yChar((e=>this._handleChar(e)))),this.register(this._terminal.onLineFeed((()=>this._handleChar("\n")))),this.register(this._terminal.onA11yTab((e=>this._handleTab(e)))),this.register(this._terminal.onKey((e=>this._handleKey(e.key)))),this.register(this._terminal.onBlur((()=>this._clearLiveRegion()))),this.register(this._renderService.onDimensionsChange((()=>this._refreshRowsDimensions()))),this.register((0,c.addDisposableDomListener)(document,"selectionchange",(()=>this._handleSelectionChange()))),this.register(this._coreBrowserService.onDprChange((()=>this._refreshRowsDimensions()))),this._refreshRows(),this.register((0,a.toDisposable)((()=>{this._accessibilityContainer.remove(),this._rowElements.length=0})))}_handleTab(e){for(let t=0;t<e;t++)this._handleChar(" ")}_handleChar(e){this._liveRegionLineCount<21&&(this._charsToConsume.length>0?this._charsToConsume.shift()!==e&&(this._charsToAnnounce+=e):this._charsToAnnounce+=e,"\n"===e&&(this._liveRegionLineCount++,21===this._liveRegionLineCount&&(this._liveRegion.textContent+=r.tooMuchOutput)))}_clearLiveRegion(){this._liveRegion.textContent="",this._liveRegionLineCount=0}_handleKey(e){this._clearLiveRegion(),/\p{Control}/u.test(e)||this._charsToConsume.push(e)}_refreshRows(e,t){this._liveRegionDebouncer.refresh(e,t,this._terminal.rows)}_renderRows(e,t){const i=this._terminal.buffer,s=i.lines.length.toString();for(let n=e;n<=t;n++){const e=i.lines.get(i.ydisp+n),t=[],r=e?.translateToString(!0,void 0,void 0,t)||"",o=(i.ydisp+n+1).toString(),a=this._rowElements[n];a&&(0===r.length?(a.innerText="Â ",this._rowColumns.set(a,[0,1])):(a.textContent=r,this._rowColumns.set(a,t)),a.setAttribute("aria-posinset",o),a.setAttribute("aria-setsize",s))}this._announceCharacters()}_announceCharacters(){0!==this._charsToAnnounce.length&&(this._liveRegion.textContent+=this._charsToAnnounce,this._charsToAnnounce="")}_handleBoundaryFocus(e,t){const i=e.target,s=this._rowElements[0===t?1:this._rowElements.length-2];if(i.getAttribute("aria-posinset")===(0===t?"1":`${this._terminal.buffer.lines.length}`))return;if(e.relatedTarget!==s)return;let n,r;if(0===t?(n=i,r=this._rowElements.pop(),this._rowContainer.removeChild(r)):(n=this._rowElements.shift(),r=i,this._rowContainer.removeChild(n)),n.removeEventListener("focus",this._topBoundaryFocusListener),r.removeEventListener("focus",this._bottomBoundaryFocusListener),0===t){const e=this._createAccessibilityTreeNode();this._rowElements.unshift(e),this._rowContainer.insertAdjacentElement("afterbegin",e)}else{const e=this._createAccessibilityTreeNode();this._rowElements.push(e),this._rowContainer.appendChild(e)}this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._terminal.scrollLines(0===t?-1:1),this._rowElements[0===t?1:this._rowElements.length-2].focus(),e.preventDefault(),e.stopImmediatePropagation()}_handleSelectionChange(){if(0===this._rowElements.length)return;const e=document.getSelection();if(!e)return;if(e.isCollapsed)return void(this._rowContainer.contains(e.anchorNode)&&this._terminal.clearSelection());if(!e.anchorNode||!e.focusNode)return void console.error("anchorNode and/or focusNode are null");let t={node:e.anchorNode,offset:e.anchorOffset},i={node:e.focusNode,offset:e.focusOffset};if((t.node.compareDocumentPosition(i.node)&Node.DOCUMENT_POSITION_PRECEDING||t.node===i.node&&t.offset>i.offset)&&([t,i]=[i,t]),t.node.compareDocumentPosition(this._rowElements[0])&(Node.DOCUMENT_POSITION_CONTAINED_BY|Node.DOCUMENT_POSITION_FOLLOWING)&&(t={node:this._rowElements[0].childNodes[0],offset:0}),!this._rowContainer.contains(t.node))return;const s=this._rowElements.slice(-1)[0];if(i.node.compareDocumentPosition(s)&(Node.DOCUMENT_POSITION_CONTAINED_BY|Node.DOCUMENT_POSITION_PRECEDING)&&(i={node:s,offset:s.textContent?.length??0}),!this._rowContainer.contains(i.node))return;const n=({node:e,offset:t})=>{const i=e instanceof Text?e.parentNode:e;let s=parseInt(i?.getAttribute("aria-posinset"),10)-1;if(isNaN(s))return console.warn("row is invalid. Race condition?"),null;const n=this._rowColumns.get(i);if(!n)return console.warn("columns is null. Race condition?"),null;let r=t<n.length?n[t]:n.slice(-1)[0]+1;return r>=this._terminal.cols&&(++s,r=0),{row:s,column:r}},r=n(t),o=n(i);if(r&&o){if(r.row>o.row||r.row===o.row&&r.column>=o.column)throw new Error("invalid range");this._terminal.select(r.column,r.row,(o.row-r.row)*this._terminal.cols-r.column+o.column)}}_handleResize(e){this._rowElements[this._rowElements.length-1].removeEventListener("focus",this._bottomBoundaryFocusListener);for(let e=this._rowContainer.children.length;e<this._terminal.rows;e++)this._rowElements[e]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[e]);for(;this._rowElements.length>e;)this._rowContainer.removeChild(this._rowElements.pop());this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions()}_createAccessibilityTreeNode(){const e=this._coreBrowserService.mainDocument.createElement("div");return e.setAttribute("role","listitem"),e.tabIndex=-1,this._refreshRowDimensions(e),e}_refreshRowsDimensions(){if(this._renderService.dimensions.css.cell.height){this._accessibilityContainer.style.width=`${this._renderService.dimensions.css.canvas.width}px`,this._rowElements.length!==this._terminal.rows&&this._handleResize(this._terminal.rows);for(let e=0;e<this._terminal.rows;e++)this._refreshRowDimensions(this._rowElements[e])}}_refreshRowDimensions(e){e.style.height=`${this._renderService.dimensions.css.cell.height}px`}};t.AccessibilityManager=d=s([n(1,h.IInstantiationService),n(2,l.ICoreBrowserService),n(3,l.IRenderService)],d)},3614:(e,t)=>{function i(e){return e.replace(/\r?\n/g,"\r")}function s(e,t){return t?"[200~"+e+"[201~":e}function n(e,t,n,r){e=s(e=i(e),n.decPrivateModes.bracketedPasteMode&&!0!==r.rawOptions.ignoreBracketedPasteMode),n.triggerDataEvent(e,!0),t.value=""}function r(e,t,i){const s=i.getBoundingClientRect(),n=e.clientX-s.left-10,r=e.clientY-s.top-10;t.style.width="20px",t.style.height="20px",t.style.left=`${n}px`,t.style.top=`${r}px`,t.style.zIndex="1000",t.focus()}Object.defineProperty(t,"__esModule",{value:!0}),t.rightClickHandler=t.moveTextAreaUnderMouseCursor=t.paste=t.handlePasteEvent=t.copyHandler=t.bracketTextForPaste=t.prepareTextForTerminal=void 0,t.prepareTextForTerminal=i,t.bracketTextForPaste=s,t.copyHandler=function(e,t){e.clipboardData&&e.clipboardData.setData("text/plain",t.selectionText),e.preventDefault()},t.handlePasteEvent=function(e,t,i,s){e.stopPropagation(),e.clipboardData&&n(e.clipboardData.getData("text/plain"),t,i,s)},t.paste=n,t.moveTextAreaUnderMouseCursor=r,t.rightClickHandler=function(e,t,i,s,n){r(e,t,i),n&&s.rightClickSelect(e),t.value=s.selectionText,t.select()}},7239:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ColorContrastCache=void 0;const s=i(1505);t.ColorContrastCache=class{constructor(){this._color=new s.TwoKeyMap,this._css=new s.TwoKeyMap}setCss(e,t,i){this._css.set(e,t,i)}getCss(e,t){return this._css.get(e,t)}setColor(e,t,i){this._color.set(e,t,i)}getColor(e,t){return this._color.get(e,t)}clear(){this._color.clear(),this._css.clear()}}},3656:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addDisposableDomListener=void 0,t.addDisposableDomListener=function(e,t,i,s){e.addEventListener(t,i,s);let n=!1;return{dispose:()=>{n||(n=!0,e.removeEventListener(t,i,s))}}}},3551:function(e,t,i){var s=this&&this.__decorate||function(e,t,i,s){var n,r=arguments.length,o=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,s);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(r<3?n(o):r>3?n(t,i,o):n(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},n=this&&this.__param||function(e,t){return function(i,s){t(i,s,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.Linkifier=void 0;const r=i(3656),o=i(8460),a=i(844),l=i(2585),h=i(4725);let c=t.Linkifier=class extends a.Disposable{get currentLink(){return this._currentLink}constructor(e,t,i,s,n){super(),this._element=e,this._mouseService=t,this._renderService=i,this._bufferService=s,this._linkProviderService=n,this._linkCacheDisposables=[],this._isMouseOut=!0,this._wasResized=!1,this._activeLine=-1,this._onShowLinkUnderline=this.register(new o.EventEmitter),this.onShowLinkUnderline=this._onShowLinkUnderline.event,this._onHideLinkUnderline=this.register(new o.EventEmitter),this.onHideLinkUnderline=this._onHideLinkUnderline.event,this.register((0,a.getDisposeArrayDisposable)(this._linkCacheDisposables)),this.register((0,a.toDisposable)((()=>{this._lastMouseEvent=void 0,this._activeProviderReplies?.clear()}))),this.register(this._bufferService.onResize((()=>{this._clearCurrentLink(),this._wasResized=!0}))),this.register((0,r.addDisposableDomListener)(this._element,"mouseleave",(()=>{this._isMouseOut=!0,this._clearCurrentLink()}))),this.register((0,r.addDisposableDomListener)(this._element,"mousemove",this._handleMouseMove.bind(this))),this.register((0,r.addDisposableDomListener)(this._element,"mousedown",this._handleMouseDown.bind(this))),this.register((0,r.addDisposableDomListener)(this._element,"mouseup",this._handleMouseUp.bind(this)))}_handleMouseMove(e){this._lastMouseEvent=e;const t=this._positionFromMouseEvent(e,this._element,this._mouseService);if(!t)return;this._isMouseOut=!1;const i=e.composedPath();for(let e=0;e<i.length;e++){const t=i[e];if(t.classList.contains("xterm"))break;if(t.classList.contains("xterm-hover"))return}this._lastBufferCell&&t.x===this._lastBufferCell.x&&t.y===this._lastBufferCell.y||(this._handleHover(t),this._lastBufferCell=t)}_handleHover(e){if(this._activeLine!==e.y||this._wasResized)return this._clearCurrentLink(),this._askForLink(e,!1),void(this._wasResized=!1);this._currentLink&&this._linkAtPosition(this._currentLink.link,e)||(this._clearCurrentLink(),this._askForLink(e,!0))}_askForLink(e,t){this._activeProviderReplies&&t||(this._activeProviderReplies?.forEach((e=>{e?.forEach((e=>{e.link.dispose&&e.link.dispose()}))})),this._activeProviderReplies=new Map,this._activeLine=e.y);let i=!1;for(const[s,n]of this._linkProviderService.linkProviders.entries())if(t){const t=this._activeProviderReplies?.get(s);t&&(i=this._checkLinkProviderResult(s,e,i))}else n.provideLinks(e.y,(t=>{if(this._isMouseOut)return;const n=t?.map((e=>({link:e})));this._activeProviderReplies?.set(s,n),i=this._checkLinkProviderResult(s,e,i),this._activeProviderReplies?.size===this._linkProviderService.linkProviders.length&&this._removeIntersectingLinks(e.y,this._activeProviderReplies)}))}_removeIntersectingLinks(e,t){const i=new Set;for(let s=0;s<t.size;s++){const n=t.get(s);if(n)for(let t=0;t<n.length;t++){const s=n[t],r=s.link.range.start.y<e?0:s.link.range.start.x,o=s.link.range.end.y>e?this._bufferService.cols:s.link.range.end.x;for(let e=r;e<=o;e++){if(i.has(e)){n.splice(t--,1);break}i.add(e)}}}}_checkLinkProviderResult(e,t,i){if(!this._activeProviderReplies)return i;const s=this._activeProviderReplies.get(e);let n=!1;for(let t=0;t<e;t++)this._activeProviderReplies.has(t)&&!this._activeProviderReplies.get(t)||(n=!0);if(!n&&s){const e=s.find((e=>this._linkAtPosition(e.link,t)));e&&(i=!0,this._handleNewLink(e))}if(this._activeProviderReplies.size===this._linkProviderService.linkProviders.length&&!i)for(let e=0;e<this._activeProviderReplies.size;e++){const s=this._activeProviderReplies.get(e)?.find((e=>this._linkAtPosition(e.link,t)));if(s){i=!0,this._handleNewLink(s);break}}return i}_handleMouseDown(){this._mouseDownLink=this._currentLink}_handleMouseUp(e){if(!this._currentLink)return;const t=this._positionFromMouseEvent(e,this._element,this._mouseService);t&&this._mouseDownLink===this._currentLink&&this._linkAtPosition(this._currentLink.link,t)&&this._currentLink.link.activate(e,this._currentLink.link.text)}_clearCurrentLink(e,t){this._currentLink&&this._lastMouseEvent&&(!e||!t||this._currentLink.link.range.start.y>=e&&this._currentLink.link.range.end.y<=t)&&(this._linkLeave(this._element,this._currentLink.link,this._lastMouseEvent),this._currentLink=void 0,(0,a.disposeArray)(this._linkCacheDisposables))}_handleNewLink(e){if(!this._lastMouseEvent)return;const t=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);t&&this._linkAtPosition(e.link,t)&&(this._currentLink=e,this._currentLink.state={decorations:{underline:void 0===e.link.decorations||e.link.decorations.underline,pointerCursor:void 0===e.link.decorations||e.link.decorations.pointerCursor},isHovered:!0},this._linkHover(this._element,e.link,this._lastMouseEvent),e.link.decorations={},Object.defineProperties(e.link.decorations,{pointerCursor:{get:()=>this._currentLink?.state?.decorations.pointerCursor,set:e=>{this._currentLink?.state&&this._currentLink.state.decorations.pointerCursor!==e&&(this._currentLink.state.decorations.pointerCursor=e,this._currentLink.state.isHovered&&this._element.classList.toggle("xterm-cursor-pointer",e))}},underline:{get:()=>this._currentLink?.state?.decorations.underline,set:t=>{this._currentLink?.state&&this._currentLink?.state?.decorations.underline!==t&&(this._currentLink.state.decorations.underline=t,this._currentLink.state.isHovered&&this._fireUnderlineEvent(e.link,t))}}}),this._linkCacheDisposables.push(this._renderService.onRenderedViewportChange((e=>{if(!this._currentLink)return;const t=0===e.start?0:e.start+1+this._bufferService.buffer.ydisp,i=this._bufferService.buffer.ydisp+1+e.end;if(this._currentLink.link.range.start.y>=t&&this._currentLink.link.range.end.y<=i&&(this._clearCurrentLink(t,i),this._lastMouseEvent)){const e=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);e&&this._askForLink(e,!1)}}))))}_linkHover(e,t,i){this._currentLink?.state&&(this._currentLink.state.isHovered=!0,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(t,!0),this._currentLink.state.decorations.pointerCursor&&e.classList.add("xterm-cursor-pointer")),t.hover&&t.hover(i,t.text)}_fireUnderlineEvent(e,t){const i=e.range,s=this._bufferService.buffer.ydisp,n=this._createLinkUnderlineEvent(i.start.x-1,i.start.y-s-1,i.end.x,i.end.y-s-1,void 0);(t?this._onShowLinkUnderline:this._onHideLinkUnderline).fire(n)}_linkLeave(e,t,i){this._currentLink?.state&&(this._currentLink.state.isHovered=!1,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(t,!1),this._currentLink.state.decorations.pointerCursor&&e.classList.remove("xterm-cursor-pointer")),t.leave&&t.leave(i,t.text)}_linkAtPosition(e,t){const i=e.range.start.y*this._bufferService.cols+e.range.start.x,s=e.range.end.y*this._bufferService.cols+e.range.end.x,n=t.y*this._bufferService.cols+t.x;return i<=n&&n<=s}_positionFromMouseEvent(e,t,i){const s=i.getCoords(e,t,this._bufferService.cols,this._bufferService.rows);if(s)return{x:s[0],y:s[1]+this._bufferService.buffer.ydisp}}_createLinkUnderlineEvent(e,t,i,s,n){return{x1:e,y1:t,x2:i,y2:s,cols:this._bufferService.cols,fg:n}}};t.Linkifier=c=s([n(1,h.IMouseService),n(2,h.IRenderService),n(3,l.IBufferService),n(4,h.ILinkProviderService)],c)},9042:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.tooMuchOutput=t.promptLabel=void 0,t.promptLabel="Terminal input",t.tooMuchOutput="Too much output to announce, navigate to rows manually to read"},3730:function(e,t,i){var s=this&&this.__decorate||function(e,t,i,s){var n,r=arguments.length,o=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,s);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(r<3?n(o):r>3?n(t,i,o):n(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},n=this&&this.__param||function(e,t){return function(i,s){t(i,s,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.OscLinkProvider=void 0;const r=i(511),o=i(2585);let a=t.OscLinkProvider=class{constructor(e,t,i){this._bufferService=e,this._optionsService=t,this._oscLinkService=i}provideLinks(e,t){const i=this._bufferService.buffer.lines.get(e-1);if(!i)return void t(void 0);const s=[],n=this._optionsService.rawOptions.linkHandler,o=new r.CellData,a=i.getTrimmedLength();let h=-1,c=-1,d=!1;for(let t=0;t<a;t++)if(-1!==c||i.hasContent(t)){if(i.loadCell(t,o),o.hasExtendedAttrs()&&o.extended.urlId){if(-1===c){c=t,h=o.extended.urlId;continue}d=o.extended.urlId!==h}else-1!==c&&(d=!0);if(d||-1!==c&&t===a-1){const i=this._oscLinkService.getLinkData(h)?.uri;if(i){const r={start:{x:c+1,y:e},end:{x:t+(d||t!==a-1?0:1),y:e}};let o=!1;if(!n?.allowNonHttpProtocols)try{const e=new URL(i);["http:","https:"].includes(e.protocol)||(o=!0)}catch(e){o=!0}o||s.push({text:i,range:r,activate:(e,t)=>n?n.activate(e,t,r):l(0,t),hover:(e,t)=>n?.hover?.(e,t,r),leave:(e,t)=>n?.leave?.(e,t,r)})}d=!1,o.hasExtendedAttrs()&&o.extended.urlId?(c=t,h=o.extended.urlId):(c=-1,h=-1)}}t(s)}};function l(e,t){if(confirm(`Do you want to navigate to ${t}?\n\nWARNING: This link could potentially be dangerous`)){const e=window.open();if(e){try{e.opener=null}catch{}e.location.href=t}else console.warn("Opening link blocked as opener could not be cleared")}}t.OscLinkProvider=a=s([n(0,o.IBufferService),n(1,o.IOptionsService),n(2,o.IOscLinkService)],a)},6193:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.RenderDebouncer=void 0,t.RenderDebouncer=class{constructor(e,t){this._renderCallback=e,this._coreBrowserService=t,this._refreshCallbacks=[]}dispose(){this._animationFrame&&(this._coreBrowserService.window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}addRefreshCallback(e){return this._refreshCallbacks.push(e),this._animationFrame||(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame((()=>this._innerRefresh()))),this._animationFrame}refresh(e,t,i){this._rowCount=i,e=void 0!==e?e:0,t=void 0!==t?t:this._rowCount-1,this._rowStart=void 0!==this._rowStart?Math.min(this._rowStart,e):e,this._rowEnd=void 0!==this._rowEnd?Math.max(this._rowEnd,t):t,this._animationFrame||(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame((()=>this._innerRefresh())))}_innerRefresh(){if(this._animationFrame=void 0,void 0===this._rowStart||void 0===this._rowEnd||void 0===this._rowCount)return void this._runRefreshCallbacks();const e=Math.max(this._rowStart,0),t=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(e,t),this._runRefreshCallbacks()}_runRefreshCallbacks(){for(const e of this._refreshCallbacks)e(0);this._refreshCallbacks=[]}}},3236:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Terminal=void 0;const s=i(3614),n=i(3656),r=i(3551),o=i(9042),a=i(3730),l=i(1680),h=i(3107),c=i(5744),d=i(2950),u=i(1296),p=i(428),m=i(4269),f=i(5114),g=i(8934),_=i(3230),v=i(9312),b=i(4725),y=i(6731),C=i(8055),w=i(8969),S=i(8460),E=i(844),x=i(6114),T=i(8437),O=i(2584),k=i(7399),I=i(5941),A=i(9074),D=i(2585),R=i(5435),P=i(4567),L=i(779);class M extends w.CoreTerminal{get onFocus(){return this._onFocus.event}get onBlur(){return this._onBlur.event}get onA11yChar(){return this._onA11yCharEmitter.event}get onA11yTab(){return this._onA11yTabEmitter.event}get onWillOpen(){return this._onWillOpen.event}constructor(e={}){super(e),this.browser=x,this._keyDownHandled=!1,this._keyDownSeen=!1,this._keyPressHandled=!1,this._unprocessedDeadKey=!1,this._accessibilityManager=this.register(new E.MutableDisposable),this._onCursorMove=this.register(new S.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onKey=this.register(new S.EventEmitter),this.onKey=this._onKey.event,this._onRender=this.register(new S.EventEmitter),this.onRender=this._onRender.event,this._onSelectionChange=this.register(new S.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onTitleChange=this.register(new S.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onBell=this.register(new S.EventEmitter),this.onBell=this._onBell.event,this._onFocus=this.register(new S.EventEmitter),this._onBlur=this.register(new S.EventEmitter),this._onA11yCharEmitter=this.register(new S.EventEmitter),this._onA11yTabEmitter=this.register(new S.EventEmitter),this._onWillOpen=this.register(new S.EventEmitter),this._setup(),this._decorationService=this._instantiationService.createInstance(A.DecorationService),this._instantiationService.setService(D.IDecorationService,this._decorationService),this._linkProviderService=this._instantiationService.createInstance(L.LinkProviderService),this._instantiationService.setService(b.ILinkProviderService,this._linkProviderService),this._linkProviderService.registerLinkProvider(this._instantiationService.createInstance(a.OscLinkProvider)),this.register(this._inputHandler.onRequestBell((()=>this._onBell.fire()))),this.register(this._inputHandler.onRequestRefreshRows(((e,t)=>this.refresh(e,t)))),this.register(this._inputHandler.onRequestSendFocus((()=>this._reportFocus()))),this.register(this._inputHandler.onRequestReset((()=>this.reset()))),this.register(this._inputHandler.onRequestWindowsOptionsReport((e=>this._reportWindowsOptions(e)))),this.register(this._inputHandler.onColor((e=>this._handleColorEvent(e)))),this.register((0,S.forwardEvent)(this._inputHandler.onCursorMove,this._onCursorMove)),this.register((0,S.forwardEvent)(this._inputHandler.onTitleChange,this._onTitleChange)),this.register((0,S.forwardEvent)(this._inputHandler.onA11yChar,this._onA11yCharEmitter)),this.register((0,S.forwardEvent)(this._inputHandler.onA11yTab,this._onA11yTabEmitter)),this.register(this._bufferService.onResize((e=>this._afterResize(e.cols,e.rows)))),this.register((0,E.toDisposable)((()=>{this._customKeyEventHandler=void 0,this.element?.parentNode?.removeChild(this.element)})))}_handleColorEvent(e){if(this._themeService)for(const t of e){let e,i="";switch(t.index){case 256:e="foreground",i="10";break;case 257:e="background",i="11";break;case 258:e="cursor",i="12";break;default:e="ansi",i="4;"+t.index}switch(t.type){case 0:const s=C.color.toColorRGB("ansi"===e?this._themeService.colors.ansi[t.index]:this._themeService.colors[e]);this.coreService.triggerDataEvent(`${O.C0.ESC}]${i};${(0,I.toRgbString)(s)}${O.C1_ESCAPED.ST}`);break;case 1:if("ansi"===e)this._themeService.modifyColors((e=>e.ansi[t.index]=C.channels.toColor(...t.color)));else{const i=e;this._themeService.modifyColors((e=>e[i]=C.channels.toColor(...t.color)))}break;case 2:this._themeService.restoreColor(t.index)}}}_setup(){super._setup(),this._customKeyEventHandler=void 0}get buffer(){return this.buffers.active}focus(){this.textarea&&this.textarea.focus({preventScroll:!0})}_handleScreenReaderModeOptionChange(e){e?!this._accessibilityManager.value&&this._renderService&&(this._accessibilityManager.value=this._instantiationService.createInstance(P.AccessibilityManager,this)):this._accessibilityManager.clear()}_handleTextAreaFocus(e){this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(O.C0.ESC+"[I"),this.element.classList.add("focus"),this._showCursor(),this._onFocus.fire()}blur(){return this.textarea?.blur()}_handleTextAreaBlur(){this.textarea.value="",this.refresh(this.buffer.y,this.buffer.y),this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(O.C0.ESC+"[O"),this.element.classList.remove("focus"),this._onBlur.fire()}_syncTextArea(){if(!this.textarea||!this.buffer.isCursorInViewport||this._compositionHelper.isComposing||!this._renderService)return;const e=this.buffer.ybase+this.buffer.y,t=this.buffer.lines.get(e);if(!t)return;const i=Math.min(this.buffer.x,this.cols-1),s=this._renderService.dimensions.css.cell.height,n=t.getWidth(i),r=this._renderService.dimensions.css.cell.width*n,o=this.buffer.y*this._renderService.dimensions.css.cell.height,a=i*this._renderService.dimensions.css.cell.width;this.textarea.style.left=a+"px",this.textarea.style.top=o+"px",this.textarea.style.width=r+"px",this.textarea.style.height=s+"px",this.textarea.style.lineHeight=s+"px",this.textarea.style.zIndex="-5"}_initGlobal(){this._bindKeys(),this.register((0,n.addDisposableDomListener)(this.element,"copy",(e=>{this.hasSelection()&&(0,s.copyHandler)(e,this._selectionService)})));const e=e=>(0,s.handlePasteEvent)(e,this.textarea,this.coreService,this.optionsService);this.register((0,n.addDisposableDomListener)(this.textarea,"paste",e)),this.register((0,n.addDisposableDomListener)(this.element,"paste",e)),x.isFirefox?this.register((0,n.addDisposableDomListener)(this.element,"mousedown",(e=>{2===e.button&&(0,s.rightClickHandler)(e,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)}))):this.register((0,n.addDisposableDomListener)(this.element,"contextmenu",(e=>{(0,s.rightClickHandler)(e,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)}))),x.isLinux&&this.register((0,n.addDisposableDomListener)(this.element,"auxclick",(e=>{1===e.button&&(0,s.moveTextAreaUnderMouseCursor)(e,this.textarea,this.screenElement)})))}_bindKeys(){this.register((0,n.addDisposableDomListener)(this.textarea,"keyup",(e=>this._keyUp(e)),!0)),this.register((0,n.addDisposableDomListener)(this.textarea,"keydown",(e=>this._keyDown(e)),!0)),this.register((0,n.addDisposableDomListener)(this.textarea,"keypress",(e=>this._keyPress(e)),!0)),this.register((0,n.addDisposableDomListener)(this.textarea,"compositionstart",(()=>this._compositionHelper.compositionstart()))),this.register((0,n.addDisposableDomListener)(this.textarea,"compositionupdate",(e=>this._compositionHelper.compositionupdate(e)))),this.register((0,n.addDisposableDomListener)(this.textarea,"compositionend",(()=>this._compositionHelper.compositionend()))),this.register((0,n.addDisposableDomListener)(this.textarea,"input",(e=>this._inputEvent(e)),!0)),this.register(this.onRender((()=>this._compositionHelper.updateCompositionElements())))}open(e){if(!e)throw new Error("Terminal requires a parent element.");if(e.isConnected||this._logService.debug("Terminal.open was called on an element that was not attached to the DOM"),this.element?.ownerDocument.defaultView&&this._coreBrowserService)return void(this.element.ownerDocument.defaultView!==this._coreBrowserService.window&&(this._coreBrowserService.window=this.element.ownerDocument.defaultView));this._document=e.ownerDocument,this.options.documentOverride&&this.options.documentOverride instanceof Document&&(this._document=this.optionsService.rawOptions.documentOverride),this.element=this._document.createElement("div"),this.element.dir="ltr",this.element.classList.add("terminal"),this.element.classList.add("xterm"),e.appendChild(this.element);const t=this._document.createDocumentFragment();this._viewportElement=this._document.createElement("div"),this._viewportElement.classList.add("xterm-viewport"),t.appendChild(this._viewportElement),this._viewportScrollArea=this._document.createElement("div"),this._viewportScrollArea.classList.add("xterm-scroll-area"),this._viewportElement.appendChild(this._viewportScrollArea),this.screenElement=this._document.createElement("div"),this.screenElement.classList.add("xterm-screen"),this.register((0,n.addDisposableDomListener)(this.screenElement,"mousemove",(e=>this.updateCursorStyle(e)))),this._helperContainer=this._document.createElement("div"),this._helperContainer.classList.add("xterm-helpers"),this.screenElement.appendChild(this._helperContainer),t.appendChild(this.screenElement),this.textarea=this._document.createElement("textarea"),this.textarea.classList.add("xterm-helper-textarea"),this.textarea.setAttribute("aria-label",o.promptLabel),x.isChromeOS||this.textarea.setAttribute("aria-multiline","false"),this.textarea.setAttribute("autocorrect","off"),this.textarea.setAttribute("autocapitalize","off"),this.textarea.setAttribute("spellcheck","false"),this.textarea.tabIndex=0,this._coreBrowserService=this.register(this._instantiationService.createInstance(f.CoreBrowserService,this.textarea,e.ownerDocument.defaultView??window,this._document??"undefined"!=typeof window?window.document:null)),this._instantiationService.setService(b.ICoreBrowserService,this._coreBrowserService),this.register((0,n.addDisposableDomListener)(this.textarea,"focus",(e=>this._handleTextAreaFocus(e)))),this.register((0,n.addDisposableDomListener)(this.textarea,"blur",(()=>this._handleTextAreaBlur()))),this._helperContainer.appendChild(this.textarea),this._charSizeService=this._instantiationService.createInstance(p.CharSizeService,this._document,this._helperContainer),this._instantiationService.setService(b.ICharSizeService,this._charSizeService),this._themeService=this._instantiationService.createInstance(y.ThemeService),this._instantiationService.setService(b.IThemeService,this._themeService),this._characterJoinerService=this._instantiationService.createInstance(m.CharacterJoinerService),this._instantiationService.setService(b.ICharacterJoinerService,this._characterJoinerService),this._renderService=this.register(this._instantiationService.createInstance(_.RenderService,this.rows,this.screenElement)),this._instantiationService.setService(b.IRenderService,this._renderService),this.register(this._renderService.onRenderedViewportChange((e=>this._onRender.fire(e)))),this.onResize((e=>this._renderService.resize(e.cols,e.rows))),this._compositionView=this._document.createElement("div"),this._compositionView.classList.add("composition-view"),this._compositionHelper=this._instantiationService.createInstance(d.CompositionHelper,this.textarea,this._compositionView),this._helperContainer.appendChild(this._compositionView),this._mouseService=this._instantiationService.createInstance(g.MouseService),this._instantiationService.setService(b.IMouseService,this._mouseService),this.linkifier=this.register(this._instantiationService.createInstance(r.Linkifier,this.screenElement)),this.element.appendChild(t);try{this._onWillOpen.fire(this.element)}catch{}this._renderService.hasRenderer()||this._renderService.setRenderer(this._createRenderer()),this.viewport=this._instantiationService.createInstance(l.Viewport,this._viewportElement,this._viewportScrollArea),this.viewport.onRequestScrollLines((e=>this.scrollLines(e.amount,e.suppressScrollEvent,1))),this.register(this._inputHandler.onRequestSyncScrollBar((()=>this.viewport.syncScrollArea()))),this.register(this.viewport),this.register(this.onCursorMove((()=>{this._renderService.handleCursorMove(),this._syncTextArea()}))),this.register(this.onResize((()=>this._renderService.handleResize(this.cols,this.rows)))),this.register(this.onBlur((()=>this._renderService.handleBlur()))),this.register(this.onFocus((()=>this._renderService.handleFocus()))),this.register(this._renderService.onDimensionsChange((()=>this.viewport.syncScrollArea()))),this._selectionService=this.register(this._instantiationService.createInstance(v.SelectionService,this.element,this.screenElement,this.linkifier)),this._instantiationService.setService(b.ISelectionService,this._selectionService),this.register(this._selectionService.onRequestScrollLines((e=>this.scrollLines(e.amount,e.suppressScrollEvent)))),this.register(this._selectionService.onSelectionChange((()=>this._onSelectionChange.fire()))),this.register(this._selectionService.onRequestRedraw((e=>this._renderService.handleSelectionChanged(e.start,e.end,e.columnSelectMode)))),this.register(this._selectionService.onLinuxMouseSelection((e=>{this.textarea.value=e,this.textarea.focus(),this.textarea.select()}))),this.register(this._onScroll.event((e=>{this.viewport.syncScrollArea(),this._selectionService.refresh()}))),this.register((0,n.addDisposableDomListener)(this._viewportElement,"scroll",(()=>this._selectionService.refresh()))),this.register(this._instantiationService.createInstance(h.BufferDecorationRenderer,this.screenElement)),this.register((0,n.addDisposableDomListener)(this.element,"mousedown",(e=>this._selectionService.handleMouseDown(e)))),this.coreMouseService.areMouseEventsActive?(this._selectionService.disable(),this.element.classList.add("enable-mouse-events")):this._selectionService.enable(),this.options.screenReaderMode&&(this._accessibilityManager.value=this._instantiationService.createInstance(P.AccessibilityManager,this)),this.register(this.optionsService.onSpecificOptionChange("screenReaderMode",(e=>this._handleScreenReaderModeOptionChange(e)))),this.options.overviewRulerWidth&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(c.OverviewRulerRenderer,this._viewportElement,this.screenElement))),this.optionsService.onSpecificOptionChange("overviewRulerWidth",(e=>{!this._overviewRulerRenderer&&e&&this._viewportElement&&this.screenElement&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(c.OverviewRulerRenderer,this._viewportElement,this.screenElement)))})),this._charSizeService.measure(),this.refresh(0,this.rows-1),this._initGlobal(),this.bindMouse()}_createRenderer(){return this._instantiationService.createInstance(u.DomRenderer,this,this._document,this.element,this.screenElement,this._viewportElement,this._helperContainer,this.linkifier)}bindMouse(){const e=this,t=this.element;function i(t){const i=e._mouseService.getMouseReportCoords(t,e.screenElement);if(!i)return!1;let s,n;switch(t.overrideType||t.type){case"mousemove":n=32,void 0===t.buttons?(s=3,void 0!==t.button&&(s=t.button<3?t.button:3)):s=1&t.buttons?0:4&t.buttons?1:2&t.buttons?2:3;break;case"mouseup":n=0,s=t.button<3?t.button:3;break;case"mousedown":n=1,s=t.button<3?t.button:3;break;case"wheel":if(e._customWheelEventHandler&&!1===e._customWheelEventHandler(t))return!1;if(0===e.viewport.getLinesScrolled(t))return!1;n=t.deltaY<0?0:1,s=4;break;default:return!1}return!(void 0===n||void 0===s||s>4)&&e.coreMouseService.triggerMouseEvent({col:i.col,row:i.row,x:i.x,y:i.y,button:s,action:n,ctrl:t.ctrlKey,alt:t.altKey,shift:t.shiftKey})}const s={mouseup:null,wheel:null,mousedrag:null,mousemove:null},r={mouseup:e=>(i(e),e.buttons||(this._document.removeEventListener("mouseup",s.mouseup),s.mousedrag&&this._document.removeEventListener("mousemove",s.mousedrag)),this.cancel(e)),wheel:e=>(i(e),this.cancel(e,!0)),mousedrag:e=>{e.buttons&&i(e)},mousemove:e=>{e.buttons||i(e)}};this.register(this.coreMouseService.onProtocolChange((e=>{e?("debug"===this.optionsService.rawOptions.logLevel&&this._logService.debug("Binding to mouse events:",this.coreMouseService.explainEvents(e)),this.element.classList.add("enable-mouse-events"),this._selectionService.disable()):(this._logService.debug("Unbinding from mouse events."),this.element.classList.remove("enable-mouse-events"),this._selectionService.enable()),8&e?s.mousemove||(t.addEventListener("mousemove",r.mousemove),s.mousemove=r.mousemove):(t.removeEventListener("mousemove",s.mousemove),s.mousemove=null),16&e?s.wheel||(t.addEventListener("wheel",r.wheel,{passive:!1}),s.wheel=r.wheel):(t.removeEventListener("wheel",s.wheel),s.wheel=null),2&e?s.mouseup||(s.mouseup=r.mouseup):(this._document.removeEventListener("mouseup",s.mouseup),s.mouseup=null),4&e?s.mousedrag||(s.mousedrag=r.mousedrag):(this._document.removeEventListener("mousemove",s.mousedrag),s.mousedrag=null)}))),this.coreMouseService.activeProtocol=this.coreMouseService.activeProtocol,this.register((0,n.addDisposableDomListener)(t,"mousedown",(e=>{if(e.preventDefault(),this.focus(),this.coreMouseService.areMouseEventsActive&&!this._selectionService.shouldForceSelection(e))return i(e),s.mouseup&&this._document.addEventListener("mouseup",s.mouseup),s.mousedrag&&this._document.addEventListener("mousemove",s.mousedrag),this.cancel(e)}))),this.register((0,n.addDisposableDomListener)(t,"wheel",(e=>{if(!s.wheel){if(this._customWheelEventHandler&&!1===this._customWheelEventHandler(e))return!1;if(!this.buffer.hasScrollback){const t=this.viewport.getLinesScrolled(e);if(0===t)return;const i=O.C0.ESC+(this.coreService.decPrivateModes.applicationCursorKeys?"O":"[")+(e.deltaY<0?"A":"B");let s="";for(let e=0;e<Math.abs(t);e++)s+=i;return this.coreService.triggerDataEvent(s,!0),this.cancel(e,!0)}return this.viewport.handleWheel(e)?this.cancel(e):void 0}}),{passive:!1})),this.register((0,n.addDisposableDomListener)(t,"touchstart",(e=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchStart(e),this.cancel(e)}),{passive:!0})),this.register((0,n.addDisposableDomListener)(t,"touchmove",(e=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchMove(e)?void 0:this.cancel(e)}),{passive:!1}))}refresh(e,t){this._renderService?.refreshRows(e,t)}updateCursorStyle(e){this._selectionService?.shouldColumnSelect(e)?this.element.classList.add("column-select"):this.element.classList.remove("column-select")}_showCursor(){this.coreService.isCursorInitialized||(this.coreService.isCursorInitialized=!0,this.refresh(this.buffer.y,this.buffer.y))}scrollLines(e,t,i=0){1===i?(super.scrollLines(e,t,i),this.refresh(0,this.rows-1)):this.viewport?.scrollLines(e)}paste(e){(0,s.paste)(e,this.textarea,this.coreService,this.optionsService)}attachCustomKeyEventHandler(e){this._customKeyEventHandler=e}attachCustomWheelEventHandler(e){this._customWheelEventHandler=e}registerLinkProvider(e){return this._linkProviderService.registerLinkProvider(e)}registerCharacterJoiner(e){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");const t=this._characterJoinerService.register(e);return this.refresh(0,this.rows-1),t}deregisterCharacterJoiner(e){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");this._characterJoinerService.deregister(e)&&this.refresh(0,this.rows-1)}get markers(){return this.buffer.markers}registerMarker(e){return this.buffer.addMarker(this.buffer.ybase+this.buffer.y+e)}registerDecoration(e){return this._decorationService.registerDecoration(e)}hasSelection(){return!!this._selectionService&&this._selectionService.hasSelection}select(e,t,i){this._selectionService.setSelection(e,t,i)}getSelection(){return this._selectionService?this._selectionService.selectionText:""}getSelectionPosition(){if(this._selectionService&&this._selectionService.hasSelection)return{start:{x:this._selectionService.selectionStart[0],y:this._selectionService.selectionStart[1]},end:{x:this._selectionService.selectionEnd[0],y:this._selectionService.selectionEnd[1]}}}clearSelection(){this._selectionService?.clearSelection()}selectAll(){this._selectionService?.selectAll()}selectLines(e,t){this._selectionService?.selectLines(e,t)}_keyDown(e){if(this._keyDownHandled=!1,this._keyDownSeen=!0,this._customKeyEventHandler&&!1===this._customKeyEventHandler(e))return!1;const t=this.browser.isMac&&this.options.macOptionIsMeta&&e.altKey;if(!t&&!this._compositionHelper.keydown(e))return this.options.scrollOnUserInput&&this.buffer.ybase!==this.buffer.ydisp&&this.scrollToBottom(),!1;t||"Dead"!==e.key&&"AltGraph"!==e.key||(this._unprocessedDeadKey=!0);const i=(0,k.evaluateKeyboardEvent)(e,this.coreService.decPrivateModes.applicationCursorKeys,this.browser.isMac,this.options.macOptionIsMeta);if(this.updateCursorStyle(e),3===i.type||2===i.type){const t=this.rows-1;return this.scrollLines(2===i.type?-t:t),this.cancel(e,!0)}return 1===i.type&&this.selectAll(),!!this._isThirdLevelShift(this.browser,e)||(i.cancel&&this.cancel(e,!0),!i.key||!!(e.key&&!e.ctrlKey&&!e.altKey&&!e.metaKey&&1===e.key.length&&e.key.charCodeAt(0)>=65&&e.key.charCodeAt(0)<=90)||(this._unprocessedDeadKey?(this._unprocessedDeadKey=!1,!0):(i.key!==O.C0.ETX&&i.key!==O.C0.CR||(this.textarea.value=""),this._onKey.fire({key:i.key,domEvent:e}),this._showCursor(),this.coreService.triggerDataEvent(i.key,!0),!this.optionsService.rawOptions.screenReaderMode||e.altKey||e.ctrlKey?this.cancel(e,!0):void(this._keyDownHandled=!0))))}_isThirdLevelShift(e,t){const i=e.isMac&&!this.options.macOptionIsMeta&&t.altKey&&!t.ctrlKey&&!t.metaKey||e.isWindows&&t.altKey&&t.ctrlKey&&!t.metaKey||e.isWindows&&t.getModifierState("AltGraph");return"keypress"===t.type?i:i&&(!t.keyCode||t.keyCode>47)}_keyUp(e){this._keyDownSeen=!1,this._customKeyEventHandler&&!1===this._customKeyEventHandler(e)||(function(e){return 16===e.keyCode||17===e.keyCode||18===e.keyCode}(e)||this.focus(),this.updateCursorStyle(e),this._keyPressHandled=!1)}_keyPress(e){let t;if(this._keyPressHandled=!1,this._keyDownHandled)return!1;if(this._customKeyEventHandler&&!1===this._customKeyEventHandler(e))return!1;if(this.cancel(e),e.charCode)t=e.charCode;else if(null===e.which||void 0===e.which)t=e.keyCode;else{if(0===e.which||0===e.charCode)return!1;t=e.which}return!(!t||(e.altKey||e.ctrlKey||e.metaKey)&&!this._isThirdLevelShift(this.browser,e)||(t=String.fromCharCode(t),this._onKey.fire({key:t,domEvent:e}),this._showCursor(),this.coreService.triggerDataEvent(t,!0),this._keyPressHandled=!0,this._unprocessedDeadKey=!1,0))}_inputEvent(e){if(e.data&&"insertText"===e.inputType&&(!e.composed||!this._keyDownSeen)&&!this.optionsService.rawOptions.screenReaderMode){if(this._keyPressHandled)return!1;this._unprocessedDeadKey=!1;const t=e.data;return this.coreService.triggerDataEvent(t,!0),this.cancel(e),!0}return!1}resize(e,t){e!==this.cols||t!==this.rows?super.resize(e,t):this._charSizeService&&!this._charSizeService.hasValidSize&&this._charSizeService.measure()}_afterResize(e,t){this._charSizeService?.measure(),this.viewport?.syncScrollArea(!0)}clear(){if(0!==this.buffer.ybase||0!==this.buffer.y){this.buffer.clearAllMarkers(),this.buffer.lines.set(0,this.buffer.lines.get(this.buffer.ybase+this.buffer.y)),this.buffer.lines.length=1,this.buffer.ydisp=0,this.buffer.ybase=0,this.buffer.y=0;for(let e=1;e<this.rows;e++)this.buffer.lines.push(this.buffer.getBlankLine(T.DEFAULT_ATTR_DATA));this._onScroll.fire({position:this.buffer.ydisp,source:0}),this.viewport?.reset(),this.refresh(0,this.rows-1)}}reset(){this.options.rows=this.rows,this.options.cols=this.cols;const e=this._customKeyEventHandler;this._setup(),super.reset(),this._selectionService?.reset(),this._decorationService.reset(),this.viewport?.reset(),this._customKeyEventHandler=e,this.refresh(0,this.rows-1)}clearTextureAtlas(){this._renderService?.clearTextureAtlas()}_reportFocus(){this.element?.classList.contains("focus")?this.coreService.triggerDataEvent(O.C0.ESC+"[I"):this.coreService.triggerDataEvent(O.C0.ESC+"[O")}_reportWindowsOptions(e){if(this._renderService)switch(e){case R.WindowsOptionsReportType.GET_WIN_SIZE_PIXELS:const e=this._renderService.dimensions.css.canvas.width.toFixed(0),t=this._renderService.dimensions.css.canvas.height.toFixed(0);this.coreService.triggerDataEvent(`${O.C0.ESC}[4;${t};${e}t`);break;case R.WindowsOptionsReportType.GET_CELL_SIZE_PIXELS:const i=this._renderService.dimensions.css.cell.width.toFixed(0),s=this._renderService.dimensions.css.cell.height.toFixed(0);this.coreService.triggerDataEvent(`${O.C0.ESC}[6;${s};${i}t`)}}cancel(e,t){if(this.options.cancelEvents||t)return e.preventDefault(),e.stopPropagation(),!1}}t.Terminal=M},9924:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TimeBasedDebouncer=void 0,t.TimeBasedDebouncer=class{constructor(e,t=1e3){this._renderCallback=e,this._debounceThresholdMS=t,this._lastRefreshMs=0,this._additionalRefreshRequested=!1}dispose(){this._refreshTimeoutID&&clearTimeout(this._refreshTimeoutID)}refresh(e,t,i){this._rowCount=i,e=void 0!==e?e:0,t=void 0!==t?t:this._rowCount-1,this._rowStart=void 0!==this._rowStart?Math.min(this._rowStart,e):e,this._rowEnd=void 0!==this._rowEnd?Math.max(this._rowEnd,t):t;const s=Date.now();if(s-this._lastRefreshMs>=this._debounceThresholdMS)this._lastRefreshMs=s,this._innerRefresh();else if(!this._additionalRefreshRequested){const e=s-this._lastRefreshMs,t=this._debounceThresholdMS-e;this._additionalRefreshRequested=!0,this._refreshTimeoutID=window.setTimeout((()=>{this._lastRefreshMs=Date.now(),this._innerRefresh(),this._additionalRefreshRequested=!1,this._refreshTimeoutID=void 0}),t)}}_innerRefresh(){if(void 0===this._rowStart||void 0===this._rowEnd||void 0===this._rowCount)return;const e=Math.max(this._rowStart,0),t=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(e,t)}}},1680:function(e,t,i){var s=this&&this.__decorate||function(e,t,i,s){var n,r=arguments.length,o=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,s);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(r<3?n(o):r>3?n(t,i,o):n(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},n=this&&this.__param||function(e,t){return function(i,s){t(i,s,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.Viewport=void 0;const r=i(3656),o=i(4725),a=i(8460),l=i(844),h=i(2585);let c=t.Viewport=class extends l.Disposable{constructor(e,t,i,s,n,o,l,h){super(),this._viewportElement=e,this._scrollArea=t,this._bufferService=i,this._optionsService=s,this._charSizeService=n,this._renderService=o,this._coreBrowserService=l,this.scrollBarWidth=0,this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._wheelPartialScroll=0,this._refreshAnimationFrame=null,this._ignoreNextScrollEvent=!1,this._smoothScrollState={startTime:0,origin:-1,target:-1},this._onRequestScrollLines=this.register(new a.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this.scrollBarWidth=this._viewportElement.offsetWidth-this._scrollArea.offsetWidth||15,this.register((0,r.addDisposableDomListener)(this._viewportElement,"scroll",this._handleScroll.bind(this))),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate((e=>this._activeBuffer=e.activeBuffer))),this._renderDimensions=this._renderService.dimensions,this.register(this._renderService.onDimensionsChange((e=>this._renderDimensions=e))),this._handleThemeChange(h.colors),this.register(h.onChangeColors((e=>this._handleThemeChange(e)))),this.register(this._optionsService.onSpecificOptionChange("scrollback",(()=>this.syncScrollArea()))),setTimeout((()=>this.syncScrollArea()))}_handleThemeChange(e){this._viewportElement.style.backgroundColor=e.background.css}reset(){this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._coreBrowserService.window.requestAnimationFrame((()=>this.syncScrollArea()))}_refresh(e){if(e)return this._innerRefresh(),void(null!==this._refreshAnimationFrame&&this._coreBrowserService.window.cancelAnimationFrame(this._refreshAnimationFrame));null===this._refreshAnimationFrame&&(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame((()=>this._innerRefresh())))}_innerRefresh(){if(this._charSizeService.height>0){this._currentRowHeight=this._renderDimensions.device.cell.height/this._coreBrowserService.dpr,this._currentDeviceCellHeight=this._renderDimensions.device.cell.height,this._lastRecordedViewportHeight=this._viewportElement.offsetHeight;const e=Math.round(this._currentRowHeight*this._lastRecordedBufferLength)+(this._lastRecordedViewportHeight-this._renderDimensions.css.canvas.height);this._lastRecordedBufferHeight!==e&&(this._lastRecordedBufferHeight=e,this._scrollArea.style.height=this._lastRecordedBufferHeight+"px")}const e=this._bufferService.buffer.ydisp*this._currentRowHeight;this._viewportElement.scrollTop!==e&&(this._ignoreNextScrollEvent=!0,this._viewportElement.scrollTop=e),this._refreshAnimationFrame=null}syncScrollArea(e=!1){if(this._lastRecordedBufferLength!==this._bufferService.buffer.lines.length)return this._lastRecordedBufferLength=this._bufferService.buffer.lines.length,void this._refresh(e);this._lastRecordedViewportHeight===this._renderService.dimensions.css.canvas.height&&this._lastScrollTop===this._activeBuffer.ydisp*this._currentRowHeight&&this._renderDimensions.device.cell.height===this._currentDeviceCellHeight||this._refresh(e)}_handleScroll(e){if(this._lastScrollTop=this._viewportElement.scrollTop,!this._viewportElement.offsetParent)return;if(this._ignoreNextScrollEvent)return this._ignoreNextScrollEvent=!1,void this._onRequestScrollLines.fire({amount:0,suppressScrollEvent:!0});const t=Math.round(this._lastScrollTop/this._currentRowHeight)-this._bufferService.buffer.ydisp;this._onRequestScrollLines.fire({amount:t,suppressScrollEvent:!0})}_smoothScroll(){if(this._isDisposed||-1===this._smoothScrollState.origin||-1===this._smoothScrollState.target)return;const e=this._smoothScrollPercent();this._viewportElement.scrollTop=this._smoothScrollState.origin+Math.round(e*(this._smoothScrollState.target-this._smoothScrollState.origin)),e<1?this._coreBrowserService.window.requestAnimationFrame((()=>this._smoothScroll())):this._clearSmoothScrollState()}_smoothScrollPercent(){return this._optionsService.rawOptions.smoothScrollDuration&&this._smoothScrollState.startTime?Math.max(Math.min((Date.now()-this._smoothScrollState.startTime)/this._optionsService.rawOptions.smoothScrollDuration,1),0):1}_clearSmoothScrollState(){this._smoothScrollState.startTime=0,this._smoothScrollState.origin=-1,this._smoothScrollState.target=-1}_bubbleScroll(e,t){const i=this._viewportElement.scrollTop+this._lastRecordedViewportHeight;return!(t<0&&0!==this._viewportElement.scrollTop||t>0&&i<this._lastRecordedBufferHeight)||(e.cancelable&&e.preventDefault(),!1)}handleWheel(e){const t=this._getPixelsScrolled(e);return 0!==t&&(this._optionsService.rawOptions.smoothScrollDuration?(this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,-1===this._smoothScrollState.target?this._smoothScrollState.target=this._viewportElement.scrollTop+t:this._smoothScrollState.target+=t,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()):this._viewportElement.scrollTop+=t,this._bubbleScroll(e,t))}scrollLines(e){if(0!==e)if(this._optionsService.rawOptions.smoothScrollDuration){const t=e*this._currentRowHeight;this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,this._smoothScrollState.target=this._smoothScrollState.origin+t,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()}else this._onRequestScrollLines.fire({amount:e,suppressScrollEvent:!1})}_getPixelsScrolled(e){if(0===e.deltaY||e.shiftKey)return 0;let t=this._applyScrollModifier(e.deltaY,e);return e.deltaMode===WheelEvent.DOM_DELTA_LINE?t*=this._currentRowHeight:e.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(t*=this._currentRowHeight*this._bufferService.rows),t}getBufferElements(e,t){let i,s="";const n=[],r=t??this._bufferService.buffer.lines.length,o=this._bufferService.buffer.lines;for(let t=e;t<r;t++){const e=o.get(t);if(!e)continue;const r=o.get(t+1)?.isWrapped;if(s+=e.translateToString(!r),!r||t===o.length-1){const e=document.createElement("div");e.textContent=s,n.push(e),s.length>0&&(i=e),s=""}}return{bufferElements:n,cursorElement:i}}getLinesScrolled(e){if(0===e.deltaY||e.shiftKey)return 0;let t=this._applyScrollModifier(e.deltaY,e);return e.deltaMode===WheelEvent.DOM_DELTA_PIXEL?(t/=this._currentRowHeight+0,this._wheelPartialScroll+=t,t=Math.floor(Math.abs(this._wheelPartialScroll))*(this._wheelPartialScroll>0?1:-1),this._wheelPartialScroll%=1):e.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(t*=this._bufferService.rows),t}_applyScrollModifier(e,t){const i=this._optionsService.rawOptions.fastScrollModifier;return"alt"===i&&t.altKey||"ctrl"===i&&t.ctrlKey||"shift"===i&&t.shiftKey?e*this._optionsService.rawOptions.fastScrollSensitivity*this._optionsService.rawOptions.scrollSensitivity:e*this._optionsService.rawOptions.scrollSensitivity}handleTouchStart(e){this._lastTouchY=e.touches[0].pageY}handleTouchMove(e){const t=this._lastTouchY-e.touches[0].pageY;return this._lastTouchY=e.touches[0].pageY,0!==t&&(this._viewportElement.scrollTop+=t,this._bubbleScroll(e,t))}};t.Viewport=c=s([n(2,h.IBufferService),n(3,h.IOptionsService),n(4,o.ICharSizeService),n(5,o.IRenderService),n(6,o.ICoreBrowserService),n(7,o.IThemeService)],c)},3107:function(e,t,i){var s=this&&this.__decorate||function(e,t,i,s){var n,r=arguments.length,o=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,s);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(r<3?n(o):r>3?n(t,i,o):n(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},n=this&&this.__param||function(e,t){return function(i,s){t(i,s,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.BufferDecorationRenderer=void 0;const r=i(4725),o=i(844),a=i(2585);let l=t.BufferDecorationRenderer=class extends o.Disposable{constructor(e,t,i,s,n){super(),this._screenElement=e,this._bufferService=t,this._coreBrowserService=i,this._decorationService=s,this._renderService=n,this._decorationElements=new Map,this._altBufferIsActive=!1,this._dimensionsChanged=!1,this._container=document.createElement("div"),this._container.classList.add("xterm-decoration-container"),this._screenElement.appendChild(this._container),this.register(this._renderService.onRenderedViewportChange((()=>this._doRefreshDecorations()))),this.register(this._renderService.onDimensionsChange((()=>{this._dimensionsChanged=!0,this._queueRefresh()}))),this.register(this._coreBrowserService.onDprChange((()=>this._queueRefresh()))),this.register(this._bufferService.buffers.onBufferActivate((()=>{this._altBufferIsActive=this._bufferService.buffer===this._bufferService.buffers.alt}))),this.register(this._decorationService.onDecorationRegistered((()=>this._queueRefresh()))),this.register(this._decorationService.onDecorationRemoved((e=>this._removeDecoration(e)))),this.register((0,o.toDisposable)((()=>{this._container.remove(),this._decorationElements.clear()})))}_queueRefresh(){void 0===this._animationFrame&&(this._animationFrame=this._renderService.addRefreshCallback((()=>{this._doRefreshDecorations(),this._animationFrame=void 0})))}_doRefreshDecorations(){for(const e of this._decorationService.decorations)this._renderDecoration(e);this._dimensionsChanged=!1}_renderDecoration(e){this._refreshStyle(e),this._dimensionsChanged&&this._refreshXPosition(e)}_createElement(e){const t=this._coreBrowserService.mainDocument.createElement("div");t.classList.add("xterm-decoration"),t.classList.toggle("xterm-decoration-top-layer","top"===e?.options?.layer),t.style.width=`${Math.round((e.options.width||1)*this._renderService.dimensions.css.cell.width)}px`,t.style.height=(e.options.height||1)*this._renderService.dimensions.css.cell.height+"px",t.style.top=(e.marker.line-this._bufferService.buffers.active.ydisp)*this._renderService.dimensions.css.cell.height+"px",t.style.lineHeight=`${this._renderService.dimensions.css.cell.height}px`;const i=e.options.x??0;return i&&i>this._bufferService.cols&&(t.style.display="none"),this._refreshXPosition(e,t),t}_refreshStyle(e){const t=e.marker.line-this._bufferService.buffers.active.ydisp;if(t<0||t>=this._bufferService.rows)e.element&&(e.element.style.display="none",e.onRenderEmitter.fire(e.element));else{let i=this._decorationElements.get(e);i||(i=this._createElement(e),e.element=i,this._decorationElements.set(e,i),this._container.appendChild(i),e.onDispose((()=>{this._decorationElements.delete(e),i.remove()}))),i.style.top=t*this._renderService.dimensions.css.cell.height+"px",i.style.display=this._altBufferIsActive?"none":"block",e.onRenderEmitter.fire(i)}}_refreshXPosition(e,t=e.element){if(!t)return;const i=e.options.x??0;"right"===(e.options.anchor||"left")?t.style.right=i?i*this._renderService.dimensions.css.cell.width+"px":"":t.style.left=i?i*this._renderService.dimensions.css.cell.width+"px":""}_removeDecoration(e){this._decorationElements.get(e)?.remove(),this._decorationElements.delete(e),e.dispose()}};t.BufferDecorationRenderer=l=s([n(1,a.IBufferService),n(2,r.ICoreBrowserService),n(3,a.IDecorationService),n(4,r.IRenderService)],l)},5871:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ColorZoneStore=void 0,t.ColorZoneStore=class{constructor(){this._zones=[],this._zonePool=[],this._zonePoolIndex=0,this._linePadding={full:0,left:0,center:0,right:0}}get zones(){return this._zonePool.length=Math.min(this._zonePool.length,this._zones.length),this._zones}clear(){this._zones.length=0,this._zonePoolIndex=0}addDecoration(e){if(e.options.overviewRulerOptions){for(const t of this._zones)if(t.color===e.options.overviewRulerOptions.color&&t.position===e.options.overviewRulerOptions.position){if(this._lineIntersectsZone(t,e.marker.line))return;if(this._lineAdjacentToZone(t,e.marker.line,e.options.overviewRulerOptions.position))return void this._addLineToZone(t,e.marker.line)}if(this._zonePoolIndex<this._zonePool.length)return this._zonePool[this._zonePoolIndex].color=e.options.overviewRulerOptions.color,this._zonePool[this._zonePoolIndex].position=e.options.overviewRulerOptions.position,this._zonePool[this._zonePoolIndex].startBufferLine=e.marker.line,this._zonePool[this._zonePoolIndex].endBufferLine=e.marker.line,void this._zones.push(this._zonePool[this._zonePoolIndex++]);this._zones.push({color:e.options.overviewRulerOptions.color,position:e.options.overviewRulerOptions.position,startBufferLine:e.marker.line,endBufferLine:e.marker.line}),this._zonePool.push(this._zones[this._zones.length-1]),this._zonePoolIndex++}}setPadding(e){this._linePadding=e}_lineIntersectsZone(e,t){return t>=e.startBufferLine&&t<=e.endBufferLine}_lineAdjacentToZone(e,t,i){return t>=e.startBufferLine-this._linePadding[i||"full"]&&t<=e.endBufferLine+this._linePadding[i||"full"]}_addLineToZone(e,t){e.startBufferLine=Math.min(e.startBufferLine,t),e.endBufferLine=Math.max(e.endBufferLine,t)}}},5744:function(e,t,i){var s=this&&this.__decorate||function(e,t,i,s){var n,r=arguments.length,o=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,s);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(r<3?n(o):r>3?n(t,i,o):n(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},n=this&&this.__param||function(e,t){return function(i,s){t(i,s,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.OverviewRulerRenderer=void 0;const r=i(5871),o=i(4725),a=i(844),l=i(2585),h={full:0,left:0,center:0,right:0},c={full:0,left:0,center:0,right:0},d={full:0,left:0,center:0,right:0};let u=t.OverviewRulerRenderer=class extends a.Disposable{get _width(){return this._optionsService.options.overviewRulerWidth||0}constructor(e,t,i,s,n,o,l){super(),this._viewportElement=e,this._screenElement=t,this._bufferService=i,this._decorationService=s,this._renderService=n,this._optionsService=o,this._coreBrowserService=l,this._colorZoneStore=new r.ColorZoneStore,this._shouldUpdateDimensions=!0,this._shouldUpdateAnchor=!0,this._lastKnownBufferLength=0,this._canvas=this._coreBrowserService.mainDocument.createElement("canvas"),this._canvas.classList.add("xterm-decoration-overview-ruler"),this._refreshCanvasDimensions(),this._viewportElement.parentElement?.insertBefore(this._canvas,this._viewportElement);const h=this._canvas.getContext("2d");if(!h)throw new Error("Ctx cannot be null");this._ctx=h,this._registerDecorationListeners(),this._registerBufferChangeListeners(),this._registerDimensionChangeListeners(),this.register((0,a.toDisposable)((()=>{this._canvas?.remove()})))}_registerDecorationListeners(){this.register(this._decorationService.onDecorationRegistered((()=>this._queueRefresh(void 0,!0)))),this.register(this._decorationService.onDecorationRemoved((()=>this._queueRefresh(void 0,!0))))}_registerBufferChangeListeners(){this.register(this._renderService.onRenderedViewportChange((()=>this._queueRefresh()))),this.register(this._bufferService.buffers.onBufferActivate((()=>{this._canvas.style.display=this._bufferService.buffer===this._bufferService.buffers.alt?"none":"block"}))),this.register(this._bufferService.onScroll((()=>{this._lastKnownBufferLength!==this._bufferService.buffers.normal.lines.length&&(this._refreshDrawHeightConstants(),this._refreshColorZonePadding())})))}_registerDimensionChangeListeners(){this.register(this._renderService.onRender((()=>{this._containerHeight&&this._containerHeight===this._screenElement.clientHeight||(this._queueRefresh(!0),this._containerHeight=this._screenElement.clientHeight)}))),this.register(this._optionsService.onSpecificOptionChange("overviewRulerWidth",(()=>this._queueRefresh(!0)))),this.register(this._coreBrowserService.onDprChange((()=>this._queueRefresh(!0)))),this._queueRefresh(!0)}_refreshDrawConstants(){const e=Math.floor(this._canvas.width/3),t=Math.ceil(this._canvas.width/3);c.full=this._canvas.width,c.left=e,c.center=t,c.right=e,this._refreshDrawHeightConstants(),d.full=0,d.left=0,d.center=c.left,d.right=c.left+c.center}_refreshDrawHeightConstants(){h.full=Math.round(2*this._coreBrowserService.dpr);const e=this._canvas.height/this._bufferService.buffer.lines.length,t=Math.round(Math.max(Math.min(e,12),6)*this._coreBrowserService.dpr);h.left=t,h.center=t,h.right=t}_refreshColorZonePadding(){this._colorZoneStore.setPadding({full:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*h.full),left:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*h.left),center:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*h.center),right:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*h.right)}),this._lastKnownBufferLength=this._bufferService.buffers.normal.lines.length}_refreshCanvasDimensions(){this._canvas.style.width=`${this._width}px`,this._canvas.width=Math.round(this._width*this._coreBrowserService.dpr),this._canvas.style.height=`${this._screenElement.clientHeight}px`,this._canvas.height=Math.round(this._screenElement.clientHeight*this._coreBrowserService.dpr),this._refreshDrawConstants(),this._refreshColorZonePadding()}_refreshDecorations(){this._shouldUpdateDimensions&&this._refreshCanvasDimensions(),this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._colorZoneStore.clear();for(const e of this._decorationService.decorations)this._colorZoneStore.addDecoration(e);this._ctx.lineWidth=1;const e=this._colorZoneStore.zones;for(const t of e)"full"!==t.position&&this._renderColorZone(t);for(const t of e)"full"===t.position&&this._renderColorZone(t);this._shouldUpdateDimensions=!1,this._shouldUpdateAnchor=!1}_renderColorZone(e){this._ctx.fillStyle=e.color,this._ctx.fillRect(d[e.position||"full"],Math.round((this._canvas.height-1)*(e.startBufferLine/this._bufferService.buffers.active.lines.length)-h[e.position||"full"]/2),c[e.position||"full"],Math.round((this._canvas.height-1)*((e.endBufferLine-e.startBufferLine)/this._bufferService.buffers.active.lines.length)+h[e.position||"full"]))}_queueRefresh(e,t){this._shouldUpdateDimensions=e||this._shouldUpdateDimensions,this._shouldUpdateAnchor=t||this._shouldUpdateAnchor,void 0===this._animationFrame&&(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame((()=>{this._refreshDecorations(),this._animationFrame=void 0})))}};t.OverviewRulerRenderer=u=s([n(2,l.IBufferService),n(3,l.IDecorationService),n(4,o.IRenderService),n(5,l.IOptionsService),n(6,o.ICoreBrowserService)],u)},2950:function(e,t,i){var s=this&&this.__decorate||function(e,t,i,s){var n,r=arguments.length,o=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,s);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(r<3?n(o):r>3?n(t,i,o):n(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},n=this&&this.__param||function(e,t){return function(i,s){t(i,s,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CompositionHelper=void 0;const r=i(4725),o=i(2585),a=i(2584);let l=t.CompositionHelper=class{get isComposing(){return this._isComposing}constructor(e,t,i,s,n,r){this._textarea=e,this._compositionView=t,this._bufferService=i,this._optionsService=s,this._coreService=n,this._renderService=r,this._isComposing=!1,this._isSendingComposition=!1,this._compositionPosition={start:0,end:0},this._dataAlreadySent=""}compositionstart(){this._isComposing=!0,this._compositionPosition.start=this._textarea.value.length,this._compositionView.textContent="",this._dataAlreadySent="",this._compositionView.classList.add("active")}compositionupdate(e){this._compositionView.textContent=e.data,this.updateCompositionElements(),setTimeout((()=>{this._compositionPosition.end=this._textarea.value.length}),0)}compositionend(){this._finalizeComposition(!0)}keydown(e){if(this._isComposing||this._isSendingComposition){if(229===e.keyCode)return!1;if(16===e.keyCode||17===e.keyCode||18===e.keyCode)return!1;this._finalizeComposition(!1)}return 229!==e.keyCode||(this._handleAnyTextareaChanges(),!1)}_finalizeComposition(e){if(this._compositionView.classList.remove("active"),this._isComposing=!1,e){const e={start:this._compositionPosition.start,end:this._compositionPosition.end};this._isSendingComposition=!0,setTimeout((()=>{if(this._isSendingComposition){let t;this._isSendingComposition=!1,e.start+=this._dataAlreadySent.length,t=this._isComposing?this._textarea.value.substring(e.start,e.end):this._textarea.value.substring(e.start),t.length>0&&this._coreService.triggerDataEvent(t,!0)}}),0)}else{this._isSendingComposition=!1;const e=this._textarea.value.substring(this._compositionPosition.start,this._compositionPosition.end);this._coreService.triggerDataEvent(e,!0)}}_handleAnyTextareaChanges(){const e=this._textarea.value;setTimeout((()=>{if(!this._isComposing){const t=this._textarea.value,i=t.replace(e,"");this._dataAlreadySent=i,t.length>e.length?this._coreService.triggerDataEvent(i,!0):t.length<e.length?this._coreService.triggerDataEvent(`${a.C0.DEL}`,!0):t.length===e.length&&t!==e&&this._coreService.triggerDataEvent(t,!0)}}),0)}updateCompositionElements(e){if(this._isComposing){if(this._bufferService.buffer.isCursorInViewport){const e=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),t=this._renderService.dimensions.css.cell.height,i=this._bufferService.buffer.y*this._renderService.dimensions.css.cell.height,s=e*this._renderService.dimensions.css.cell.width;this._compositionView.style.left=s+"px",this._compositionView.style.top=i+"px",this._compositionView.style.height=t+"px",this._compositionView.style.lineHeight=t+"px",this._compositionView.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._compositionView.style.fontSize=this._optionsService.rawOptions.fontSize+"px";const n=this._compositionView.getBoundingClientRect();this._textarea.style.left=s+"px",this._textarea.style.top=i+"px",this._textarea.style.width=Math.max(n.width,1)+"px",this._textarea.style.height=Math.max(n.height,1)+"px",this._textarea.style.lineHeight=n.height+"px"}e||setTimeout((()=>this.updateCompositionElements(!0)),0)}}};t.CompositionHelper=l=s([n(2,o.IBufferService),n(3,o.IOptionsService),n(4,o.ICoreService),n(5,r.IRenderService)],l)},9806:(e,t)=>{function i(e,t,i){const s=i.getBoundingClientRect(),n=e.getComputedStyle(i),r=parseInt(n.getPropertyValue("padding-left")),o=parseInt(n.getPropertyValue("padding-top"));return[t.clientX-s.left-r,t.clientY-s.top-o]}Object.defineProperty(t,"__esModule",{value:!0}),t.getCoords=t.getCoordsRelativeToElement=void 0,t.getCoordsRelativeToElement=i,t.getCoords=function(e,t,s,n,r,o,a,l,h){if(!o)return;const c=i(e,t,s);return c?(c[0]=Math.ceil((c[0]+(h?a/2:0))/a),c[1]=Math.ceil(c[1]/l),c[0]=Math.min(Math.max(c[0],1),n+(h?1:0)),c[1]=Math.min(Math.max(c[1],1),r),c):void 0}},9504:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.moveToCellSequence=void 0;const s=i(2584);function n(e,t,i,s){const n=e-r(e,i),a=t-r(t,i),c=Math.abs(n-a)-function(e,t,i){let s=0;const n=e-r(e,i),a=t-r(t,i);for(let r=0;r<Math.abs(n-a);r++){const a="A"===o(e,t)?-1:1,l=i.buffer.lines.get(n+a*r);l?.isWrapped&&s++}return s}(e,t,i);return h(c,l(o(e,t),s))}function r(e,t){let i=0,s=t.buffer.lines.get(e),n=s?.isWrapped;for(;n&&e>=0&&e<t.rows;)i++,s=t.buffer.lines.get(--e),n=s?.isWrapped;return i}function o(e,t){return e>t?"A":"B"}function a(e,t,i,s,n,r){let o=e,a=t,l="";for(;o!==i||a!==s;)o+=n?1:-1,n&&o>r.cols-1?(l+=r.buffer.translateBufferLineToString(a,!1,e,o),o=0,e=0,a++):!n&&o<0&&(l+=r.buffer.translateBufferLineToString(a,!1,0,e+1),o=r.cols-1,e=o,a--);return l+r.buffer.translateBufferLineToString(a,!1,e,o)}function l(e,t){const i=t?"O":"[";return s.C0.ESC+i+e}function h(e,t){e=Math.floor(e);let i="";for(let s=0;s<e;s++)i+=t;return i}t.moveToCellSequence=function(e,t,i,s){const o=i.buffer.x,c=i.buffer.y;if(!i.buffer.hasScrollback)return function(e,t,i,s,o,c){return 0===n(t,s,o,c).length?"":h(a(e,t,e,t-r(t,o),!1,o).length,l("D",c))}(o,c,0,t,i,s)+n(c,t,i,s)+function(e,t,i,s,o,c){let d;d=n(t,s,o,c).length>0?s-r(s,o):t;const u=s,p=function(e,t,i,s,o,a){let l;return l=n(i,s,o,a).length>0?s-r(s,o):t,e<i&&l<=s||e>=i&&l<s?"C":"D"}(e,t,i,s,o,c);return h(a(e,d,i,u,"C"===p,o).length,l(p,c))}(o,c,e,t,i,s);let d;if(c===t)return d=o>e?"D":"C",h(Math.abs(o-e),l(d,s));d=c>t?"D":"C";const u=Math.abs(c-t);return h(function(e,t){return t.cols-e}(c>t?e:o,i)+(u-1)*i.cols+1+((c>t?o:e)-1),l(d,s))}},1296:function(e,t,i){var s=this&&this.__decorate||function(e,t,i,s){var n,r=arguments.length,o=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,s);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(r<3?n(o):r>3?n(t,i,o):n(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},n=this&&this.__param||function(e,t){return function(i,s){t(i,s,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.DomRenderer=void 0;const r=i(3787),o=i(2550),a=i(2223),l=i(6171),h=i(6052),c=i(4725),d=i(8055),u=i(8460),p=i(844),m=i(2585),f="xterm-dom-renderer-owner-",g="xterm-rows",_="xterm-fg-",v="xterm-bg-",b="xterm-focus",y="xterm-selection";let C=1,w=t.DomRenderer=class extends p.Disposable{constructor(e,t,i,s,n,a,c,d,m,_,v,b,w){super(),this._terminal=e,this._document=t,this._element=i,this._screenElement=s,this._viewportElement=n,this._helperContainer=a,this._linkifier2=c,this._charSizeService=m,this._optionsService=_,this._bufferService=v,this._coreBrowserService=b,this._themeService=w,this._terminalClass=C++,this._rowElements=[],this._selectionRenderModel=(0,h.createSelectionRenderModel)(),this.onRequestRedraw=this.register(new u.EventEmitter).event,this._rowContainer=this._document.createElement("div"),this._rowContainer.classList.add(g),this._rowContainer.style.lineHeight="normal",this._rowContainer.setAttribute("aria-hidden","true"),this._refreshRowElements(this._bufferService.cols,this._bufferService.rows),this._selectionContainer=this._document.createElement("div"),this._selectionContainer.classList.add(y),this._selectionContainer.setAttribute("aria-hidden","true"),this.dimensions=(0,l.createRenderDimensions)(),this._updateDimensions(),this.register(this._optionsService.onOptionChange((()=>this._handleOptionsChanged()))),this.register(this._themeService.onChangeColors((e=>this._injectCss(e)))),this._injectCss(this._themeService.colors),this._rowFactory=d.createInstance(r.DomRendererRowFactory,document),this._element.classList.add(f+this._terminalClass),this._screenElement.appendChild(this._rowContainer),this._screenElement.appendChild(this._selectionContainer),this.register(this._linkifier2.onShowLinkUnderline((e=>this._handleLinkHover(e)))),this.register(this._linkifier2.onHideLinkUnderline((e=>this._handleLinkLeave(e)))),this.register((0,p.toDisposable)((()=>{this._element.classList.remove(f+this._terminalClass),this._rowContainer.remove(),this._selectionContainer.remove(),this._widthCache.dispose(),this._themeStyleElement.remove(),this._dimensionsStyleElement.remove()}))),this._widthCache=new o.WidthCache(this._document,this._helperContainer),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}_updateDimensions(){const e=this._coreBrowserService.dpr;this.dimensions.device.char.width=this._charSizeService.width*e,this.dimensions.device.char.height=Math.ceil(this._charSizeService.height*e),this.dimensions.device.cell.width=this.dimensions.device.char.width+Math.round(this._optionsService.rawOptions.letterSpacing),this.dimensions.device.cell.height=Math.floor(this.dimensions.device.char.height*this._optionsService.rawOptions.lineHeight),this.dimensions.device.char.left=0,this.dimensions.device.char.top=0,this.dimensions.device.canvas.width=this.dimensions.device.cell.width*this._bufferService.cols,this.dimensions.device.canvas.height=this.dimensions.device.cell.height*this._bufferService.rows,this.dimensions.css.canvas.width=Math.round(this.dimensions.device.canvas.width/e),this.dimensions.css.canvas.height=Math.round(this.dimensions.device.canvas.height/e),this.dimensions.css.cell.width=this.dimensions.css.canvas.width/this._bufferService.cols,this.dimensions.css.cell.height=this.dimensions.css.canvas.height/this._bufferService.rows;for(const e of this._rowElements)e.style.width=`${this.dimensions.css.canvas.width}px`,e.style.height=`${this.dimensions.css.cell.height}px`,e.style.lineHeight=`${this.dimensions.css.cell.height}px`,e.style.overflow="hidden";this._dimensionsStyleElement||(this._dimensionsStyleElement=this._document.createElement("style"),this._screenElement.appendChild(this._dimensionsStyleElement));const t=`${this._terminalSelector} .${g} span { display: inline-block; height: 100%; vertical-align: top;}`;this._dimensionsStyleElement.textContent=t,this._selectionContainer.style.height=this._viewportElement.style.height,this._screenElement.style.width=`${this.dimensions.css.canvas.width}px`,this._screenElement.style.height=`${this.dimensions.css.canvas.height}px`}_injectCss(e){this._themeStyleElement||(this._themeStyleElement=this._document.createElement("style"),this._screenElement.appendChild(this._themeStyleElement));let t=`${this._terminalSelector} .${g} { color: ${e.foreground.css}; font-family: ${this._optionsService.rawOptions.fontFamily}; font-size: ${this._optionsService.rawOptions.fontSize}px; font-kerning: none; white-space: pre}`;t+=`${this._terminalSelector} .${g} .xterm-dim { color: ${d.color.multiplyOpacity(e.foreground,.5).css};}`,t+=`${this._terminalSelector} span:not(.xterm-bold) { font-weight: ${this._optionsService.rawOptions.fontWeight};}${this._terminalSelector} span.xterm-bold { font-weight: ${this._optionsService.rawOptions.fontWeightBold};}${this._terminalSelector} span.xterm-italic { font-style: italic;}`;const i=`blink_underline_${this._terminalClass}`,s=`blink_bar_${this._terminalClass}`,n=`blink_block_${this._terminalClass}`;t+=`@keyframes ${i} { 50% {  border-bottom-style: hidden; }}`,t+=`@keyframes ${s} { 50% {  box-shadow: none; }}`,t+=`@keyframes ${n} { 0% {  background-color: ${e.cursor.css};  color: ${e.cursorAccent.css}; } 50% {  background-color: inherit;  color: ${e.cursor.css}; }}`,t+=`${this._terminalSelector} .${g}.${b} .xterm-cursor.xterm-cursor-blink.xterm-cursor-underline { animation: ${i} 1s step-end infinite;}${this._terminalSelector} .${g}.${b} .xterm-cursor.xterm-cursor-blink.xterm-cursor-bar { animation: ${s} 1s step-end infinite;}${this._terminalSelector} .${g}.${b} .xterm-cursor.xterm-cursor-blink.xterm-cursor-block { animation: ${n} 1s step-end infinite;}${this._terminalSelector} .${g} .xterm-cursor.xterm-cursor-block { background-color: ${e.cursor.css}; color: ${e.cursorAccent.css};}${this._terminalSelector} .${g} .xterm-cursor.xterm-cursor-block:not(.xterm-cursor-blink) { background-color: ${e.cursor.css} !important; color: ${e.cursorAccent.css} !important;}${this._terminalSelector} .${g} .xterm-cursor.xterm-cursor-outline { outline: 1px solid ${e.cursor.css}; outline-offset: -1px;}${this._terminalSelector} .${g} .xterm-cursor.xterm-cursor-bar { box-shadow: ${this._optionsService.rawOptions.cursorWidth}px 0 0 ${e.cursor.css} inset;}${this._terminalSelector} .${g} .xterm-cursor.xterm-cursor-underline { border-bottom: 1px ${e.cursor.css}; border-bottom-style: solid; height: calc(100% - 1px);}`,t+=`${this._terminalSelector} .${y} { position: absolute; top: 0; left: 0; z-index: 1; pointer-events: none;}${this._terminalSelector}.focus .${y} div { position: absolute; background-color: ${e.selectionBackgroundOpaque.css};}${this._terminalSelector} .${y} div { position: absolute; background-color: ${e.selectionInactiveBackgroundOpaque.css};}`;for(const[i,s]of e.ansi.entries())t+=`${this._terminalSelector} .${_}${i} { color: ${s.css}; }${this._terminalSelector} .${_}${i}.xterm-dim { color: ${d.color.multiplyOpacity(s,.5).css}; }${this._terminalSelector} .${v}${i} { background-color: ${s.css}; }`;t+=`${this._terminalSelector} .${_}${a.INVERTED_DEFAULT_COLOR} { color: ${d.color.opaque(e.background).css}; }${this._terminalSelector} .${_}${a.INVERTED_DEFAULT_COLOR}.xterm-dim { color: ${d.color.multiplyOpacity(d.color.opaque(e.background),.5).css}; }${this._terminalSelector} .${v}${a.INVERTED_DEFAULT_COLOR} { background-color: ${e.foreground.css}; }`,this._themeStyleElement.textContent=t}_setDefaultSpacing(){const e=this.dimensions.css.cell.width-this._widthCache.get("W",!1,!1);this._rowContainer.style.letterSpacing=`${e}px`,this._rowFactory.defaultSpacing=e}handleDevicePixelRatioChange(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}_refreshRowElements(e,t){for(let e=this._rowElements.length;e<=t;e++){const e=this._document.createElement("div");this._rowContainer.appendChild(e),this._rowElements.push(e)}for(;this._rowElements.length>t;)this._rowContainer.removeChild(this._rowElements.pop())}handleResize(e,t){this._refreshRowElements(e,t),this._updateDimensions(),this.handleSelectionChanged(this._selectionRenderModel.selectionStart,this._selectionRenderModel.selectionEnd,this._selectionRenderModel.columnSelectMode)}handleCharSizeChanged(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}handleBlur(){this._rowContainer.classList.remove(b),this.renderRows(0,this._bufferService.rows-1)}handleFocus(){this._rowContainer.classList.add(b),this.renderRows(this._bufferService.buffer.y,this._bufferService.buffer.y)}handleSelectionChanged(e,t,i){if(this._selectionContainer.replaceChildren(),this._rowFactory.handleSelectionChanged(e,t,i),this.renderRows(0,this._bufferService.rows-1),!e||!t)return;this._selectionRenderModel.update(this._terminal,e,t,i);const s=this._selectionRenderModel.viewportStartRow,n=this._selectionRenderModel.viewportEndRow,r=this._selectionRenderModel.viewportCappedStartRow,o=this._selectionRenderModel.viewportCappedEndRow;if(r>=this._bufferService.rows||o<0)return;const a=this._document.createDocumentFragment();if(i){const i=e[0]>t[0];a.appendChild(this._createSelectionElement(r,i?t[0]:e[0],i?e[0]:t[0],o-r+1))}else{const i=s===r?e[0]:0,l=r===n?t[0]:this._bufferService.cols;a.appendChild(this._createSelectionElement(r,i,l));const h=o-r-1;if(a.appendChild(this._createSelectionElement(r+1,0,this._bufferService.cols,h)),r!==o){const e=n===o?t[0]:this._bufferService.cols;a.appendChild(this._createSelectionElement(o,0,e))}}this._selectionContainer.appendChild(a)}_createSelectionElement(e,t,i,s=1){const n=this._document.createElement("div"),r=t*this.dimensions.css.cell.width;let o=this.dimensions.css.cell.width*(i-t);return r+o>this.dimensions.css.canvas.width&&(o=this.dimensions.css.canvas.width-r),n.style.height=s*this.dimensions.css.cell.height+"px",n.style.top=e*this.dimensions.css.cell.height+"px",n.style.left=`${r}px`,n.style.width=`${o}px`,n}handleCursorMove(){}_handleOptionsChanged(){this._updateDimensions(),this._injectCss(this._themeService.colors),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}clear(){for(const e of this._rowElements)e.replaceChildren()}renderRows(e,t){const i=this._bufferService.buffer,s=i.ybase+i.y,n=Math.min(i.x,this._bufferService.cols-1),r=this._optionsService.rawOptions.cursorBlink,o=this._optionsService.rawOptions.cursorStyle,a=this._optionsService.rawOptions.cursorInactiveStyle;for(let l=e;l<=t;l++){const e=l+i.ydisp,t=this._rowElements[l],h=i.lines.get(e);if(!t||!h)break;t.replaceChildren(...this._rowFactory.createRow(h,e,e===s,o,a,n,r,this.dimensions.css.cell.width,this._widthCache,-1,-1))}}get _terminalSelector(){return`.${f}${this._terminalClass}`}_handleLinkHover(e){this._setCellUnderline(e.x1,e.x2,e.y1,e.y2,e.cols,!0)}_handleLinkLeave(e){this._setCellUnderline(e.x1,e.x2,e.y1,e.y2,e.cols,!1)}_setCellUnderline(e,t,i,s,n,r){i<0&&(e=0),s<0&&(t=0);const o=this._bufferService.rows-1;i=Math.max(Math.min(i,o),0),s=Math.max(Math.min(s,o),0),n=Math.min(n,this._bufferService.cols);const a=this._bufferService.buffer,l=a.ybase+a.y,h=Math.min(a.x,n-1),c=this._optionsService.rawOptions.cursorBlink,d=this._optionsService.rawOptions.cursorStyle,u=this._optionsService.rawOptions.cursorInactiveStyle;for(let o=i;o<=s;++o){const p=o+a.ydisp,m=this._rowElements[o],f=a.lines.get(p);if(!m||!f)break;m.replaceChildren(...this._rowFactory.createRow(f,p,p===l,d,u,h,c,this.dimensions.css.cell.width,this._widthCache,r?o===i?e:0:-1,r?(o===s?t:n)-1:-1))}}};t.DomRenderer=w=s([n(7,m.IInstantiationService),n(8,c.ICharSizeService),n(9,m.IOptionsService),n(10,m.IBufferService),n(11,c.ICoreBrowserService),n(12,c.IThemeService)],w)},3787:function(e,t,i){var s=this&&this.__decorate||function(e,t,i,s){var n,r=arguments.length,o=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,s);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(r<3?n(o):r>3?n(t,i,o):n(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},n=this&&this.__param||function(e,t){return function(i,s){t(i,s,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.DomRendererRowFactory=void 0;const r=i(2223),o=i(643),a=i(511),l=i(2585),h=i(8055),c=i(4725),d=i(4269),u=i(6171),p=i(3734);let m=t.DomRendererRowFactory=class{constructor(e,t,i,s,n,r,o){this._document=e,this._characterJoinerService=t,this._optionsService=i,this._coreBrowserService=s,this._coreService=n,this._decorationService=r,this._themeService=o,this._workCell=new a.CellData,this._columnSelectMode=!1,this.defaultSpacing=0}handleSelectionChanged(e,t,i){this._selectionStart=e,this._selectionEnd=t,this._columnSelectMode=i}createRow(e,t,i,s,n,a,l,c,u,m,g){const _=[],v=this._characterJoinerService.getJoinedCharacters(t),b=this._themeService.colors;let y,C=e.getNoBgTrimmedLength();i&&C<a+1&&(C=a+1);let w=0,S="",E=0,x=0,T=0,O=!1,k=0,I=!1,A=0;const D=[],R=-1!==m&&-1!==g;for(let P=0;P<C;P++){e.loadCell(P,this._workCell);let C=this._workCell.getWidth();if(0===C)continue;let L=!1,M=P,N=this._workCell;if(v.length>0&&P===v[0][0]){L=!0;const t=v.shift();N=new d.JoinedCellData(this._workCell,e.translateToString(!0,t[0],t[1]),t[1]-t[0]),M=t[1]-1,C=N.getWidth()}const F=this._isCellInSelection(P,t),B=i&&P===a,H=R&&P>=m&&P<=g;let z=!1;this._decorationService.forEachDecorationAtCell(P,t,void 0,(e=>{z=!0}));let $=N.getChars()||o.WHITESPACE_CELL_CHAR;if(" "===$&&(N.isUnderline()||N.isOverline())&&($="Â "),A=C*c-u.get($,N.isBold(),N.isItalic()),y){if(w&&(F&&I||!F&&!I&&N.bg===E)&&(F&&I&&b.selectionForeground||N.fg===x)&&N.extended.ext===T&&H===O&&A===k&&!B&&!L&&!z){N.isInvisible()?S+=o.WHITESPACE_CELL_CHAR:S+=$,w++;continue}w&&(y.textContent=S),y=this._document.createElement("span"),w=0,S=""}else y=this._document.createElement("span");if(E=N.bg,x=N.fg,T=N.extended.ext,O=H,k=A,I=F,L&&a>=P&&a<=M&&(a=P),!this._coreService.isCursorHidden&&B&&this._coreService.isCursorInitialized)if(D.push("xterm-cursor"),this._coreBrowserService.isFocused)l&&D.push("xterm-cursor-blink"),D.push("bar"===s?"xterm-cursor-bar":"underline"===s?"xterm-cursor-underline":"xterm-cursor-block");else if(n)switch(n){case"outline":D.push("xterm-cursor-outline");break;case"block":D.push("xterm-cursor-block");break;case"bar":D.push("xterm-cursor-bar");break;case"underline":D.push("xterm-cursor-underline")}if(N.isBold()&&D.push("xterm-bold"),N.isItalic()&&D.push("xterm-italic"),N.isDim()&&D.push("xterm-dim"),S=N.isInvisible()?o.WHITESPACE_CELL_CHAR:N.getChars()||o.WHITESPACE_CELL_CHAR,N.isUnderline()&&(D.push(`xterm-underline-${N.extended.underlineStyle}`)," "===S&&(S="Â "),!N.isUnderlineColorDefault()))if(N.isUnderlineColorRGB())y.style.textDecorationColor=`rgb(${p.AttributeData.toColorRGB(N.getUnderlineColor()).join(",")})`;else{let e=N.getUnderlineColor();this._optionsService.rawOptions.drawBoldTextInBrightColors&&N.isBold()&&e<8&&(e+=8),y.style.textDecorationColor=b.ansi[e].css}N.isOverline()&&(D.push("xterm-overline")," "===S&&(S="Â ")),N.isStrikethrough()&&D.push("xterm-strikethrough"),H&&(y.style.textDecoration="underline");let V=N.getFgColor(),W=N.getFgColorMode(),U=N.getBgColor(),j=N.getBgColorMode();const G=!!N.isInverse();if(G){const e=V;V=U,U=e;const t=W;W=j,j=t}let q,K,Y,X=!1;switch(this._decorationService.forEachDecorationAtCell(P,t,void 0,(e=>{"top"!==e.options.layer&&X||(e.backgroundColorRGB&&(j=50331648,U=e.backgroundColorRGB.rgba>>8&16777215,q=e.backgroundColorRGB),e.foregroundColorRGB&&(W=50331648,V=e.foregroundColorRGB.rgba>>8&16777215,K=e.foregroundColorRGB),X="top"===e.options.layer)})),!X&&F&&(q=this._coreBrowserService.isFocused?b.selectionBackgroundOpaque:b.selectionInactiveBackgroundOpaque,U=q.rgba>>8&16777215,j=50331648,X=!0,b.selectionForeground&&(W=50331648,V=b.selectionForeground.rgba>>8&16777215,K=b.selectionForeground)),X&&D.push("xterm-decoration-top"),j){case 16777216:case 33554432:Y=b.ansi[U],D.push(`xterm-bg-${U}`);break;case 50331648:Y=h.channels.toColor(U>>16,U>>8&255,255&U),this._addStyle(y,`background-color:#${f((U>>>0).toString(16),"0",6)}`);break;default:G?(Y=b.foreground,D.push(`xterm-bg-${r.INVERTED_DEFAULT_COLOR}`)):Y=b.background}switch(q||N.isDim()&&(q=h.color.multiplyOpacity(Y,.5)),W){case 16777216:case 33554432:N.isBold()&&V<8&&this._optionsService.rawOptions.drawBoldTextInBrightColors&&(V+=8),this._applyMinimumContrast(y,Y,b.ansi[V],N,q,void 0)||D.push(`xterm-fg-${V}`);break;case 50331648:const e=h.channels.toColor(V>>16&255,V>>8&255,255&V);this._applyMinimumContrast(y,Y,e,N,q,K)||this._addStyle(y,`color:#${f(V.toString(16),"0",6)}`);break;default:this._applyMinimumContrast(y,Y,b.foreground,N,q,K)||G&&D.push(`xterm-fg-${r.INVERTED_DEFAULT_COLOR}`)}D.length&&(y.className=D.join(" "),D.length=0),B||L||z?y.textContent=S:w++,A!==this.defaultSpacing&&(y.style.letterSpacing=`${A}px`),_.push(y),P=M}return y&&w&&(y.textContent=S),_}_applyMinimumContrast(e,t,i,s,n,r){if(1===this._optionsService.rawOptions.minimumContrastRatio||(0,u.treatGlyphAsBackgroundColor)(s.getCode()))return!1;const o=this._getContrastCache(s);let a;if(n||r||(a=o.getColor(t.rgba,i.rgba)),void 0===a){const e=this._optionsService.rawOptions.minimumContrastRatio/(s.isDim()?2:1);a=h.color.ensureContrastRatio(n||t,r||i,e),o.setColor((n||t).rgba,(r||i).rgba,a??null)}return!!a&&(this._addStyle(e,`color:${a.css}`),!0)}_getContrastCache(e){return e.isDim()?this._themeService.colors.halfContrastCache:this._themeService.colors.contrastCache}_addStyle(e,t){e.setAttribute("style",`${e.getAttribute("style")||""}${t};`)}_isCellInSelection(e,t){const i=this._selectionStart,s=this._selectionEnd;return!(!i||!s)&&(this._columnSelectMode?i[0]<=s[0]?e>=i[0]&&t>=i[1]&&e<s[0]&&t<=s[1]:e<i[0]&&t>=i[1]&&e>=s[0]&&t<=s[1]:t>i[1]&&t<s[1]||i[1]===s[1]&&t===i[1]&&e>=i[0]&&e<s[0]||i[1]<s[1]&&t===s[1]&&e<s[0]||i[1]<s[1]&&t===i[1]&&e>=i[0])}};function f(e,t,i){for(;e.length<i;)e=t+e;return e}t.DomRendererRowFactory=m=s([n(1,c.ICharacterJoinerService),n(2,l.IOptionsService),n(3,c.ICoreBrowserService),n(4,l.ICoreService),n(5,l.IDecorationService),n(6,c.IThemeService)],m)},2550:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WidthCache=void 0,t.WidthCache=class{constructor(e,t){this._flat=new Float32Array(256),this._font="",this._fontSize=0,this._weight="normal",this._weightBold="bold",this._measureElements=[],this._container=e.createElement("div"),this._container.classList.add("xterm-width-cache-measure-container"),this._container.setAttribute("aria-hidden","true"),this._container.style.whiteSpace="pre",this._container.style.fontKerning="none";const i=e.createElement("span");i.classList.add("xterm-char-measure-element");const s=e.createElement("span");s.classList.add("xterm-char-measure-element"),s.style.fontWeight="bold";const n=e.createElement("span");n.classList.add("xterm-char-measure-element"),n.style.fontStyle="italic";const r=e.createElement("span");r.classList.add("xterm-char-measure-element"),r.style.fontWeight="bold",r.style.fontStyle="italic",this._measureElements=[i,s,n,r],this._container.appendChild(i),this._container.appendChild(s),this._container.appendChild(n),this._container.appendChild(r),t.appendChild(this._container),this.clear()}dispose(){this._container.remove(),this._measureElements.length=0,this._holey=void 0}clear(){this._flat.fill(-9999),this._holey=new Map}setFont(e,t,i,s){e===this._font&&t===this._fontSize&&i===this._weight&&s===this._weightBold||(this._font=e,this._fontSize=t,this._weight=i,this._weightBold=s,this._container.style.fontFamily=this._font,this._container.style.fontSize=`${this._fontSize}px`,this._measureElements[0].style.fontWeight=`${i}`,this._measureElements[1].style.fontWeight=`${s}`,this._measureElements[2].style.fontWeight=`${i}`,this._measureElements[3].style.fontWeight=`${s}`,this.clear())}get(e,t,i){let s=0;if(!t&&!i&&1===e.length&&(s=e.charCodeAt(0))<256){if(-9999!==this._flat[s])return this._flat[s];const t=this._measure(e,0);return t>0&&(this._flat[s]=t),t}let n=e;t&&(n+="B"),i&&(n+="I");let r=this._holey.get(n);if(void 0===r){let s=0;t&&(s|=1),i&&(s|=2),r=this._measure(e,s),r>0&&this._holey.set(n,r)}return r}_measure(e,t){const i=this._measureElements[t];return i.textContent=e.repeat(32),i.offsetWidth/32}}},2223:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TEXT_BASELINE=t.DIM_OPACITY=t.INVERTED_DEFAULT_COLOR=void 0;const s=i(6114);t.INVERTED_DEFAULT_COLOR=257,t.DIM_OPACITY=.5,t.TEXT_BASELINE=s.isFirefox||s.isLegacyEdge?"bottom":"ideographic"},6171:(e,t)=>{function i(e){return 57508<=e&&e<=57558}function s(e){return e>=128512&&e<=128591||e>=127744&&e<=128511||e>=128640&&e<=128767||e>=9728&&e<=9983||e>=9984&&e<=10175||e>=65024&&e<=65039||e>=129280&&e<=129535||e>=127462&&e<=127487}Object.defineProperty(t,"__esModule",{value:!0}),t.computeNextVariantOffset=t.createRenderDimensions=t.treatGlyphAsBackgroundColor=t.allowRescaling=t.isEmoji=t.isRestrictedPowerlineGlyph=t.isPowerlineGlyph=t.throwIfFalsy=void 0,t.throwIfFalsy=function(e){if(!e)throw new Error("value must not be falsy");return e},t.isPowerlineGlyph=i,t.isRestrictedPowerlineGlyph=function(e){return 57520<=e&&e<=57527},t.isEmoji=s,t.allowRescaling=function(e,t,n,r){return 1===t&&n>Math.ceil(1.5*r)&&void 0!==e&&e>255&&!s(e)&&!i(e)&&!function(e){return 57344<=e&&e<=63743}(e)},t.treatGlyphAsBackgroundColor=function(e){return i(e)||function(e){return 9472<=e&&e<=9631}(e)},t.createRenderDimensions=function(){return{css:{canvas:{width:0,height:0},cell:{width:0,height:0}},device:{canvas:{width:0,height:0},cell:{width:0,height:0},char:{width:0,height:0,left:0,top:0}}}},t.computeNextVariantOffset=function(e,t,i=0){return(e-(2*Math.round(t)-i))%(2*Math.round(t))}},6052:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createSelectionRenderModel=void 0;class i{constructor(){this.clear()}clear(){this.hasSelection=!1,this.columnSelectMode=!1,this.viewportStartRow=0,this.viewportEndRow=0,this.viewportCappedStartRow=0,this.viewportCappedEndRow=0,this.startCol=0,this.endCol=0,this.selectionStart=void 0,this.selectionEnd=void 0}update(e,t,i,s=!1){if(this.selectionStart=t,this.selectionEnd=i,!t||!i||t[0]===i[0]&&t[1]===i[1])return void this.clear();const n=e.buffers.active.ydisp,r=t[1]-n,o=i[1]-n,a=Math.max(r,0),l=Math.min(o,e.rows-1);a>=e.rows||l<0?this.clear():(this.hasSelection=!0,this.columnSelectMode=s,this.viewportStartRow=r,this.viewportEndRow=o,this.viewportCappedStartRow=a,this.viewportCappedEndRow=l,this.startCol=t[0],this.endCol=i[0])}isCellSelected(e,t,i){return!!this.hasSelection&&(i-=e.buffer.active.viewportY,this.columnSelectMode?this.startCol<=this.endCol?t>=this.startCol&&i>=this.viewportCappedStartRow&&t<this.endCol&&i<=this.viewportCappedEndRow:t<this.startCol&&i>=this.viewportCappedStartRow&&t>=this.endCol&&i<=this.viewportCappedEndRow:i>this.viewportStartRow&&i<this.viewportEndRow||this.viewportStartRow===this.viewportEndRow&&i===this.viewportStartRow&&t>=this.startCol&&t<this.endCol||this.viewportStartRow<this.viewportEndRow&&i===this.viewportEndRow&&t<this.endCol||this.viewportStartRow<this.viewportEndRow&&i===this.viewportStartRow&&t>=this.startCol)}}t.createSelectionRenderModel=function(){return new i}},456:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SelectionModel=void 0,t.SelectionModel=class{constructor(e){this._bufferService=e,this.isSelectAllActive=!1,this.selectionStartLength=0}clearSelection(){this.selectionStart=void 0,this.selectionEnd=void 0,this.isSelectAllActive=!1,this.selectionStartLength=0}get finalSelectionStart(){return this.isSelectAllActive?[0,0]:this.selectionEnd&&this.selectionStart&&this.areSelectionValuesReversed()?this.selectionEnd:this.selectionStart}get finalSelectionEnd(){if(this.isSelectAllActive)return[this._bufferService.cols,this._bufferService.buffer.ybase+this._bufferService.rows-1];if(this.selectionStart){if(!this.selectionEnd||this.areSelectionValuesReversed()){const e=this.selectionStart[0]+this.selectionStartLength;return e>this._bufferService.cols?e%this._bufferService.cols==0?[this._bufferService.cols,this.selectionStart[1]+Math.floor(e/this._bufferService.cols)-1]:[e%this._bufferService.cols,this.selectionStart[1]+Math.floor(e/this._bufferService.cols)]:[e,this.selectionStart[1]]}if(this.selectionStartLength&&this.selectionEnd[1]===this.selectionStart[1]){const e=this.selectionStart[0]+this.selectionStartLength;return e>this._bufferService.cols?[e%this._bufferService.cols,this.selectionStart[1]+Math.floor(e/this._bufferService.cols)]:[Math.max(e,this.selectionEnd[0]),this.selectionEnd[1]]}return this.selectionEnd}}areSelectionValuesReversed(){const e=this.selectionStart,t=this.selectionEnd;return!(!e||!t)&&(e[1]>t[1]||e[1]===t[1]&&e[0]>t[0])}handleTrim(e){return this.selectionStart&&(this.selectionStart[1]-=e),this.selectionEnd&&(this.selectionEnd[1]-=e),this.selectionEnd&&this.selectionEnd[1]<0?(this.clearSelection(),!0):(this.selectionStart&&this.selectionStart[1]<0&&(this.selectionStart[1]=0),!1)}}},428:function(e,t,i){var s=this&&this.__decorate||function(e,t,i,s){var n,r=arguments.length,o=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,s);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(r<3?n(o):r>3?n(t,i,o):n(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},n=this&&this.__param||function(e,t){return function(i,s){t(i,s,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CharSizeService=void 0;const r=i(2585),o=i(8460),a=i(844);let l=t.CharSizeService=class extends a.Disposable{get hasValidSize(){return this.width>0&&this.height>0}constructor(e,t,i){super(),this._optionsService=i,this.width=0,this.height=0,this._onCharSizeChange=this.register(new o.EventEmitter),this.onCharSizeChange=this._onCharSizeChange.event;try{this._measureStrategy=this.register(new d(this._optionsService))}catch{this._measureStrategy=this.register(new c(e,t,this._optionsService))}this.register(this._optionsService.onMultipleOptionChange(["fontFamily","fontSize"],(()=>this.measure())))}measure(){const e=this._measureStrategy.measure();e.width===this.width&&e.height===this.height||(this.width=e.width,this.height=e.height,this._onCharSizeChange.fire())}};t.CharSizeService=l=s([n(2,r.IOptionsService)],l);class h extends a.Disposable{constructor(){super(...arguments),this._result={width:0,height:0}}_validateAndSet(e,t){void 0!==e&&e>0&&void 0!==t&&t>0&&(this._result.width=e,this._result.height=t)}}class c extends h{constructor(e,t,i){super(),this._document=e,this._parentElement=t,this._optionsService=i,this._measureElement=this._document.createElement("span"),this._measureElement.classList.add("xterm-char-measure-element"),this._measureElement.textContent="W".repeat(32),this._measureElement.setAttribute("aria-hidden","true"),this._measureElement.style.whiteSpace="pre",this._measureElement.style.fontKerning="none",this._parentElement.appendChild(this._measureElement)}measure(){return this._measureElement.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._measureElement.style.fontSize=`${this._optionsService.rawOptions.fontSize}px`,this._validateAndSet(Number(this._measureElement.offsetWidth)/32,Number(this._measureElement.offsetHeight)),this._result}}class d extends h{constructor(e){super(),this._optionsService=e,this._canvas=new OffscreenCanvas(100,100),this._ctx=this._canvas.getContext("2d");const t=this._ctx.measureText("W");if(!("width"in t&&"fontBoundingBoxAscent"in t&&"fontBoundingBoxDescent"in t))throw new Error("Required font metrics not supported")}measure(){this._ctx.font=`${this._optionsService.rawOptions.fontSize}px ${this._optionsService.rawOptions.fontFamily}`;const e=this._ctx.measureText("W");return this._validateAndSet(e.width,e.fontBoundingBoxAscent+e.fontBoundingBoxDescent),this._result}}},4269:function(e,t,i){var s=this&&this.__decorate||function(e,t,i,s){var n,r=arguments.length,o=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,s);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(r<3?n(o):r>3?n(t,i,o):n(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},n=this&&this.__param||function(e,t){return function(i,s){t(i,s,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CharacterJoinerService=t.JoinedCellData=void 0;const r=i(3734),o=i(643),a=i(511),l=i(2585);class h extends r.AttributeData{constructor(e,t,i){super(),this.content=0,this.combinedData="",this.fg=e.fg,this.bg=e.bg,this.combinedData=t,this._width=i}isCombined(){return 2097152}getWidth(){return this._width}getChars(){return this.combinedData}getCode(){return 2097151}setFromCharData(e){throw new Error("not implemented")}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}t.JoinedCellData=h;let c=t.CharacterJoinerService=class e{constructor(e){this._bufferService=e,this._characterJoiners=[],this._nextCharacterJoinerId=0,this._workCell=new a.CellData}register(e){const t={id:this._nextCharacterJoinerId++,handler:e};return this._characterJoiners.push(t),t.id}deregister(e){for(let t=0;t<this._characterJoiners.length;t++)if(this._characterJoiners[t].id===e)return this._characterJoiners.splice(t,1),!0;return!1}getJoinedCharacters(e){if(0===this._characterJoiners.length)return[];const t=this._bufferService.buffer.lines.get(e);if(!t||0===t.length)return[];const i=[],s=t.translateToString(!0);let n=0,r=0,a=0,l=t.getFg(0),h=t.getBg(0);for(let e=0;e<t.getTrimmedLength();e++)if(t.loadCell(e,this._workCell),0!==this._workCell.getWidth()){if(this._workCell.fg!==l||this._workCell.bg!==h){if(e-n>1){const e=this._getJoinedRanges(s,a,r,t,n);for(let t=0;t<e.length;t++)i.push(e[t])}n=e,a=r,l=this._workCell.fg,h=this._workCell.bg}r+=this._workCell.getChars().length||o.WHITESPACE_CELL_CHAR.length}if(this._bufferService.cols-n>1){const e=this._getJoinedRanges(s,a,r,t,n);for(let t=0;t<e.length;t++)i.push(e[t])}return i}_getJoinedRanges(t,i,s,n,r){const o=t.substring(i,s);let a=[];try{a=this._characterJoiners[0].handler(o)}catch(e){console.error(e)}for(let t=1;t<this._characterJoiners.length;t++)try{const i=this._characterJoiners[t].handler(o);for(let t=0;t<i.length;t++)e._mergeRanges(a,i[t])}catch(e){console.error(e)}return this._stringRangesToCellRanges(a,n,r),a}_stringRangesToCellRanges(e,t,i){let s=0,n=!1,r=0,a=e[s];if(a){for(let l=i;l<this._bufferService.cols;l++){const i=t.getWidth(l),h=t.getString(l).length||o.WHITESPACE_CELL_CHAR.length;if(0!==i){if(!n&&a[0]<=r&&(a[0]=l,n=!0),a[1]<=r){if(a[1]=l,a=e[++s],!a)break;a[0]<=r?(a[0]=l,n=!0):n=!1}r+=h}}a&&(a[1]=this._bufferService.cols)}}static _mergeRanges(e,t){let i=!1;for(let s=0;s<e.length;s++){const n=e[s];if(i){if(t[1]<=n[0])return e[s-1][1]=t[1],e;if(t[1]<=n[1])return e[s-1][1]=Math.max(t[1],n[1]),e.splice(s,1),e;e.splice(s,1),s--}else{if(t[1]<=n[0])return e.splice(s,0,t),e;if(t[1]<=n[1])return n[0]=Math.min(t[0],n[0]),e;t[0]<n[1]&&(n[0]=Math.min(t[0],n[0]),i=!0)}}return i?e[e.length-1][1]=t[1]:e.push(t),e}};t.CharacterJoinerService=c=s([n(0,l.IBufferService)],c)},5114:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CoreBrowserService=void 0;const s=i(844),n=i(8460),r=i(3656);class o extends s.Disposable{constructor(e,t,i){super(),this._textarea=e,this._window=t,this.mainDocument=i,this._isFocused=!1,this._cachedIsFocused=void 0,this._screenDprMonitor=new a(this._window),this._onDprChange=this.register(new n.EventEmitter),this.onDprChange=this._onDprChange.event,this._onWindowChange=this.register(new n.EventEmitter),this.onWindowChange=this._onWindowChange.event,this.register(this.onWindowChange((e=>this._screenDprMonitor.setWindow(e)))),this.register((0,n.forwardEvent)(this._screenDprMonitor.onDprChange,this._onDprChange)),this._textarea.addEventListener("focus",(()=>this._isFocused=!0)),this._textarea.addEventListener("blur",(()=>this._isFocused=!1))}get window(){return this._window}set window(e){this._window!==e&&(this._window=e,this._onWindowChange.fire(this._window))}get dpr(){return this.window.devicePixelRatio}get isFocused(){return void 0===this._cachedIsFocused&&(this._cachedIsFocused=this._isFocused&&this._textarea.ownerDocument.hasFocus(),queueMicrotask((()=>this._cachedIsFocused=void 0))),this._cachedIsFocused}}t.CoreBrowserService=o;class a extends s.Disposable{constructor(e){super(),this._parentWindow=e,this._windowResizeListener=this.register(new s.MutableDisposable),this._onDprChange=this.register(new n.EventEmitter),this.onDprChange=this._onDprChange.event,this._outerListener=()=>this._setDprAndFireIfDiffers(),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._updateDpr(),this._setWindowResizeListener(),this.register((0,s.toDisposable)((()=>this.clearListener())))}setWindow(e){this._parentWindow=e,this._setWindowResizeListener(),this._setDprAndFireIfDiffers()}_setWindowResizeListener(){this._windowResizeListener.value=(0,r.addDisposableDomListener)(this._parentWindow,"resize",(()=>this._setDprAndFireIfDiffers()))}_setDprAndFireIfDiffers(){this._parentWindow.devicePixelRatio!==this._currentDevicePixelRatio&&this._onDprChange.fire(this._parentWindow.devicePixelRatio),this._updateDpr()}_updateDpr(){this._outerListener&&(this._resolutionMediaMatchList?.removeListener(this._outerListener),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._resolutionMediaMatchList=this._parentWindow.matchMedia(`screen and (resolution: ${this._parentWindow.devicePixelRatio}dppx)`),this._resolutionMediaMatchList.addListener(this._outerListener))}clearListener(){this._resolutionMediaMatchList&&this._outerListener&&(this._resolutionMediaMatchList.removeListener(this._outerListener),this._resolutionMediaMatchList=void 0,this._outerListener=void 0)}}},779:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LinkProviderService=void 0;const s=i(844);class n extends s.Disposable{constructor(){super(),this.linkProviders=[],this.register((0,s.toDisposable)((()=>this.linkProviders.length=0)))}registerLinkProvider(e){return this.linkProviders.push(e),{dispose:()=>{const t=this.linkProviders.indexOf(e);-1!==t&&this.linkProviders.splice(t,1)}}}}t.LinkProviderService=n},8934:function(e,t,i){var s=this&&this.__decorate||function(e,t,i,s){var n,r=arguments.length,o=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,s);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(r<3?n(o):r>3?n(t,i,o):n(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},n=this&&this.__param||function(e,t){return function(i,s){t(i,s,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.MouseService=void 0;const r=i(4725),o=i(9806);let a=t.MouseService=class{constructor(e,t){this._renderService=e,this._charSizeService=t}getCoords(e,t,i,s,n){return(0,o.getCoords)(window,e,t,i,s,this._charSizeService.hasValidSize,this._renderService.dimensions.css.cell.width,this._renderService.dimensions.css.cell.height,n)}getMouseReportCoords(e,t){const i=(0,o.getCoordsRelativeToElement)(window,e,t);if(this._charSizeService.hasValidSize)return i[0]=Math.min(Math.max(i[0],0),this._renderService.dimensions.css.canvas.width-1),i[1]=Math.min(Math.max(i[1],0),this._renderService.dimensions.css.canvas.height-1),{col:Math.floor(i[0]/this._renderService.dimensions.css.cell.width),row:Math.floor(i[1]/this._renderService.dimensions.css.cell.height),x:Math.floor(i[0]),y:Math.floor(i[1])}}};t.MouseService=a=s([n(0,r.IRenderService),n(1,r.ICharSizeService)],a)},3230:function(e,t,i){var s=this&&this.__decorate||function(e,t,i,s){var n,r=arguments.length,o=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,s);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(r<3?n(o):r>3?n(t,i,o):n(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},n=this&&this.__param||function(e,t){return function(i,s){t(i,s,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.RenderService=void 0;const r=i(6193),o=i(4725),a=i(8460),l=i(844),h=i(7226),c=i(2585);let d=t.RenderService=class extends l.Disposable{get dimensions(){return this._renderer.value.dimensions}constructor(e,t,i,s,n,o,c,d){super(),this._rowCount=e,this._charSizeService=s,this._renderer=this.register(new l.MutableDisposable),this._pausedResizeTask=new h.DebouncedIdleTask,this._observerDisposable=this.register(new l.MutableDisposable),this._isPaused=!1,this._needsFullRefresh=!1,this._isNextRenderRedrawOnly=!0,this._needsSelectionRefresh=!1,this._canvasWidth=0,this._canvasHeight=0,this._selectionState={start:void 0,end:void 0,columnSelectMode:!1},this._onDimensionsChange=this.register(new a.EventEmitter),this.onDimensionsChange=this._onDimensionsChange.event,this._onRenderedViewportChange=this.register(new a.EventEmitter),this.onRenderedViewportChange=this._onRenderedViewportChange.event,this._onRender=this.register(new a.EventEmitter),this.onRender=this._onRender.event,this._onRefreshRequest=this.register(new a.EventEmitter),this.onRefreshRequest=this._onRefreshRequest.event,this._renderDebouncer=new r.RenderDebouncer(((e,t)=>this._renderRows(e,t)),c),this.register(this._renderDebouncer),this.register(c.onDprChange((()=>this.handleDevicePixelRatioChange()))),this.register(o.onResize((()=>this._fullRefresh()))),this.register(o.buffers.onBufferActivate((()=>this._renderer.value?.clear()))),this.register(i.onOptionChange((()=>this._handleOptionsChanged()))),this.register(this._charSizeService.onCharSizeChange((()=>this.handleCharSizeChanged()))),this.register(n.onDecorationRegistered((()=>this._fullRefresh()))),this.register(n.onDecorationRemoved((()=>this._fullRefresh()))),this.register(i.onMultipleOptionChange(["customGlyphs","drawBoldTextInBrightColors","letterSpacing","lineHeight","fontFamily","fontSize","fontWeight","fontWeightBold","minimumContrastRatio","rescaleOverlappingGlyphs"],(()=>{this.clear(),this.handleResize(o.cols,o.rows),this._fullRefresh()}))),this.register(i.onMultipleOptionChange(["cursorBlink","cursorStyle"],(()=>this.refreshRows(o.buffer.y,o.buffer.y,!0)))),this.register(d.onChangeColors((()=>this._fullRefresh()))),this._registerIntersectionObserver(c.window,t),this.register(c.onWindowChange((e=>this._registerIntersectionObserver(e,t))))}_registerIntersectionObserver(e,t){if("IntersectionObserver"in e){const i=new e.IntersectionObserver((e=>this._handleIntersectionChange(e[e.length-1])),{threshold:0});i.observe(t),this._observerDisposable.value=(0,l.toDisposable)((()=>i.disconnect()))}}_handleIntersectionChange(e){this._isPaused=void 0===e.isIntersecting?0===e.intersectionRatio:!e.isIntersecting,this._isPaused||this._charSizeService.hasValidSize||this._charSizeService.measure(),!this._isPaused&&this._needsFullRefresh&&(this._pausedResizeTask.flush(),this.refreshRows(0,this._rowCount-1),this._needsFullRefresh=!1)}refreshRows(e,t,i=!1){this._isPaused?this._needsFullRefresh=!0:(i||(this._isNextRenderRedrawOnly=!1),this._renderDebouncer.refresh(e,t,this._rowCount))}_renderRows(e,t){this._renderer.value&&(e=Math.min(e,this._rowCount-1),t=Math.min(t,this._rowCount-1),this._renderer.value.renderRows(e,t),this._needsSelectionRefresh&&(this._renderer.value.handleSelectionChanged(this._selectionState.start,this._selectionState.end,this._selectionState.columnSelectMode),this._needsSelectionRefresh=!1),this._isNextRenderRedrawOnly||this._onRenderedViewportChange.fire({start:e,end:t}),this._onRender.fire({start:e,end:t}),this._isNextRenderRedrawOnly=!0)}resize(e,t){this._rowCount=t,this._fireOnCanvasResize()}_handleOptionsChanged(){this._renderer.value&&(this.refreshRows(0,this._rowCount-1),this._fireOnCanvasResize())}_fireOnCanvasResize(){this._renderer.value&&(this._renderer.value.dimensions.css.canvas.width===this._canvasWidth&&this._renderer.value.dimensions.css.canvas.height===this._canvasHeight||this._onDimensionsChange.fire(this._renderer.value.dimensions))}hasRenderer(){return!!this._renderer.value}setRenderer(e){this._renderer.value=e,this._renderer.value&&(this._renderer.value.onRequestRedraw((e=>this.refreshRows(e.start,e.end,!0))),this._needsSelectionRefresh=!0,this._fullRefresh())}addRefreshCallback(e){return this._renderDebouncer.addRefreshCallback(e)}_fullRefresh(){this._isPaused?this._needsFullRefresh=!0:this.refreshRows(0,this._rowCount-1)}clearTextureAtlas(){this._renderer.value&&(this._renderer.value.clearTextureAtlas?.(),this._fullRefresh())}handleDevicePixelRatioChange(){this._charSizeService.measure(),this._renderer.value&&(this._renderer.value.handleDevicePixelRatioChange(),this.refreshRows(0,this._rowCount-1))}handleResize(e,t){this._renderer.value&&(this._isPaused?this._pausedResizeTask.set((()=>this._renderer.value?.handleResize(e,t))):this._renderer.value.handleResize(e,t),this._fullRefresh())}handleCharSizeChanged(){this._renderer.value?.handleCharSizeChanged()}handleBlur(){this._renderer.value?.handleBlur()}handleFocus(){this._renderer.value?.handleFocus()}handleSelectionChanged(e,t,i){this._selectionState.start=e,this._selectionState.end=t,this._selectionState.columnSelectMode=i,this._renderer.value?.handleSelectionChanged(e,t,i)}handleCursorMove(){this._renderer.value?.handleCursorMove()}clear(){this._renderer.value?.clear()}};t.RenderService=d=s([n(2,c.IOptionsService),n(3,o.ICharSizeService),n(4,c.IDecorationService),n(5,c.IBufferService),n(6,o.ICoreBrowserService),n(7,o.IThemeService)],d)},9312:function(e,t,i){var s=this&&this.__decorate||function(e,t,i,s){var n,r=arguments.length,o=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,s);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(r<3?n(o):r>3?n(t,i,o):n(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},n=this&&this.__param||function(e,t){return function(i,s){t(i,s,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.SelectionService=void 0;const r=i(9806),o=i(9504),a=i(456),l=i(4725),h=i(8460),c=i(844),d=i(6114),u=i(4841),p=i(511),m=i(2585),f=String.fromCharCode(160),g=new RegExp(f,"g");let _=t.SelectionService=class extends c.Disposable{constructor(e,t,i,s,n,r,o,l,d){super(),this._element=e,this._screenElement=t,this._linkifier=i,this._bufferService=s,this._coreService=n,this._mouseService=r,this._optionsService=o,this._renderService=l,this._coreBrowserService=d,this._dragScrollAmount=0,this._enabled=!0,this._workCell=new p.CellData,this._mouseDownTimeStamp=0,this._oldHasSelection=!1,this._oldSelectionStart=void 0,this._oldSelectionEnd=void 0,this._onLinuxMouseSelection=this.register(new h.EventEmitter),this.onLinuxMouseSelection=this._onLinuxMouseSelection.event,this._onRedrawRequest=this.register(new h.EventEmitter),this.onRequestRedraw=this._onRedrawRequest.event,this._onSelectionChange=this.register(new h.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onRequestScrollLines=this.register(new h.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this._mouseMoveListener=e=>this._handleMouseMove(e),this._mouseUpListener=e=>this._handleMouseUp(e),this._coreService.onUserInput((()=>{this.hasSelection&&this.clearSelection()})),this._trimListener=this._bufferService.buffer.lines.onTrim((e=>this._handleTrim(e))),this.register(this._bufferService.buffers.onBufferActivate((e=>this._handleBufferActivate(e)))),this.enable(),this._model=new a.SelectionModel(this._bufferService),this._activeSelectionMode=0,this.register((0,c.toDisposable)((()=>{this._removeMouseDownListeners()})))}reset(){this.clearSelection()}disable(){this.clearSelection(),this._enabled=!1}enable(){this._enabled=!0}get selectionStart(){return this._model.finalSelectionStart}get selectionEnd(){return this._model.finalSelectionEnd}get hasSelection(){const e=this._model.finalSelectionStart,t=this._model.finalSelectionEnd;return!(!e||!t||e[0]===t[0]&&e[1]===t[1])}get selectionText(){const e=this._model.finalSelectionStart,t=this._model.finalSelectionEnd;if(!e||!t)return"";const i=this._bufferService.buffer,s=[];if(3===this._activeSelectionMode){if(e[0]===t[0])return"";const n=e[0]<t[0]?e[0]:t[0],r=e[0]<t[0]?t[0]:e[0];for(let o=e[1];o<=t[1];o++){const e=i.translateBufferLineToString(o,!0,n,r);s.push(e)}}else{const n=e[1]===t[1]?t[0]:void 0;s.push(i.translateBufferLineToString(e[1],!0,e[0],n));for(let n=e[1]+1;n<=t[1]-1;n++){const e=i.lines.get(n),t=i.translateBufferLineToString(n,!0);e?.isWrapped?s[s.length-1]+=t:s.push(t)}if(e[1]!==t[1]){const e=i.lines.get(t[1]),n=i.translateBufferLineToString(t[1],!0,0,t[0]);e&&e.isWrapped?s[s.length-1]+=n:s.push(n)}}return s.map((e=>e.replace(g," "))).join(d.isWindows?"\r\n":"\n")}clearSelection(){this._model.clearSelection(),this._removeMouseDownListeners(),this.refresh(),this._onSelectionChange.fire()}refresh(e){this._refreshAnimationFrame||(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame((()=>this._refresh()))),d.isLinux&&e&&this.selectionText.length&&this._onLinuxMouseSelection.fire(this.selectionText)}_refresh(){this._refreshAnimationFrame=void 0,this._onRedrawRequest.fire({start:this._model.finalSelectionStart,end:this._model.finalSelectionEnd,columnSelectMode:3===this._activeSelectionMode})}_isClickInSelection(e){const t=this._getMouseBufferCoords(e),i=this._model.finalSelectionStart,s=this._model.finalSelectionEnd;return!!(i&&s&&t)&&this._areCoordsInSelection(t,i,s)}isCellInSelection(e,t){const i=this._model.finalSelectionStart,s=this._model.finalSelectionEnd;return!(!i||!s)&&this._areCoordsInSelection([e,t],i,s)}_areCoordsInSelection(e,t,i){return e[1]>t[1]&&e[1]<i[1]||t[1]===i[1]&&e[1]===t[1]&&e[0]>=t[0]&&e[0]<i[0]||t[1]<i[1]&&e[1]===i[1]&&e[0]<i[0]||t[1]<i[1]&&e[1]===t[1]&&e[0]>=t[0]}_selectWordAtCursor(e,t){const i=this._linkifier.currentLink?.link?.range;if(i)return this._model.selectionStart=[i.start.x-1,i.start.y-1],this._model.selectionStartLength=(0,u.getRangeLength)(i,this._bufferService.cols),this._model.selectionEnd=void 0,!0;const s=this._getMouseBufferCoords(e);return!!s&&(this._selectWordAt(s,t),this._model.selectionEnd=void 0,!0)}selectAll(){this._model.isSelectAllActive=!0,this.refresh(),this._onSelectionChange.fire()}selectLines(e,t){this._model.clearSelection(),e=Math.max(e,0),t=Math.min(t,this._bufferService.buffer.lines.length-1),this._model.selectionStart=[0,e],this._model.selectionEnd=[this._bufferService.cols,t],this.refresh(),this._onSelectionChange.fire()}_handleTrim(e){this._model.handleTrim(e)&&this.refresh()}_getMouseBufferCoords(e){const t=this._mouseService.getCoords(e,this._screenElement,this._bufferService.cols,this._bufferService.rows,!0);if(t)return t[0]--,t[1]--,t[1]+=this._bufferService.buffer.ydisp,t}_getMouseEventScrollAmount(e){let t=(0,r.getCoordsRelativeToElement)(this._coreBrowserService.window,e,this._screenElement)[1];const i=this._renderService.dimensions.css.canvas.height;return t>=0&&t<=i?0:(t>i&&(t-=i),t=Math.min(Math.max(t,-50),50),t/=50,t/Math.abs(t)+Math.round(14*t))}shouldForceSelection(e){return d.isMac?e.altKey&&this._optionsService.rawOptions.macOptionClickForcesSelection:e.shiftKey}handleMouseDown(e){if(this._mouseDownTimeStamp=e.timeStamp,(2!==e.button||!this.hasSelection)&&0===e.button){if(!this._enabled){if(!this.shouldForceSelection(e))return;e.stopPropagation()}e.preventDefault(),this._dragScrollAmount=0,this._enabled&&e.shiftKey?this._handleIncrementalClick(e):1===e.detail?this._handleSingleClick(e):2===e.detail?this._handleDoubleClick(e):3===e.detail&&this._handleTripleClick(e),this._addMouseDownListeners(),this.refresh(!0)}}_addMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.addEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.addEventListener("mouseup",this._mouseUpListener)),this._dragScrollIntervalTimer=this._coreBrowserService.window.setInterval((()=>this._dragScroll()),50)}_removeMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.removeEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.removeEventListener("mouseup",this._mouseUpListener)),this._coreBrowserService.window.clearInterval(this._dragScrollIntervalTimer),this._dragScrollIntervalTimer=void 0}_handleIncrementalClick(e){this._model.selectionStart&&(this._model.selectionEnd=this._getMouseBufferCoords(e))}_handleSingleClick(e){if(this._model.selectionStartLength=0,this._model.isSelectAllActive=!1,this._activeSelectionMode=this.shouldColumnSelect(e)?3:0,this._model.selectionStart=this._getMouseBufferCoords(e),!this._model.selectionStart)return;this._model.selectionEnd=void 0;const t=this._bufferService.buffer.lines.get(this._model.selectionStart[1]);t&&t.length!==this._model.selectionStart[0]&&0===t.hasWidth(this._model.selectionStart[0])&&this._model.selectionStart[0]++}_handleDoubleClick(e){this._selectWordAtCursor(e,!0)&&(this._activeSelectionMode=1)}_handleTripleClick(e){const t=this._getMouseBufferCoords(e);t&&(this._activeSelectionMode=2,this._selectLineAt(t[1]))}shouldColumnSelect(e){return e.altKey&&!(d.isMac&&this._optionsService.rawOptions.macOptionClickForcesSelection)}_handleMouseMove(e){if(e.stopImmediatePropagation(),!this._model.selectionStart)return;const t=this._model.selectionEnd?[this._model.selectionEnd[0],this._model.selectionEnd[1]]:null;if(this._model.selectionEnd=this._getMouseBufferCoords(e),!this._model.selectionEnd)return void this.refresh(!0);2===this._activeSelectionMode?this._model.selectionEnd[1]<this._model.selectionStart[1]?this._model.selectionEnd[0]=0:this._model.selectionEnd[0]=this._bufferService.cols:1===this._activeSelectionMode&&this._selectToWordAt(this._model.selectionEnd),this._dragScrollAmount=this._getMouseEventScrollAmount(e),3!==this._activeSelectionMode&&(this._dragScrollAmount>0?this._model.selectionEnd[0]=this._bufferService.cols:this._dragScrollAmount<0&&(this._model.selectionEnd[0]=0));const i=this._bufferService.buffer;if(this._model.selectionEnd[1]<i.lines.length){const e=i.lines.get(this._model.selectionEnd[1]);e&&0===e.hasWidth(this._model.selectionEnd[0])&&this._model.selectionEnd[0]<this._bufferService.cols&&this._model.selectionEnd[0]++}t&&t[0]===this._model.selectionEnd[0]&&t[1]===this._model.selectionEnd[1]||this.refresh(!0)}_dragScroll(){if(this._model.selectionEnd&&this._model.selectionStart&&this._dragScrollAmount){this._onRequestScrollLines.fire({amount:this._dragScrollAmount,suppressScrollEvent:!1});const e=this._bufferService.buffer;this._dragScrollAmount>0?(3!==this._activeSelectionMode&&(this._model.selectionEnd[0]=this._bufferService.cols),this._model.selectionEnd[1]=Math.min(e.ydisp+this._bufferService.rows,e.lines.length-1)):(3!==this._activeSelectionMode&&(this._model.selectionEnd[0]=0),this._model.selectionEnd[1]=e.ydisp),this.refresh()}}_handleMouseUp(e){const t=e.timeStamp-this._mouseDownTimeStamp;if(this._removeMouseDownListeners(),this.selectionText.length<=1&&t<500&&e.altKey&&this._optionsService.rawOptions.altClickMovesCursor){if(this._bufferService.buffer.ybase===this._bufferService.buffer.ydisp){const t=this._mouseService.getCoords(e,this._element,this._bufferService.cols,this._bufferService.rows,!1);if(t&&void 0!==t[0]&&void 0!==t[1]){const e=(0,o.moveToCellSequence)(t[0]-1,t[1]-1,this._bufferService,this._coreService.decPrivateModes.applicationCursorKeys);this._coreService.triggerDataEvent(e,!0)}}}else this._fireEventIfSelectionChanged()}_fireEventIfSelectionChanged(){const e=this._model.finalSelectionStart,t=this._model.finalSelectionEnd,i=!(!e||!t||e[0]===t[0]&&e[1]===t[1]);i?e&&t&&(this._oldSelectionStart&&this._oldSelectionEnd&&e[0]===this._oldSelectionStart[0]&&e[1]===this._oldSelectionStart[1]&&t[0]===this._oldSelectionEnd[0]&&t[1]===this._oldSelectionEnd[1]||this._fireOnSelectionChange(e,t,i)):this._oldHasSelection&&this._fireOnSelectionChange(e,t,i)}_fireOnSelectionChange(e,t,i){this._oldSelectionStart=e,this._oldSelectionEnd=t,this._oldHasSelection=i,this._onSelectionChange.fire()}_handleBufferActivate(e){this.clearSelection(),this._trimListener.dispose(),this._trimListener=e.activeBuffer.lines.onTrim((e=>this._handleTrim(e)))}_convertViewportColToCharacterIndex(e,t){let i=t;for(let s=0;t>=s;s++){const n=e.loadCell(s,this._workCell).getChars().length;0===this._workCell.getWidth()?i--:n>1&&t!==s&&(i+=n-1)}return i}setSelection(e,t,i){this._model.clearSelection(),this._removeMouseDownListeners(),this._model.selectionStart=[e,t],this._model.selectionStartLength=i,this.refresh(),this._fireEventIfSelectionChanged()}rightClickSelect(e){this._isClickInSelection(e)||(this._selectWordAtCursor(e,!1)&&this.refresh(!0),this._fireEventIfSelectionChanged())}_getWordAt(e,t,i=!0,s=!0){if(e[0]>=this._bufferService.cols)return;const n=this._bufferService.buffer,r=n.lines.get(e[1]);if(!r)return;const o=n.translateBufferLineToString(e[1],!1);let a=this._convertViewportColToCharacterIndex(r,e[0]),l=a;const h=e[0]-a;let c=0,d=0,u=0,p=0;if(" "===o.charAt(a)){for(;a>0&&" "===o.charAt(a-1);)a--;for(;l<o.length&&" "===o.charAt(l+1);)l++}else{let t=e[0],i=e[0];0===r.getWidth(t)&&(c++,t--),2===r.getWidth(i)&&(d++,i++);const s=r.getString(i).length;for(s>1&&(p+=s-1,l+=s-1);t>0&&a>0&&!this._isCharWordSeparator(r.loadCell(t-1,this._workCell));){r.loadCell(t-1,this._workCell);const e=this._workCell.getChars().length;0===this._workCell.getWidth()?(c++,t--):e>1&&(u+=e-1,a-=e-1),a--,t--}for(;i<r.length&&l+1<o.length&&!this._isCharWordSeparator(r.loadCell(i+1,this._workCell));){r.loadCell(i+1,this._workCell);const e=this._workCell.getChars().length;2===this._workCell.getWidth()?(d++,i++):e>1&&(p+=e-1,l+=e-1),l++,i++}}l++;let m=a+h-c+u,f=Math.min(this._bufferService.cols,l-a+c+d-u-p);if(t||""!==o.slice(a,l).trim()){if(i&&0===m&&32!==r.getCodePoint(0)){const t=n.lines.get(e[1]-1);if(t&&r.isWrapped&&32!==t.getCodePoint(this._bufferService.cols-1)){const t=this._getWordAt([this._bufferService.cols-1,e[1]-1],!1,!0,!1);if(t){const e=this._bufferService.cols-t.start;m-=e,f+=e}}}if(s&&m+f===this._bufferService.cols&&32!==r.getCodePoint(this._bufferService.cols-1)){const t=n.lines.get(e[1]+1);if(t?.isWrapped&&32!==t.getCodePoint(0)){const t=this._getWordAt([0,e[1]+1],!1,!1,!0);t&&(f+=t.length)}}return{start:m,length:f}}}_selectWordAt(e,t){const i=this._getWordAt(e,t);if(i){for(;i.start<0;)i.start+=this._bufferService.cols,e[1]--;this._model.selectionStart=[i.start,e[1]],this._model.selectionStartLength=i.length}}_selectToWordAt(e){const t=this._getWordAt(e,!0);if(t){let i=e[1];for(;t.start<0;)t.start+=this._bufferService.cols,i--;if(!this._model.areSelectionValuesReversed())for(;t.start+t.length>this._bufferService.cols;)t.length-=this._bufferService.cols,i++;this._model.selectionEnd=[this._model.areSelectionValuesReversed()?t.start:t.start+t.length,i]}}_isCharWordSeparator(e){return 0!==e.getWidth()&&this._optionsService.rawOptions.wordSeparator.indexOf(e.getChars())>=0}_selectLineAt(e){const t=this._bufferService.buffer.getWrappedRangeForLine(e),i={start:{x:0,y:t.first},end:{x:this._bufferService.cols-1,y:t.last}};this._model.selectionStart=[0,t.first],this._model.selectionEnd=void 0,this._model.selectionStartLength=(0,u.getRangeLength)(i,this._bufferService.cols)}};t.SelectionService=_=s([n(3,m.IBufferService),n(4,m.ICoreService),n(5,l.IMouseService),n(6,m.IOptionsService),n(7,l.IRenderService),n(8,l.ICoreBrowserService)],_)},4725:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ILinkProviderService=t.IThemeService=t.ICharacterJoinerService=t.ISelectionService=t.IRenderService=t.IMouseService=t.ICoreBrowserService=t.ICharSizeService=void 0;const s=i(8343);t.ICharSizeService=(0,s.createDecorator)("CharSizeService"),t.ICoreBrowserService=(0,s.createDecorator)("CoreBrowserService"),t.IMouseService=(0,s.createDecorator)("MouseService"),t.IRenderService=(0,s.createDecorator)("RenderService"),t.ISelectionService=(0,s.createDecorator)("SelectionService"),t.ICharacterJoinerService=(0,s.createDecorator)("CharacterJoinerService"),t.IThemeService=(0,s.createDecorator)("ThemeService"),t.ILinkProviderService=(0,s.createDecorator)("LinkProviderService")},6731:function(e,t,i){var s=this&&this.__decorate||function(e,t,i,s){var n,r=arguments.length,o=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,s);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(r<3?n(o):r>3?n(t,i,o):n(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},n=this&&this.__param||function(e,t){return function(i,s){t(i,s,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ThemeService=t.DEFAULT_ANSI_COLORS=void 0;const r=i(7239),o=i(8055),a=i(8460),l=i(844),h=i(2585),c=o.css.toColor("#ffffff"),d=o.css.toColor("#000000"),u=o.css.toColor("#ffffff"),p=o.css.toColor("#000000"),m={css:"rgba(255, 255, 255, 0.3)",rgba:4294967117};t.DEFAULT_ANSI_COLORS=Object.freeze((()=>{const e=[o.css.toColor("#2e3436"),o.css.toColor("#cc0000"),o.css.toColor("#4e9a06"),o.css.toColor("#c4a000"),o.css.toColor("#3465a4"),o.css.toColor("#75507b"),o.css.toColor("#06989a"),o.css.toColor("#d3d7cf"),o.css.toColor("#555753"),o.css.toColor("#ef2929"),o.css.toColor("#8ae234"),o.css.toColor("#fce94f"),o.css.toColor("#729fcf"),o.css.toColor("#ad7fa8"),o.css.toColor("#34e2e2"),o.css.toColor("#eeeeec")],t=[0,95,135,175,215,255];for(let i=0;i<216;i++){const s=t[i/36%6|0],n=t[i/6%6|0],r=t[i%6];e.push({css:o.channels.toCss(s,n,r),rgba:o.channels.toRgba(s,n,r)})}for(let t=0;t<24;t++){const i=8+10*t;e.push({css:o.channels.toCss(i,i,i),rgba:o.channels.toRgba(i,i,i)})}return e})());let f=t.ThemeService=class extends l.Disposable{get colors(){return this._colors}constructor(e){super(),this._optionsService=e,this._contrastCache=new r.ColorContrastCache,this._halfContrastCache=new r.ColorContrastCache,this._onChangeColors=this.register(new a.EventEmitter),this.onChangeColors=this._onChangeColors.event,this._colors={foreground:c,background:d,cursor:u,cursorAccent:p,selectionForeground:void 0,selectionBackgroundTransparent:m,selectionBackgroundOpaque:o.color.blend(d,m),selectionInactiveBackgroundTransparent:m,selectionInactiveBackgroundOpaque:o.color.blend(d,m),ansi:t.DEFAULT_ANSI_COLORS.slice(),contrastCache:this._contrastCache,halfContrastCache:this._halfContrastCache},this._updateRestoreColors(),this._setTheme(this._optionsService.rawOptions.theme),this.register(this._optionsService.onSpecificOptionChange("minimumContrastRatio",(()=>this._contrastCache.clear()))),this.register(this._optionsService.onSpecificOptionChange("theme",(()=>this._setTheme(this._optionsService.rawOptions.theme))))}_setTheme(e={}){const i=this._colors;if(i.foreground=g(e.foreground,c),i.background=g(e.background,d),i.cursor=g(e.cursor,u),i.cursorAccent=g(e.cursorAccent,p),i.selectionBackgroundTransparent=g(e.selectionBackground,m),i.selectionBackgroundOpaque=o.color.blend(i.background,i.selectionBackgroundTransparent),i.selectionInactiveBackgroundTransparent=g(e.selectionInactiveBackground,i.selectionBackgroundTransparent),i.selectionInactiveBackgroundOpaque=o.color.blend(i.background,i.selectionInactiveBackgroundTransparent),i.selectionForeground=e.selectionForeground?g(e.selectionForeground,o.NULL_COLOR):void 0,i.selectionForeground===o.NULL_COLOR&&(i.selectionForeground=void 0),o.color.isOpaque(i.selectionBackgroundTransparent)){const e=.3;i.selectionBackgroundTransparent=o.color.opacity(i.selectionBackgroundTransparent,e)}if(o.color.isOpaque(i.selectionInactiveBackgroundTransparent)){const e=.3;i.selectionInactiveBackgroundTransparent=o.color.opacity(i.selectionInactiveBackgroundTransparent,e)}if(i.ansi=t.DEFAULT_ANSI_COLORS.slice(),i.ansi[0]=g(e.black,t.DEFAULT_ANSI_COLORS[0]),i.ansi[1]=g(e.red,t.DEFAULT_ANSI_COLORS[1]),i.ansi[2]=g(e.green,t.DEFAULT_ANSI_COLORS[2]),i.ansi[3]=g(e.yellow,t.DEFAULT_ANSI_COLORS[3]),i.ansi[4]=g(e.blue,t.DEFAULT_ANSI_COLORS[4]),i.ansi[5]=g(e.magenta,t.DEFAULT_ANSI_COLORS[5]),i.ansi[6]=g(e.cyan,t.DEFAULT_ANSI_COLORS[6]),i.ansi[7]=g(e.white,t.DEFAULT_ANSI_COLORS[7]),i.ansi[8]=g(e.brightBlack,t.DEFAULT_ANSI_COLORS[8]),i.ansi[9]=g(e.brightRed,t.DEFAULT_ANSI_COLORS[9]),i.ansi[10]=g(e.brightGreen,t.DEFAULT_ANSI_COLORS[10]),i.ansi[11]=g(e.brightYellow,t.DEFAULT_ANSI_COLORS[11]),i.ansi[12]=g(e.brightBlue,t.DEFAULT_ANSI_COLORS[12]),i.ansi[13]=g(e.brightMagenta,t.DEFAULT_ANSI_COLORS[13]),i.ansi[14]=g(e.brightCyan,t.DEFAULT_ANSI_COLORS[14]),i.ansi[15]=g(e.brightWhite,t.DEFAULT_ANSI_COLORS[15]),e.extendedAnsi){const s=Math.min(i.ansi.length-16,e.extendedAnsi.length);for(let n=0;n<s;n++)i.ansi[n+16]=g(e.extendedAnsi[n],t.DEFAULT_ANSI_COLORS[n+16])}this._contrastCache.clear(),this._halfContrastCache.clear(),this._updateRestoreColors(),this._onChangeColors.fire(this.colors)}restoreColor(e){this._restoreColor(e),this._onChangeColors.fire(this.colors)}_restoreColor(e){if(void 0!==e)switch(e){case 256:this._colors.foreground=this._restoreColors.foreground;break;case 257:this._colors.background=this._restoreColors.background;break;case 258:this._colors.cursor=this._restoreColors.cursor;break;default:this._colors.ansi[e]=this._restoreColors.ansi[e]}else for(let e=0;e<this._restoreColors.ansi.length;++e)this._colors.ansi[e]=this._restoreColors.ansi[e]}modifyColors(e){e(this._colors),this._onChangeColors.fire(this.colors)}_updateRestoreColors(){this._restoreColors={foreground:this._colors.foreground,background:this._colors.background,cursor:this._colors.cursor,ansi:this._colors.ansi.slice()}}};function g(e,t){if(void 0!==e)try{return o.css.toColor(e)}catch{}return t}t.ThemeService=f=s([n(0,h.IOptionsService)],f)},6349:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CircularList=void 0;const s=i(8460),n=i(844);class r extends n.Disposable{constructor(e){super(),this._maxLength=e,this.onDeleteEmitter=this.register(new s.EventEmitter),this.onDelete=this.onDeleteEmitter.event,this.onInsertEmitter=this.register(new s.EventEmitter),this.onInsert=this.onInsertEmitter.event,this.onTrimEmitter=this.register(new s.EventEmitter),this.onTrim=this.onTrimEmitter.event,this._array=new Array(this._maxLength),this._startIndex=0,this._length=0}get maxLength(){return this._maxLength}set maxLength(e){if(this._maxLength===e)return;const t=new Array(e);for(let i=0;i<Math.min(e,this.length);i++)t[i]=this._array[this._getCyclicIndex(i)];this._array=t,this._maxLength=e,this._startIndex=0}get length(){return this._length}set length(e){if(e>this._length)for(let t=this._length;t<e;t++)this._array[t]=void 0;this._length=e}get(e){return this._array[this._getCyclicIndex(e)]}set(e,t){this._array[this._getCyclicIndex(e)]=t}push(e){this._array[this._getCyclicIndex(this._length)]=e,this._length===this._maxLength?(this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1)):this._length++}recycle(){if(this._length!==this._maxLength)throw new Error("Can only recycle when the buffer is full");return this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1),this._array[this._getCyclicIndex(this._length-1)]}get isFull(){return this._length===this._maxLength}pop(){return this._array[this._getCyclicIndex(this._length---1)]}splice(e,t,...i){if(t){for(let i=e;i<this._length-t;i++)this._array[this._getCyclicIndex(i)]=this._array[this._getCyclicIndex(i+t)];this._length-=t,this.onDeleteEmitter.fire({index:e,amount:t})}for(let t=this._length-1;t>=e;t--)this._array[this._getCyclicIndex(t+i.length)]=this._array[this._getCyclicIndex(t)];for(let t=0;t<i.length;t++)this._array[this._getCyclicIndex(e+t)]=i[t];if(i.length&&this.onInsertEmitter.fire({index:e,amount:i.length}),this._length+i.length>this._maxLength){const e=this._length+i.length-this._maxLength;this._startIndex+=e,this._length=this._maxLength,this.onTrimEmitter.fire(e)}else this._length+=i.length}trimStart(e){e>this._length&&(e=this._length),this._startIndex+=e,this._length-=e,this.onTrimEmitter.fire(e)}shiftElements(e,t,i){if(!(t<=0)){if(e<0||e>=this._length)throw new Error("start argument out of range");if(e+i<0)throw new Error("Cannot shift elements in list beyond index 0");if(i>0){for(let s=t-1;s>=0;s--)this.set(e+s+i,this.get(e+s));const s=e+t+i-this._length;if(s>0)for(this._length+=s;this._length>this._maxLength;)this._length--,this._startIndex++,this.onTrimEmitter.fire(1)}else for(let s=0;s<t;s++)this.set(e+s+i,this.get(e+s))}}_getCyclicIndex(e){return(this._startIndex+e)%this._maxLength}}t.CircularList=r},1439:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.clone=void 0,t.clone=function e(t,i=5){if("object"!=typeof t)return t;const s=Array.isArray(t)?[]:{};for(const n in t)s[n]=i<=1?t[n]:t[n]&&e(t[n],i-1);return s}},8055:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.contrastRatio=t.toPaddedHex=t.rgba=t.rgb=t.css=t.color=t.channels=t.NULL_COLOR=void 0;let i=0,s=0,n=0,r=0;var o,a,l,h,c;function d(e){const t=e.toString(16);return t.length<2?"0"+t:t}function u(e,t){return e<t?(t+.05)/(e+.05):(e+.05)/(t+.05)}t.NULL_COLOR={css:"#00000000",rgba:0},function(e){e.toCss=function(e,t,i,s){return void 0!==s?`#${d(e)}${d(t)}${d(i)}${d(s)}`:`#${d(e)}${d(t)}${d(i)}`},e.toRgba=function(e,t,i,s=255){return(e<<24|t<<16|i<<8|s)>>>0},e.toColor=function(t,i,s,n){return{css:e.toCss(t,i,s,n),rgba:e.toRgba(t,i,s,n)}}}(o||(t.channels=o={})),function(e){function t(e,t){return r=Math.round(255*t),[i,s,n]=c.toChannels(e.rgba),{css:o.toCss(i,s,n,r),rgba:o.toRgba(i,s,n,r)}}e.blend=function(e,t){if(r=(255&t.rgba)/255,1===r)return{css:t.css,rgba:t.rgba};const a=t.rgba>>24&255,l=t.rgba>>16&255,h=t.rgba>>8&255,c=e.rgba>>24&255,d=e.rgba>>16&255,u=e.rgba>>8&255;return i=c+Math.round((a-c)*r),s=d+Math.round((l-d)*r),n=u+Math.round((h-u)*r),{css:o.toCss(i,s,n),rgba:o.toRgba(i,s,n)}},e.isOpaque=function(e){return!(255&~e.rgba)},e.ensureContrastRatio=function(e,t,i){const s=c.ensureContrastRatio(e.rgba,t.rgba,i);if(s)return o.toColor(s>>24&255,s>>16&255,s>>8&255)},e.opaque=function(e){const t=(255|e.rgba)>>>0;return[i,s,n]=c.toChannels(t),{css:o.toCss(i,s,n),rgba:t}},e.opacity=t,e.multiplyOpacity=function(e,i){return r=255&e.rgba,t(e,r*i/255)},e.toColorRGB=function(e){return[e.rgba>>24&255,e.rgba>>16&255,e.rgba>>8&255]}}(a||(t.color=a={})),function(e){let t,a;try{const e=document.createElement("canvas");e.width=1,e.height=1;const i=e.getContext("2d",{willReadFrequently:!0});i&&(t=i,t.globalCompositeOperation="copy",a=t.createLinearGradient(0,0,1,1))}catch{}e.toColor=function(e){if(e.match(/#[\da-f]{3,8}/i))switch(e.length){case 4:return i=parseInt(e.slice(1,2).repeat(2),16),s=parseInt(e.slice(2,3).repeat(2),16),n=parseInt(e.slice(3,4).repeat(2),16),o.toColor(i,s,n);case 5:return i=parseInt(e.slice(1,2).repeat(2),16),s=parseInt(e.slice(2,3).repeat(2),16),n=parseInt(e.slice(3,4).repeat(2),16),r=parseInt(e.slice(4,5).repeat(2),16),o.toColor(i,s,n,r);case 7:return{css:e,rgba:(parseInt(e.slice(1),16)<<8|255)>>>0};case 9:return{css:e,rgba:parseInt(e.slice(1),16)>>>0}}const l=e.match(/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(,\s*(0|1|\d?\.(\d+))\s*)?\)/);if(l)return i=parseInt(l[1]),s=parseInt(l[2]),n=parseInt(l[3]),r=Math.round(255*(void 0===l[5]?1:parseFloat(l[5]))),o.toColor(i,s,n,r);if(!t||!a)throw new Error("css.toColor: Unsupported css format");if(t.fillStyle=a,t.fillStyle=e,"string"!=typeof t.fillStyle)throw new Error("css.toColor: Unsupported css format");if(t.fillRect(0,0,1,1),[i,s,n,r]=t.getImageData(0,0,1,1).data,255!==r)throw new Error("css.toColor: Unsupported css format");return{rgba:o.toRgba(i,s,n,r),css:e}}}(l||(t.css=l={})),function(e){function t(e,t,i){const s=e/255,n=t/255,r=i/255;return.2126*(s<=.03928?s/12.92:Math.pow((s+.055)/1.055,2.4))+.7152*(n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4))+.0722*(r<=.03928?r/12.92:Math.pow((r+.055)/1.055,2.4))}e.relativeLuminance=function(e){return t(e>>16&255,e>>8&255,255&e)},e.relativeLuminance2=t}(h||(t.rgb=h={})),function(e){function t(e,t,i){const s=e>>24&255,n=e>>16&255,r=e>>8&255;let o=t>>24&255,a=t>>16&255,l=t>>8&255,c=u(h.relativeLuminance2(o,a,l),h.relativeLuminance2(s,n,r));for(;c<i&&(o>0||a>0||l>0);)o-=Math.max(0,Math.ceil(.1*o)),a-=Math.max(0,Math.ceil(.1*a)),l-=Math.max(0,Math.ceil(.1*l)),c=u(h.relativeLuminance2(o,a,l),h.relativeLuminance2(s,n,r));return(o<<24|a<<16|l<<8|255)>>>0}function a(e,t,i){const s=e>>24&255,n=e>>16&255,r=e>>8&255;let o=t>>24&255,a=t>>16&255,l=t>>8&255,c=u(h.relativeLuminance2(o,a,l),h.relativeLuminance2(s,n,r));for(;c<i&&(o<255||a<255||l<255);)o=Math.min(255,o+Math.ceil(.1*(255-o))),a=Math.min(255,a+Math.ceil(.1*(255-a))),l=Math.min(255,l+Math.ceil(.1*(255-l))),c=u(h.relativeLuminance2(o,a,l),h.relativeLuminance2(s,n,r));return(o<<24|a<<16|l<<8|255)>>>0}e.blend=function(e,t){if(r=(255&t)/255,1===r)return t;const a=t>>24&255,l=t>>16&255,h=t>>8&255,c=e>>24&255,d=e>>16&255,u=e>>8&255;return i=c+Math.round((a-c)*r),s=d+Math.round((l-d)*r),n=u+Math.round((h-u)*r),o.toRgba(i,s,n)},e.ensureContrastRatio=function(e,i,s){const n=h.relativeLuminance(e>>8),r=h.relativeLuminance(i>>8);if(u(n,r)<s){if(r<n){const r=t(e,i,s),o=u(n,h.relativeLuminance(r>>8));if(o<s){const t=a(e,i,s);return o>u(n,h.relativeLuminance(t>>8))?r:t}return r}const o=a(e,i,s),l=u(n,h.relativeLuminance(o>>8));if(l<s){const r=t(e,i,s);return l>u(n,h.relativeLuminance(r>>8))?o:r}return o}},e.reduceLuminance=t,e.increaseLuminance=a,e.toChannels=function(e){return[e>>24&255,e>>16&255,e>>8&255,255&e]}}(c||(t.rgba=c={})),t.toPaddedHex=d,t.contrastRatio=u},8969:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CoreTerminal=void 0;const s=i(844),n=i(2585),r=i(4348),o=i(7866),a=i(744),l=i(7302),h=i(6975),c=i(8460),d=i(1753),u=i(1480),p=i(7994),m=i(9282),f=i(5435),g=i(5981),_=i(2660);let v=!1;class b extends s.Disposable{get onScroll(){return this._onScrollApi||(this._onScrollApi=this.register(new c.EventEmitter),this._onScroll.event((e=>{this._onScrollApi?.fire(e.position)}))),this._onScrollApi.event}get cols(){return this._bufferService.cols}get rows(){return this._bufferService.rows}get buffers(){return this._bufferService.buffers}get options(){return this.optionsService.options}set options(e){for(const t in e)this.optionsService.options[t]=e[t]}constructor(e){super(),this._windowsWrappingHeuristics=this.register(new s.MutableDisposable),this._onBinary=this.register(new c.EventEmitter),this.onBinary=this._onBinary.event,this._onData=this.register(new c.EventEmitter),this.onData=this._onData.event,this._onLineFeed=this.register(new c.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onResize=this.register(new c.EventEmitter),this.onResize=this._onResize.event,this._onWriteParsed=this.register(new c.EventEmitter),this.onWriteParsed=this._onWriteParsed.event,this._onScroll=this.register(new c.EventEmitter),this._instantiationService=new r.InstantiationService,this.optionsService=this.register(new l.OptionsService(e)),this._instantiationService.setService(n.IOptionsService,this.optionsService),this._bufferService=this.register(this._instantiationService.createInstance(a.BufferService)),this._instantiationService.setService(n.IBufferService,this._bufferService),this._logService=this.register(this._instantiationService.createInstance(o.LogService)),this._instantiationService.setService(n.ILogService,this._logService),this.coreService=this.register(this._instantiationService.createInstance(h.CoreService)),this._instantiationService.setService(n.ICoreService,this.coreService),this.coreMouseService=this.register(this._instantiationService.createInstance(d.CoreMouseService)),this._instantiationService.setService(n.ICoreMouseService,this.coreMouseService),this.unicodeService=this.register(this._instantiationService.createInstance(u.UnicodeService)),this._instantiationService.setService(n.IUnicodeService,this.unicodeService),this._charsetService=this._instantiationService.createInstance(p.CharsetService),this._instantiationService.setService(n.ICharsetService,this._charsetService),this._oscLinkService=this._instantiationService.createInstance(_.OscLinkService),this._instantiationService.setService(n.IOscLinkService,this._oscLinkService),this._inputHandler=this.register(new f.InputHandler(this._bufferService,this._charsetService,this.coreService,this._logService,this.optionsService,this._oscLinkService,this.coreMouseService,this.unicodeService)),this.register((0,c.forwardEvent)(this._inputHandler.onLineFeed,this._onLineFeed)),this.register(this._inputHandler),this.register((0,c.forwardEvent)(this._bufferService.onResize,this._onResize)),this.register((0,c.forwardEvent)(this.coreService.onData,this._onData)),this.register((0,c.forwardEvent)(this.coreService.onBinary,this._onBinary)),this.register(this.coreService.onRequestScrollToBottom((()=>this.scrollToBottom()))),this.register(this.coreService.onUserInput((()=>this._writeBuffer.handleUserInput()))),this.register(this.optionsService.onMultipleOptionChange(["windowsMode","windowsPty"],(()=>this._handleWindowsPtyOptionChange()))),this.register(this._bufferService.onScroll((e=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)}))),this.register(this._inputHandler.onScroll((e=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)}))),this._writeBuffer=this.register(new g.WriteBuffer(((e,t)=>this._inputHandler.parse(e,t)))),this.register((0,c.forwardEvent)(this._writeBuffer.onWriteParsed,this._onWriteParsed))}write(e,t){this._writeBuffer.write(e,t)}writeSync(e,t){this._logService.logLevel<=n.LogLevelEnum.WARN&&!v&&(this._logService.warn("writeSync is unreliable and will be removed soon."),v=!0),this._writeBuffer.writeSync(e,t)}input(e,t=!0){this.coreService.triggerDataEvent(e,t)}resize(e,t){isNaN(e)||isNaN(t)||(e=Math.max(e,a.MINIMUM_COLS),t=Math.max(t,a.MINIMUM_ROWS),this._bufferService.resize(e,t))}scroll(e,t=!1){this._bufferService.scroll(e,t)}scrollLines(e,t,i){this._bufferService.scrollLines(e,t,i)}scrollPages(e){this.scrollLines(e*(this.rows-1))}scrollToTop(){this.scrollLines(-this._bufferService.buffer.ydisp)}scrollToBottom(){this.scrollLines(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp)}scrollToLine(e){const t=e-this._bufferService.buffer.ydisp;0!==t&&this.scrollLines(t)}registerEscHandler(e,t){return this._inputHandler.registerEscHandler(e,t)}registerDcsHandler(e,t){return this._inputHandler.registerDcsHandler(e,t)}registerCsiHandler(e,t){return this._inputHandler.registerCsiHandler(e,t)}registerOscHandler(e,t){return this._inputHandler.registerOscHandler(e,t)}_setup(){this._handleWindowsPtyOptionChange()}reset(){this._inputHandler.reset(),this._bufferService.reset(),this._charsetService.reset(),this.coreService.reset(),this.coreMouseService.reset()}_handleWindowsPtyOptionChange(){let e=!1;const t=this.optionsService.rawOptions.windowsPty;t&&void 0!==t.buildNumber&&void 0!==t.buildNumber?e=!!("conpty"===t.backend&&t.buildNumber<21376):this.optionsService.rawOptions.windowsMode&&(e=!0),e?this._enableWindowsWrappingHeuristics():this._windowsWrappingHeuristics.clear()}_enableWindowsWrappingHeuristics(){if(!this._windowsWrappingHeuristics.value){const e=[];e.push(this.onLineFeed(m.updateWindowsModeWrappedState.bind(null,this._bufferService))),e.push(this.registerCsiHandler({final:"H"},(()=>((0,m.updateWindowsModeWrappedState)(this._bufferService),!1)))),this._windowsWrappingHeuristics.value=(0,s.toDisposable)((()=>{for(const t of e)t.dispose()}))}}}t.CoreTerminal=b},8460:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.runAndSubscribe=t.forwardEvent=t.EventEmitter=void 0,t.EventEmitter=class{constructor(){this._listeners=[],this._disposed=!1}get event(){return this._event||(this._event=e=>(this._listeners.push(e),{dispose:()=>{if(!this._disposed)for(let t=0;t<this._listeners.length;t++)if(this._listeners[t]===e)return void this._listeners.splice(t,1)}})),this._event}fire(e,t){const i=[];for(let e=0;e<this._listeners.length;e++)i.push(this._listeners[e]);for(let s=0;s<i.length;s++)i[s].call(void 0,e,t)}dispose(){this.clearListeners(),this._disposed=!0}clearListeners(){this._listeners&&(this._listeners.length=0)}},t.forwardEvent=function(e,t){return e((e=>t.fire(e)))},t.runAndSubscribe=function(e,t){return t(void 0),e((e=>t(e)))}},5435:function(e,t,i){var s=this&&this.__decorate||function(e,t,i,s){var n,r=arguments.length,o=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,s);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(r<3?n(o):r>3?n(t,i,o):n(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},n=this&&this.__param||function(e,t){return function(i,s){t(i,s,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.InputHandler=t.WindowsOptionsReportType=void 0;const r=i(2584),o=i(7116),a=i(2015),l=i(844),h=i(482),c=i(8437),d=i(8460),u=i(643),p=i(511),m=i(3734),f=i(2585),g=i(1480),_=i(6242),v=i(6351),b=i(5941),y={"(":0,")":1,"*":2,"+":3,"-":1,".":2},C=131072;function w(e,t){if(e>24)return t.setWinLines||!1;switch(e){case 1:return!!t.restoreWin;case 2:return!!t.minimizeWin;case 3:return!!t.setWinPosition;case 4:return!!t.setWinSizePixels;case 5:return!!t.raiseWin;case 6:return!!t.lowerWin;case 7:return!!t.refreshWin;case 8:return!!t.setWinSizeChars;case 9:return!!t.maximizeWin;case 10:return!!t.fullscreenWin;case 11:return!!t.getWinState;case 13:return!!t.getWinPosition;case 14:return!!t.getWinSizePixels;case 15:return!!t.getScreenSizePixels;case 16:return!!t.getCellSizePixels;case 18:return!!t.getWinSizeChars;case 19:return!!t.getScreenSizeChars;case 20:return!!t.getIconTitle;case 21:return!!t.getWinTitle;case 22:return!!t.pushTitle;case 23:return!!t.popTitle;case 24:return!!t.setWinLines}return!1}var S;!function(e){e[e.GET_WIN_SIZE_PIXELS=0]="GET_WIN_SIZE_PIXELS",e[e.GET_CELL_SIZE_PIXELS=1]="GET_CELL_SIZE_PIXELS"}(S||(t.WindowsOptionsReportType=S={}));let E=0;class x extends l.Disposable{getAttrData(){return this._curAttrData}constructor(e,t,i,s,n,l,u,m,f=new a.EscapeSequenceParser){super(),this._bufferService=e,this._charsetService=t,this._coreService=i,this._logService=s,this._optionsService=n,this._oscLinkService=l,this._coreMouseService=u,this._unicodeService=m,this._parser=f,this._parseBuffer=new Uint32Array(4096),this._stringDecoder=new h.StringToUtf32,this._utf8Decoder=new h.Utf8ToUtf32,this._workCell=new p.CellData,this._windowTitle="",this._iconName="",this._windowTitleStack=[],this._iconNameStack=[],this._curAttrData=c.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=c.DEFAULT_ATTR_DATA.clone(),this._onRequestBell=this.register(new d.EventEmitter),this.onRequestBell=this._onRequestBell.event,this._onRequestRefreshRows=this.register(new d.EventEmitter),this.onRequestRefreshRows=this._onRequestRefreshRows.event,this._onRequestReset=this.register(new d.EventEmitter),this.onRequestReset=this._onRequestReset.event,this._onRequestSendFocus=this.register(new d.EventEmitter),this.onRequestSendFocus=this._onRequestSendFocus.event,this._onRequestSyncScrollBar=this.register(new d.EventEmitter),this.onRequestSyncScrollBar=this._onRequestSyncScrollBar.event,this._onRequestWindowsOptionsReport=this.register(new d.EventEmitter),this.onRequestWindowsOptionsReport=this._onRequestWindowsOptionsReport.event,this._onA11yChar=this.register(new d.EventEmitter),this.onA11yChar=this._onA11yChar.event,this._onA11yTab=this.register(new d.EventEmitter),this.onA11yTab=this._onA11yTab.event,this._onCursorMove=this.register(new d.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onLineFeed=this.register(new d.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onScroll=this.register(new d.EventEmitter),this.onScroll=this._onScroll.event,this._onTitleChange=this.register(new d.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onColor=this.register(new d.EventEmitter),this.onColor=this._onColor.event,this._parseStack={paused:!1,cursorStartX:0,cursorStartY:0,decodedLength:0,position:0},this._specialColors=[256,257,258],this.register(this._parser),this._dirtyRowTracker=new T(this._bufferService),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate((e=>this._activeBuffer=e.activeBuffer))),this._parser.setCsiHandlerFallback(((e,t)=>{this._logService.debug("Unknown CSI code: ",{identifier:this._parser.identToString(e),params:t.toArray()})})),this._parser.setEscHandlerFallback((e=>{this._logService.debug("Unknown ESC code: ",{identifier:this._parser.identToString(e)})})),this._parser.setExecuteHandlerFallback((e=>{this._logService.debug("Unknown EXECUTE code: ",{code:e})})),this._parser.setOscHandlerFallback(((e,t,i)=>{this._logService.debug("Unknown OSC code: ",{identifier:e,action:t,data:i})})),this._parser.setDcsHandlerFallback(((e,t,i)=>{"HOOK"===t&&(i=i.toArray()),this._logService.debug("Unknown DCS code: ",{identifier:this._parser.identToString(e),action:t,payload:i})})),this._parser.setPrintHandler(((e,t,i)=>this.print(e,t,i))),this._parser.registerCsiHandler({final:"@"},(e=>this.insertChars(e))),this._parser.registerCsiHandler({intermediates:" ",final:"@"},(e=>this.scrollLeft(e))),this._parser.registerCsiHandler({final:"A"},(e=>this.cursorUp(e))),this._parser.registerCsiHandler({intermediates:" ",final:"A"},(e=>this.scrollRight(e))),this._parser.registerCsiHandler({final:"B"},(e=>this.cursorDown(e))),this._parser.registerCsiHandler({final:"C"},(e=>this.cursorForward(e))),this._parser.registerCsiHandler({final:"D"},(e=>this.cursorBackward(e))),this._parser.registerCsiHandler({final:"E"},(e=>this.cursorNextLine(e))),this._parser.registerCsiHandler({final:"F"},(e=>this.cursorPrecedingLine(e))),this._parser.registerCsiHandler({final:"G"},(e=>this.cursorCharAbsolute(e))),this._parser.registerCsiHandler({final:"H"},(e=>this.cursorPosition(e))),this._parser.registerCsiHandler({final:"I"},(e=>this.cursorForwardTab(e))),this._parser.registerCsiHandler({final:"J"},(e=>this.eraseInDisplay(e,!1))),this._parser.registerCsiHandler({prefix:"?",final:"J"},(e=>this.eraseInDisplay(e,!0))),this._parser.registerCsiHandler({final:"K"},(e=>this.eraseInLine(e,!1))),this._parser.registerCsiHandler({prefix:"?",final:"K"},(e=>this.eraseInLine(e,!0))),this._parser.registerCsiHandler({final:"L"},(e=>this.insertLines(e))),this._parser.registerCsiHandler({final:"M"},(e=>this.deleteLines(e))),this._parser.registerCsiHandler({final:"P"},(e=>this.deleteChars(e))),this._parser.registerCsiHandler({final:"S"},(e=>this.scrollUp(e))),this._parser.registerCsiHandler({final:"T"},(e=>this.scrollDown(e))),this._parser.registerCsiHandler({final:"X"},(e=>this.eraseChars(e))),this._parser.registerCsiHandler({final:"Z"},(e=>this.cursorBackwardTab(e))),this._parser.registerCsiHandler({final:"`"},(e=>this.charPosAbsolute(e))),this._parser.registerCsiHandler({final:"a"},(e=>this.hPositionRelative(e))),this._parser.registerCsiHandler({final:"b"},(e=>this.repeatPrecedingCharacter(e))),this._parser.registerCsiHandler({final:"c"},(e=>this.sendDeviceAttributesPrimary(e))),this._parser.registerCsiHandler({prefix:">",final:"c"},(e=>this.sendDeviceAttributesSecondary(e))),this._parser.registerCsiHandler({final:"d"},(e=>this.linePosAbsolute(e))),this._parser.registerCsiHandler({final:"e"},(e=>this.vPositionRelative(e))),this._parser.registerCsiHandler({final:"f"},(e=>this.hVPosition(e))),this._parser.registerCsiHandler({final:"g"},(e=>this.tabClear(e))),this._parser.registerCsiHandler({final:"h"},(e=>this.setMode(e))),this._parser.registerCsiHandler({prefix:"?",final:"h"},(e=>this.setModePrivate(e))),this._parser.registerCsiHandler({final:"l"},(e=>this.resetMode(e))),this._parser.registerCsiHandler({prefix:"?",final:"l"},(e=>this.resetModePrivate(e))),this._parser.registerCsiHandler({final:"m"},(e=>this.charAttributes(e))),this._parser.registerCsiHandler({final:"n"},(e=>this.deviceStatus(e))),this._parser.registerCsiHandler({prefix:"?",final:"n"},(e=>this.deviceStatusPrivate(e))),this._parser.registerCsiHandler({intermediates:"!",final:"p"},(e=>this.softReset(e))),this._parser.registerCsiHandler({intermediates:" ",final:"q"},(e=>this.setCursorStyle(e))),this._parser.registerCsiHandler({final:"r"},(e=>this.setScrollRegion(e))),this._parser.registerCsiHandler({final:"s"},(e=>this.saveCursor(e))),this._parser.registerCsiHandler({final:"t"},(e=>this.windowOptions(e))),this._parser.registerCsiHandler({final:"u"},(e=>this.restoreCursor(e))),this._parser.registerCsiHandler({intermediates:"'",final:"}"},(e=>this.insertColumns(e))),this._parser.registerCsiHandler({intermediates:"'",final:"~"},(e=>this.deleteColumns(e))),this._parser.registerCsiHandler({intermediates:'"',final:"q"},(e=>this.selectProtected(e))),this._parser.registerCsiHandler({intermediates:"$",final:"p"},(e=>this.requestMode(e,!0))),this._parser.registerCsiHandler({prefix:"?",intermediates:"$",final:"p"},(e=>this.requestMode(e,!1))),this._parser.setExecuteHandler(r.C0.BEL,(()=>this.bell())),this._parser.setExecuteHandler(r.C0.LF,(()=>this.lineFeed())),this._parser.setExecuteHandler(r.C0.VT,(()=>this.lineFeed())),this._parser.setExecuteHandler(r.C0.FF,(()=>this.lineFeed())),this._parser.setExecuteHandler(r.C0.CR,(()=>this.carriageReturn())),this._parser.setExecuteHandler(r.C0.BS,(()=>this.backspace())),this._parser.setExecuteHandler(r.C0.HT,(()=>this.tab())),this._parser.setExecuteHandler(r.C0.SO,(()=>this.shiftOut())),this._parser.setExecuteHandler(r.C0.SI,(()=>this.shiftIn())),this._parser.setExecuteHandler(r.C1.IND,(()=>this.index())),this._parser.setExecuteHandler(r.C1.NEL,(()=>this.nextLine())),this._parser.setExecuteHandler(r.C1.HTS,(()=>this.tabSet())),this._parser.registerOscHandler(0,new _.OscHandler((e=>(this.setTitle(e),this.setIconName(e),!0)))),this._parser.registerOscHandler(1,new _.OscHandler((e=>this.setIconName(e)))),this._parser.registerOscHandler(2,new _.OscHandler((e=>this.setTitle(e)))),this._parser.registerOscHandler(4,new _.OscHandler((e=>this.setOrReportIndexedColor(e)))),this._parser.registerOscHandler(8,new _.OscHandler((e=>this.setHyperlink(e)))),this._parser.registerOscHandler(10,new _.OscHandler((e=>this.setOrReportFgColor(e)))),this._parser.registerOscHandler(11,new _.OscHandler((e=>this.setOrReportBgColor(e)))),this._parser.registerOscHandler(12,new _.OscHandler((e=>this.setOrReportCursorColor(e)))),this._parser.registerOscHandler(104,new _.OscHandler((e=>this.restoreIndexedColor(e)))),this._parser.registerOscHandler(110,new _.OscHandler((e=>this.restoreFgColor(e)))),this._parser.registerOscHandler(111,new _.OscHandler((e=>this.restoreBgColor(e)))),this._parser.registerOscHandler(112,new _.OscHandler((e=>this.restoreCursorColor(e)))),this._parser.registerEscHandler({final:"7"},(()=>this.saveCursor())),this._parser.registerEscHandler({final:"8"},(()=>this.restoreCursor())),this._parser.registerEscHandler({final:"D"},(()=>this.index())),this._parser.registerEscHandler({final:"E"},(()=>this.nextLine())),this._parser.registerEscHandler({final:"H"},(()=>this.tabSet())),this._parser.registerEscHandler({final:"M"},(()=>this.reverseIndex())),this._parser.registerEscHandler({final:"="},(()=>this.keypadApplicationMode())),this._parser.registerEscHandler({final:">"},(()=>this.keypadNumericMode())),this._parser.registerEscHandler({final:"c"},(()=>this.fullReset())),this._parser.registerEscHandler({final:"n"},(()=>this.setgLevel(2))),this._parser.registerEscHandler({final:"o"},(()=>this.setgLevel(3))),this._parser.registerEscHandler({final:"|"},(()=>this.setgLevel(3))),this._parser.registerEscHandler({final:"}"},(()=>this.setgLevel(2))),this._parser.registerEscHandler({final:"~"},(()=>this.setgLevel(1))),this._parser.registerEscHandler({intermediates:"%",final:"@"},(()=>this.selectDefaultCharset())),this._parser.registerEscHandler({intermediates:"%",final:"G"},(()=>this.selectDefaultCharset()));for(const e in o.CHARSETS)this._parser.registerEscHandler({intermediates:"(",final:e},(()=>this.selectCharset("("+e))),this._parser.registerEscHandler({intermediates:")",final:e},(()=>this.selectCharset(")"+e))),this._parser.registerEscHandler({intermediates:"*",final:e},(()=>this.selectCharset("*"+e))),this._parser.registerEscHandler({intermediates:"+",final:e},(()=>this.selectCharset("+"+e))),this._parser.registerEscHandler({intermediates:"-",final:e},(()=>this.selectCharset("-"+e))),this._parser.registerEscHandler({intermediates:".",final:e},(()=>this.selectCharset("."+e))),this._parser.registerEscHandler({intermediates:"/",final:e},(()=>this.selectCharset("/"+e)));this._parser.registerEscHandler({intermediates:"#",final:"8"},(()=>this.screenAlignmentPattern())),this._parser.setErrorHandler((e=>(this._logService.error("Parsing error: ",e),e))),this._parser.registerDcsHandler({intermediates:"$",final:"q"},new v.DcsHandler(((e,t)=>this.requestStatusString(e,t))))}_preserveStack(e,t,i,s){this._parseStack.paused=!0,this._parseStack.cursorStartX=e,this._parseStack.cursorStartY=t,this._parseStack.decodedLength=i,this._parseStack.position=s}_logSlowResolvingAsync(e){this._logService.logLevel<=f.LogLevelEnum.WARN&&Promise.race([e,new Promise(((e,t)=>setTimeout((()=>t("#SLOW_TIMEOUT")),5e3)))]).catch((e=>{if("#SLOW_TIMEOUT"!==e)throw e;console.warn("async parser handler taking longer than 5000 ms")}))}_getCurrentLinkId(){return this._curAttrData.extended.urlId}parse(e,t){let i,s=this._activeBuffer.x,n=this._activeBuffer.y,r=0;const o=this._parseStack.paused;if(o){if(i=this._parser.parse(this._parseBuffer,this._parseStack.decodedLength,t))return this._logSlowResolvingAsync(i),i;s=this._parseStack.cursorStartX,n=this._parseStack.cursorStartY,this._parseStack.paused=!1,e.length>C&&(r=this._parseStack.position+C)}if(this._logService.logLevel<=f.LogLevelEnum.DEBUG&&this._logService.debug("parsing data"+("string"==typeof e?` "${e}"`:` "${Array.prototype.map.call(e,(e=>String.fromCharCode(e))).join("")}"`),"string"==typeof e?e.split("").map((e=>e.charCodeAt(0))):e),this._parseBuffer.length<e.length&&this._parseBuffer.length<C&&(this._parseBuffer=new Uint32Array(Math.min(e.length,C))),o||this._dirtyRowTracker.clearRange(),e.length>C)for(let t=r;t<e.length;t+=C){const r=t+C<e.length?t+C:e.length,o="string"==typeof e?this._stringDecoder.decode(e.substring(t,r),this._parseBuffer):this._utf8Decoder.decode(e.subarray(t,r),this._parseBuffer);if(i=this._parser.parse(this._parseBuffer,o))return this._preserveStack(s,n,o,t),this._logSlowResolvingAsync(i),i}else if(!o){const t="string"==typeof e?this._stringDecoder.decode(e,this._parseBuffer):this._utf8Decoder.decode(e,this._parseBuffer);if(i=this._parser.parse(this._parseBuffer,t))return this._preserveStack(s,n,t,0),this._logSlowResolvingAsync(i),i}this._activeBuffer.x===s&&this._activeBuffer.y===n||this._onCursorMove.fire();const a=this._dirtyRowTracker.end+(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp),l=this._dirtyRowTracker.start+(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp);l<this._bufferService.rows&&this._onRequestRefreshRows.fire(Math.min(l,this._bufferService.rows-1),Math.min(a,this._bufferService.rows-1))}print(e,t,i){let s,n;const r=this._charsetService.charset,o=this._optionsService.rawOptions.screenReaderMode,a=this._bufferService.cols,l=this._coreService.decPrivateModes.wraparound,d=this._coreService.modes.insertMode,p=this._curAttrData;let m=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._activeBuffer.x&&i-t>0&&2===m.getWidth(this._activeBuffer.x-1)&&m.setCellFromCodepoint(this._activeBuffer.x-1,0,1,p);let f=this._parser.precedingJoinState;for(let _=t;_<i;++_){if(s=e[_],s<127&&r){const e=r[String.fromCharCode(s)];e&&(s=e.charCodeAt(0))}const t=this._unicodeService.charProperties(s,f);n=g.UnicodeService.extractWidth(t);const i=g.UnicodeService.extractShouldJoin(t),v=i?g.UnicodeService.extractWidth(f):0;if(f=t,o&&this._onA11yChar.fire((0,h.stringFromCodePoint)(s)),this._getCurrentLinkId()&&this._oscLinkService.addLineToLink(this._getCurrentLinkId(),this._activeBuffer.ybase+this._activeBuffer.y),this._activeBuffer.x+n-v>a)if(l){const e=m;let t=this._activeBuffer.x-v;for(this._activeBuffer.x=v,this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData(),!0)):(this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!0),m=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y),v>0&&m instanceof c.BufferLine&&m.copyCellsFrom(e,t,0,v,!1);t<a;)e.setCellFromCodepoint(t++,0,1,p)}else if(this._activeBuffer.x=a-1,2===n)continue;if(i&&this._activeBuffer.x){const e=m.getWidth(this._activeBuffer.x-1)?1:2;m.addCodepointToCell(this._activeBuffer.x-e,s,n);for(let e=n-v;--e>=0;)m.setCellFromCodepoint(this._activeBuffer.x++,0,0,p)}else if(d&&(m.insertCells(this._activeBuffer.x,n-v,this._activeBuffer.getNullCell(p)),2===m.getWidth(a-1)&&m.setCellFromCodepoint(a-1,u.NULL_CELL_CODE,u.NULL_CELL_WIDTH,p)),m.setCellFromCodepoint(this._activeBuffer.x++,s,n,p),n>0)for(;--n;)m.setCellFromCodepoint(this._activeBuffer.x++,0,0,p)}this._parser.precedingJoinState=f,this._activeBuffer.x<a&&i-t>0&&0===m.getWidth(this._activeBuffer.x)&&!m.hasContent(this._activeBuffer.x)&&m.setCellFromCodepoint(this._activeBuffer.x,0,1,p),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}registerCsiHandler(e,t){return"t"!==e.final||e.prefix||e.intermediates?this._parser.registerCsiHandler(e,t):this._parser.registerCsiHandler(e,(e=>!w(e.params[0],this._optionsService.rawOptions.windowOptions)||t(e)))}registerDcsHandler(e,t){return this._parser.registerDcsHandler(e,new v.DcsHandler(t))}registerEscHandler(e,t){return this._parser.registerEscHandler(e,t)}registerOscHandler(e,t){return this._parser.registerOscHandler(e,new _.OscHandler(t))}bell(){return this._onRequestBell.fire(),!0}lineFeed(){return this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._optionsService.rawOptions.convertEol&&(this._activeBuffer.x=0),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows?this._activeBuffer.y=this._bufferService.rows-1:this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.x>=this._bufferService.cols&&this._activeBuffer.x--,this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._onLineFeed.fire(),!0}carriageReturn(){return this._activeBuffer.x=0,!0}backspace(){if(!this._coreService.decPrivateModes.reverseWraparound)return this._restrictCursor(),this._activeBuffer.x>0&&this._activeBuffer.x--,!0;if(this._restrictCursor(this._bufferService.cols),this._activeBuffer.x>0)this._activeBuffer.x--;else if(0===this._activeBuffer.x&&this._activeBuffer.y>this._activeBuffer.scrollTop&&this._activeBuffer.y<=this._activeBuffer.scrollBottom&&this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y)?.isWrapped){this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.y--,this._activeBuffer.x=this._bufferService.cols-1;const e=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);e.hasWidth(this._activeBuffer.x)&&!e.hasContent(this._activeBuffer.x)&&this._activeBuffer.x--}return this._restrictCursor(),!0}tab(){if(this._activeBuffer.x>=this._bufferService.cols)return!0;const e=this._activeBuffer.x;return this._activeBuffer.x=this._activeBuffer.nextStop(),this._optionsService.rawOptions.screenReaderMode&&this._onA11yTab.fire(this._activeBuffer.x-e),!0}shiftOut(){return this._charsetService.setgLevel(1),!0}shiftIn(){return this._charsetService.setgLevel(0),!0}_restrictCursor(e=this._bufferService.cols-1){this._activeBuffer.x=Math.min(e,Math.max(0,this._activeBuffer.x)),this._activeBuffer.y=this._coreService.decPrivateModes.origin?Math.min(this._activeBuffer.scrollBottom,Math.max(this._activeBuffer.scrollTop,this._activeBuffer.y)):Math.min(this._bufferService.rows-1,Math.max(0,this._activeBuffer.y)),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_setCursor(e,t){this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._coreService.decPrivateModes.origin?(this._activeBuffer.x=e,this._activeBuffer.y=this._activeBuffer.scrollTop+t):(this._activeBuffer.x=e,this._activeBuffer.y=t),this._restrictCursor(),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_moveCursor(e,t){this._restrictCursor(),this._setCursor(this._activeBuffer.x+e,this._activeBuffer.y+t)}cursorUp(e){const t=this._activeBuffer.y-this._activeBuffer.scrollTop;return t>=0?this._moveCursor(0,-Math.min(t,e.params[0]||1)):this._moveCursor(0,-(e.params[0]||1)),!0}cursorDown(e){const t=this._activeBuffer.scrollBottom-this._activeBuffer.y;return t>=0?this._moveCursor(0,Math.min(t,e.params[0]||1)):this._moveCursor(0,e.params[0]||1),!0}cursorForward(e){return this._moveCursor(e.params[0]||1,0),!0}cursorBackward(e){return this._moveCursor(-(e.params[0]||1),0),!0}cursorNextLine(e){return this.cursorDown(e),this._activeBuffer.x=0,!0}cursorPrecedingLine(e){return this.cursorUp(e),this._activeBuffer.x=0,!0}cursorCharAbsolute(e){return this._setCursor((e.params[0]||1)-1,this._activeBuffer.y),!0}cursorPosition(e){return this._setCursor(e.length>=2?(e.params[1]||1)-1:0,(e.params[0]||1)-1),!0}charPosAbsolute(e){return this._setCursor((e.params[0]||1)-1,this._activeBuffer.y),!0}hPositionRelative(e){return this._moveCursor(e.params[0]||1,0),!0}linePosAbsolute(e){return this._setCursor(this._activeBuffer.x,(e.params[0]||1)-1),!0}vPositionRelative(e){return this._moveCursor(0,e.params[0]||1),!0}hVPosition(e){return this.cursorPosition(e),!0}tabClear(e){const t=e.params[0];return 0===t?delete this._activeBuffer.tabs[this._activeBuffer.x]:3===t&&(this._activeBuffer.tabs={}),!0}cursorForwardTab(e){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let t=e.params[0]||1;for(;t--;)this._activeBuffer.x=this._activeBuffer.nextStop();return!0}cursorBackwardTab(e){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let t=e.params[0]||1;for(;t--;)this._activeBuffer.x=this._activeBuffer.prevStop();return!0}selectProtected(e){const t=e.params[0];return 1===t&&(this._curAttrData.bg|=536870912),2!==t&&0!==t||(this._curAttrData.bg&=-536870913),!0}_eraseInBufferLine(e,t,i,s=!1,n=!1){const r=this._activeBuffer.lines.get(this._activeBuffer.ybase+e);r.replaceCells(t,i,this._activeBuffer.getNullCell(this._eraseAttrData()),n),s&&(r.isWrapped=!1)}_resetBufferLine(e,t=!1){const i=this._activeBuffer.lines.get(this._activeBuffer.ybase+e);i&&(i.fill(this._activeBuffer.getNullCell(this._eraseAttrData()),t),this._bufferService.buffer.clearMarkers(this._activeBuffer.ybase+e),i.isWrapped=!1)}eraseInDisplay(e,t=!1){let i;switch(this._restrictCursor(this._bufferService.cols),e.params[0]){case 0:for(i=this._activeBuffer.y,this._dirtyRowTracker.markDirty(i),this._eraseInBufferLine(i++,this._activeBuffer.x,this._bufferService.cols,0===this._activeBuffer.x,t);i<this._bufferService.rows;i++)this._resetBufferLine(i,t);this._dirtyRowTracker.markDirty(i);break;case 1:for(i=this._activeBuffer.y,this._dirtyRowTracker.markDirty(i),this._eraseInBufferLine(i,0,this._activeBuffer.x+1,!0,t),this._activeBuffer.x+1>=this._bufferService.cols&&(this._activeBuffer.lines.get(i+1).isWrapped=!1);i--;)this._resetBufferLine(i,t);this._dirtyRowTracker.markDirty(0);break;case 2:for(i=this._bufferService.rows,this._dirtyRowTracker.markDirty(i-1);i--;)this._resetBufferLine(i,t);this._dirtyRowTracker.markDirty(0);break;case 3:const e=this._activeBuffer.lines.length-this._bufferService.rows;e>0&&(this._activeBuffer.lines.trimStart(e),this._activeBuffer.ybase=Math.max(this._activeBuffer.ybase-e,0),this._activeBuffer.ydisp=Math.max(this._activeBuffer.ydisp-e,0),this._onScroll.fire(0))}return!0}eraseInLine(e,t=!1){switch(this._restrictCursor(this._bufferService.cols),e.params[0]){case 0:this._eraseInBufferLine(this._activeBuffer.y,this._activeBuffer.x,this._bufferService.cols,0===this._activeBuffer.x,t);break;case 1:this._eraseInBufferLine(this._activeBuffer.y,0,this._activeBuffer.x+1,!1,t);break;case 2:this._eraseInBufferLine(this._activeBuffer.y,0,this._bufferService.cols,!0,t)}return this._dirtyRowTracker.markDirty(this._activeBuffer.y),!0}insertLines(e){this._restrictCursor();let t=e.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const i=this._activeBuffer.ybase+this._activeBuffer.y,s=this._bufferService.rows-1-this._activeBuffer.scrollBottom,n=this._bufferService.rows-1+this._activeBuffer.ybase-s+1;for(;t--;)this._activeBuffer.lines.splice(n-1,1),this._activeBuffer.lines.splice(i,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}deleteLines(e){this._restrictCursor();let t=e.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const i=this._activeBuffer.ybase+this._activeBuffer.y;let s;for(s=this._bufferService.rows-1-this._activeBuffer.scrollBottom,s=this._bufferService.rows-1+this._activeBuffer.ybase-s;t--;)this._activeBuffer.lines.splice(i,1),this._activeBuffer.lines.splice(s,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}insertChars(e){this._restrictCursor();const t=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return t&&(t.insertCells(this._activeBuffer.x,e.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}deleteChars(e){this._restrictCursor();const t=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return t&&(t.deleteCells(this._activeBuffer.x,e.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}scrollUp(e){let t=e.params[0]||1;for(;t--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollDown(e){let t=e.params[0]||1;for(;t--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,0,this._activeBuffer.getBlankLine(c.DEFAULT_ATTR_DATA));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollLeft(e){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const t=e.params[0]||1;for(let e=this._activeBuffer.scrollTop;e<=this._activeBuffer.scrollBottom;++e){const i=this._activeBuffer.lines.get(this._activeBuffer.ybase+e);i.deleteCells(0,t,this._activeBuffer.getNullCell(this._eraseAttrData())),i.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollRight(e){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const t=e.params[0]||1;for(let e=this._activeBuffer.scrollTop;e<=this._activeBuffer.scrollBottom;++e){const i=this._activeBuffer.lines.get(this._activeBuffer.ybase+e);i.insertCells(0,t,this._activeBuffer.getNullCell(this._eraseAttrData())),i.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}insertColumns(e){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const t=e.params[0]||1;for(let e=this._activeBuffer.scrollTop;e<=this._activeBuffer.scrollBottom;++e){const i=this._activeBuffer.lines.get(this._activeBuffer.ybase+e);i.insertCells(this._activeBuffer.x,t,this._activeBuffer.getNullCell(this._eraseAttrData())),i.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}deleteColumns(e){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const t=e.params[0]||1;for(let e=this._activeBuffer.scrollTop;e<=this._activeBuffer.scrollBottom;++e){const i=this._activeBuffer.lines.get(this._activeBuffer.ybase+e);i.deleteCells(this._activeBuffer.x,t,this._activeBuffer.getNullCell(this._eraseAttrData())),i.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}eraseChars(e){this._restrictCursor();const t=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return t&&(t.replaceCells(this._activeBuffer.x,this._activeBuffer.x+(e.params[0]||1),this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}repeatPrecedingCharacter(e){const t=this._parser.precedingJoinState;if(!t)return!0;const i=e.params[0]||1,s=g.UnicodeService.extractWidth(t),n=this._activeBuffer.x-s,r=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).getString(n),o=new Uint32Array(r.length*i);let a=0;for(let e=0;e<r.length;){const t=r.codePointAt(e)||0;o[a++]=t,e+=t>65535?2:1}let l=a;for(let e=1;e<i;++e)o.copyWithin(l,0,a),l+=a;return this.print(o,0,l),!0}sendDeviceAttributesPrimary(e){return e.params[0]>0||(this._is("xterm")||this._is("rxvt-unicode")||this._is("screen")?this._coreService.triggerDataEvent(r.C0.ESC+"[?1;2c"):this._is("linux")&&this._coreService.triggerDataEvent(r.C0.ESC+"[?6c")),!0}sendDeviceAttributesSecondary(e){return e.params[0]>0||(this._is("xterm")?this._coreService.triggerDataEvent(r.C0.ESC+"[>0;276;0c"):this._is("rxvt-unicode")?this._coreService.triggerDataEvent(r.C0.ESC+"[>85;95;0c"):this._is("linux")?this._coreService.triggerDataEvent(e.params[0]+"c"):this._is("screen")&&this._coreService.triggerDataEvent(r.C0.ESC+"[>83;40003;0c")),!0}_is(e){return 0===(this._optionsService.rawOptions.termName+"").indexOf(e)}setMode(e){for(let t=0;t<e.length;t++)switch(e.params[t]){case 4:this._coreService.modes.insertMode=!0;break;case 20:this._optionsService.options.convertEol=!0}return!0}setModePrivate(e){for(let t=0;t<e.length;t++)switch(e.params[t]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!0;break;case 2:this._charsetService.setgCharset(0,o.DEFAULT_CHARSET),this._charsetService.setgCharset(1,o.DEFAULT_CHARSET),this._charsetService.setgCharset(2,o.DEFAULT_CHARSET),this._charsetService.setgCharset(3,o.DEFAULT_CHARSET);break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(132,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!0,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!0;break;case 12:this._optionsService.options.cursorBlink=!0;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!0;break;case 66:this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire();break;case 9:this._coreMouseService.activeProtocol="X10";break;case 1e3:this._coreMouseService.activeProtocol="VT200";break;case 1002:this._coreMouseService.activeProtocol="DRAG";break;case 1003:this._coreMouseService.activeProtocol="ANY";break;case 1004:this._coreService.decPrivateModes.sendFocus=!0,this._onRequestSendFocus.fire();break;case 1005:this._logService.debug("DECSET 1005 not supported (see #2507)");break;case 1006:this._coreMouseService.activeEncoding="SGR";break;case 1015:this._logService.debug("DECSET 1015 not supported (see #2507)");break;case 1016:this._coreMouseService.activeEncoding="SGR_PIXELS";break;case 25:this._coreService.isCursorHidden=!1;break;case 1048:this.saveCursor();break;case 1049:this.saveCursor();case 47:case 1047:this._bufferService.buffers.activateAltBuffer(this._eraseAttrData()),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!0}return!0}resetMode(e){for(let t=0;t<e.length;t++)switch(e.params[t]){case 4:this._coreService.modes.insertMode=!1;break;case 20:this._optionsService.options.convertEol=!1}return!0}resetModePrivate(e){for(let t=0;t<e.length;t++)switch(e.params[t]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!1;break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(80,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!1,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!1;break;case 12:this._optionsService.options.cursorBlink=!1;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!1;break;case 66:this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire();break;case 9:case 1e3:case 1002:case 1003:this._coreMouseService.activeProtocol="NONE";break;case 1004:this._coreService.decPrivateModes.sendFocus=!1;break;case 1005:this._logService.debug("DECRST 1005 not supported (see #2507)");break;case 1006:case 1016:this._coreMouseService.activeEncoding="DEFAULT";break;case 1015:this._logService.debug("DECRST 1015 not supported (see #2507)");break;case 25:this._coreService.isCursorHidden=!0;break;case 1048:this.restoreCursor();break;case 1049:case 47:case 1047:this._bufferService.buffers.activateNormalBuffer(),1049===e.params[t]&&this.restoreCursor(),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!1}return!0}requestMode(e,t){const i=this._coreService.decPrivateModes,{activeProtocol:s,activeEncoding:n}=this._coreMouseService,o=this._coreService,{buffers:a,cols:l}=this._bufferService,{active:h,alt:c}=a,d=this._optionsService.rawOptions,u=e=>e?1:2,p=e.params[0];return m=p,f=t?2===p?4:4===p?u(o.modes.insertMode):12===p?3:20===p?u(d.convertEol):0:1===p?u(i.applicationCursorKeys):3===p?d.windowOptions.setWinLines?80===l?2:132===l?1:0:0:6===p?u(i.origin):7===p?u(i.wraparound):8===p?3:9===p?u("X10"===s):12===p?u(d.cursorBlink):25===p?u(!o.isCursorHidden):45===p?u(i.reverseWraparound):66===p?u(i.applicationKeypad):67===p?4:1e3===p?u("VT200"===s):1002===p?u("DRAG"===s):1003===p?u("ANY"===s):1004===p?u(i.sendFocus):1005===p?4:1006===p?u("SGR"===n):1015===p?4:1016===p?u("SGR_PIXELS"===n):1048===p?1:47===p||1047===p||1049===p?u(h===c):2004===p?u(i.bracketedPasteMode):0,o.triggerDataEvent(`${r.C0.ESC}[${t?"":"?"}${m};${f}$y`),!0;var m,f}_updateAttrColor(e,t,i,s,n){return 2===t?(e|=50331648,e&=-16777216,e|=m.AttributeData.fromColorRGB([i,s,n])):5===t&&(e&=-50331904,e|=33554432|255&i),e}_extractColor(e,t,i){const s=[0,0,-1,0,0,0];let n=0,r=0;do{if(s[r+n]=e.params[t+r],e.hasSubParams(t+r)){const i=e.getSubParams(t+r);let o=0;do{5===s[1]&&(n=1),s[r+o+1+n]=i[o]}while(++o<i.length&&o+r+1+n<s.length);break}if(5===s[1]&&r+n>=2||2===s[1]&&r+n>=5)break;s[1]&&(n=1)}while(++r+t<e.length&&r+n<s.length);for(let e=2;e<s.length;++e)-1===s[e]&&(s[e]=0);switch(s[0]){case 38:i.fg=this._updateAttrColor(i.fg,s[1],s[3],s[4],s[5]);break;case 48:i.bg=this._updateAttrColor(i.bg,s[1],s[3],s[4],s[5]);break;case 58:i.extended=i.extended.clone(),i.extended.underlineColor=this._updateAttrColor(i.extended.underlineColor,s[1],s[3],s[4],s[5])}return r}_processUnderline(e,t){t.extended=t.extended.clone(),(!~e||e>5)&&(e=1),t.extended.underlineStyle=e,t.fg|=268435456,0===e&&(t.fg&=-268435457),t.updateExtended()}_processSGR0(e){e.fg=c.DEFAULT_ATTR_DATA.fg,e.bg=c.DEFAULT_ATTR_DATA.bg,e.extended=e.extended.clone(),e.extended.underlineStyle=0,e.extended.underlineColor&=-67108864,e.updateExtended()}charAttributes(e){if(1===e.length&&0===e.params[0])return this._processSGR0(this._curAttrData),!0;const t=e.length;let i;const s=this._curAttrData;for(let n=0;n<t;n++)i=e.params[n],i>=30&&i<=37?(s.fg&=-50331904,s.fg|=16777216|i-30):i>=40&&i<=47?(s.bg&=-50331904,s.bg|=16777216|i-40):i>=90&&i<=97?(s.fg&=-50331904,s.fg|=16777224|i-90):i>=100&&i<=107?(s.bg&=-50331904,s.bg|=16777224|i-100):0===i?this._processSGR0(s):1===i?s.fg|=134217728:3===i?s.bg|=67108864:4===i?(s.fg|=268435456,this._processUnderline(e.hasSubParams(n)?e.getSubParams(n)[0]:1,s)):5===i?s.fg|=536870912:7===i?s.fg|=67108864:8===i?s.fg|=1073741824:9===i?s.fg|=2147483648:2===i?s.bg|=134217728:21===i?this._processUnderline(2,s):22===i?(s.fg&=-134217729,s.bg&=-134217729):23===i?s.bg&=-67108865:24===i?(s.fg&=-268435457,this._processUnderline(0,s)):25===i?s.fg&=-536870913:27===i?s.fg&=-67108865:28===i?s.fg&=-1073741825:29===i?s.fg&=2147483647:39===i?(s.fg&=-67108864,s.fg|=16777215&c.DEFAULT_ATTR_DATA.fg):49===i?(s.bg&=-67108864,s.bg|=16777215&c.DEFAULT_ATTR_DATA.bg):38===i||48===i||58===i?n+=this._extractColor(e,n,s):53===i?s.bg|=1073741824:55===i?s.bg&=-1073741825:59===i?(s.extended=s.extended.clone(),s.extended.underlineColor=-1,s.updateExtended()):100===i?(s.fg&=-67108864,s.fg|=16777215&c.DEFAULT_ATTR_DATA.fg,s.bg&=-67108864,s.bg|=16777215&c.DEFAULT_ATTR_DATA.bg):this._logService.debug("Unknown SGR attribute: %d.",i);return!0}deviceStatus(e){switch(e.params[0]){case 5:this._coreService.triggerDataEvent(`${r.C0.ESC}[0n`);break;case 6:const e=this._activeBuffer.y+1,t=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${r.C0.ESC}[${e};${t}R`)}return!0}deviceStatusPrivate(e){if(6===e.params[0]){const e=this._activeBuffer.y+1,t=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${r.C0.ESC}[?${e};${t}R`)}return!0}softReset(e){return this._coreService.isCursorHidden=!1,this._onRequestSyncScrollBar.fire(),this._activeBuffer.scrollTop=0,this._activeBuffer.scrollBottom=this._bufferService.rows-1,this._curAttrData=c.DEFAULT_ATTR_DATA.clone(),this._coreService.reset(),this._charsetService.reset(),this._activeBuffer.savedX=0,this._activeBuffer.savedY=this._activeBuffer.ybase,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,this._coreService.decPrivateModes.origin=!1,!0}setCursorStyle(e){const t=e.params[0]||1;switch(t){case 1:case 2:this._optionsService.options.cursorStyle="block";break;case 3:case 4:this._optionsService.options.cursorStyle="underline";break;case 5:case 6:this._optionsService.options.cursorStyle="bar"}const i=t%2==1;return this._optionsService.options.cursorBlink=i,!0}setScrollRegion(e){const t=e.params[0]||1;let i;return(e.length<2||(i=e.params[1])>this._bufferService.rows||0===i)&&(i=this._bufferService.rows),i>t&&(this._activeBuffer.scrollTop=t-1,this._activeBuffer.scrollBottom=i-1,this._setCursor(0,0)),!0}windowOptions(e){if(!w(e.params[0],this._optionsService.rawOptions.windowOptions))return!0;const t=e.length>1?e.params[1]:0;switch(e.params[0]){case 14:2!==t&&this._onRequestWindowsOptionsReport.fire(S.GET_WIN_SIZE_PIXELS);break;case 16:this._onRequestWindowsOptionsReport.fire(S.GET_CELL_SIZE_PIXELS);break;case 18:this._bufferService&&this._coreService.triggerDataEvent(`${r.C0.ESC}[8;${this._bufferService.rows};${this._bufferService.cols}t`);break;case 22:0!==t&&2!==t||(this._windowTitleStack.push(this._windowTitle),this._windowTitleStack.length>10&&this._windowTitleStack.shift()),0!==t&&1!==t||(this._iconNameStack.push(this._iconName),this._iconNameStack.length>10&&this._iconNameStack.shift());break;case 23:0!==t&&2!==t||this._windowTitleStack.length&&this.setTitle(this._windowTitleStack.pop()),0!==t&&1!==t||this._iconNameStack.length&&this.setIconName(this._iconNameStack.pop())}return!0}saveCursor(e){return this._activeBuffer.savedX=this._activeBuffer.x,this._activeBuffer.savedY=this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,!0}restoreCursor(e){return this._activeBuffer.x=this._activeBuffer.savedX||0,this._activeBuffer.y=Math.max(this._activeBuffer.savedY-this._activeBuffer.ybase,0),this._curAttrData.fg=this._activeBuffer.savedCurAttrData.fg,this._curAttrData.bg=this._activeBuffer.savedCurAttrData.bg,this._charsetService.charset=this._savedCharset,this._activeBuffer.savedCharset&&(this._charsetService.charset=this._activeBuffer.savedCharset),this._restrictCursor(),!0}setTitle(e){return this._windowTitle=e,this._onTitleChange.fire(e),!0}setIconName(e){return this._iconName=e,!0}setOrReportIndexedColor(e){const t=[],i=e.split(";");for(;i.length>1;){const e=i.shift(),s=i.shift();if(/^\d+$/.exec(e)){const i=parseInt(e);if(O(i))if("?"===s)t.push({type:0,index:i});else{const e=(0,b.parseColor)(s);e&&t.push({type:1,index:i,color:e})}}}return t.length&&this._onColor.fire(t),!0}setHyperlink(e){const t=e.split(";");return!(t.length<2)&&(t[1]?this._createHyperlink(t[0],t[1]):!t[0]&&this._finishHyperlink())}_createHyperlink(e,t){this._getCurrentLinkId()&&this._finishHyperlink();const i=e.split(":");let s;const n=i.findIndex((e=>e.startsWith("id=")));return-1!==n&&(s=i[n].slice(3)||void 0),this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=this._oscLinkService.registerLink({id:s,uri:t}),this._curAttrData.updateExtended(),!0}_finishHyperlink(){return this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=0,this._curAttrData.updateExtended(),!0}_setOrReportSpecialColor(e,t){const i=e.split(";");for(let e=0;e<i.length&&!(t>=this._specialColors.length);++e,++t)if("?"===i[e])this._onColor.fire([{type:0,index:this._specialColors[t]}]);else{const s=(0,b.parseColor)(i[e]);s&&this._onColor.fire([{type:1,index:this._specialColors[t],color:s}])}return!0}setOrReportFgColor(e){return this._setOrReportSpecialColor(e,0)}setOrReportBgColor(e){return this._setOrReportSpecialColor(e,1)}setOrReportCursorColor(e){return this._setOrReportSpecialColor(e,2)}restoreIndexedColor(e){if(!e)return this._onColor.fire([{type:2}]),!0;const t=[],i=e.split(";");for(let e=0;e<i.length;++e)if(/^\d+$/.exec(i[e])){const s=parseInt(i[e]);O(s)&&t.push({type:2,index:s})}return t.length&&this._onColor.fire(t),!0}restoreFgColor(e){return this._onColor.fire([{type:2,index:256}]),!0}restoreBgColor(e){return this._onColor.fire([{type:2,index:257}]),!0}restoreCursorColor(e){return this._onColor.fire([{type:2,index:258}]),!0}nextLine(){return this._activeBuffer.x=0,this.index(),!0}keypadApplicationMode(){return this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire(),!0}keypadNumericMode(){return this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire(),!0}selectDefaultCharset(){return this._charsetService.setgLevel(0),this._charsetService.setgCharset(0,o.DEFAULT_CHARSET),!0}selectCharset(e){return 2!==e.length?(this.selectDefaultCharset(),!0):("/"===e[0]||this._charsetService.setgCharset(y[e[0]],o.CHARSETS[e[1]]||o.DEFAULT_CHARSET),!0)}index(){return this._restrictCursor(),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._restrictCursor(),!0}tabSet(){return this._activeBuffer.tabs[this._activeBuffer.x]=!0,!0}reverseIndex(){if(this._restrictCursor(),this._activeBuffer.y===this._activeBuffer.scrollTop){const e=this._activeBuffer.scrollBottom-this._activeBuffer.scrollTop;this._activeBuffer.lines.shiftElements(this._activeBuffer.ybase+this._activeBuffer.y,e,1),this._activeBuffer.lines.set(this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.getBlankLine(this._eraseAttrData())),this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom)}else this._activeBuffer.y--,this._restrictCursor();return!0}fullReset(){return this._parser.reset(),this._onRequestReset.fire(),!0}reset(){this._curAttrData=c.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=c.DEFAULT_ATTR_DATA.clone()}_eraseAttrData(){return this._eraseAttrDataInternal.bg&=-67108864,this._eraseAttrDataInternal.bg|=67108863&this._curAttrData.bg,this._eraseAttrDataInternal}setgLevel(e){return this._charsetService.setgLevel(e),!0}screenAlignmentPattern(){const e=new p.CellData;e.content=1<<22|"E".charCodeAt(0),e.fg=this._curAttrData.fg,e.bg=this._curAttrData.bg,this._setCursor(0,0);for(let t=0;t<this._bufferService.rows;++t){const i=this._activeBuffer.ybase+this._activeBuffer.y+t,s=this._activeBuffer.lines.get(i);s&&(s.fill(e),s.isWrapped=!1)}return this._dirtyRowTracker.markAllDirty(),this._setCursor(0,0),!0}requestStatusString(e,t){const i=this._bufferService.buffer,s=this._optionsService.rawOptions;return(e=>(this._coreService.triggerDataEvent(`${r.C0.ESC}${e}${r.C0.ESC}\\`),!0))('"q'===e?`P1$r${this._curAttrData.isProtected()?1:0}"q`:'"p'===e?'P1$r61;1"p':"r"===e?`P1$r${i.scrollTop+1};${i.scrollBottom+1}r`:"m"===e?"P1$r0m":" q"===e?`P1$r${{block:2,underline:4,bar:6}[s.cursorStyle]-(s.cursorBlink?1:0)} q`:"P0$r")}markRangeDirty(e,t){this._dirtyRowTracker.markRangeDirty(e,t)}}t.InputHandler=x;let T=class{constructor(e){this._bufferService=e,this.clearRange()}clearRange(){this.start=this._bufferService.buffer.y,this.end=this._bufferService.buffer.y}markDirty(e){e<this.start?this.start=e:e>this.end&&(this.end=e)}markRangeDirty(e,t){e>t&&(E=e,e=t,t=E),e<this.start&&(this.start=e),t>this.end&&(this.end=t)}markAllDirty(){this.markRangeDirty(0,this._bufferService.rows-1)}};function O(e){return 0<=e&&e<256}T=s([n(0,f.IBufferService)],T)},844:(e,t)=>{function i(e){for(const t of e)t.dispose();e.length=0}Object.defineProperty(t,"__esModule",{value:!0}),t.getDisposeArrayDisposable=t.disposeArray=t.toDisposable=t.MutableDisposable=t.Disposable=void 0,t.Disposable=class{constructor(){this._disposables=[],this._isDisposed=!1}dispose(){this._isDisposed=!0;for(const e of this._disposables)e.dispose();this._disposables.length=0}register(e){return this._disposables.push(e),e}unregister(e){const t=this._disposables.indexOf(e);-1!==t&&this._disposables.splice(t,1)}},t.MutableDisposable=class{constructor(){this._isDisposed=!1}get value(){return this._isDisposed?void 0:this._value}set value(e){this._isDisposed||e===this._value||(this._value?.dispose(),this._value=e)}clear(){this.value=void 0}dispose(){this._isDisposed=!0,this._value?.dispose(),this._value=void 0}},t.toDisposable=function(e){return{dispose:e}},t.disposeArray=i,t.getDisposeArrayDisposable=function(e){return{dispose:()=>i(e)}}},1505:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FourKeyMap=t.TwoKeyMap=void 0;class i{constructor(){this._data={}}set(e,t,i){this._data[e]||(this._data[e]={}),this._data[e][t]=i}get(e,t){return this._data[e]?this._data[e][t]:void 0}clear(){this._data={}}}t.TwoKeyMap=i,t.FourKeyMap=class{constructor(){this._data=new i}set(e,t,s,n,r){this._data.get(e,t)||this._data.set(e,t,new i),this._data.get(e,t).set(s,n,r)}get(e,t,i,s){return this._data.get(e,t)?.get(i,s)}clear(){this._data.clear()}}},6114:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isChromeOS=t.isLinux=t.isWindows=t.isIphone=t.isIpad=t.isMac=t.getSafariVersion=t.isSafari=t.isLegacyEdge=t.isFirefox=t.isNode=void 0,t.isNode="undefined"!=typeof process&&"title"in process;const i=t.isNode?"node":navigator.userAgent,s=t.isNode?"node":navigator.platform;t.isFirefox=i.includes("Firefox"),t.isLegacyEdge=i.includes("Edge"),t.isSafari=/^((?!chrome|android).)*safari/i.test(i),t.getSafariVersion=function(){if(!t.isSafari)return 0;const e=i.match(/Version\/(\d+)/);return null===e||e.length<2?0:parseInt(e[1])},t.isMac=["Macintosh","MacIntel","MacPPC","Mac68K"].includes(s),t.isIpad="iPad"===s,t.isIphone="iPhone"===s,t.isWindows=["Windows","Win16","Win32","WinCE"].includes(s),t.isLinux=s.indexOf("Linux")>=0,t.isChromeOS=/\bCrOS\b/.test(i)},6106:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SortedList=void 0;let i=0;t.SortedList=class{constructor(e){this._getKey=e,this._array=[]}clear(){this._array.length=0}insert(e){0!==this._array.length?(i=this._search(this._getKey(e)),this._array.splice(i,0,e)):this._array.push(e)}delete(e){if(0===this._array.length)return!1;const t=this._getKey(e);if(void 0===t)return!1;if(i=this._search(t),-1===i)return!1;if(this._getKey(this._array[i])!==t)return!1;do{if(this._array[i]===e)return this._array.splice(i,1),!0}while(++i<this._array.length&&this._getKey(this._array[i])===t);return!1}*getKeyIterator(e){if(0!==this._array.length&&(i=this._search(e),!(i<0||i>=this._array.length)&&this._getKey(this._array[i])===e))do{yield this._array[i]}while(++i<this._array.length&&this._getKey(this._array[i])===e)}forEachByKey(e,t){if(0!==this._array.length&&(i=this._search(e),!(i<0||i>=this._array.length)&&this._getKey(this._array[i])===e))do{t(this._array[i])}while(++i<this._array.length&&this._getKey(this._array[i])===e)}values(){return[...this._array].values()}_search(e){let t=0,i=this._array.length-1;for(;i>=t;){let s=t+i>>1;const n=this._getKey(this._array[s]);if(n>e)i=s-1;else{if(!(n<e)){for(;s>0&&this._getKey(this._array[s-1])===e;)s--;return s}t=s+1}}return t}}},7226:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DebouncedIdleTask=t.IdleTaskQueue=t.PriorityTaskQueue=void 0;const s=i(6114);class n{constructor(){this._tasks=[],this._i=0}enqueue(e){this._tasks.push(e),this._start()}flush(){for(;this._i<this._tasks.length;)this._tasks[this._i]()||this._i++;this.clear()}clear(){this._idleCallback&&(this._cancelCallback(this._idleCallback),this._idleCallback=void 0),this._i=0,this._tasks.length=0}_start(){this._idleCallback||(this._idleCallback=this._requestCallback(this._process.bind(this)))}_process(e){this._idleCallback=void 0;let t=0,i=0,s=e.timeRemaining(),n=0;for(;this._i<this._tasks.length;){if(t=Date.now(),this._tasks[this._i]()||this._i++,t=Math.max(1,Date.now()-t),i=Math.max(t,i),n=e.timeRemaining(),1.5*i>n)return s-t<-20&&console.warn(`task queue exceeded allotted deadline by ${Math.abs(Math.round(s-t))}ms`),void this._start();s=n}this.clear()}}class r extends n{_requestCallback(e){return setTimeout((()=>e(this._createDeadline(16))))}_cancelCallback(e){clearTimeout(e)}_createDeadline(e){const t=Date.now()+e;return{timeRemaining:()=>Math.max(0,t-Date.now())}}}t.PriorityTaskQueue=r,t.IdleTaskQueue=!s.isNode&&"requestIdleCallback"in window?class extends n{_requestCallback(e){return requestIdleCallback(e)}_cancelCallback(e){cancelIdleCallback(e)}}:r,t.DebouncedIdleTask=class{constructor(){this._queue=new t.IdleTaskQueue}set(e){this._queue.clear(),this._queue.enqueue(e)}flush(){this._queue.flush()}}},9282:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateWindowsModeWrappedState=void 0;const s=i(643);t.updateWindowsModeWrappedState=function(e){const t=e.buffer.lines.get(e.buffer.ybase+e.buffer.y-1),i=t?.get(e.cols-1),n=e.buffer.lines.get(e.buffer.ybase+e.buffer.y);n&&i&&(n.isWrapped=i[s.CHAR_DATA_CODE_INDEX]!==s.NULL_CELL_CODE&&i[s.CHAR_DATA_CODE_INDEX]!==s.WHITESPACE_CELL_CODE)}},3734:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ExtendedAttrs=t.AttributeData=void 0;class i{constructor(){this.fg=0,this.bg=0,this.extended=new s}static toColorRGB(e){return[e>>>16&255,e>>>8&255,255&e]}static fromColorRGB(e){return(255&e[0])<<16|(255&e[1])<<8|255&e[2]}clone(){const e=new i;return e.fg=this.fg,e.bg=this.bg,e.extended=this.extended.clone(),e}isInverse(){return 67108864&this.fg}isBold(){return 134217728&this.fg}isUnderline(){return this.hasExtendedAttrs()&&0!==this.extended.underlineStyle?1:268435456&this.fg}isBlink(){return 536870912&this.fg}isInvisible(){return 1073741824&this.fg}isItalic(){return 67108864&this.bg}isDim(){return 134217728&this.bg}isStrikethrough(){return 2147483648&this.fg}isProtected(){return 536870912&this.bg}isOverline(){return 1073741824&this.bg}getFgColorMode(){return 50331648&this.fg}getBgColorMode(){return 50331648&this.bg}isFgRGB(){return!(50331648&~this.fg)}isBgRGB(){return!(50331648&~this.bg)}isFgPalette(){return 16777216==(50331648&this.fg)||33554432==(50331648&this.fg)}isBgPalette(){return 16777216==(50331648&this.bg)||33554432==(50331648&this.bg)}isFgDefault(){return!(50331648&this.fg)}isBgDefault(){return!(50331648&this.bg)}isAttributeDefault(){return 0===this.fg&&0===this.bg}getFgColor(){switch(50331648&this.fg){case 16777216:case 33554432:return 255&this.fg;case 50331648:return 16777215&this.fg;default:return-1}}getBgColor(){switch(50331648&this.bg){case 16777216:case 33554432:return 255&this.bg;case 50331648:return 16777215&this.bg;default:return-1}}hasExtendedAttrs(){return 268435456&this.bg}updateExtended(){this.extended.isEmpty()?this.bg&=-268435457:this.bg|=268435456}getUnderlineColor(){if(268435456&this.bg&&~this.extended.underlineColor)switch(50331648&this.extended.underlineColor){case 16777216:case 33554432:return 255&this.extended.underlineColor;case 50331648:return 16777215&this.extended.underlineColor;default:return this.getFgColor()}return this.getFgColor()}getUnderlineColorMode(){return 268435456&this.bg&&~this.extended.underlineColor?50331648&this.extended.underlineColor:this.getFgColorMode()}isUnderlineColorRGB(){return 268435456&this.bg&&~this.extended.underlineColor?!(50331648&~this.extended.underlineColor):this.isFgRGB()}isUnderlineColorPalette(){return 268435456&this.bg&&~this.extended.underlineColor?16777216==(50331648&this.extended.underlineColor)||33554432==(50331648&this.extended.underlineColor):this.isFgPalette()}isUnderlineColorDefault(){return 268435456&this.bg&&~this.extended.underlineColor?!(50331648&this.extended.underlineColor):this.isFgDefault()}getUnderlineStyle(){return 268435456&this.fg?268435456&this.bg?this.extended.underlineStyle:1:0}getUnderlineVariantOffset(){return this.extended.underlineVariantOffset}}t.AttributeData=i;class s{get ext(){return this._urlId?-469762049&this._ext|this.underlineStyle<<26:this._ext}set ext(e){this._ext=e}get underlineStyle(){return this._urlId?5:(469762048&this._ext)>>26}set underlineStyle(e){this._ext&=-469762049,this._ext|=e<<26&469762048}get underlineColor(){return 67108863&this._ext}set underlineColor(e){this._ext&=-67108864,this._ext|=67108863&e}get urlId(){return this._urlId}set urlId(e){this._urlId=e}get underlineVariantOffset(){const e=(3758096384&this._ext)>>29;return e<0?4294967288^e:e}set underlineVariantOffset(e){this._ext&=536870911,this._ext|=e<<29&3758096384}constructor(e=0,t=0){this._ext=0,this._urlId=0,this._ext=e,this._urlId=t}clone(){return new s(this._ext,this._urlId)}isEmpty(){return 0===this.underlineStyle&&0===this._urlId}}t.ExtendedAttrs=s},9092:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Buffer=t.MAX_BUFFER_SIZE=void 0;const s=i(6349),n=i(7226),r=i(3734),o=i(8437),a=i(4634),l=i(511),h=i(643),c=i(4863),d=i(7116);t.MAX_BUFFER_SIZE=4294967295,t.Buffer=class{constructor(e,t,i){this._hasScrollback=e,this._optionsService=t,this._bufferService=i,this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.tabs={},this.savedY=0,this.savedX=0,this.savedCurAttrData=o.DEFAULT_ATTR_DATA.clone(),this.savedCharset=d.DEFAULT_CHARSET,this.markers=[],this._nullCell=l.CellData.fromCharData([0,h.NULL_CELL_CHAR,h.NULL_CELL_WIDTH,h.NULL_CELL_CODE]),this._whitespaceCell=l.CellData.fromCharData([0,h.WHITESPACE_CELL_CHAR,h.WHITESPACE_CELL_WIDTH,h.WHITESPACE_CELL_CODE]),this._isClearing=!1,this._memoryCleanupQueue=new n.IdleTaskQueue,this._memoryCleanupPosition=0,this._cols=this._bufferService.cols,this._rows=this._bufferService.rows,this.lines=new s.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}getNullCell(e){return e?(this._nullCell.fg=e.fg,this._nullCell.bg=e.bg,this._nullCell.extended=e.extended):(this._nullCell.fg=0,this._nullCell.bg=0,this._nullCell.extended=new r.ExtendedAttrs),this._nullCell}getWhitespaceCell(e){return e?(this._whitespaceCell.fg=e.fg,this._whitespaceCell.bg=e.bg,this._whitespaceCell.extended=e.extended):(this._whitespaceCell.fg=0,this._whitespaceCell.bg=0,this._whitespaceCell.extended=new r.ExtendedAttrs),this._whitespaceCell}getBlankLine(e,t){return new o.BufferLine(this._bufferService.cols,this.getNullCell(e),t)}get hasScrollback(){return this._hasScrollback&&this.lines.maxLength>this._rows}get isCursorInViewport(){const e=this.ybase+this.y-this.ydisp;return e>=0&&e<this._rows}_getCorrectBufferLength(e){if(!this._hasScrollback)return e;const i=e+this._optionsService.rawOptions.scrollback;return i>t.MAX_BUFFER_SIZE?t.MAX_BUFFER_SIZE:i}fillViewportRows(e){if(0===this.lines.length){void 0===e&&(e=o.DEFAULT_ATTR_DATA);let t=this._rows;for(;t--;)this.lines.push(this.getBlankLine(e))}}clear(){this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.lines=new s.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}resize(e,t){const i=this.getNullCell(o.DEFAULT_ATTR_DATA);let s=0;const n=this._getCorrectBufferLength(t);if(n>this.lines.maxLength&&(this.lines.maxLength=n),this.lines.length>0){if(this._cols<e)for(let t=0;t<this.lines.length;t++)s+=+this.lines.get(t).resize(e,i);let r=0;if(this._rows<t)for(let s=this._rows;s<t;s++)this.lines.length<t+this.ybase&&(this._optionsService.rawOptions.windowsMode||void 0!==this._optionsService.rawOptions.windowsPty.backend||void 0!==this._optionsService.rawOptions.windowsPty.buildNumber?this.lines.push(new o.BufferLine(e,i)):this.ybase>0&&this.lines.length<=this.ybase+this.y+r+1?(this.ybase--,r++,this.ydisp>0&&this.ydisp--):this.lines.push(new o.BufferLine(e,i)));else for(let e=this._rows;e>t;e--)this.lines.length>t+this.ybase&&(this.lines.length>this.ybase+this.y+1?this.lines.pop():(this.ybase++,this.ydisp++));if(n<this.lines.maxLength){const e=this.lines.length-n;e>0&&(this.lines.trimStart(e),this.ybase=Math.max(this.ybase-e,0),this.ydisp=Math.max(this.ydisp-e,0),this.savedY=Math.max(this.savedY-e,0)),this.lines.maxLength=n}this.x=Math.min(this.x,e-1),this.y=Math.min(this.y,t-1),r&&(this.y+=r),this.savedX=Math.min(this.savedX,e-1),this.scrollTop=0}if(this.scrollBottom=t-1,this._isReflowEnabled&&(this._reflow(e,t),this._cols>e))for(let t=0;t<this.lines.length;t++)s+=+this.lines.get(t).resize(e,i);this._cols=e,this._rows=t,this._memoryCleanupQueue.clear(),s>.1*this.lines.length&&(this._memoryCleanupPosition=0,this._memoryCleanupQueue.enqueue((()=>this._batchedMemoryCleanup())))}_batchedMemoryCleanup(){let e=!0;this._memoryCleanupPosition>=this.lines.length&&(this._memoryCleanupPosition=0,e=!1);let t=0;for(;this._memoryCleanupPosition<this.lines.length;)if(t+=this.lines.get(this._memoryCleanupPosition++).cleanupMemory(),t>100)return!0;return e}get _isReflowEnabled(){const e=this._optionsService.rawOptions.windowsPty;return e&&e.buildNumber?this._hasScrollback&&"conpty"===e.backend&&e.buildNumber>=21376:this._hasScrollback&&!this._optionsService.rawOptions.windowsMode}_reflow(e,t){this._cols!==e&&(e>this._cols?this._reflowLarger(e,t):this._reflowSmaller(e,t))}_reflowLarger(e,t){const i=(0,a.reflowLargerGetLinesToRemove)(this.lines,this._cols,e,this.ybase+this.y,this.getNullCell(o.DEFAULT_ATTR_DATA));if(i.length>0){const s=(0,a.reflowLargerCreateNewLayout)(this.lines,i);(0,a.reflowLargerApplyNewLayout)(this.lines,s.layout),this._reflowLargerAdjustViewport(e,t,s.countRemoved)}}_reflowLargerAdjustViewport(e,t,i){const s=this.getNullCell(o.DEFAULT_ATTR_DATA);let n=i;for(;n-- >0;)0===this.ybase?(this.y>0&&this.y--,this.lines.length<t&&this.lines.push(new o.BufferLine(e,s))):(this.ydisp===this.ybase&&this.ydisp--,this.ybase--);this.savedY=Math.max(this.savedY-i,0)}_reflowSmaller(e,t){const i=this.getNullCell(o.DEFAULT_ATTR_DATA),s=[];let n=0;for(let r=this.lines.length-1;r>=0;r--){let l=this.lines.get(r);if(!l||!l.isWrapped&&l.getTrimmedLength()<=e)continue;const h=[l];for(;l.isWrapped&&r>0;)l=this.lines.get(--r),h.unshift(l);const c=this.ybase+this.y;if(c>=r&&c<r+h.length)continue;const d=h[h.length-1].getTrimmedLength(),u=(0,a.reflowSmallerGetNewLineLengths)(h,this._cols,e),p=u.length-h.length;let m;m=0===this.ybase&&this.y!==this.lines.length-1?Math.max(0,this.y-this.lines.maxLength+p):Math.max(0,this.lines.length-this.lines.maxLength+p);const f=[];for(let e=0;e<p;e++){const e=this.getBlankLine(o.DEFAULT_ATTR_DATA,!0);f.push(e)}f.length>0&&(s.push({start:r+h.length+n,newLines:f}),n+=f.length),h.push(...f);let g=u.length-1,_=u[g];0===_&&(g--,_=u[g]);let v=h.length-p-1,b=d;for(;v>=0;){const e=Math.min(b,_);if(void 0===h[g])break;if(h[g].copyCellsFrom(h[v],b-e,_-e,e,!0),_-=e,0===_&&(g--,_=u[g]),b-=e,0===b){v--;const e=Math.max(v,0);b=(0,a.getWrappedLineTrimmedLength)(h,e,this._cols)}}for(let t=0;t<h.length;t++)u[t]<e&&h[t].setCell(u[t],i);let y=p-m;for(;y-- >0;)0===this.ybase?this.y<t-1?(this.y++,this.lines.pop()):(this.ybase++,this.ydisp++):this.ybase<Math.min(this.lines.maxLength,this.lines.length+n)-t&&(this.ybase===this.ydisp&&this.ydisp++,this.ybase++);this.savedY=Math.min(this.savedY+p,this.ybase+t-1)}if(s.length>0){const e=[],t=[];for(let e=0;e<this.lines.length;e++)t.push(this.lines.get(e));const i=this.lines.length;let r=i-1,o=0,a=s[o];this.lines.length=Math.min(this.lines.maxLength,this.lines.length+n);let l=0;for(let h=Math.min(this.lines.maxLength-1,i+n-1);h>=0;h--)if(a&&a.start>r+l){for(let e=a.newLines.length-1;e>=0;e--)this.lines.set(h--,a.newLines[e]);h++,e.push({index:r+1,amount:a.newLines.length}),l+=a.newLines.length,a=s[++o]}else this.lines.set(h,t[r--]);let h=0;for(let t=e.length-1;t>=0;t--)e[t].index+=h,this.lines.onInsertEmitter.fire(e[t]),h+=e[t].amount;const c=Math.max(0,i+n-this.lines.maxLength);c>0&&this.lines.onTrimEmitter.fire(c)}}translateBufferLineToString(e,t,i=0,s){const n=this.lines.get(e);return n?n.translateToString(t,i,s):""}getWrappedRangeForLine(e){let t=e,i=e;for(;t>0&&this.lines.get(t).isWrapped;)t--;for(;i+1<this.lines.length&&this.lines.get(i+1).isWrapped;)i++;return{first:t,last:i}}setupTabStops(e){for(null!=e?this.tabs[e]||(e=this.prevStop(e)):(this.tabs={},e=0);e<this._cols;e+=this._optionsService.rawOptions.tabStopWidth)this.tabs[e]=!0}prevStop(e){for(null==e&&(e=this.x);!this.tabs[--e]&&e>0;);return e>=this._cols?this._cols-1:e<0?0:e}nextStop(e){for(null==e&&(e=this.x);!this.tabs[++e]&&e<this._cols;);return e>=this._cols?this._cols-1:e<0?0:e}clearMarkers(e){this._isClearing=!0;for(let t=0;t<this.markers.length;t++)this.markers[t].line===e&&(this.markers[t].dispose(),this.markers.splice(t--,1));this._isClearing=!1}clearAllMarkers(){this._isClearing=!0;for(let e=0;e<this.markers.length;e++)this.markers[e].dispose(),this.markers.splice(e--,1);this._isClearing=!1}addMarker(e){const t=new c.Marker(e);return this.markers.push(t),t.register(this.lines.onTrim((e=>{t.line-=e,t.line<0&&t.dispose()}))),t.register(this.lines.onInsert((e=>{t.line>=e.index&&(t.line+=e.amount)}))),t.register(this.lines.onDelete((e=>{t.line>=e.index&&t.line<e.index+e.amount&&t.dispose(),t.line>e.index&&(t.line-=e.amount)}))),t.register(t.onDispose((()=>this._removeMarker(t)))),t}_removeMarker(e){this._isClearing||this.markers.splice(this.markers.indexOf(e),1)}}},8437:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BufferLine=t.DEFAULT_ATTR_DATA=void 0;const s=i(3734),n=i(511),r=i(643),o=i(482);t.DEFAULT_ATTR_DATA=Object.freeze(new s.AttributeData);let a=0;class l{constructor(e,t,i=!1){this.isWrapped=i,this._combined={},this._extendedAttrs={},this._data=new Uint32Array(3*e);const s=t||n.CellData.fromCharData([0,r.NULL_CELL_CHAR,r.NULL_CELL_WIDTH,r.NULL_CELL_CODE]);for(let t=0;t<e;++t)this.setCell(t,s);this.length=e}get(e){const t=this._data[3*e+0],i=2097151&t;return[this._data[3*e+1],2097152&t?this._combined[e]:i?(0,o.stringFromCodePoint)(i):"",t>>22,2097152&t?this._combined[e].charCodeAt(this._combined[e].length-1):i]}set(e,t){this._data[3*e+1]=t[r.CHAR_DATA_ATTR_INDEX],t[r.CHAR_DATA_CHAR_INDEX].length>1?(this._combined[e]=t[1],this._data[3*e+0]=2097152|e|t[r.CHAR_DATA_WIDTH_INDEX]<<22):this._data[3*e+0]=t[r.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|t[r.CHAR_DATA_WIDTH_INDEX]<<22}getWidth(e){return this._data[3*e+0]>>22}hasWidth(e){return 12582912&this._data[3*e+0]}getFg(e){return this._data[3*e+1]}getBg(e){return this._data[3*e+2]}hasContent(e){return 4194303&this._data[3*e+0]}getCodePoint(e){const t=this._data[3*e+0];return 2097152&t?this._combined[e].charCodeAt(this._combined[e].length-1):2097151&t}isCombined(e){return 2097152&this._data[3*e+0]}getString(e){const t=this._data[3*e+0];return 2097152&t?this._combined[e]:2097151&t?(0,o.stringFromCodePoint)(2097151&t):""}isProtected(e){return 536870912&this._data[3*e+2]}loadCell(e,t){return a=3*e,t.content=this._data[a+0],t.fg=this._data[a+1],t.bg=this._data[a+2],2097152&t.content&&(t.combinedData=this._combined[e]),268435456&t.bg&&(t.extended=this._extendedAttrs[e]),t}setCell(e,t){2097152&t.content&&(this._combined[e]=t.combinedData),268435456&t.bg&&(this._extendedAttrs[e]=t.extended),this._data[3*e+0]=t.content,this._data[3*e+1]=t.fg,this._data[3*e+2]=t.bg}setCellFromCodepoint(e,t,i,s){268435456&s.bg&&(this._extendedAttrs[e]=s.extended),this._data[3*e+0]=t|i<<22,this._data[3*e+1]=s.fg,this._data[3*e+2]=s.bg}addCodepointToCell(e,t,i){let s=this._data[3*e+0];2097152&s?this._combined[e]+=(0,o.stringFromCodePoint)(t):2097151&s?(this._combined[e]=(0,o.stringFromCodePoint)(2097151&s)+(0,o.stringFromCodePoint)(t),s&=-2097152,s|=2097152):s=t|1<<22,i&&(s&=-12582913,s|=i<<22),this._data[3*e+0]=s}insertCells(e,t,i){if((e%=this.length)&&2===this.getWidth(e-1)&&this.setCellFromCodepoint(e-1,0,1,i),t<this.length-e){const s=new n.CellData;for(let i=this.length-e-t-1;i>=0;--i)this.setCell(e+t+i,this.loadCell(e+i,s));for(let s=0;s<t;++s)this.setCell(e+s,i)}else for(let t=e;t<this.length;++t)this.setCell(t,i);2===this.getWidth(this.length-1)&&this.setCellFromCodepoint(this.length-1,0,1,i)}deleteCells(e,t,i){if(e%=this.length,t<this.length-e){const s=new n.CellData;for(let i=0;i<this.length-e-t;++i)this.setCell(e+i,this.loadCell(e+t+i,s));for(let e=this.length-t;e<this.length;++e)this.setCell(e,i)}else for(let t=e;t<this.length;++t)this.setCell(t,i);e&&2===this.getWidth(e-1)&&this.setCellFromCodepoint(e-1,0,1,i),0!==this.getWidth(e)||this.hasContent(e)||this.setCellFromCodepoint(e,0,1,i)}replaceCells(e,t,i,s=!1){if(s)for(e&&2===this.getWidth(e-1)&&!this.isProtected(e-1)&&this.setCellFromCodepoint(e-1,0,1,i),t<this.length&&2===this.getWidth(t-1)&&!this.isProtected(t)&&this.setCellFromCodepoint(t,0,1,i);e<t&&e<this.length;)this.isProtected(e)||this.setCell(e,i),e++;else for(e&&2===this.getWidth(e-1)&&this.setCellFromCodepoint(e-1,0,1,i),t<this.length&&2===this.getWidth(t-1)&&this.setCellFromCodepoint(t,0,1,i);e<t&&e<this.length;)this.setCell(e++,i)}resize(e,t){if(e===this.length)return 4*this._data.length*2<this._data.buffer.byteLength;const i=3*e;if(e>this.length){if(this._data.buffer.byteLength>=4*i)this._data=new Uint32Array(this._data.buffer,0,i);else{const e=new Uint32Array(i);e.set(this._data),this._data=e}for(let i=this.length;i<e;++i)this.setCell(i,t)}else{this._data=this._data.subarray(0,i);const t=Object.keys(this._combined);for(let i=0;i<t.length;i++){const s=parseInt(t[i],10);s>=e&&delete this._combined[s]}const s=Object.keys(this._extendedAttrs);for(let t=0;t<s.length;t++){const i=parseInt(s[t],10);i>=e&&delete this._extendedAttrs[i]}}return this.length=e,4*i*2<this._data.buffer.byteLength}cleanupMemory(){if(4*this._data.length*2<this._data.buffer.byteLength){const e=new Uint32Array(this._data.length);return e.set(this._data),this._data=e,1}return 0}fill(e,t=!1){if(t)for(let t=0;t<this.length;++t)this.isProtected(t)||this.setCell(t,e);else{this._combined={},this._extendedAttrs={};for(let t=0;t<this.length;++t)this.setCell(t,e)}}copyFrom(e){this.length!==e.length?this._data=new Uint32Array(e._data):this._data.set(e._data),this.length=e.length,this._combined={};for(const t in e._combined)this._combined[t]=e._combined[t];this._extendedAttrs={};for(const t in e._extendedAttrs)this._extendedAttrs[t]=e._extendedAttrs[t];this.isWrapped=e.isWrapped}clone(){const e=new l(0);e._data=new Uint32Array(this._data),e.length=this.length;for(const t in this._combined)e._combined[t]=this._combined[t];for(const t in this._extendedAttrs)e._extendedAttrs[t]=this._extendedAttrs[t];return e.isWrapped=this.isWrapped,e}getTrimmedLength(){for(let e=this.length-1;e>=0;--e)if(4194303&this._data[3*e+0])return e+(this._data[3*e+0]>>22);return 0}getNoBgTrimmedLength(){for(let e=this.length-1;e>=0;--e)if(4194303&this._data[3*e+0]||50331648&this._data[3*e+2])return e+(this._data[3*e+0]>>22);return 0}copyCellsFrom(e,t,i,s,n){const r=e._data;if(n)for(let n=s-1;n>=0;n--){for(let e=0;e<3;e++)this._data[3*(i+n)+e]=r[3*(t+n)+e];268435456&r[3*(t+n)+2]&&(this._extendedAttrs[i+n]=e._extendedAttrs[t+n])}else for(let n=0;n<s;n++){for(let e=0;e<3;e++)this._data[3*(i+n)+e]=r[3*(t+n)+e];268435456&r[3*(t+n)+2]&&(this._extendedAttrs[i+n]=e._extendedAttrs[t+n])}const o=Object.keys(e._combined);for(let s=0;s<o.length;s++){const n=parseInt(o[s],10);n>=t&&(this._combined[n-t+i]=e._combined[n])}}translateToString(e,t,i,s){t=t??0,i=i??this.length,e&&(i=Math.min(i,this.getTrimmedLength())),s&&(s.length=0);let n="";for(;t<i;){const e=this._data[3*t+0],i=2097151&e,a=2097152&e?this._combined[t]:i?(0,o.stringFromCodePoint)(i):r.WHITESPACE_CELL_CHAR;if(n+=a,s)for(let e=0;e<a.length;++e)s.push(t);t+=e>>22||1}return s&&s.push(t),n}}t.BufferLine=l},4841:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getRangeLength=void 0,t.getRangeLength=function(e,t){if(e.start.y>e.end.y)throw new Error(`Buffer range end (${e.end.x}, ${e.end.y}) cannot be before start (${e.start.x}, ${e.start.y})`);return t*(e.end.y-e.start.y)+(e.end.x-e.start.x+1)}},4634:(e,t)=>{function i(e,t,i){if(t===e.length-1)return e[t].getTrimmedLength();const s=!e[t].hasContent(i-1)&&1===e[t].getWidth(i-1),n=2===e[t+1].getWidth(0);return s&&n?i-1:i}Object.defineProperty(t,"__esModule",{value:!0}),t.getWrappedLineTrimmedLength=t.reflowSmallerGetNewLineLengths=t.reflowLargerApplyNewLayout=t.reflowLargerCreateNewLayout=t.reflowLargerGetLinesToRemove=void 0,t.reflowLargerGetLinesToRemove=function(e,t,s,n,r){const o=[];for(let a=0;a<e.length-1;a++){let l=a,h=e.get(++l);if(!h.isWrapped)continue;const c=[e.get(a)];for(;l<e.length&&h.isWrapped;)c.push(h),h=e.get(++l);if(n>=a&&n<l){a+=c.length-1;continue}let d=0,u=i(c,d,t),p=1,m=0;for(;p<c.length;){const e=i(c,p,t),n=e-m,o=s-u,a=Math.min(n,o);c[d].copyCellsFrom(c[p],m,u,a,!1),u+=a,u===s&&(d++,u=0),m+=a,m===e&&(p++,m=0),0===u&&0!==d&&2===c[d-1].getWidth(s-1)&&(c[d].copyCellsFrom(c[d-1],s-1,u++,1,!1),c[d-1].setCell(s-1,r))}c[d].replaceCells(u,s,r);let f=0;for(let e=c.length-1;e>0&&(e>d||0===c[e].getTrimmedLength());e--)f++;f>0&&(o.push(a+c.length-f),o.push(f)),a+=c.length-1}return o},t.reflowLargerCreateNewLayout=function(e,t){const i=[];let s=0,n=t[s],r=0;for(let o=0;o<e.length;o++)if(n===o){const i=t[++s];e.onDeleteEmitter.fire({index:o-r,amount:i}),o+=i-1,r+=i,n=t[++s]}else i.push(o);return{layout:i,countRemoved:r}},t.reflowLargerApplyNewLayout=function(e,t){const i=[];for(let s=0;s<t.length;s++)i.push(e.get(t[s]));for(let t=0;t<i.length;t++)e.set(t,i[t]);e.length=t.length},t.reflowSmallerGetNewLineLengths=function(e,t,s){const n=[],r=e.map(((s,n)=>i(e,n,t))).reduce(((e,t)=>e+t));let o=0,a=0,l=0;for(;l<r;){if(r-l<s){n.push(r-l);break}o+=s;const h=i(e,a,t);o>h&&(o-=h,a++);const c=2===e[a].getWidth(o-1);c&&o--;const d=c?s-1:s;n.push(d),l+=d}return n},t.getWrappedLineTrimmedLength=i},5295:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BufferSet=void 0;const s=i(8460),n=i(844),r=i(9092);class o extends n.Disposable{constructor(e,t){super(),this._optionsService=e,this._bufferService=t,this._onBufferActivate=this.register(new s.EventEmitter),this.onBufferActivate=this._onBufferActivate.event,this.reset(),this.register(this._optionsService.onSpecificOptionChange("scrollback",(()=>this.resize(this._bufferService.cols,this._bufferService.rows)))),this.register(this._optionsService.onSpecificOptionChange("tabStopWidth",(()=>this.setupTabStops())))}reset(){this._normal=new r.Buffer(!0,this._optionsService,this._bufferService),this._normal.fillViewportRows(),this._alt=new r.Buffer(!1,this._optionsService,this._bufferService),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}),this.setupTabStops()}get alt(){return this._alt}get active(){return this._activeBuffer}get normal(){return this._normal}activateNormalBuffer(){this._activeBuffer!==this._normal&&(this._normal.x=this._alt.x,this._normal.y=this._alt.y,this._alt.clearAllMarkers(),this._alt.clear(),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}))}activateAltBuffer(e){this._activeBuffer!==this._alt&&(this._alt.fillViewportRows(e),this._alt.x=this._normal.x,this._alt.y=this._normal.y,this._activeBuffer=this._alt,this._onBufferActivate.fire({activeBuffer:this._alt,inactiveBuffer:this._normal}))}resize(e,t){this._normal.resize(e,t),this._alt.resize(e,t),this.setupTabStops(e)}setupTabStops(e){this._normal.setupTabStops(e),this._alt.setupTabStops(e)}}t.BufferSet=o},511:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CellData=void 0;const s=i(482),n=i(643),r=i(3734);class o extends r.AttributeData{constructor(){super(...arguments),this.content=0,this.fg=0,this.bg=0,this.extended=new r.ExtendedAttrs,this.combinedData=""}static fromCharData(e){const t=new o;return t.setFromCharData(e),t}isCombined(){return 2097152&this.content}getWidth(){return this.content>>22}getChars(){return 2097152&this.content?this.combinedData:2097151&this.content?(0,s.stringFromCodePoint)(2097151&this.content):""}getCode(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):2097151&this.content}setFromCharData(e){this.fg=e[n.CHAR_DATA_ATTR_INDEX],this.bg=0;let t=!1;if(e[n.CHAR_DATA_CHAR_INDEX].length>2)t=!0;else if(2===e[n.CHAR_DATA_CHAR_INDEX].length){const i=e[n.CHAR_DATA_CHAR_INDEX].charCodeAt(0);if(55296<=i&&i<=56319){const s=e[n.CHAR_DATA_CHAR_INDEX].charCodeAt(1);56320<=s&&s<=57343?this.content=1024*(i-55296)+s-56320+65536|e[n.CHAR_DATA_WIDTH_INDEX]<<22:t=!0}else t=!0}else this.content=e[n.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|e[n.CHAR_DATA_WIDTH_INDEX]<<22;t&&(this.combinedData=e[n.CHAR_DATA_CHAR_INDEX],this.content=2097152|e[n.CHAR_DATA_WIDTH_INDEX]<<22)}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}t.CellData=o},643:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WHITESPACE_CELL_CODE=t.WHITESPACE_CELL_WIDTH=t.WHITESPACE_CELL_CHAR=t.NULL_CELL_CODE=t.NULL_CELL_WIDTH=t.NULL_CELL_CHAR=t.CHAR_DATA_CODE_INDEX=t.CHAR_DATA_WIDTH_INDEX=t.CHAR_DATA_CHAR_INDEX=t.CHAR_DATA_ATTR_INDEX=t.DEFAULT_EXT=t.DEFAULT_ATTR=t.DEFAULT_COLOR=void 0,t.DEFAULT_COLOR=0,t.DEFAULT_ATTR=256|t.DEFAULT_COLOR<<9,t.DEFAULT_EXT=0,t.CHAR_DATA_ATTR_INDEX=0,t.CHAR_DATA_CHAR_INDEX=1,t.CHAR_DATA_WIDTH_INDEX=2,t.CHAR_DATA_CODE_INDEX=3,t.NULL_CELL_CHAR="",t.NULL_CELL_WIDTH=1,t.NULL_CELL_CODE=0,t.WHITESPACE_CELL_CHAR=" ",t.WHITESPACE_CELL_WIDTH=1,t.WHITESPACE_CELL_CODE=32},4863:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Marker=void 0;const s=i(8460),n=i(844);class r{get id(){return this._id}constructor(e){this.line=e,this.isDisposed=!1,this._disposables=[],this._id=r._nextId++,this._onDispose=this.register(new s.EventEmitter),this.onDispose=this._onDispose.event}dispose(){this.isDisposed||(this.isDisposed=!0,this.line=-1,this._onDispose.fire(),(0,n.disposeArray)(this._disposables),this._disposables.length=0)}register(e){return this._disposables.push(e),e}}t.Marker=r,r._nextId=1},7116:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_CHARSET=t.CHARSETS=void 0,t.CHARSETS={},t.DEFAULT_CHARSET=t.CHARSETS.B,t.CHARSETS[0]={"`":"â",a:"â",b:"â",c:"â",d:"â",e:"â",f:"Â°",g:"Â±",h:"â¤",i:"â",j:"â",k:"â",l:"â",m:"â",n:"â¼",o:"âº",p:"â»",q:"â",r:"â¼",s:"â½",t:"â",u:"â¤",v:"â´",w:"â¬",x:"â",y:"â¤",z:"â¥","{":"Ï","|":"â ","}":"Â£","~":"Â·"},t.CHARSETS.A={"#":"Â£"},t.CHARSETS.B=void 0,t.CHARSETS[4]={"#":"Â£","@":"Â¾","[":"ij","\\":"Â½","]":"|","{":"Â¨","|":"f","}":"Â¼","~":"Â´"},t.CHARSETS.C=t.CHARSETS[5]={"[":"Ã","\\":"Ã","]":"Ã","^":"Ã","`":"Ã©","{":"Ã¤","|":"Ã¶","}":"Ã¥","~":"Ã¼"},t.CHARSETS.R={"#":"Â£","@":"Ã ","[":"Â°","\\":"Ã§","]":"Â§","{":"Ã©","|":"Ã¹","}":"Ã¨","~":"Â¨"},t.CHARSETS.Q={"@":"Ã ","[":"Ã¢","\\":"Ã§","]":"Ãª","^":"Ã®","`":"Ã´","{":"Ã©","|":"Ã¹","}":"Ã¨","~":"Ã»"},t.CHARSETS.K={"@":"Â§","[":"Ã","\\":"Ã","]":"Ã","{":"Ã¤","|":"Ã¶","}":"Ã¼","~":"Ã"},t.CHARSETS.Y={"#":"Â£","@":"Â§","[":"Â°","\\":"Ã§","]":"Ã©","`":"Ã¹","{":"Ã ","|":"Ã²","}":"Ã¨","~":"Ã¬"},t.CHARSETS.E=t.CHARSETS[6]={"@":"Ã","[":"Ã","\\":"Ã","]":"Ã","^":"Ã","`":"Ã¤","{":"Ã¦","|":"Ã¸","}":"Ã¥","~":"Ã¼"},t.CHARSETS.Z={"#":"Â£","@":"Â§","[":"Â¡","\\":"Ã","]":"Â¿","{":"Â°","|":"Ã±","}":"Ã§"},t.CHARSETS.H=t.CHARSETS[7]={"@":"Ã","[":"Ã","\\":"Ã","]":"Ã","^":"Ã","`":"Ã©","{":"Ã¤","|":"Ã¶","}":"Ã¥","~":"Ã¼"},t.CHARSETS["="]={"#":"Ã¹","@":"Ã ","[":"Ã©","\\":"Ã§","]":"Ãª","^":"Ã®",_:"Ã¨","`":"Ã´","{":"Ã¤","|":"Ã¶","}":"Ã¼","~":"Ã»"}},2584:(e,t)=>{var i,s,n;Object.defineProperty(t,"__esModule",{value:!0}),t.C1_ESCAPED=t.C1=t.C0=void 0,function(e){e.NUL="\0",e.SOH="",e.STX="",e.ETX="",e.EOT="",e.ENQ="",e.ACK="",e.BEL="",e.BS="\b",e.HT="\t",e.LF="\n",e.VT="\v",e.FF="\f",e.CR="\r",e.SO="",e.SI="",e.DLE="",e.DC1="",e.DC2="",e.DC3="",e.DC4="",e.NAK="",e.SYN="",e.ETB="",e.CAN="",e.EM="",e.SUB="",e.ESC="",e.FS="",e.GS="",e.RS="",e.US="",e.SP=" ",e.DEL=""}(i||(t.C0=i={})),function(e){e.PAD="Â",e.HOP="Â",e.BPH="Â",e.NBH="Â",e.IND="Â",e.NEL="Â",e.SSA="Â",e.ESA="Â",e.HTS="Â",e.HTJ="Â",e.VTS="Â",e.PLD="Â",e.PLU="Â",e.RI="Â",e.SS2="Â",e.SS3="Â",e.DCS="Â",e.PU1="Â",e.PU2="Â",e.STS="Â",e.CCH="Â",e.MW="Â",e.SPA="Â",e.EPA="Â",e.SOS="Â",e.SGCI="Â",e.SCI="Â",e.CSI="Â",e.ST="Â",e.OSC="Â",e.PM="Â",e.APC="Â"}(s||(t.C1=s={})),function(e){e.ST=`${i.ESC}\\`}(n||(t.C1_ESCAPED=n={}))},7399:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.evaluateKeyboardEvent=void 0;const s=i(2584),n={48:["0",")"],49:["1","!"],50:["2","@"],51:["3","#"],52:["4","$"],53:["5","%"],54:["6","^"],55:["7","&"],56:["8","*"],57:["9","("],186:[";",":"],187:["=","+"],188:[",","<"],189:["-","_"],190:[".",">"],191:["/","?"],192:["`","~"],219:["[","{"],220:["\\","|"],221:["]","}"],222:["'",'"']};t.evaluateKeyboardEvent=function(e,t,i,r){const o={type:0,cancel:!1,key:void 0},a=(e.shiftKey?1:0)|(e.altKey?2:0)|(e.ctrlKey?4:0)|(e.metaKey?8:0);switch(e.keyCode){case 0:"UIKeyInputUpArrow"===e.key?o.key=t?s.C0.ESC+"OA":s.C0.ESC+"[A":"UIKeyInputLeftArrow"===e.key?o.key=t?s.C0.ESC+"OD":s.C0.ESC+"[D":"UIKeyInputRightArrow"===e.key?o.key=t?s.C0.ESC+"OC":s.C0.ESC+"[C":"UIKeyInputDownArrow"===e.key&&(o.key=t?s.C0.ESC+"OB":s.C0.ESC+"[B");break;case 8:o.key=e.ctrlKey?"\b":s.C0.DEL,e.altKey&&(o.key=s.C0.ESC+o.key);break;case 9:if(e.shiftKey){o.key=s.C0.ESC+"[Z";break}o.key=s.C0.HT,o.cancel=!0;break;case 13:o.key=e.altKey?s.C0.ESC+s.C0.CR:s.C0.CR,o.cancel=!0;break;case 27:o.key=s.C0.ESC,e.altKey&&(o.key=s.C0.ESC+s.C0.ESC),o.cancel=!0;break;case 37:if(e.metaKey)break;a?(o.key=s.C0.ESC+"[1;"+(a+1)+"D",o.key===s.C0.ESC+"[1;3D"&&(o.key=s.C0.ESC+(i?"b":"[1;5D"))):o.key=t?s.C0.ESC+"OD":s.C0.ESC+"[D";break;case 39:if(e.metaKey)break;a?(o.key=s.C0.ESC+"[1;"+(a+1)+"C",o.key===s.C0.ESC+"[1;3C"&&(o.key=s.C0.ESC+(i?"f":"[1;5C"))):o.key=t?s.C0.ESC+"OC":s.C0.ESC+"[C";break;case 38:if(e.metaKey)break;a?(o.key=s.C0.ESC+"[1;"+(a+1)+"A",i||o.key!==s.C0.ESC+"[1;3A"||(o.key=s.C0.ESC+"[1;5A")):o.key=t?s.C0.ESC+"OA":s.C0.ESC+"[A";break;case 40:if(e.metaKey)break;a?(o.key=s.C0.ESC+"[1;"+(a+1)+"B",i||o.key!==s.C0.ESC+"[1;3B"||(o.key=s.C0.ESC+"[1;5B")):o.key=t?s.C0.ESC+"OB":s.C0.ESC+"[B";break;case 45:e.shiftKey||e.ctrlKey||(o.key=s.C0.ESC+"[2~");break;case 46:o.key=a?s.C0.ESC+"[3;"+(a+1)+"~":s.C0.ESC+"[3~";break;case 36:o.key=a?s.C0.ESC+"[1;"+(a+1)+"H":t?s.C0.ESC+"OH":s.C0.ESC+"[H";break;case 35:o.key=a?s.C0.ESC+"[1;"+(a+1)+"F":t?s.C0.ESC+"OF":s.C0.ESC+"[F";break;case 33:e.shiftKey?o.type=2:e.ctrlKey?o.key=s.C0.ESC+"[5;"+(a+1)+"~":o.key=s.C0.ESC+"[5~";break;case 34:e.shiftKey?o.type=3:e.ctrlKey?o.key=s.C0.ESC+"[6;"+(a+1)+"~":o.key=s.C0.ESC+"[6~";break;case 112:o.key=a?s.C0.ESC+"[1;"+(a+1)+"P":s.C0.ESC+"OP";break;case 113:o.key=a?s.C0.ESC+"[1;"+(a+1)+"Q":s.C0.ESC+"OQ";break;case 114:o.key=a?s.C0.ESC+"[1;"+(a+1)+"R":s.C0.ESC+"OR";break;case 115:o.key=a?s.C0.ESC+"[1;"+(a+1)+"S":s.C0.ESC+"OS";break;case 116:o.key=a?s.C0.ESC+"[15;"+(a+1)+"~":s.C0.ESC+"[15~";break;case 117:o.key=a?s.C0.ESC+"[17;"+(a+1)+"~":s.C0.ESC+"[17~";break;case 118:o.key=a?s.C0.ESC+"[18;"+(a+1)+"~":s.C0.ESC+"[18~";break;case 119:o.key=a?s.C0.ESC+"[19;"+(a+1)+"~":s.C0.ESC+"[19~";break;case 120:o.key=a?s.C0.ESC+"[20;"+(a+1)+"~":s.C0.ESC+"[20~";break;case 121:o.key=a?s.C0.ESC+"[21;"+(a+1)+"~":s.C0.ESC+"[21~";break;case 122:o.key=a?s.C0.ESC+"[23;"+(a+1)+"~":s.C0.ESC+"[23~";break;case 123:o.key=a?s.C0.ESC+"[24;"+(a+1)+"~":s.C0.ESC+"[24~";break;default:if(!e.ctrlKey||e.shiftKey||e.altKey||e.metaKey)if(i&&!r||!e.altKey||e.metaKey)!i||e.altKey||e.ctrlKey||e.shiftKey||!e.metaKey?e.key&&!e.ctrlKey&&!e.altKey&&!e.metaKey&&e.keyCode>=48&&1===e.key.length?o.key=e.key:e.key&&e.ctrlKey&&("_"===e.key&&(o.key=s.C0.US),"@"===e.key&&(o.key=s.C0.NUL)):65===e.keyCode&&(o.type=1);else{const t=n[e.keyCode],i=t?.[e.shiftKey?1:0];if(i)o.key=s.C0.ESC+i;else if(e.keyCode>=65&&e.keyCode<=90){const t=e.ctrlKey?e.keyCode-64:e.keyCode+32;let i=String.fromCharCode(t);e.shiftKey&&(i=i.toUpperCase()),o.key=s.C0.ESC+i}else if(32===e.keyCode)o.key=s.C0.ESC+(e.ctrlKey?s.C0.NUL:" ");else if("Dead"===e.key&&e.code.startsWith("Key")){let t=e.code.slice(3,4);e.shiftKey||(t=t.toLowerCase()),o.key=s.C0.ESC+t,o.cancel=!0}}else e.keyCode>=65&&e.keyCode<=90?o.key=String.fromCharCode(e.keyCode-64):32===e.keyCode?o.key=s.C0.NUL:e.keyCode>=51&&e.keyCode<=55?o.key=String.fromCharCode(e.keyCode-51+27):56===e.keyCode?o.key=s.C0.DEL:219===e.keyCode?o.key=s.C0.ESC:220===e.keyCode?o.key=s.C0.FS:221===e.keyCode&&(o.key=s.C0.GS)}return o}},482:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Utf8ToUtf32=t.StringToUtf32=t.utf32ToString=t.stringFromCodePoint=void 0,t.stringFromCodePoint=function(e){return e>65535?(e-=65536,String.fromCharCode(55296+(e>>10))+String.fromCharCode(e%1024+56320)):String.fromCharCode(e)},t.utf32ToString=function(e,t=0,i=e.length){let s="";for(let n=t;n<i;++n){let t=e[n];t>65535?(t-=65536,s+=String.fromCharCode(55296+(t>>10))+String.fromCharCode(t%1024+56320)):s+=String.fromCharCode(t)}return s},t.StringToUtf32=class{constructor(){this._interim=0}clear(){this._interim=0}decode(e,t){const i=e.length;if(!i)return 0;let s=0,n=0;if(this._interim){const i=e.charCodeAt(n++);56320<=i&&i<=57343?t[s++]=1024*(this._interim-55296)+i-56320+65536:(t[s++]=this._interim,t[s++]=i),this._interim=0}for(let r=n;r<i;++r){const n=e.charCodeAt(r);if(55296<=n&&n<=56319){if(++r>=i)return this._interim=n,s;const o=e.charCodeAt(r);56320<=o&&o<=57343?t[s++]=1024*(n-55296)+o-56320+65536:(t[s++]=n,t[s++]=o)}else 65279!==n&&(t[s++]=n)}return s}},t.Utf8ToUtf32=class{constructor(){this.interim=new Uint8Array(3)}clear(){this.interim.fill(0)}decode(e,t){const i=e.length;if(!i)return 0;let s,n,r,o,a=0,l=0,h=0;if(this.interim[0]){let s=!1,n=this.interim[0];n&=192==(224&n)?31:224==(240&n)?15:7;let r,o=0;for(;(r=63&this.interim[++o])&&o<4;)n<<=6,n|=r;const l=192==(224&this.interim[0])?2:224==(240&this.interim[0])?3:4,c=l-o;for(;h<c;){if(h>=i)return 0;if(r=e[h++],128!=(192&r)){h--,s=!0;break}this.interim[o++]=r,n<<=6,n|=63&r}s||(2===l?n<128?h--:t[a++]=n:3===l?n<2048||n>=55296&&n<=57343||65279===n||(t[a++]=n):n<65536||n>1114111||(t[a++]=n)),this.interim.fill(0)}const c=i-4;let d=h;for(;d<i;){for(;!(!(d<c)||128&(s=e[d])||128&(n=e[d+1])||128&(r=e[d+2])||128&(o=e[d+3]));)t[a++]=s,t[a++]=n,t[a++]=r,t[a++]=o,d+=4;if(s=e[d++],s<128)t[a++]=s;else if(192==(224&s)){if(d>=i)return this.interim[0]=s,a;if(n=e[d++],128!=(192&n)){d--;continue}if(l=(31&s)<<6|63&n,l<128){d--;continue}t[a++]=l}else if(224==(240&s)){if(d>=i)return this.interim[0]=s,a;if(n=e[d++],128!=(192&n)){d--;continue}if(d>=i)return this.interim[0]=s,this.interim[1]=n,a;if(r=e[d++],128!=(192&r)){d--;continue}if(l=(15&s)<<12|(63&n)<<6|63&r,l<2048||l>=55296&&l<=57343||65279===l)continue;t[a++]=l}else if(240==(248&s)){if(d>=i)return this.interim[0]=s,a;if(n=e[d++],128!=(192&n)){d--;continue}if(d>=i)return this.interim[0]=s,this.interim[1]=n,a;if(r=e[d++],128!=(192&r)){d--;continue}if(d>=i)return this.interim[0]=s,this.interim[1]=n,this.interim[2]=r,a;if(o=e[d++],128!=(192&o)){d--;continue}if(l=(7&s)<<18|(63&n)<<12|(63&r)<<6|63&o,l<65536||l>1114111)continue;t[a++]=l}}return a}}},225:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UnicodeV6=void 0;const s=i(1480),n=[[768,879],[1155,1158],[1160,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1536,1539],[1552,1557],[1611,1630],[1648,1648],[1750,1764],[1767,1768],[1770,1773],[1807,1807],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2305,2306],[2364,2364],[2369,2376],[2381,2381],[2385,2388],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2561,2562],[2620,2620],[2625,2626],[2631,2632],[2635,2637],[2672,2673],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2817,2817],[2876,2876],[2879,2879],[2881,2883],[2893,2893],[2902,2902],[2946,2946],[3008,3008],[3021,3021],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3393,3395],[3405,3405],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3769],[3771,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3984,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4146],[4150,4151],[4153,4153],[4184,4185],[4448,4607],[4959,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6157],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7616,7626],[7678,7679],[8203,8207],[8234,8238],[8288,8291],[8298,8303],[8400,8431],[12330,12335],[12441,12442],[43014,43014],[43019,43019],[43045,43046],[64286,64286],[65024,65039],[65056,65059],[65279,65279],[65529,65531]],r=[[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[917505,917505],[917536,917631],[917760,917999]];let o;t.UnicodeV6=class{constructor(){if(this.version="6",!o){o=new Uint8Array(65536),o.fill(1),o[0]=0,o.fill(0,1,32),o.fill(0,127,160),o.fill(2,4352,4448),o[9001]=2,o[9002]=2,o.fill(2,11904,42192),o[12351]=1,o.fill(2,44032,55204),o.fill(2,63744,64256),o.fill(2,65040,65050),o.fill(2,65072,65136),o.fill(2,65280,65377),o.fill(2,65504,65511);for(let e=0;e<n.length;++e)o.fill(0,n[e][0],n[e][1]+1)}}wcwidth(e){return e<32?0:e<127?1:e<65536?o[e]:function(e,t){let i,s=0,n=t.length-1;if(e<t[0][0]||e>t[n][1])return!1;for(;n>=s;)if(i=s+n>>1,e>t[i][1])s=i+1;else{if(!(e<t[i][0]))return!0;n=i-1}return!1}(e,r)?0:e>=131072&&e<=196605||e>=196608&&e<=262141?2:1}charProperties(e,t){let i=this.wcwidth(e),n=0===i&&0!==t;if(n){const e=s.UnicodeService.extractWidth(t);0===e?n=!1:e>i&&(i=e)}return s.UnicodeService.createPropertyValue(0,i,n)}}},5981:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WriteBuffer=void 0;const s=i(8460),n=i(844);class r extends n.Disposable{constructor(e){super(),this._action=e,this._writeBuffer=[],this._callbacks=[],this._pendingData=0,this._bufferOffset=0,this._isSyncWriting=!1,this._syncCalls=0,this._didUserInput=!1,this._onWriteParsed=this.register(new s.EventEmitter),this.onWriteParsed=this._onWriteParsed.event}handleUserInput(){this._didUserInput=!0}writeSync(e,t){if(void 0!==t&&this._syncCalls>t)return void(this._syncCalls=0);if(this._pendingData+=e.length,this._writeBuffer.push(e),this._callbacks.push(void 0),this._syncCalls++,this._isSyncWriting)return;let i;for(this._isSyncWriting=!0;i=this._writeBuffer.shift();){this._action(i);const e=this._callbacks.shift();e&&e()}this._pendingData=0,this._bufferOffset=2147483647,this._isSyncWriting=!1,this._syncCalls=0}write(e,t){if(this._pendingData>5e7)throw new Error("write data discarded, use flow control to avoid losing data");if(!this._writeBuffer.length){if(this._bufferOffset=0,this._didUserInput)return this._didUserInput=!1,this._pendingData+=e.length,this._writeBuffer.push(e),this._callbacks.push(t),void this._innerWrite();setTimeout((()=>this._innerWrite()))}this._pendingData+=e.length,this._writeBuffer.push(e),this._callbacks.push(t)}_innerWrite(e=0,t=!0){const i=e||Date.now();for(;this._writeBuffer.length>this._bufferOffset;){const e=this._writeBuffer[this._bufferOffset],s=this._action(e,t);if(s){const e=e=>Date.now()-i>=12?setTimeout((()=>this._innerWrite(0,e))):this._innerWrite(i,e);return void s.catch((e=>(queueMicrotask((()=>{throw e})),Promise.resolve(!1)))).then(e)}const n=this._callbacks[this._bufferOffset];if(n&&n(),this._bufferOffset++,this._pendingData-=e.length,Date.now()-i>=12)break}this._writeBuffer.length>this._bufferOffset?(this._bufferOffset>50&&(this._writeBuffer=this._writeBuffer.slice(this._bufferOffset),this._callbacks=this._callbacks.slice(this._bufferOffset),this._bufferOffset=0),setTimeout((()=>this._innerWrite()))):(this._writeBuffer.length=0,this._callbacks.length=0,this._pendingData=0,this._bufferOffset=0),this._onWriteParsed.fire()}}t.WriteBuffer=r},5941:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.toRgbString=t.parseColor=void 0;const i=/^([\da-f])\/([\da-f])\/([\da-f])$|^([\da-f]{2})\/([\da-f]{2})\/([\da-f]{2})$|^([\da-f]{3})\/([\da-f]{3})\/([\da-f]{3})$|^([\da-f]{4})\/([\da-f]{4})\/([\da-f]{4})$/,s=/^[\da-f]+$/;function n(e,t){const i=e.toString(16),s=i.length<2?"0"+i:i;switch(t){case 4:return i[0];case 8:return s;case 12:return(s+s).slice(0,3);default:return s+s}}t.parseColor=function(e){if(!e)return;let t=e.toLowerCase();if(0===t.indexOf("rgb:")){t=t.slice(4);const e=i.exec(t);if(e){const t=e[1]?15:e[4]?255:e[7]?4095:65535;return[Math.round(parseInt(e[1]||e[4]||e[7]||e[10],16)/t*255),Math.round(parseInt(e[2]||e[5]||e[8]||e[11],16)/t*255),Math.round(parseInt(e[3]||e[6]||e[9]||e[12],16)/t*255)]}}else if(0===t.indexOf("#")&&(t=t.slice(1),s.exec(t)&&[3,6,9,12].includes(t.length))){const e=t.length/3,i=[0,0,0];for(let s=0;s<3;++s){const n=parseInt(t.slice(e*s,e*s+e),16);i[s]=1===e?n<<4:2===e?n:3===e?n>>4:n>>8}return i}},t.toRgbString=function(e,t=16){const[i,s,r]=e;return`rgb:${n(i,t)}/${n(s,t)}/${n(r,t)}`}},5770:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PAYLOAD_LIMIT=void 0,t.PAYLOAD_LIMIT=1e7},6351:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DcsHandler=t.DcsParser=void 0;const s=i(482),n=i(8742),r=i(5770),o=[];t.DcsParser=class{constructor(){this._handlers=Object.create(null),this._active=o,this._ident=0,this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=o}registerHandler(e,t){void 0===this._handlers[e]&&(this._handlers[e]=[]);const i=this._handlers[e];return i.push(t),{dispose:()=>{const e=i.indexOf(t);-1!==e&&i.splice(e,1)}}}clearHandler(e){this._handlers[e]&&delete this._handlers[e]}setHandlerFallback(e){this._handlerFb=e}reset(){if(this._active.length)for(let e=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;e>=0;--e)this._active[e].unhook(!1);this._stack.paused=!1,this._active=o,this._ident=0}hook(e,t){if(this.reset(),this._ident=e,this._active=this._handlers[e]||o,this._active.length)for(let e=this._active.length-1;e>=0;e--)this._active[e].hook(t);else this._handlerFb(this._ident,"HOOK",t)}put(e,t,i){if(this._active.length)for(let s=this._active.length-1;s>=0;s--)this._active[s].put(e,t,i);else this._handlerFb(this._ident,"PUT",(0,s.utf32ToString)(e,t,i))}unhook(e,t=!0){if(this._active.length){let i=!1,s=this._active.length-1,n=!1;if(this._stack.paused&&(s=this._stack.loopPosition-1,i=t,n=this._stack.fallThrough,this._stack.paused=!1),!n&&!1===i){for(;s>=0&&(i=this._active[s].unhook(e),!0!==i);s--)if(i instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=s,this._stack.fallThrough=!1,i;s--}for(;s>=0;s--)if(i=this._active[s].unhook(!1),i instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=s,this._stack.fallThrough=!0,i}else this._handlerFb(this._ident,"UNHOOK",e);this._active=o,this._ident=0}};const a=new n.Params;a.addParam(0),t.DcsHandler=class{constructor(e){this._handler=e,this._data="",this._params=a,this._hitLimit=!1}hook(e){this._params=e.length>1||e.params[0]?e.clone():a,this._data="",this._hitLimit=!1}put(e,t,i){this._hitLimit||(this._data+=(0,s.utf32ToString)(e,t,i),this._data.length>r.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}unhook(e){let t=!1;if(this._hitLimit)t=!1;else if(e&&(t=this._handler(this._data,this._params),t instanceof Promise))return t.then((e=>(this._params=a,this._data="",this._hitLimit=!1,e)));return this._params=a,this._data="",this._hitLimit=!1,t}}},2015:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EscapeSequenceParser=t.VT500_TRANSITION_TABLE=t.TransitionTable=void 0;const s=i(844),n=i(8742),r=i(6242),o=i(6351);class a{constructor(e){this.table=new Uint8Array(e)}setDefault(e,t){this.table.fill(e<<4|t)}add(e,t,i,s){this.table[t<<8|e]=i<<4|s}addMany(e,t,i,s){for(let n=0;n<e.length;n++)this.table[t<<8|e[n]]=i<<4|s}}t.TransitionTable=a;const l=160;t.VT500_TRANSITION_TABLE=function(){const e=new a(4095),t=Array.apply(null,Array(256)).map(((e,t)=>t)),i=(e,i)=>t.slice(e,i),s=i(32,127),n=i(0,24);n.push(25),n.push.apply(n,i(28,32));const r=i(0,14);let o;for(o in e.setDefault(1,0),e.addMany(s,0,2,0),r)e.addMany([24,26,153,154],o,3,0),e.addMany(i(128,144),o,3,0),e.addMany(i(144,152),o,3,0),e.add(156,o,0,0),e.add(27,o,11,1),e.add(157,o,4,8),e.addMany([152,158,159],o,0,7),e.add(155,o,11,3),e.add(144,o,11,9);return e.addMany(n,0,3,0),e.addMany(n,1,3,1),e.add(127,1,0,1),e.addMany(n,8,0,8),e.addMany(n,3,3,3),e.add(127,3,0,3),e.addMany(n,4,3,4),e.add(127,4,0,4),e.addMany(n,6,3,6),e.addMany(n,5,3,5),e.add(127,5,0,5),e.addMany(n,2,3,2),e.add(127,2,0,2),e.add(93,1,4,8),e.addMany(s,8,5,8),e.add(127,8,5,8),e.addMany([156,27,24,26,7],8,6,0),e.addMany(i(28,32),8,0,8),e.addMany([88,94,95],1,0,7),e.addMany(s,7,0,7),e.addMany(n,7,0,7),e.add(156,7,0,0),e.add(127,7,0,7),e.add(91,1,11,3),e.addMany(i(64,127),3,7,0),e.addMany(i(48,60),3,8,4),e.addMany([60,61,62,63],3,9,4),e.addMany(i(48,60),4,8,4),e.addMany(i(64,127),4,7,0),e.addMany([60,61,62,63],4,0,6),e.addMany(i(32,64),6,0,6),e.add(127,6,0,6),e.addMany(i(64,127),6,0,0),e.addMany(i(32,48),3,9,5),e.addMany(i(32,48),5,9,5),e.addMany(i(48,64),5,0,6),e.addMany(i(64,127),5,7,0),e.addMany(i(32,48),4,9,5),e.addMany(i(32,48),1,9,2),e.addMany(i(32,48),2,9,2),e.addMany(i(48,127),2,10,0),e.addMany(i(48,80),1,10,0),e.addMany(i(81,88),1,10,0),e.addMany([89,90,92],1,10,0),e.addMany(i(96,127),1,10,0),e.add(80,1,11,9),e.addMany(n,9,0,9),e.add(127,9,0,9),e.addMany(i(28,32),9,0,9),e.addMany(i(32,48),9,9,12),e.addMany(i(48,60),9,8,10),e.addMany([60,61,62,63],9,9,10),e.addMany(n,11,0,11),e.addMany(i(32,128),11,0,11),e.addMany(i(28,32),11,0,11),e.addMany(n,10,0,10),e.add(127,10,0,10),e.addMany(i(28,32),10,0,10),e.addMany(i(48,60),10,8,10),e.addMany([60,61,62,63],10,0,11),e.addMany(i(32,48),10,9,12),e.addMany(n,12,0,12),e.add(127,12,0,12),e.addMany(i(28,32),12,0,12),e.addMany(i(32,48),12,9,12),e.addMany(i(48,64),12,0,11),e.addMany(i(64,127),12,12,13),e.addMany(i(64,127),10,12,13),e.addMany(i(64,127),9,12,13),e.addMany(n,13,13,13),e.addMany(s,13,13,13),e.add(127,13,0,13),e.addMany([27,156,24,26],13,14,0),e.add(l,0,2,0),e.add(l,8,5,8),e.add(l,6,0,6),e.add(l,11,0,11),e.add(l,13,13,13),e}();class h extends s.Disposable{constructor(e=t.VT500_TRANSITION_TABLE){super(),this._transitions=e,this._parseStack={state:0,handlers:[],handlerPos:0,transition:0,chunkPos:0},this.initialState=0,this.currentState=this.initialState,this._params=new n.Params,this._params.addParam(0),this._collect=0,this.precedingJoinState=0,this._printHandlerFb=(e,t,i)=>{},this._executeHandlerFb=e=>{},this._csiHandlerFb=(e,t)=>{},this._escHandlerFb=e=>{},this._errorHandlerFb=e=>e,this._printHandler=this._printHandlerFb,this._executeHandlers=Object.create(null),this._csiHandlers=Object.create(null),this._escHandlers=Object.create(null),this.register((0,s.toDisposable)((()=>{this._csiHandlers=Object.create(null),this._executeHandlers=Object.create(null),this._escHandlers=Object.create(null)}))),this._oscParser=this.register(new r.OscParser),this._dcsParser=this.register(new o.DcsParser),this._errorHandler=this._errorHandlerFb,this.registerEscHandler({final:"\\"},(()=>!0))}_identifier(e,t=[64,126]){let i=0;if(e.prefix){if(e.prefix.length>1)throw new Error("only one byte as prefix supported");if(i=e.prefix.charCodeAt(0),i&&60>i||i>63)throw new Error("prefix must be in range 0x3c .. 0x3f")}if(e.intermediates){if(e.intermediates.length>2)throw new Error("only two bytes as intermediates are supported");for(let t=0;t<e.intermediates.length;++t){const s=e.intermediates.charCodeAt(t);if(32>s||s>47)throw new Error("intermediate must be in range 0x20 .. 0x2f");i<<=8,i|=s}}if(1!==e.final.length)throw new Error("final must be a single byte");const s=e.final.charCodeAt(0);if(t[0]>s||s>t[1])throw new Error(`final must be in range ${t[0]} .. ${t[1]}`);return i<<=8,i|=s,i}identToString(e){const t=[];for(;e;)t.push(String.fromCharCode(255&e)),e>>=8;return t.reverse().join("")}setPrintHandler(e){this._printHandler=e}clearPrintHandler(){this._printHandler=this._printHandlerFb}registerEscHandler(e,t){const i=this._identifier(e,[48,126]);void 0===this._escHandlers[i]&&(this._escHandlers[i]=[]);const s=this._escHandlers[i];return s.push(t),{dispose:()=>{const e=s.indexOf(t);-1!==e&&s.splice(e,1)}}}clearEscHandler(e){this._escHandlers[this._identifier(e,[48,126])]&&delete this._escHandlers[this._identifier(e,[48,126])]}setEscHandlerFallback(e){this._escHandlerFb=e}setExecuteHandler(e,t){this._executeHandlers[e.charCodeAt(0)]=t}clearExecuteHandler(e){this._executeHandlers[e.charCodeAt(0)]&&delete this._executeHandlers[e.charCodeAt(0)]}setExecuteHandlerFallback(e){this._executeHandlerFb=e}registerCsiHandler(e,t){const i=this._identifier(e);void 0===this._csiHandlers[i]&&(this._csiHandlers[i]=[]);const s=this._csiHandlers[i];return s.push(t),{dispose:()=>{const e=s.indexOf(t);-1!==e&&s.splice(e,1)}}}clearCsiHandler(e){this._csiHandlers[this._identifier(e)]&&delete this._csiHandlers[this._identifier(e)]}setCsiHandlerFallback(e){this._csiHandlerFb=e}registerDcsHandler(e,t){return this._dcsParser.registerHandler(this._identifier(e),t)}clearDcsHandler(e){this._dcsParser.clearHandler(this._identifier(e))}setDcsHandlerFallback(e){this._dcsParser.setHandlerFallback(e)}registerOscHandler(e,t){return this._oscParser.registerHandler(e,t)}clearOscHandler(e){this._oscParser.clearHandler(e)}setOscHandlerFallback(e){this._oscParser.setHandlerFallback(e)}setErrorHandler(e){this._errorHandler=e}clearErrorHandler(){this._errorHandler=this._errorHandlerFb}reset(){this.currentState=this.initialState,this._oscParser.reset(),this._dcsParser.reset(),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0,0!==this._parseStack.state&&(this._parseStack.state=2,this._parseStack.handlers=[])}_preserveStack(e,t,i,s,n){this._parseStack.state=e,this._parseStack.handlers=t,this._parseStack.handlerPos=i,this._parseStack.transition=s,this._parseStack.chunkPos=n}parse(e,t,i){let s,n=0,r=0,o=0;if(this._parseStack.state)if(2===this._parseStack.state)this._parseStack.state=0,o=this._parseStack.chunkPos+1;else{if(void 0===i||1===this._parseStack.state)throw this._parseStack.state=1,new Error("improper continuation due to previous async handler, giving up parsing");const t=this._parseStack.handlers;let r=this._parseStack.handlerPos-1;switch(this._parseStack.state){case 3:if(!1===i&&r>-1)for(;r>=0&&(s=t[r](this._params),!0!==s);r--)if(s instanceof Promise)return this._parseStack.handlerPos=r,s;this._parseStack.handlers=[];break;case 4:if(!1===i&&r>-1)for(;r>=0&&(s=t[r](),!0!==s);r--)if(s instanceof Promise)return this._parseStack.handlerPos=r,s;this._parseStack.handlers=[];break;case 6:if(n=e[this._parseStack.chunkPos],s=this._dcsParser.unhook(24!==n&&26!==n,i),s)return s;27===n&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0;break;case 5:if(n=e[this._parseStack.chunkPos],s=this._oscParser.end(24!==n&&26!==n,i),s)return s;27===n&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0}this._parseStack.state=0,o=this._parseStack.chunkPos+1,this.precedingJoinState=0,this.currentState=15&this._parseStack.transition}for(let i=o;i<t;++i){switch(n=e[i],r=this._transitions.table[this.currentState<<8|(n<160?n:l)],r>>4){case 2:for(let s=i+1;;++s){if(s>=t||(n=e[s])<32||n>126&&n<l){this._printHandler(e,i,s),i=s-1;break}if(++s>=t||(n=e[s])<32||n>126&&n<l){this._printHandler(e,i,s),i=s-1;break}if(++s>=t||(n=e[s])<32||n>126&&n<l){this._printHandler(e,i,s),i=s-1;break}if(++s>=t||(n=e[s])<32||n>126&&n<l){this._printHandler(e,i,s),i=s-1;break}}break;case 3:this._executeHandlers[n]?this._executeHandlers[n]():this._executeHandlerFb(n),this.precedingJoinState=0;break;case 0:break;case 1:if(this._errorHandler({position:i,code:n,currentState:this.currentState,collect:this._collect,params:this._params,abort:!1}).abort)return;break;case 7:const o=this._csiHandlers[this._collect<<8|n];let a=o?o.length-1:-1;for(;a>=0&&(s=o[a](this._params),!0!==s);a--)if(s instanceof Promise)return this._preserveStack(3,o,a,r,i),s;a<0&&this._csiHandlerFb(this._collect<<8|n,this._params),this.precedingJoinState=0;break;case 8:do{switch(n){case 59:this._params.addParam(0);break;case 58:this._params.addSubParam(-1);break;default:this._params.addDigit(n-48)}}while(++i<t&&(n=e[i])>47&&n<60);i--;break;case 9:this._collect<<=8,this._collect|=n;break;case 10:const h=this._escHandlers[this._collect<<8|n];let c=h?h.length-1:-1;for(;c>=0&&(s=h[c](),!0!==s);c--)if(s instanceof Promise)return this._preserveStack(4,h,c,r,i),s;c<0&&this._escHandlerFb(this._collect<<8|n),this.precedingJoinState=0;break;case 11:this._params.reset(),this._params.addParam(0),this._collect=0;break;case 12:this._dcsParser.hook(this._collect<<8|n,this._params);break;case 13:for(let s=i+1;;++s)if(s>=t||24===(n=e[s])||26===n||27===n||n>127&&n<l){this._dcsParser.put(e,i,s),i=s-1;break}break;case 14:if(s=this._dcsParser.unhook(24!==n&&26!==n),s)return this._preserveStack(6,[],0,r,i),s;27===n&&(r|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0;break;case 4:this._oscParser.start();break;case 5:for(let s=i+1;;s++)if(s>=t||(n=e[s])<32||n>127&&n<l){this._oscParser.put(e,i,s),i=s-1;break}break;case 6:if(s=this._oscParser.end(24!==n&&26!==n),s)return this._preserveStack(5,[],0,r,i),s;27===n&&(r|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0}this.currentState=15&r}}}t.EscapeSequenceParser=h},6242:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OscHandler=t.OscParser=void 0;const s=i(5770),n=i(482),r=[];t.OscParser=class{constructor(){this._state=0,this._active=r,this._id=-1,this._handlers=Object.create(null),this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}registerHandler(e,t){void 0===this._handlers[e]&&(this._handlers[e]=[]);const i=this._handlers[e];return i.push(t),{dispose:()=>{const e=i.indexOf(t);-1!==e&&i.splice(e,1)}}}clearHandler(e){this._handlers[e]&&delete this._handlers[e]}setHandlerFallback(e){this._handlerFb=e}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=r}reset(){if(2===this._state)for(let e=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;e>=0;--e)this._active[e].end(!1);this._stack.paused=!1,this._active=r,this._id=-1,this._state=0}_start(){if(this._active=this._handlers[this._id]||r,this._active.length)for(let e=this._active.length-1;e>=0;e--)this._active[e].start();else this._handlerFb(this._id,"START")}_put(e,t,i){if(this._active.length)for(let s=this._active.length-1;s>=0;s--)this._active[s].put(e,t,i);else this._handlerFb(this._id,"PUT",(0,n.utf32ToString)(e,t,i))}start(){this.reset(),this._state=1}put(e,t,i){if(3!==this._state){if(1===this._state)for(;t<i;){const i=e[t++];if(59===i){this._state=2,this._start();break}if(i<48||57<i)return void(this._state=3);-1===this._id&&(this._id=0),this._id=10*this._id+i-48}2===this._state&&i-t>0&&this._put(e,t,i)}}end(e,t=!0){if(0!==this._state){if(3!==this._state)if(1===this._state&&this._start(),this._active.length){let i=!1,s=this._active.length-1,n=!1;if(this._stack.paused&&(s=this._stack.loopPosition-1,i=t,n=this._stack.fallThrough,this._stack.paused=!1),!n&&!1===i){for(;s>=0&&(i=this._active[s].end(e),!0!==i);s--)if(i instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=s,this._stack.fallThrough=!1,i;s--}for(;s>=0;s--)if(i=this._active[s].end(!1),i instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=s,this._stack.fallThrough=!0,i}else this._handlerFb(this._id,"END",e);this._active=r,this._id=-1,this._state=0}}},t.OscHandler=class{constructor(e){this._handler=e,this._data="",this._hitLimit=!1}start(){this._data="",this._hitLimit=!1}put(e,t,i){this._hitLimit||(this._data+=(0,n.utf32ToString)(e,t,i),this._data.length>s.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}end(e){let t=!1;if(this._hitLimit)t=!1;else if(e&&(t=this._handler(this._data),t instanceof Promise))return t.then((e=>(this._data="",this._hitLimit=!1,e)));return this._data="",this._hitLimit=!1,t}}},8742:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Params=void 0;const i=2147483647;class s{static fromArray(e){const t=new s;if(!e.length)return t;for(let i=Array.isArray(e[0])?1:0;i<e.length;++i){const s=e[i];if(Array.isArray(s))for(let e=0;e<s.length;++e)t.addSubParam(s[e]);else t.addParam(s)}return t}constructor(e=32,t=32){if(this.maxLength=e,this.maxSubParamsLength=t,t>256)throw new Error("maxSubParamsLength must not be greater than 256");this.params=new Int32Array(e),this.length=0,this._subParams=new Int32Array(t),this._subParamsLength=0,this._subParamsIdx=new Uint16Array(e),this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}clone(){const e=new s(this.maxLength,this.maxSubParamsLength);return e.params.set(this.params),e.length=this.length,e._subParams.set(this._subParams),e._subParamsLength=this._subParamsLength,e._subParamsIdx.set(this._subParamsIdx),e._rejectDigits=this._rejectDigits,e._rejectSubDigits=this._rejectSubDigits,e._digitIsSub=this._digitIsSub,e}toArray(){const e=[];for(let t=0;t<this.length;++t){e.push(this.params[t]);const i=this._subParamsIdx[t]>>8,s=255&this._subParamsIdx[t];s-i>0&&e.push(Array.prototype.slice.call(this._subParams,i,s))}return e}reset(){this.length=0,this._subParamsLength=0,this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}addParam(e){if(this._digitIsSub=!1,this.length>=this.maxLength)this._rejectDigits=!0;else{if(e<-1)throw new Error("values lesser than -1 are not allowed");this._subParamsIdx[this.length]=this._subParamsLength<<8|this._subParamsLength,this.params[this.length++]=e>i?i:e}}addSubParam(e){if(this._digitIsSub=!0,this.length)if(this._rejectDigits||this._subParamsLength>=this.maxSubParamsLength)this._rejectSubDigits=!0;else{if(e<-1)throw new Error("values lesser than -1 are not allowed");this._subParams[this._subParamsLength++]=e>i?i:e,this._subParamsIdx[this.length-1]++}}hasSubParams(e){return(255&this._subParamsIdx[e])-(this._subParamsIdx[e]>>8)>0}getSubParams(e){const t=this._subParamsIdx[e]>>8,i=255&this._subParamsIdx[e];return i-t>0?this._subParams.subarray(t,i):null}getSubParamsAll(){const e={};for(let t=0;t<this.length;++t){const i=this._subParamsIdx[t]>>8,s=255&this._subParamsIdx[t];s-i>0&&(e[t]=this._subParams.slice(i,s))}return e}addDigit(e){let t;if(this._rejectDigits||!(t=this._digitIsSub?this._subParamsLength:this.length)||this._digitIsSub&&this._rejectSubDigits)return;const s=this._digitIsSub?this._subParams:this.params,n=s[t-1];s[t-1]=~n?Math.min(10*n+e,i):e}}t.Params=s},5741:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AddonManager=void 0,t.AddonManager=class{constructor(){this._addons=[]}dispose(){for(let e=this._addons.length-1;e>=0;e--)this._addons[e].instance.dispose()}loadAddon(e,t){const i={instance:t,dispose:t.dispose,isDisposed:!1};this._addons.push(i),t.dispose=()=>this._wrappedAddonDispose(i),t.activate(e)}_wrappedAddonDispose(e){if(e.isDisposed)return;let t=-1;for(let i=0;i<this._addons.length;i++)if(this._addons[i]===e){t=i;break}if(-1===t)throw new Error("Could not dispose an addon that has not been loaded");e.isDisposed=!0,e.dispose.apply(e.instance),this._addons.splice(t,1)}}},8771:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BufferApiView=void 0;const s=i(3785),n=i(511);t.BufferApiView=class{constructor(e,t){this._buffer=e,this.type=t}init(e){return this._buffer=e,this}get cursorY(){return this._buffer.y}get cursorX(){return this._buffer.x}get viewportY(){return this._buffer.ydisp}get baseY(){return this._buffer.ybase}get length(){return this._buffer.lines.length}getLine(e){const t=this._buffer.lines.get(e);if(t)return new s.BufferLineApiView(t)}getNullCell(){return new n.CellData}}},3785:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BufferLineApiView=void 0;const s=i(511);t.BufferLineApiView=class{constructor(e){this._line=e}get isWrapped(){return this._line.isWrapped}get length(){return this._line.length}getCell(e,t){if(!(e<0||e>=this._line.length))return t?(this._line.loadCell(e,t),t):this._line.loadCell(e,new s.CellData)}translateToString(e,t,i){return this._line.translateToString(e,t,i)}}},8285:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BufferNamespaceApi=void 0;const s=i(8771),n=i(8460),r=i(844);class o extends r.Disposable{constructor(e){super(),this._core=e,this._onBufferChange=this.register(new n.EventEmitter),this.onBufferChange=this._onBufferChange.event,this._normal=new s.BufferApiView(this._core.buffers.normal,"normal"),this._alternate=new s.BufferApiView(this._core.buffers.alt,"alternate"),this._core.buffers.onBufferActivate((()=>this._onBufferChange.fire(this.active)))}get active(){if(this._core.buffers.active===this._core.buffers.normal)return this.normal;if(this._core.buffers.active===this._core.buffers.alt)return this.alternate;throw new Error("Active buffer is neither normal nor alternate")}get normal(){return this._normal.init(this._core.buffers.normal)}get alternate(){return this._alternate.init(this._core.buffers.alt)}}t.BufferNamespaceApi=o},7975:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ParserApi=void 0,t.ParserApi=class{constructor(e){this._core=e}registerCsiHandler(e,t){return this._core.registerCsiHandler(e,(e=>t(e.toArray())))}addCsiHandler(e,t){return this.registerCsiHandler(e,t)}registerDcsHandler(e,t){return this._core.registerDcsHandler(e,((e,i)=>t(e,i.toArray())))}addDcsHandler(e,t){return this.registerDcsHandler(e,t)}registerEscHandler(e,t){return this._core.registerEscHandler(e,t)}addEscHandler(e,t){return this.registerEscHandler(e,t)}registerOscHandler(e,t){return this._core.registerOscHandler(e,t)}addOscHandler(e,t){return this.registerOscHandler(e,t)}}},7090:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UnicodeApi=void 0,t.UnicodeApi=class{constructor(e){this._core=e}register(e){this._core.unicodeService.register(e)}get versions(){return this._core.unicodeService.versions}get activeVersion(){return this._core.unicodeService.activeVersion}set activeVersion(e){this._core.unicodeService.activeVersion=e}}},744:function(e,t,i){var s=this&&this.__decorate||function(e,t,i,s){var n,r=arguments.length,o=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,s);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(r<3?n(o):r>3?n(t,i,o):n(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},n=this&&this.__param||function(e,t){return function(i,s){t(i,s,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.BufferService=t.MINIMUM_ROWS=t.MINIMUM_COLS=void 0;const r=i(8460),o=i(844),a=i(5295),l=i(2585);t.MINIMUM_COLS=2,t.MINIMUM_ROWS=1;let h=t.BufferService=class extends o.Disposable{get buffer(){return this.buffers.active}constructor(e){super(),this.isUserScrolling=!1,this._onResize=this.register(new r.EventEmitter),this.onResize=this._onResize.event,this._onScroll=this.register(new r.EventEmitter),this.onScroll=this._onScroll.event,this.cols=Math.max(e.rawOptions.cols||0,t.MINIMUM_COLS),this.rows=Math.max(e.rawOptions.rows||0,t.MINIMUM_ROWS),this.buffers=this.register(new a.BufferSet(e,this))}resize(e,t){this.cols=e,this.rows=t,this.buffers.resize(e,t),this._onResize.fire({cols:e,rows:t})}reset(){this.buffers.reset(),this.isUserScrolling=!1}scroll(e,t=!1){const i=this.buffer;let s;s=this._cachedBlankLine,s&&s.length===this.cols&&s.getFg(0)===e.fg&&s.getBg(0)===e.bg||(s=i.getBlankLine(e,t),this._cachedBlankLine=s),s.isWrapped=t;const n=i.ybase+i.scrollTop,r=i.ybase+i.scrollBottom;if(0===i.scrollTop){const e=i.lines.isFull;r===i.lines.length-1?e?i.lines.recycle().copyFrom(s):i.lines.push(s.clone()):i.lines.splice(r+1,0,s.clone()),e?this.isUserScrolling&&(i.ydisp=Math.max(i.ydisp-1,0)):(i.ybase++,this.isUserScrolling||i.ydisp++)}else{const e=r-n+1;i.lines.shiftElements(n+1,e-1,-1),i.lines.set(r,s.clone())}this.isUserScrolling||(i.ydisp=i.ybase),this._onScroll.fire(i.ydisp)}scrollLines(e,t,i){const s=this.buffer;if(e<0){if(0===s.ydisp)return;this.isUserScrolling=!0}else e+s.ydisp>=s.ybase&&(this.isUserScrolling=!1);const n=s.ydisp;s.ydisp=Math.max(Math.min(s.ydisp+e,s.ybase),0),n!==s.ydisp&&(t||this._onScroll.fire(s.ydisp))}};t.BufferService=h=s([n(0,l.IOptionsService)],h)},7994:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CharsetService=void 0,t.CharsetService=class{constructor(){this.glevel=0,this._charsets=[]}reset(){this.charset=void 0,this._charsets=[],this.glevel=0}setgLevel(e){this.glevel=e,this.charset=this._charsets[e]}setgCharset(e,t){this._charsets[e]=t,this.glevel===e&&(this.charset=t)}}},1753:function(e,t,i){var s=this&&this.__decorate||function(e,t,i,s){var n,r=arguments.length,o=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,s);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(r<3?n(o):r>3?n(t,i,o):n(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},n=this&&this.__param||function(e,t){return function(i,s){t(i,s,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CoreMouseService=void 0;const r=i(2585),o=i(8460),a=i(844),l={NONE:{events:0,restrict:()=>!1},X10:{events:1,restrict:e=>4!==e.button&&1===e.action&&(e.ctrl=!1,e.alt=!1,e.shift=!1,!0)},VT200:{events:19,restrict:e=>32!==e.action},DRAG:{events:23,restrict:e=>32!==e.action||3!==e.button},ANY:{events:31,restrict:e=>!0}};function h(e,t){let i=(e.ctrl?16:0)|(e.shift?4:0)|(e.alt?8:0);return 4===e.button?(i|=64,i|=e.action):(i|=3&e.button,4&e.button&&(i|=64),8&e.button&&(i|=128),32===e.action?i|=32:0!==e.action||t||(i|=3)),i}const c=String.fromCharCode,d={DEFAULT:e=>{const t=[h(e,!1)+32,e.col+32,e.row+32];return t[0]>255||t[1]>255||t[2]>255?"":`[M${c(t[0])}${c(t[1])}${c(t[2])}`},SGR:e=>{const t=0===e.action&&4!==e.button?"m":"M";return`[<${h(e,!0)};${e.col};${e.row}${t}`},SGR_PIXELS:e=>{const t=0===e.action&&4!==e.button?"m":"M";return`[<${h(e,!0)};${e.x};${e.y}${t}`}};let u=t.CoreMouseService=class extends a.Disposable{constructor(e,t){super(),this._bufferService=e,this._coreService=t,this._protocols={},this._encodings={},this._activeProtocol="",this._activeEncoding="",this._lastEvent=null,this._onProtocolChange=this.register(new o.EventEmitter),this.onProtocolChange=this._onProtocolChange.event;for(const e of Object.keys(l))this.addProtocol(e,l[e]);for(const e of Object.keys(d))this.addEncoding(e,d[e]);this.reset()}addProtocol(e,t){this._protocols[e]=t}addEncoding(e,t){this._encodings[e]=t}get activeProtocol(){return this._activeProtocol}get areMouseEventsActive(){return 0!==this._protocols[this._activeProtocol].events}set activeProtocol(e){if(!this._protocols[e])throw new Error(`unknown protocol "${e}"`);this._activeProtocol=e,this._onProtocolChange.fire(this._protocols[e].events)}get activeEncoding(){return this._activeEncoding}set activeEncoding(e){if(!this._encodings[e])throw new Error(`unknown encoding "${e}"`);this._activeEncoding=e}reset(){this.activeProtocol="NONE",this.activeEncoding="DEFAULT",this._lastEvent=null}triggerMouseEvent(e){if(e.col<0||e.col>=this._bufferService.cols||e.row<0||e.row>=this._bufferService.rows)return!1;if(4===e.button&&32===e.action)return!1;if(3===e.button&&32!==e.action)return!1;if(4!==e.button&&(2===e.action||3===e.action))return!1;if(e.col++,e.row++,32===e.action&&this._lastEvent&&this._equalEvents(this._lastEvent,e,"SGR_PIXELS"===this._activeEncoding))return!1;if(!this._protocols[this._activeProtocol].restrict(e))return!1;const t=this._encodings[this._activeEncoding](e);return t&&("DEFAULT"===this._activeEncoding?this._coreService.triggerBinaryEvent(t):this._coreService.triggerDataEvent(t,!0)),this._lastEvent=e,!0}explainEvents(e){return{down:!!(1&e),up:!!(2&e),drag:!!(4&e),move:!!(8&e),wheel:!!(16&e)}}_equalEvents(e,t,i){if(i){if(e.x!==t.x)return!1;if(e.y!==t.y)return!1}else{if(e.col!==t.col)return!1;if(e.row!==t.row)return!1}return e.button===t.button&&e.action===t.action&&e.ctrl===t.ctrl&&e.alt===t.alt&&e.shift===t.shift}};t.CoreMouseService=u=s([n(0,r.IBufferService),n(1,r.ICoreService)],u)},6975:function(e,t,i){var s=this&&this.__decorate||function(e,t,i,s){var n,r=arguments.length,o=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,s);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(r<3?n(o):r>3?n(t,i,o):n(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},n=this&&this.__param||function(e,t){return function(i,s){t(i,s,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CoreService=void 0;const r=i(1439),o=i(8460),a=i(844),l=i(2585),h=Object.freeze({insertMode:!1}),c=Object.freeze({applicationCursorKeys:!1,applicationKeypad:!1,bracketedPasteMode:!1,origin:!1,reverseWraparound:!1,sendFocus:!1,wraparound:!0});let d=t.CoreService=class extends a.Disposable{constructor(e,t,i){super(),this._bufferService=e,this._logService=t,this._optionsService=i,this.isCursorInitialized=!1,this.isCursorHidden=!1,this._onData=this.register(new o.EventEmitter),this.onData=this._onData.event,this._onUserInput=this.register(new o.EventEmitter),this.onUserInput=this._onUserInput.event,this._onBinary=this.register(new o.EventEmitter),this.onBinary=this._onBinary.event,this._onRequestScrollToBottom=this.register(new o.EventEmitter),this.onRequestScrollToBottom=this._onRequestScrollToBottom.event,this.modes=(0,r.clone)(h),this.decPrivateModes=(0,r.clone)(c)}reset(){this.modes=(0,r.clone)(h),this.decPrivateModes=(0,r.clone)(c)}triggerDataEvent(e,t=!1){if(this._optionsService.rawOptions.disableStdin)return;const i=this._bufferService.buffer;t&&this._optionsService.rawOptions.scrollOnUserInput&&i.ybase!==i.ydisp&&this._onRequestScrollToBottom.fire(),t&&this._onUserInput.fire(),this._logService.debug(`sending data "${e}"`,(()=>e.split("").map((e=>e.charCodeAt(0))))),this._onData.fire(e)}triggerBinaryEvent(e){this._optionsService.rawOptions.disableStdin||(this._logService.debug(`sending binary "${e}"`,(()=>e.split("").map((e=>e.charCodeAt(0))))),this._onBinary.fire(e))}};t.CoreService=d=s([n(0,l.IBufferService),n(1,l.ILogService),n(2,l.IOptionsService)],d)},9074:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DecorationService=void 0;const s=i(8055),n=i(8460),r=i(844),o=i(6106);let a=0,l=0;class h extends r.Disposable{get decorations(){return this._decorations.values()}constructor(){super(),this._decorations=new o.SortedList((e=>e?.marker.line)),this._onDecorationRegistered=this.register(new n.EventEmitter),this.onDecorationRegistered=this._onDecorationRegistered.event,this._onDecorationRemoved=this.register(new n.EventEmitter),this.onDecorationRemoved=this._onDecorationRemoved.event,this.register((0,r.toDisposable)((()=>this.reset())))}registerDecoration(e){if(e.marker.isDisposed)return;const t=new c(e);if(t){const e=t.marker.onDispose((()=>t.dispose()));t.onDispose((()=>{t&&(this._decorations.delete(t)&&this._onDecorationRemoved.fire(t),e.dispose())})),this._decorations.insert(t),this._onDecorationRegistered.fire(t)}return t}reset(){for(const e of this._decorations.values())e.dispose();this._decorations.clear()}*getDecorationsAtCell(e,t,i){let s=0,n=0;for(const r of this._decorations.getKeyIterator(t))s=r.options.x??0,n=s+(r.options.width??1),e>=s&&e<n&&(!i||(r.options.layer??"bottom")===i)&&(yield r)}forEachDecorationAtCell(e,t,i,s){this._decorations.forEachByKey(t,(t=>{a=t.options.x??0,l=a+(t.options.width??1),e>=a&&e<l&&(!i||(t.options.layer??"bottom")===i)&&s(t)}))}}t.DecorationService=h;class c extends r.Disposable{get isDisposed(){return this._isDisposed}get backgroundColorRGB(){return null===this._cachedBg&&(this.options.backgroundColor?this._cachedBg=s.css.toColor(this.options.backgroundColor):this._cachedBg=void 0),this._cachedBg}get foregroundColorRGB(){return null===this._cachedFg&&(this.options.foregroundColor?this._cachedFg=s.css.toColor(this.options.foregroundColor):this._cachedFg=void 0),this._cachedFg}constructor(e){super(),this.options=e,this.onRenderEmitter=this.register(new n.EventEmitter),this.onRender=this.onRenderEmitter.event,this._onDispose=this.register(new n.EventEmitter),this.onDispose=this._onDispose.event,this._cachedBg=null,this._cachedFg=null,this.marker=e.marker,this.options.overviewRulerOptions&&!this.options.overviewRulerOptions.position&&(this.options.overviewRulerOptions.position="full")}dispose(){this._onDispose.fire(),super.dispose()}}},4348:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.InstantiationService=t.ServiceCollection=void 0;const s=i(2585),n=i(8343);class r{constructor(...e){this._entries=new Map;for(const[t,i]of e)this.set(t,i)}set(e,t){const i=this._entries.get(e);return this._entries.set(e,t),i}forEach(e){for(const[t,i]of this._entries.entries())e(t,i)}has(e){return this._entries.has(e)}get(e){return this._entries.get(e)}}t.ServiceCollection=r,t.InstantiationService=class{constructor(){this._services=new r,this._services.set(s.IInstantiationService,this)}setService(e,t){this._services.set(e,t)}getService(e){return this._services.get(e)}createInstance(e,...t){const i=(0,n.getServiceDependencies)(e).sort(((e,t)=>e.index-t.index)),s=[];for(const t of i){const i=this._services.get(t.id);if(!i)throw new Error(`[createInstance] ${e.name} depends on UNKNOWN service ${t.id}.`);s.push(i)}const r=i.length>0?i[0].index:t.length;if(t.length!==r)throw new Error(`[createInstance] First service dependency of ${e.name} at position ${r+1} conflicts with ${t.length} static arguments`);return new e(...[...t,...s])}}},7866:function(e,t,i){var s=this&&this.__decorate||function(e,t,i,s){var n,r=arguments.length,o=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,s);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(r<3?n(o):r>3?n(t,i,o):n(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},n=this&&this.__param||function(e,t){return function(i,s){t(i,s,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.traceCall=t.setTraceLogger=t.LogService=void 0;const r=i(844),o=i(2585),a={trace:o.LogLevelEnum.TRACE,debug:o.LogLevelEnum.DEBUG,info:o.LogLevelEnum.INFO,warn:o.LogLevelEnum.WARN,error:o.LogLevelEnum.ERROR,off:o.LogLevelEnum.OFF};let l,h=t.LogService=class extends r.Disposable{get logLevel(){return this._logLevel}constructor(e){super(),this._optionsService=e,this._logLevel=o.LogLevelEnum.OFF,this._updateLogLevel(),this.register(this._optionsService.onSpecificOptionChange("logLevel",(()=>this._updateLogLevel()))),l=this}_updateLogLevel(){this._logLevel=a[this._optionsService.rawOptions.logLevel]}_evalLazyOptionalParams(e){for(let t=0;t<e.length;t++)"function"==typeof e[t]&&(e[t]=e[t]())}_log(e,t,i){this._evalLazyOptionalParams(i),e.call(console,(this._optionsService.options.logger?"":"xterm.js: ")+t,...i)}trace(e,...t){this._logLevel<=o.LogLevelEnum.TRACE&&this._log(this._optionsService.options.logger?.trace.bind(this._optionsService.options.logger)??console.log,e,t)}debug(e,...t){this._logLevel<=o.LogLevelEnum.DEBUG&&this._log(this._optionsService.options.logger?.debug.bind(this._optionsService.options.logger)??console.log,e,t)}info(e,...t){this._logLevel<=o.LogLevelEnum.INFO&&this._log(this._optionsService.options.logger?.info.bind(this._optionsService.options.logger)??console.info,e,t)}warn(e,...t){this._logLevel<=o.LogLevelEnum.WARN&&this._log(this._optionsService.options.logger?.warn.bind(this._optionsService.options.logger)??console.warn,e,t)}error(e,...t){this._logLevel<=o.LogLevelEnum.ERROR&&this._log(this._optionsService.options.logger?.error.bind(this._optionsService.options.logger)??console.error,e,t)}};t.LogService=h=s([n(0,o.IOptionsService)],h),t.setTraceLogger=function(e){l=e},t.traceCall=function(e,t,i){if("function"!=typeof i.value)throw new Error("not supported");const s=i.value;i.value=function(...e){if(l.logLevel!==o.LogLevelEnum.TRACE)return s.apply(this,e);l.trace(`GlyphRenderer#${s.name}(${e.map((e=>JSON.stringify(e))).join(", ")})`);const t=s.apply(this,e);return l.trace(`GlyphRenderer#${s.name} return`,t),t}}},7302:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OptionsService=t.DEFAULT_OPTIONS=void 0;const s=i(8460),n=i(844),r=i(6114);t.DEFAULT_OPTIONS={cols:80,rows:24,cursorBlink:!1,cursorStyle:"block",cursorWidth:1,cursorInactiveStyle:"outline",customGlyphs:!0,drawBoldTextInBrightColors:!0,documentOverride:null,fastScrollModifier:"alt",fastScrollSensitivity:5,fontFamily:"courier-new, courier, monospace",fontSize:15,fontWeight:"normal",fontWeightBold:"bold",ignoreBracketedPasteMode:!1,lineHeight:1,letterSpacing:0,linkHandler:null,logLevel:"info",logger:null,scrollback:1e3,scrollOnUserInput:!0,scrollSensitivity:1,screenReaderMode:!1,smoothScrollDuration:0,macOptionIsMeta:!1,macOptionClickForcesSelection:!1,minimumContrastRatio:1,disableStdin:!1,allowProposedApi:!1,allowTransparency:!1,tabStopWidth:8,theme:{},rescaleOverlappingGlyphs:!1,rightClickSelectsWord:r.isMac,windowOptions:{},windowsMode:!1,windowsPty:{},wordSeparator:" ()[]{}',\"`",altClickMovesCursor:!0,convertEol:!1,termName:"xterm",cancelEvents:!1,overviewRulerWidth:0};const o=["normal","bold","100","200","300","400","500","600","700","800","900"];class a extends n.Disposable{constructor(e){super(),this._onOptionChange=this.register(new s.EventEmitter),this.onOptionChange=this._onOptionChange.event;const i={...t.DEFAULT_OPTIONS};for(const t in e)if(t in i)try{const s=e[t];i[t]=this._sanitizeAndValidateOption(t,s)}catch(e){console.error(e)}this.rawOptions=i,this.options={...i},this._setupOptions(),this.register((0,n.toDisposable)((()=>{this.rawOptions.linkHandler=null,this.rawOptions.documentOverride=null})))}onSpecificOptionChange(e,t){return this.onOptionChange((i=>{i===e&&t(this.rawOptions[e])}))}onMultipleOptionChange(e,t){return this.onOptionChange((i=>{-1!==e.indexOf(i)&&t()}))}_setupOptions(){const e=e=>{if(!(e in t.DEFAULT_OPTIONS))throw new Error(`No option with key "${e}"`);return this.rawOptions[e]},i=(e,i)=>{if(!(e in t.DEFAULT_OPTIONS))throw new Error(`No option with key "${e}"`);i=this._sanitizeAndValidateOption(e,i),this.rawOptions[e]!==i&&(this.rawOptions[e]=i,this._onOptionChange.fire(e))};for(const t in this.rawOptions){const s={get:e.bind(this,t),set:i.bind(this,t)};Object.defineProperty(this.options,t,s)}}_sanitizeAndValidateOption(e,i){switch(e){case"cursorStyle":if(i||(i=t.DEFAULT_OPTIONS[e]),!function(e){return"block"===e||"underline"===e||"bar"===e}(i))throw new Error(`"${i}" is not a valid value for ${e}`);break;case"wordSeparator":i||(i=t.DEFAULT_OPTIONS[e]);break;case"fontWeight":case"fontWeightBold":if("number"==typeof i&&1<=i&&i<=1e3)break;i=o.includes(i)?i:t.DEFAULT_OPTIONS[e];break;case"cursorWidth":i=Math.floor(i);case"lineHeight":case"tabStopWidth":if(i<1)throw new Error(`${e} cannot be less than 1, value: ${i}`);break;case"minimumContrastRatio":i=Math.max(1,Math.min(21,Math.round(10*i)/10));break;case"scrollback":if((i=Math.min(i,4294967295))<0)throw new Error(`${e} cannot be less than 0, value: ${i}`);break;case"fastScrollSensitivity":case"scrollSensitivity":if(i<=0)throw new Error(`${e} cannot be less than or equal to 0, value: ${i}`);break;case"rows":case"cols":if(!i&&0!==i)throw new Error(`${e} must be numeric, value: ${i}`);break;case"windowsPty":i=i??{}}return i}}t.OptionsService=a},2660:function(e,t,i){var s=this&&this.__decorate||function(e,t,i,s){var n,r=arguments.length,o=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,s);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(r<3?n(o):r>3?n(t,i,o):n(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},n=this&&this.__param||function(e,t){return function(i,s){t(i,s,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.OscLinkService=void 0;const r=i(2585);let o=t.OscLinkService=class{constructor(e){this._bufferService=e,this._nextId=1,this._entriesWithId=new Map,this._dataByLinkId=new Map}registerLink(e){const t=this._bufferService.buffer;if(void 0===e.id){const i=t.addMarker(t.ybase+t.y),s={data:e,id:this._nextId++,lines:[i]};return i.onDispose((()=>this._removeMarkerFromLink(s,i))),this._dataByLinkId.set(s.id,s),s.id}const i=e,s=this._getEntryIdKey(i),n=this._entriesWithId.get(s);if(n)return this.addLineToLink(n.id,t.ybase+t.y),n.id;const r=t.addMarker(t.ybase+t.y),o={id:this._nextId++,key:this._getEntryIdKey(i),data:i,lines:[r]};return r.onDispose((()=>this._removeMarkerFromLink(o,r))),this._entriesWithId.set(o.key,o),this._dataByLinkId.set(o.id,o),o.id}addLineToLink(e,t){const i=this._dataByLinkId.get(e);if(i&&i.lines.every((e=>e.line!==t))){const e=this._bufferService.buffer.addMarker(t);i.lines.push(e),e.onDispose((()=>this._removeMarkerFromLink(i,e)))}}getLinkData(e){return this._dataByLinkId.get(e)?.data}_getEntryIdKey(e){return`${e.id};;${e.uri}`}_removeMarkerFromLink(e,t){const i=e.lines.indexOf(t);-1!==i&&(e.lines.splice(i,1),0===e.lines.length&&(void 0!==e.data.id&&this._entriesWithId.delete(e.key),this._dataByLinkId.delete(e.id)))}};t.OscLinkService=o=s([n(0,r.IBufferService)],o)},8343:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createDecorator=t.getServiceDependencies=t.serviceRegistry=void 0;const i="di$target",s="di$dependencies";t.serviceRegistry=new Map,t.getServiceDependencies=function(e){return e[s]||[]},t.createDecorator=function(e){if(t.serviceRegistry.has(e))return t.serviceRegistry.get(e);const n=function(e,t,r){if(3!==arguments.length)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");!function(e,t,n){t[i]===t?t[s].push({id:e,index:n}):(t[s]=[{id:e,index:n}],t[i]=t)}(n,e,r)};return n.toString=()=>e,t.serviceRegistry.set(e,n),n}},2585:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.IDecorationService=t.IUnicodeService=t.IOscLinkService=t.IOptionsService=t.ILogService=t.LogLevelEnum=t.IInstantiationService=t.ICharsetService=t.ICoreService=t.ICoreMouseService=t.IBufferService=void 0;const s=i(8343);var n;t.IBufferService=(0,s.createDecorator)("BufferService"),t.ICoreMouseService=(0,s.createDecorator)("CoreMouseService"),t.ICoreService=(0,s.createDecorator)("CoreService"),t.ICharsetService=(0,s.createDecorator)("CharsetService"),t.IInstantiationService=(0,s.createDecorator)("InstantiationService"),function(e){e[e.TRACE=0]="TRACE",e[e.DEBUG=1]="DEBUG",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.OFF=5]="OFF"}(n||(t.LogLevelEnum=n={})),t.ILogService=(0,s.createDecorator)("LogService"),t.IOptionsService=(0,s.createDecorator)("OptionsService"),t.IOscLinkService=(0,s.createDecorator)("OscLinkService"),t.IUnicodeService=(0,s.createDecorator)("UnicodeService"),t.IDecorationService=(0,s.createDecorator)("DecorationService")},1480:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UnicodeService=void 0;const s=i(8460),n=i(225);class r{static extractShouldJoin(e){return!!(1&e)}static extractWidth(e){return e>>1&3}static extractCharKind(e){return e>>3}static createPropertyValue(e,t,i=!1){return(16777215&e)<<3|(3&t)<<1|(i?1:0)}constructor(){this._providers=Object.create(null),this._active="",this._onChange=new s.EventEmitter,this.onChange=this._onChange.event;const e=new n.UnicodeV6;this.register(e),this._active=e.version,this._activeProvider=e}dispose(){this._onChange.dispose()}get versions(){return Object.keys(this._providers)}get activeVersion(){return this._active}set activeVersion(e){if(!this._providers[e])throw new Error(`unknown Unicode version "${e}"`);this._active=e,this._activeProvider=this._providers[e],this._onChange.fire(e)}register(e){this._providers[e.version]=e}wcwidth(e){return this._activeProvider.wcwidth(e)}getStringCellWidth(e){let t=0,i=0;const s=e.length;for(let n=0;n<s;++n){let o=e.charCodeAt(n);if(55296<=o&&o<=56319){if(++n>=s)return t+this.wcwidth(o);const i=e.charCodeAt(n);56320<=i&&i<=57343?o=1024*(o-55296)+i-56320+65536:t+=this.wcwidth(i)}const a=this.charProperties(o,i);let l=r.extractWidth(a);r.extractShouldJoin(a)&&(l-=r.extractWidth(i)),t+=l,i=a}return t}charProperties(e,t){return this._activeProvider.charProperties(e,t)}}t.UnicodeService=r}},t={};function i(s){var n=t[s];if(void 0!==n)return n.exports;var r=t[s]={exports:{}};return e[s].call(r.exports,r,r.exports,i),r.exports}var s={};return(()=>{var e=s;Object.defineProperty(e,"__esModule",{value:!0}),e.Terminal=void 0;const t=i(9042),n=i(3236),r=i(844),o=i(5741),a=i(8285),l=i(7975),h=i(7090),c=["cols","rows"];class d extends r.Disposable{constructor(e){super(),this._core=this.register(new n.Terminal(e)),this._addonManager=this.register(new o.AddonManager),this._publicOptions={...this._core.options};const t=e=>this._core.options[e],i=(e,t)=>{this._checkReadonlyOptions(e),this._core.options[e]=t};for(const e in this._core.options){const s={get:t.bind(this,e),set:i.bind(this,e)};Object.defineProperty(this._publicOptions,e,s)}}_checkReadonlyOptions(e){if(c.includes(e))throw new Error(`Option "${e}" can only be set in the constructor`)}_checkProposedApi(){if(!this._core.optionsService.rawOptions.allowProposedApi)throw new Error("You must set the allowProposedApi option to true to use proposed API")}get onBell(){return this._core.onBell}get onBinary(){return this._core.onBinary}get onCursorMove(){return this._core.onCursorMove}get onData(){return this._core.onData}get onKey(){return this._core.onKey}get onLineFeed(){return this._core.onLineFeed}get onRender(){return this._core.onRender}get onResize(){return this._core.onResize}get onScroll(){return this._core.onScroll}get onSelectionChange(){return this._core.onSelectionChange}get onTitleChange(){return this._core.onTitleChange}get onWriteParsed(){return this._core.onWriteParsed}get element(){return this._core.element}get parser(){return this._parser||(this._parser=new l.ParserApi(this._core)),this._parser}get unicode(){return this._checkProposedApi(),new h.UnicodeApi(this._core)}get textarea(){return this._core.textarea}get rows(){return this._core.rows}get cols(){return this._core.cols}get buffer(){return this._buffer||(this._buffer=this.register(new a.BufferNamespaceApi(this._core))),this._buffer}get markers(){return this._checkProposedApi(),this._core.markers}get modes(){const e=this._core.coreService.decPrivateModes;let t="none";switch(this._core.coreMouseService.activeProtocol){case"X10":t="x10";break;case"VT200":t="vt200";break;case"DRAG":t="drag";break;case"ANY":t="any"}return{applicationCursorKeysMode:e.applicationCursorKeys,applicationKeypadMode:e.applicationKeypad,bracketedPasteMode:e.bracketedPasteMode,insertMode:this._core.coreService.modes.insertMode,mouseTrackingMode:t,originMode:e.origin,reverseWraparoundMode:e.reverseWraparound,sendFocusMode:e.sendFocus,wraparoundMode:e.wraparound}}get options(){return this._publicOptions}set options(e){for(const t in e)this._publicOptions[t]=e[t]}blur(){this._core.blur()}focus(){this._core.focus()}input(e,t=!0){this._core.input(e,t)}resize(e,t){this._verifyIntegers(e,t),this._core.resize(e,t)}open(e){this._core.open(e)}attachCustomKeyEventHandler(e){this._core.attachCustomKeyEventHandler(e)}attachCustomWheelEventHandler(e){this._core.attachCustomWheelEventHandler(e)}registerLinkProvider(e){return this._core.registerLinkProvider(e)}registerCharacterJoiner(e){return this._checkProposedApi(),this._core.registerCharacterJoiner(e)}deregisterCharacterJoiner(e){this._checkProposedApi(),this._core.deregisterCharacterJoiner(e)}registerMarker(e=0){return this._verifyIntegers(e),this._core.registerMarker(e)}registerDecoration(e){return this._checkProposedApi(),this._verifyPositiveIntegers(e.x??0,e.width??0,e.height??0),this._core.registerDecoration(e)}hasSelection(){return this._core.hasSelection()}select(e,t,i){this._verifyIntegers(e,t,i),this._core.select(e,t,i)}getSelection(){return this._core.getSelection()}getSelectionPosition(){return this._core.getSelectionPosition()}clearSelection(){this._core.clearSelection()}selectAll(){this._core.selectAll()}selectLines(e,t){this._verifyIntegers(e,t),this._core.selectLines(e,t)}dispose(){super.dispose()}scrollLines(e){this._verifyIntegers(e),this._core.scrollLines(e)}scrollPages(e){this._verifyIntegers(e),this._core.scrollPages(e)}scrollToTop(){this._core.scrollToTop()}scrollToBottom(){this._core.scrollToBottom()}scrollToLine(e){this._verifyIntegers(e),this._core.scrollToLine(e)}clear(){this._core.clear()}write(e,t){this._core.write(e,t)}writeln(e,t){this._core.write(e),this._core.write("\r\n",t)}paste(e){this._core.paste(e)}refresh(e,t){this._verifyIntegers(e,t),this._core.refresh(e,t)}reset(){this._core.reset()}clearTextureAtlas(){this._core.clearTextureAtlas()}loadAddon(e){this._addonManager.loadAddon(this,e)}static get strings(){return t}_verifyIntegers(...e){for(const t of e)if(t===1/0||isNaN(t)||t%1!=0)throw new Error("This API only accepts integers")}_verifyPositiveIntegers(...e){for(const t of e)if(t&&(t===1/0||isNaN(t)||t%1!=0||t<0))throw new Error("This API only accepts positive integers")}}e.Terminal=d})(),s})(),e.exports=t()},680:(e,t,i)=>{"use strict";function s(e){for(var t=0,i=null,s=!1,n=null,o=-1,a=!1,l=e.length-1;l>=0;l--){var h=e[l],c=r(h,l>0?e[l-1]:null,s,n);if(s=c.inString,n=c.stringChar,!s)if(")"===h)t++;else if("("===h&&--t<0){var d;a=!0,o=l,i=(null===(d=e.slice(0,l).trim().match(/[\w\.]+(::[\w\.]+)?$/))||void 0===d?void 0:d[0])||null;break}}return a&&0!==t?{functionName:i,argumentStartIndex:o+1}:null}function n(e){for(var t=[],i="",s=0,n=!1,o=null,a=0;a<e.length;a++){var l=e[a],h=r(l,a>0?e[a-1]:null,n,o);n=h.inString,o=h.stringChar,","!==l||0!==s||n?(i+=l,"("===l&&s++,")"===l&&s--):(t.push(i.trim()),i="")}return e.trim().endsWith(",")?t.push(""):i.trim()&&t.push(i.trim()),t}function r(e,t,i,s){if(('"'===e||"'"===e)&&"\\"!==t){if(!i)return{inString:!0,stringChar:e};if(e===s)return{inString:!1,stringChar:null}}return{inString:i,stringChar:s}}function o(e,t){var i=s(t);if(!i)return{fullLine:e,functionName:null,arguments:[],lastArgument:null};var r=i.functionName,o=i.argumentStartIndex,a=n(t.slice(o)),l=a.length>0?a[a.length-1]:null;return{fullLine:e,functionName:r,arguments:a.length>1?a.slice(0,-1):[],lastArgument:l}}function a(e,t){var i=e.getLineContent(t.lineNumber),s=i.slice(0,t.column-1);return o(i,s)}i.r(t),i.d(t,{extractArguments:()=>n,extractFunctionCallInfo:()=>a,extractFunctionCallInfoInner:()=>o,findInnermostFunctionName:()=>s})},188:(e,t,i)=>{"use strict";function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var i=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=i){var s,n,r,o,a=[],l=!0,h=!1;try{if(r=(i=i.call(e)).next,0===t){if(Object(i)!==i)return;l=!1}else for(;!(l=(s=r.call(i)).done)&&(a.push(s.value),a.length!==t);l=!0);}catch(e){h=!0,n=e}finally{try{if(!l&&null!=i.return&&(o=i.return(),Object(o)!==o))return}finally{if(h)throw n}}return a}}(e,t)||function(e,t){if(e){if("string"==typeof e)return n(e,t);var i={}.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?n(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,s=Array(t);i<t;i++)s[i]=e[i];return s}function r(e,t){var i=t.parameters.map((function(e,t){return[e.label.trim(),t]})),n=e.arguments,r=e.lastArgument;if(n.forEach((function(e){var t=e.match(/^(\w+)\s*=/);if(t){var n=t[1].trim();i=i.filter((function(e){return s(e,1)[0]!==n}))}})),n.forEach((function(e){e.match(/^(\w+)\s*=/)||i.shift()})),r){var o=r.match(/^(\w+)/);if(o){var a=o[1].trim(),l=i.find((function(e){return s(e,1)[0].startsWith(a)}));if(l)return l[1]}}return i.length>0?i[0][1]:0}i.r(t),i.d(t,{getActiveParameter:()=>r})},677:(e,t,i)=>{"use strict";function s(e){return function(e){if(Array.isArray(e))return n(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return n(e,t);var i={}.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?n(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,s=Array(t);i<t;i++)s[i]=e[i];return s}function r(e,t,i){var n=[t];var r=["+","-","*","/","^","%","=","<-","->","~","::",":::",",","|>"];return function e(t,i,s){if(t.length>0)for(var n=t[t.length-1].trim(),o=0,a=r;o<a.length;o++){var l=a[o];if(new RegExp("\\".concat(l,"\\s*$")).test(n))return i.unshift(t.pop()),e(t,i,s)}var h=function(e){var t=e.replace(/#.*$/gm,"").trim();if(""===t)return"need_more_below";for(var i=0,s=0,n=0,o=!1,a=!1,l=!1,h=t.split("\n"),c=h[h.length-1].trim(),d=h[0].trim(),u=0,p=["if","for","while","repeat","else"];u<p.length;u++)if(new RegExp("^".concat(p[u],"\\b.*[^\\{;]$")).test(c)&&!c.endsWith("{"))return"need_more_below";for(var m=0;m<t.length;m++){var f=t[m];if(l)l=!1;else if("\\"!==f)if(o)"'"===f&&(o=!1);else if(a)'"'===f&&(a=!1);else if("'"!==f)if('"'!==f)switch(f){case"(":i++;break;case")":i--;break;case"{":s++;break;case"}":s--;break;case"[":n++;break;case"]":n--}else a=!0;else o=!0;else l=!0}if(i<0||s<0||n<0)return"need_more_above";if(i>0||s>0||n>0)return"need_more_below";t.replace(/(['"]).*?(\1|$)/g,"");for(var g=0,_=r;g<_.length;g++){var v=_[g];if(new RegExp("\\".concat(v,"\\s*$")).test(c.trim()))return"need_more_below"}return/^\s*,/.test(d)?"need_more_above":"complete"}(i.join("\n"));return"complete"===h?{lines_above:t,accumulated_lines:i,lines_below:s}:"need_more_below"===h&&s.length>0?(i.push(s.shift()),e(t,i,s)):"need_more_above"===h&&t.length>0?(i.unshift(t.pop()),e(t,i,s)):{lines_above:t,accumulated_lines:i,lines_below:s}}(s(e),n,s(i))}i.r(t),i.d(t,{getCompleteRBlock:()=>r})},816:(e,t,i)=>{"use strict";function s(e,t){if(e<1||e>t.length)return"";for(var i=e-1,s=e-1,n=/[a-zA-Z0-9_:\$\.]/;i>0&&n.test(t.charAt(i-1));)i--;for(;s<t.length&&n.test(t.charAt(s));)s++;return t.slice(i,s)}function n(e,t){var i=t.lineNumber;return s(t.column-1,e.getLineContent(i))}i.r(t),i.d(t,{getCurrentRWord:()=>s,getCurrentWord:()=>n})},34:(e,t,i)=>{"use strict";i.r(t),i.d(t,{GoldenLayout:()=>a});var s=i(692),n=i.n(s);function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}var o={config:{},container:{},controls:{},errors:{},items:{},utils:{}};o.utils.F=function(){},o.utils.extend=function(e,t){e.prototype=o.utils.createObject(t.prototype),e.prototype.contructor=e},o.utils.createObject=function(e){return"function"==typeof Object.create?Object.create(e):(o.utils.F.prototype=e,new o.utils.F)},o.utils.objectKeys=function(e){var t,i;if("function"==typeof Object.keys)return Object.keys(e);for(i in t=[],e)t.push(i);return t},o.utils.getHashValue=function(e){var t=location.hash.match(new RegExp(e+"=([^&]*)"));return t?t[1]:null},o.utils.getQueryStringParam=function(e){if(window.location.hash)return o.utils.getHashValue(e);if(!window.location.search)return null;var t,i,s=window.location.search.substr(1).split("&"),n={};for(i=0;i<s.length;i++)n[(t=s[i].split("="))[0]]=t[1];return n[e]||null},o.utils.copy=function(e,t){for(var i in t)e[i]=t[i];return e},o.utils.animFrame=function(e){return(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)})((function(){e()}))},o.utils.indexOf=function(e,t){if(!(t instanceof Array))throw new Error("Haystack is not an Array");if(t.indexOf)return t.indexOf(e);for(var i=0;i<t.length;i++)if(t[i]===e)return i;return-1},"object"!=("undefined"==typeof Int8Array?"undefined":r(Int8Array))?o.utils.isFunction=function(e){return"function"==typeof e||!1}:o.utils.isFunction=function(e){return"[object Function]"===toString.call(e)},o.utils.fnBind=function(e,t,i){if(void 0!==Function.prototype.bind)return Function.prototype.bind.apply(e,[t].concat(i||[]));var s=function(){var n=(i||[]).concat(Array.prototype.slice.call(arguments,0));if(!(this instanceof s))return e.apply(t,n);e.apply(this,n)};return s.prototype=e.prototype,s},o.utils.removeFromArray=function(e,t){var i=o.utils.indexOf(e,t);if(-1===i)throw new Error("Can't remove item from array. Item is not in the array");t.splice(i,1)},o.utils.now=function(){return"function"==typeof Date.now?Date.now():(new Date).getTime()},o.utils.getUniqueId=function(){return(1e15*Math.random()).toString(36).replace(".","")},o.utils.filterXss=function(e,t){var i=e.replace(/javascript/gi,"j&#97;vascript").replace(/expression/gi,"expr&#101;ssion").replace(/onload/gi,"onlo&#97;d").replace(/script/gi,"&#115;cript").replace(/onerror/gi,"on&#101;rror");return!0===t?i:i.replace(/>/g,"&gt;").replace(/</g,"&lt;")},o.utils.stripTags=function(e){return n().trim(e.replace(/(<([^>]+)>)/gi,""))},o.utils.EventEmitter=function(){this._mSubscriptions={},this._mSubscriptions[o.utils.EventEmitter.ALL_EVENT]=[],this.on=function(e,t,i){if(!o.utils.isFunction(t))throw new Error("Tried to listen to event "+e+" with non-function callback "+t);this._mSubscriptions[e]||(this._mSubscriptions[e]=[]),this._mSubscriptions[e].push({fn:t,ctx:i})},this.emit=function(e){var t,i,s;if(s=Array.prototype.slice.call(arguments,1),this._mSubscriptions[e])for(t=0;t<this._mSubscriptions[e].length;t++)i=this._mSubscriptions[e][t].ctx||{},this._mSubscriptions[e][t].fn.apply(i,s);for(s.unshift(e),t=0;t<this._mSubscriptions[o.utils.EventEmitter.ALL_EVENT].length;t++)i=this._mSubscriptions[o.utils.EventEmitter.ALL_EVENT][t].ctx||{},this._mSubscriptions[o.utils.EventEmitter.ALL_EVENT][t].fn.apply(i,s)},this.unbind=function(e,t,i){if(!this._mSubscriptions[e])throw new Error("No subscribtions to unsubscribe for event "+e);var s,n=!1;for(s=0;s<this._mSubscriptions[e].length;s++)t&&this._mSubscriptions[e][s].fn!==t||i&&i!==this._mSubscriptions[e][s].ctx||(this._mSubscriptions[e].splice(s,1),n=!0);if(!1===n)throw new Error("Nothing to unbind for "+e)},this.off=this.unbind,this.trigger=this.emit},o.utils.EventEmitter.ALL_EVENT="__all",o.utils.DragListener=function(e,t){o.utils.EventEmitter.call(this),this._eElement=n()(e),this._oDocument=n()(document),this._eBody=n()(document.body),this._nButtonCode=t||0,this._nDelay=200,this._nDistance=10,this._nX=0,this._nY=0,this._nOriginalX=0,this._nOriginalY=0,this._bDragging=!1,this._fMove=o.utils.fnBind(this.onMouseMove,this),this._fUp=o.utils.fnBind(this.onMouseUp,this),this._fDown=o.utils.fnBind(this.onMouseDown,this),this._eElement.on("mousedown touchstart",this._fDown)},o.utils.DragListener.timeout=null,o.utils.copy(o.utils.DragListener.prototype,{destroy:function(){this._eElement.unbind("mousedown touchstart",this._fDown)},onMouseDown:function(e){if(e.preventDefault(),0==e.button||"touchstart"===e.type){var t=this._getCoordinates(e);this._nOriginalX=t.x,this._nOriginalY=t.y,this._oDocument.on("mousemove touchmove",this._fMove),this._oDocument.one("mouseup touchend",this._fUp),this._timeout=setTimeout(o.utils.fnBind(this._startDrag,this),this._nDelay)}},onMouseMove:function(e){if(null!=this._timeout){e.preventDefault();var t=this._getCoordinates(e);this._nX=t.x-this._nOriginalX,this._nY=t.y-this._nOriginalY,!1===this._bDragging&&(Math.abs(this._nX)>this._nDistance||Math.abs(this._nY)>this._nDistance)&&(clearTimeout(this._timeout),this._startDrag()),this._bDragging&&this.emit("drag",this._nX,this._nY,e)}},onMouseUp:function(e){null!=this._timeout&&(clearTimeout(this._timeout),this._eBody.removeClass("lm_dragging"),this._eElement.removeClass("lm_dragging"),this._oDocument.find("iframe").css("pointer-events",""),this._oDocument.unbind("mousemove touchmove",this._fMove),!0===this._bDragging&&(this._bDragging=!1,this.emit("dragStop",e,this._nOriginalX+this._nX)))},_startDrag:function(){this._bDragging=!0,this._eBody.addClass("lm_dragging"),this._eElement.addClass("lm_dragging"),this._oDocument.find("iframe").css("pointer-events","none"),this.emit("dragStart",this._nOriginalX,this._nOriginalY)},_getCoordinates:function(e){return{x:(e=e.originalEvent&&e.originalEvent.touches?e.originalEvent.touches[0]:e).pageX,y:e.pageY}}}),o.LayoutManager=function(e,t){if(!n()||"function"!=typeof n().noConflict)throw new Error('jQuery is missing as dependency for GoldenLayout. Please either expose $ on GoldenLayout\'s scope (e.g. window) or add "jquery" to your paths when using RequireJS/AMD');o.utils.EventEmitter.call(this),this.isInitialised=!1,this._isFullPage=!1,this._resizeTimeoutId=null,this._components={"lm-react-component":o.utils.ReactComponentHandler},this._itemAreas=[],this._resizeFunction=o.utils.fnBind(this._onResize,this),this._unloadFunction=o.utils.fnBind(this._onUnload,this),this._maximisedItem=null,this._maximisePlaceholder=n()('<div class="lm_maximise_place"></div>'),this._creationTimeoutPassed=!1,this._subWindowsCreated=!1,this._dragSources=[],this._updatingColumnsResponsive=!1,this._firstLoad=!0,this.width=null,this.height=null,this.root=null,this.openPopouts=[],this.selectedItem=null,this.isSubWindow=!1,this.eventHub=new o.utils.EventHub(this),this.config=this._createConfig(e),this.container=t,this.dropTargetIndicator=null,this.transitionIndicator=null,this.tabDropPlaceholder=n()('<div class="lm_drop_tab_placeholder"></div>'),!0===this.isSubWindow&&n()("body").css("visibility","hidden"),this._typeToItem={column:o.utils.fnBind(o.items.RowOrColumn,this,[!0]),row:o.utils.fnBind(o.items.RowOrColumn,this,[!1]),stack:o.items.Stack,component:o.items.Component}},o.LayoutManager.__lm=o,o.LayoutManager.minifyConfig=function(e){return(new o.utils.ConfigMinifier).minifyConfig(e)},o.LayoutManager.unminifyConfig=function(e){return(new o.utils.ConfigMinifier).unminifyConfig(e)},o.utils.copy(o.LayoutManager.prototype,{registerComponent:function(e,t){if("function"!=typeof t)throw new Error("Please register a constructor function");if(void 0!==this._components[e])throw new Error("Component "+e+" is already registered");this._components[e]=t},toConfig:function(e){var t,i,s;if(!1===this.isInitialised)throw new Error("Can't create config, layout not yet initialised");if(e&&!(e instanceof o.items.AbstractContentItem))throw new Error("Root must be a ContentItem");for((t={settings:o.utils.copy({},this.config.settings),dimensions:o.utils.copy({},this.config.dimensions),labels:o.utils.copy({},this.config.labels)}).content=[],i=function(e,t){var s,n;for(s in t.config)"content"!==s&&(e[s]=t.config[s]);if(t.contentItems.length)for(e.content=[],n=0;n<t.contentItems.length;n++)e.content[n]={},i(e.content[n],t.contentItems[n])},i(t,e?{contentItems:[e]}:this.root),this._$reconcilePopoutWindows(),t.openPopouts=[],s=0;s<this.openPopouts.length;s++)t.openPopouts.push(this.openPopouts[s].toConfig());return t.maximisedItemId=this._maximisedItem?"__glMaximised":null,t},getComponent:function(e){if(void 0===this._components[e])throw new o.errors.ConfigurationError('Unknown component "'+e+'"');return this._components[e]},init:function(){if(!1===this._subWindowsCreated&&(this._createSubWindows(),this._subWindowsCreated=!0),"loading"!==document.readyState&&null!==document.body){if(!0===this.isSubWindow&&!1===this._creationTimeoutPassed)return setTimeout(o.utils.fnBind(this.init,this),7),void(this._creationTimeoutPassed=!0);!0===this.isSubWindow&&this._adjustToWindowMode(),this._setContainer(),this.dropTargetIndicator=new o.controls.DropTargetIndicator(this.container),this.transitionIndicator=new o.controls.TransitionIndicator,this.updateSize(),this._create(this.config),this._bindEvents(),this.isInitialised=!0,this._adjustColumnsResponsive(),this.emit("initialised")}else n()(document).ready(o.utils.fnBind(this.init,this))},updateSize:function(e,t){2===arguments.length?(this.width=e,this.height=t):(this.width=this.container.width(),this.height=this.container.height()),!0===this.isInitialised&&(this.root.callDownwards("setSize",[this.width,this.height]),this._maximisedItem&&(this._maximisedItem.element.width(this.container.width()),this._maximisedItem.element.height(this.container.height()),this._maximisedItem.callDownwards("setSize")),this._adjustColumnsResponsive())},destroy:function(){!1!==this.isInitialised&&(this._onUnload(),n()(window).off("resize",this._resizeFunction),n()(window).off("unload beforeunload",this._unloadFunction),this.root.callDownwards("_$destroy",[],!0),this.root.contentItems=[],this.tabDropPlaceholder.remove(),this.dropTargetIndicator.destroy(),this.transitionIndicator.destroy(),this.eventHub.destroy(),this._dragSources.forEach((function(e){e._dragListener.destroy(),e._element=null,e._itemConfig=null,e._dragListener=null})),this._dragSources=[])},createContentItem:function(e,t){var i;if("string"!=typeof e.type)throw new o.errors.ConfigurationError("Missing parameter 'type'",e);if("react-component"===e.type&&(e.type="component",e.componentName="lm-react-component"),!this._typeToItem[e.type])throw i="Unknown type '"+e.type+"'. Valid types are "+o.utils.objectKeys(this._typeToItem).join(","),new o.errors.ConfigurationError(i);return"component"!==e.type||t instanceof o.items.Stack||!t||!0===this.isSubWindow&&t instanceof o.items.Root||(e={type:"stack",width:e.width,height:e.height,content:[e]}),new this._typeToItem[e.type](this,e,t)},createPopout:function(e,t,i,s){var n,r,a,l,h,c,d=e,u=e instanceof o.items.AbstractContentItem,p=this;if(i=i||null,u){for(d=this.toConfig(e).content,i=o.utils.getUniqueId(),l=e.parent,h=e;1===l.contentItems.length&&!l.isRoot;)l=l.parent,h=h.parent;l.addId(i),isNaN(s)&&(s=o.utils.indexOf(h,l.contentItems))}else d instanceof Array||(d=[d]);return!t&&u&&(n=window.screenX||window.screenLeft,r=window.screenY||window.screenTop,t={left:n+(a=e.element.offset()).left,top:r+a.top,width:e.element.width(),height:e.element.height()}),t||u||(t={left:window.screenX||window.screenLeft+20,top:window.screenY||window.screenTop+20,width:500,height:309}),u&&e.remove(),(c=new o.controls.BrowserPopout(d,t,i,s,this)).on("initialised",(function(){p.emit("windowOpened",c)})),c.on("closed",(function(){p._$reconcilePopoutWindows()})),this.openPopouts.push(c),c},createDragSource:function(e,t){this.config.settings.constrainDragToContainer=!1;var i=new o.controls.DragSource(n()(e),t,this);return this._dragSources.push(i),i},selectItem:function(e,t){if(!0!==this.config.settings.selectionEnabled)throw new Error("Please set selectionEnabled to true to use this feature");e!==this.selectedItem&&(null!==this.selectedItem&&this.selectedItem.deselect(),e&&!0!==t&&e.select(),this.selectedItem=e,this.emit("selectionChanged",e))},_$maximiseItem:function(e){null!==this._maximisedItem&&this._$minimiseItem(this._maximisedItem),this._maximisedItem=e,this._maximisedItem.addId("__glMaximised"),e.element.addClass("lm_maximised"),e.element.after(this._maximisePlaceholder),this.root.element.prepend(e.element),e.element.width(this.container.width()),e.element.height(this.container.height()),e.callDownwards("setSize"),this._maximisedItem.emit("maximised"),this.emit("stateChanged")},_$minimiseItem:function(e){e.element.removeClass("lm_maximised"),e.removeId("__glMaximised"),this._maximisePlaceholder.after(e.element),this._maximisePlaceholder.remove(),e.parent.callDownwards("setSize"),this._maximisedItem=null,e.emit("minimised"),this.emit("stateChanged")},_$closeWindow:function(){window.setTimeout((function(){window.close()}),1)},_$getArea:function(e,t){var i,s,n=1/0,r=null;for(i=0;i<this._itemAreas.length;i++)e>(s=this._itemAreas[i]).x1&&e<s.x2&&t>s.y1&&t<s.y2&&n>s.surface&&(n=s.surface,r=s);return r},_$createRootItemAreas:function(){var e={y2:0,x2:0,y1:"y2",x1:"x2"};for(side in e){var t=this.root._$getArea();t.side=side,e[side]?t[side]=t[e[side]]-50:t[side]=50,surface=(t.x2-t.x1)*(t.y2-t.y1),this._itemAreas.push(t)}},_$calculateItemAreas:function(){var e,t,i=this._getAllContentItems();if(this._itemAreas=[],1!==i.length){for(this._$createRootItemAreas(),e=0;e<i.length;e++)if(i[e].isStack&&null!==(t=i[e]._$getArea()))if(t instanceof Array)this._itemAreas=this._itemAreas.concat(t);else{this._itemAreas.push(t);var s={};o.utils.copy(s,t),o.utils.copy(s,t.contentItem._contentAreaDimensions.header.highlightArea),surface=(s.x2-s.x1)*(s.y2-s.y1),this._itemAreas.push(s)}}else this._itemAreas.push(this.root._$getArea())},_$normalizeContentItem:function(e,t){if(!e)throw new Error("No content item defined");if(o.utils.isFunction(e)&&(e=e()),e instanceof o.items.AbstractContentItem)return e;if(n().isPlainObject(e)&&e.type){var i=this.createContentItem(e,t);return i.callDownwards("_$init"),i}throw new Error("Invalid contentItem")},_$reconcilePopoutWindows:function(){var e,t=[];for(e=0;e<this.openPopouts.length;e++)!1===this.openPopouts[e].getWindow().closed?t.push(this.openPopouts[e]):this.emit("windowClosed",this.openPopouts[e]);this.openPopouts.length!==t.length&&(this.emit("stateChanged"),this.openPopouts=t)},_getAllContentItems:function(){var e=[],t=function(i){if(e.push(i),i.contentItems instanceof Array)for(var s=0;s<i.contentItems.length;s++)t(i.contentItems[s])};return t(this.root),e},_bindEvents:function(){this._isFullPage&&n()(window).resize(this._resizeFunction),n()(window).on("unload beforeunload",this._unloadFunction)},_onResize:function(){clearTimeout(this._resizeTimeoutId),this._resizeTimeoutId=setTimeout(o.utils.fnBind(this.updateSize,this),100)},_createConfig:function(e){var t=o.utils.getQueryStringParam("gl-window");t&&(this.isSubWindow=!0,e=localStorage.getItem(t),e=JSON.parse(e),e=(new o.utils.ConfigMinifier).unminifyConfig(e),localStorage.removeItem(t)),e=n().extend(!0,{},o.config.defaultConfig,e);var i=function(e){for(var t in e)"props"!==t&&"object"===r(e[t])?i(e[t]):"type"===t&&"react-component"===e[t]&&(e.type="component",e.componentName="lm-react-component")};return i(e),!1===e.settings.hasHeaders&&(e.dimensions.headerHeight=0),e},_adjustToWindowMode:function(){var e=n()('<div class="lm_popin" title="'+this.config.labels.popin+'"><div class="lm_icon"></div><div class="lm_bg"></div></div>');e.click(o.utils.fnBind((function(){this.emit("popIn")}),this)),document.title=o.utils.stripTags(this.config.content[0].title),n()("head").append(n()("body link, body style, template, .gl_keep")),this.container=n()("body").html("").css("visibility","visible").append(e),document.body.offsetHeight,window.__glInstance=this},_createSubWindows:function(){var e,t;for(e=0;e<this.config.openPopouts.length;e++)t=this.config.openPopouts[e],this.createPopout(t.content,t.dimensions,t.parentId,t.indexInParent)},_setContainer:function(){var e=n()(this.container||"body");if(0===e.length)throw new Error("GoldenLayout container not found");if(e.length>1)throw new Error("GoldenLayout more than one container element specified");e[0]===document.body&&(this._isFullPage=!0,n()("html, body").css({height:"100%",margin:0,padding:0,overflow:"hidden"})),this.container=e},_create:function(e){var t;if(!(e.content instanceof Array))throw t=void 0===e.content?"Missing setting 'content' on top level of configuration":"Configuration parameter 'content' must be an array",new o.errors.ConfigurationError(t,e);if(e.content.length>1)throw t="Top level content can't contain more then one element.",new o.errors.ConfigurationError(t,e);this.root=new o.items.Root(this,{content:e.content},this.container),this.root.callDownwards("_$init"),"__glMaximised"===e.maximisedItemId&&this.root.getItemsById(e.maximisedItemId)[0].toggleMaximise()},_onUnload:function(){if(!0===this.config.settings.closePopoutsOnUnload)for(var e=0;e<this.openPopouts.length;e++)this.openPopouts[e].close()},_adjustColumnsResponsive:function(){if(this._useResponsiveLayout()&&!this._updatingColumnsResponsive&&this.config.dimensions&&this.config.dimensions.minItemWidth&&0!==this.root.contentItems.length&&this.root.contentItems[0].isRow){this._firstLoad=!1;var e=this.root.contentItems[0].contentItems.length;if(!(e<=1)){var t=this.config.dimensions.minItemWidth;if(!(e*t<=this.width)){this._updatingColumnsResponsive=!0;for(var i=e-Math.max(Math.floor(this.width/t),1),s=this.root.contentItems[0],n=this._findAllStackContainers()[0],r=0;r<i;r++){var o=s.contentItems[s.contentItems.length-1];s.removeChild(o),this._addChildContentItemsToContainer(n,o)}this._updatingColumnsResponsive=!1}}}else this._firstLoad=!1},_useResponsiveLayout:function(){return this.config.settings&&("always"==this.config.settings.responsiveMode||"onload"==this.config.settings.responsiveMode&&this._firstLoad)},_addChildContentItemsToContainer:function(e,t){"stack"===t.type?t.contentItems.forEach((function(t){e.addChild(t)})):t.contentItems.forEach(o.utils.fnBind((function(t){this._addChildContentItemsToContainer(e,t)}),this))},_findAllStackContainers:function(){var e=[];return this._findAllStackContainersRecursive(e,this.root),e},_findAllStackContainersRecursive:function(e,t){t.contentItems.forEach(o.utils.fnBind((function(t){"stack"==t.type?e.push(t):t.isComponent||this._findAllStackContainersRecursive(e,t)}),this))}}),o.config.itemDefaultConfig={isClosable:!0,reorderEnabled:!0,title:""},o.config.defaultConfig={openPopouts:[],settings:{hasHeaders:!0,constrainDragToContainer:!0,reorderEnabled:!0,selectionEnabled:!1,popoutWholeStack:!1,blockedPopoutsThrowError:!0,closePopoutsOnUnload:!0,showPopoutIcon:!0,showMaximiseIcon:!0,showCloseIcon:!0,responsiveMode:"onload"},dimensions:{borderWidth:5,minItemHeight:10,minItemWidth:10,headerHeight:20,dragProxyWidth:300,dragProxyHeight:200},labels:{close:"close",maximise:"maximise",minimise:"minimise",popout:"open in new window",popin:"pop in",tabDropdown:"additional tabs"}},o.container.ItemContainer=function(e,t,i){o.utils.EventEmitter.call(this),this.width=null,this.height=null,this.title=e.componentName,this.parent=t,this.layoutManager=i,this.isHidden=!1,this._config=e,this._element=n()(['<div class="lm_item_container">','<div class="lm_content"></div>',"</div>"].join("")),this._contentElement=this._element.find(".lm_content")},o.utils.copy(o.container.ItemContainer.prototype,{getElement:function(){return this._contentElement},hide:function(){this.emit("hide"),this.isHidden=!0,this._element.hide()},show:function(){this.emit("show"),this.isHidden=!1,this._element.show(),0==this.height&&0==this.width||this.emit("shown")},setSize:function(e,t){for(var i,s,n,r,o=this.parent,a=this;!o.isColumn&&!o.isRow;)if(a=o,(o=o.parent).isRoot)return!1;for(i=("height"==(s=o.isColumn?"height":"width")?t:e)/(this[s]*(1/(a.config[s]/100)))*100,n=(a.config[s]-i)/(o.contentItems.length-1),r=0;r<o.contentItems.length;r++)o.contentItems[r]===a?o.contentItems[r].config[s]=i:o.contentItems[r].config[s]+=n;return o.callDownwards("setSize"),!0},close:function(){this._config.isClosable&&(this.emit("close"),this.parent.close())},getState:function(){return this._config.componentState},extendState:function(e){this.setState(n().extend(!0,this.getState(),e))},setState:function(e){this._config.componentState=e,this.parent.emitBubblingEvent("stateChanged")},setTitle:function(e){this.parent.setTitle(e)},_$setSize:function(e,t){e===this.width&&t===this.height||(this.width=e,this.height=t,this._contentElement.width(this.width).height(this.height),this.emit("resize"))}}),o.controls.BrowserPopout=function(e,t,i,s,n){o.utils.EventEmitter.call(this),this.isInitialised=!1,this._config=e,this._dimensions=t,this._parentId=i,this._indexInParent=s,this._layoutManager=n,this._popoutWindow=null,this._id=null,this._createWindow()},o.utils.copy(o.controls.BrowserPopout.prototype,{toConfig:function(){if(!1===this.isInitialised)throw new Error("Can't create config, layout not yet initialised");return{dimensions:{width:this.getGlInstance().width,height:this.getGlInstance().height,left:this._popoutWindow.screenX||this._popoutWindow.screenLeft,top:this._popoutWindow.screenY||this._popoutWindow.screenTop},content:this.getGlInstance().toConfig().content,parentId:this._parentId,indexInParent:this._indexInParent}},getGlInstance:function(){return this._popoutWindow.__glInstance},getWindow:function(){return this._popoutWindow},close:function(){if(this.getGlInstance())this.getGlInstance()._$closeWindow();else try{this.getWindow().close()}catch(e){}},popIn:function(){var e,t;this._indexInParent,this._parentId&&(e=n().extend(!0,{},this.getGlInstance().toConfig()).content[0],(t=this._layoutManager.root.getItemsById(this._parentId)[0])||(t=this._layoutManager.root.contentItems.length>0?this._layoutManager.root.contentItems[0]:this._layoutManager.root)),t.addChild(e,this._indexInParent),this.close()},_createWindow:function(){var e,t=this._createUrl(),i=Math.floor(1e6*Math.random()).toString(36),s=this._serializeWindowOptions({width:this._dimensions.width,height:this._dimensions.height,innerWidth:this._dimensions.width,innerHeight:this._dimensions.height,menubar:"no",toolbar:"no",location:"no",personalbar:"no",resizable:"yes",scrollbars:"no",status:"no"});if(this._popoutWindow=window.open(t,i,s),this._popoutWindow)n()(this._popoutWindow).on("load",o.utils.fnBind(this._positionWindow,this)).on("unload beforeunload",o.utils.fnBind(this._onClose,this)),e=setInterval(o.utils.fnBind((function(){this._popoutWindow.__glInstance&&this._popoutWindow.__glInstance.isInitialised&&(this._onInitialised(),clearInterval(e))}),this),10);else if(!0===this._layoutManager.config.settings.blockedPopoutsThrowError){var r=new Error("Popout blocked");throw r.type="popoutBlocked",r}},_serializeWindowOptions:function(e){var t,i=[];for(t in e)i.push(t+"="+e[t]);return i.join(",")},_createUrl:function(){var e,t={content:this._config},i="gl-window-config-"+o.utils.getUniqueId();t=(new o.utils.ConfigMinifier).minifyConfig(t);try{localStorage.setItem(i,JSON.stringify(t))}catch(e){throw new Error("Error while writing to localStorage "+e.toString())}return 1===(e=document.location.href.split("?")).length?e[0]+"?gl-window="+i:document.location.href+"&gl-window="+i},_positionWindow:function(){this._popoutWindow.moveTo(this._dimensions.left,this._dimensions.top),this._popoutWindow.focus()},_onInitialised:function(){this.isInitialised=!0,this.getGlInstance().on("popIn",this.popIn,this),this.emit("initialised")},_onClose:function(){setTimeout(o.utils.fnBind(this.emit,this,["closed"]),50)}}),o.controls.DragProxy=function(e,t,i,s,r,a){o.utils.EventEmitter.call(this),this._dragListener=i,this._layoutManager=s,this._contentItem=r,this._originalParent=a,this._area=null,this._lastValidArea=null,this._dragListener.on("drag",this._onDrag,this),this._dragListener.on("dragStop",this._onDrop,this),this.element=n()(o.controls.DragProxy._template),a&&a._side&&(this._sided=a._sided,this.element.addClass("lm_"+a._side),["right","bottom"].indexOf(a._side)>=0&&this.element.find(".lm_content").after(this.element.find(".lm_header"))),this.element.css({left:e,top:t}),this.element.find(".lm_tab").attr("title",o.utils.stripTags(this._contentItem.config.title)),this.element.find(".lm_title").html(this._contentItem.config.title),this.childElementContainer=this.element.find(".lm_content"),this.childElementContainer.append(r.element),this._updateTree(),this._layoutManager._$calculateItemAreas(),this._setDimensions(),n()(document.body).append(this.element);var l=this._layoutManager.container.offset();this._minX=l.left,this._minY=l.top,this._maxX=this._layoutManager.container.width()+this._minX,this._maxY=this._layoutManager.container.height()+this._minY,this._width=this.element.width(),this._height=this.element.height(),this._setDropPosition(e,t)},o.controls.DragProxy._template='<div class="lm_dragProxy"><div class="lm_header"><ul class="lm_tabs"><li class="lm_tab lm_active"><i class="lm_left"></i><span class="lm_title"></span><i class="lm_right"></i></li></ul></div><div class="lm_content"></div></div>',o.utils.copy(o.controls.DragProxy.prototype,{_onDrag:function(e,t,i){var s=(i=i.originalEvent&&i.originalEvent.touches?i.originalEvent.touches[0]:i).pageX,n=i.pageY;(s>this._minX&&s<this._maxX&&n>this._minY&&n<this._maxY||!0!==this._layoutManager.config.settings.constrainDragToContainer)&&this._setDropPosition(s,n)},_setDropPosition:function(e,t){this.element.css({left:e,top:t}),this._area=this._layoutManager._$getArea(e,t),null!==this._area&&(this._lastValidArea=this._area,this._area.contentItem._$highlightDropZone(e,t,this._area))},_onDrop:function(){this._layoutManager.dropTargetIndicator.hide(),null!==this._area?this._area.contentItem._$onDrop(this._contentItem,this._area):null!==this._lastValidArea?this._lastValidArea.contentItem._$onDrop(this._contentItem,this._lastValidArea):this._originalParent?this._originalParent.addChild(this._contentItem):this._contentItem._$destroy(),this.element.remove(),this._layoutManager.emit("itemDropped",this._contentItem)},_updateTree:function(){this._contentItem.parent&&this._contentItem.parent.removeChild(this._contentItem,!0),this._contentItem._$setParent(this)},_setDimensions:function(){var e=this._layoutManager.config.dimensions,t=e.dragProxyWidth,i=e.dragProxyHeight;this.element.width(t),this.element.height(i),t-=this._sided?e.headerHeight:0,i-=this._sided?0:e.headerHeight,this.childElementContainer.width(t),this.childElementContainer.height(i),this._contentItem.element.width(t),this._contentItem.element.height(i),this._contentItem.callDownwards("_$show"),this._contentItem.callDownwards("setSize")}}),o.controls.DragSource=function(e,t,i){this._element=e,this._itemConfig=t,this._layoutManager=i,this._dragListener=null,this._createDragListener()},o.utils.copy(o.controls.DragSource.prototype,{_createDragListener:function(){null!==this._dragListener&&this._dragListener.destroy(),this._dragListener=new o.utils.DragListener(this._element),this._dragListener.on("dragStart",this._onDragStart,this),this._dragListener.on("dragStop",this._createDragListener,this)},_onDragStart:function(e,t){var i=this._itemConfig;o.utils.isFunction(i)&&(i=i());var s=this._layoutManager._$normalizeContentItem(n().extend(!0,{},i)),r=new o.controls.DragProxy(e,t,this._dragListener,this._layoutManager,s,null);this._layoutManager.transitionIndicator.transitionElements(this._element,r.element)}}),o.controls.DropTargetIndicator=function(){this.element=n()(o.controls.DropTargetIndicator._template),n()(document.body).append(this.element)},o.controls.DropTargetIndicator._template='<div class="lm_dropTargetIndicator"><div class="lm_inner"></div></div>',o.utils.copy(o.controls.DropTargetIndicator.prototype,{destroy:function(){this.element.remove()},highlight:function(e,t,i,s){this.highlightArea({x1:e,y1:t,x2:i,y2:s})},highlightArea:function(e){this.element.css({left:e.x1,top:e.y1,width:e.x2-e.x1,height:e.y2-e.y1}).show()},hide:function(){this.element.hide()}}),o.controls.Header=function(e,t){o.utils.EventEmitter.call(this),this.layoutManager=e,this.element=n()(o.controls.Header._template),!0===this.layoutManager.config.settings.selectionEnabled&&(this.element.addClass("lm_selectable"),this.element.on("click touchstart",o.utils.fnBind(this._onHeaderClick,this))),this.tabsContainer=this.element.find(".lm_tabs"),this.tabDropdownContainer=this.element.find(".lm_tabdropdown_list"),this.tabDropdownContainer.hide(),this.controlsContainer=this.element.find(".lm_controls"),this.parent=t,this.parent.on("resize",this._updateTabSizes,this),this.tabs=[],this.activeContentItem=null,this.closeButton=null,this.tabDropdownButton=null,n()(document).mouseup(o.utils.fnBind(this._hideAdditionalTabsDropdown,this)),this._lastVisibleTabIndex=-1,this._tabControlOffset=10,this._createControls()},o.controls.Header._template=['<div class="lm_header">','<ul class="lm_tabs"></ul>','<ul class="lm_controls"></ul>','<ul class="lm_tabdropdown_list"></ul>',"</div>"].join(""),o.utils.copy(o.controls.Header.prototype,{createTab:function(e,t){var i,s;for(s=0;s<this.tabs.length;s++)if(this.tabs[s].contentItem===e)return;if(i=new o.controls.Tab(this,e),0===this.tabs.length)return this.tabs.push(i),void this.tabsContainer.append(i.element);void 0===t&&(t=this.tabs.length),t>0?this.tabs[t-1].element.after(i.element):this.tabs[0].element.before(i.element),this.tabs.splice(t,0,i),this._updateTabSizes()},removeTab:function(e){for(var t=0;t<this.tabs.length;t++)if(this.tabs[t].contentItem===e)return this.tabs[t]._$destroy(),void this.tabs.splice(t,1);throw new Error("contentItem is not controlled by this header")},setActiveContentItem:function(e){var t,i,s,n;for(t=0;t<this.tabs.length;t++)s=this.tabs[t].contentItem===e,this.tabs[t].setActive(s),!0===s&&(this.activeContentItem=e,this.parent.config.activeItemIndex=t);if(-1!==this._lastVisibleTabIndex&&this.parent.config.activeItemIndex>this._lastVisibleTabIndex){for(n=this.tabs[this.parent.config.activeItemIndex],i=this.parent.config.activeItemIndex;i>0;i--)this.tabs[i]=this.tabs[i-1];this.tabs[0]=n,this.parent.config.activeItemIndex=0}this._updateTabSizes(),this.parent.emitBubblingEvent("stateChanged")},position:function(e){var t=this.parent._header.show;return t&&!this.parent._side&&(t="top"),void 0!==e&&this.parent._header.show!=e&&(this.parent._header.show=e,this.parent._setupHeaderPosition()),t},_$setClosable:function(e){return!(!this.closeButton||!this._isClosable()||(this.closeButton.element[e?"show":"hide"](),0))},_$destroy:function(){this.emit("destroy",this);for(var e=0;e<this.tabs.length;e++)this.tabs[e]._$destroy();this.element.remove()},_getHeaderSetting:function(e){if(e in this.parent._header)return this.parent._header[e]},_createControls:function(){var e,t,i,s,n,r,a,l,h;h=o.utils.fnBind(this._showAdditionalTabsDropdown,this),l=this.layoutManager.config.labels.tabDropdown,this.tabDropdownButton=new o.controls.HeaderButton(this,l,"lm_tabdropdown",h),this.tabDropdownButton.element.hide(),this._getHeaderSetting("popout")&&(t=o.utils.fnBind(this._onPopoutClick,this),i=this._getHeaderSetting("popout"),new o.controls.HeaderButton(this,i,"lm_popout",t)),this._getHeaderSetting("maximise")&&(r=o.utils.fnBind(this.parent.toggleMaximise,this.parent),s=this._getHeaderSetting("maximise"),n=this._getHeaderSetting("minimise"),a=new o.controls.HeaderButton(this,s,"lm_maximise",r),this.parent.on("maximised",(function(){a.element.attr("title",n)})),this.parent.on("minimised",(function(){a.element.attr("title",s)}))),this._isClosable()&&(e=o.utils.fnBind(this.parent.remove,this.parent),i=this._getHeaderSetting("close"),this.closeButton=new o.controls.HeaderButton(this,i,"lm_close",e))},_showAdditionalTabsDropdown:function(){this.tabDropdownContainer.show()},_hideAdditionalTabsDropdown:function(e){this.tabDropdownContainer.hide()},_isClosable:function(){return this.parent.config.isClosable&&this.layoutManager.config.settings.showCloseIcon},_onPopoutClick:function(){!0===this.layoutManager.config.settings.popoutWholeStack?this.parent.popout():this.activeContentItem.popout()},_onHeaderClick:function(e){e.target===this.element[0]&&this.parent.select()},_updateTabSizes:function(){if(0!==this.tabs.length){var e=function(e){return e?"width":"height"};this.element.css(e(!this.parent._sided),""),this.element[e(this.parent._sided)](this.layoutManager.config.dimensions.headerHeight);var t,i,s,n,r=this.element.outerWidth()-this.controlsContainer.outerWidth()-this._tabControlOffset,o=0,a=!1;for(this.parent._sided&&(r=this.element.outerHeight()-this.controlsContainer.outerHeight()-this._tabControlOffset),this._lastVisibleTabIndex=-1,i=0;i<this.tabs.length;i++)(n=(t=this.tabs[i].element).data("lastTabWidth"))||(n=t.outerWidth()+parseInt(t.css("margin-right"),10)),(o+=n)>r&&a?(t.data("lastTabWidth",n),this.tabDropdownContainer.append(t)):(a=!0,this._lastVisibleTabIndex=i,t.removeData("lastTabWidth"),this.tabsContainer.append(t));s=o>r,this.tabDropdownButton.element[s?"show":"hide"]()}}}),o.controls.HeaderButton=function(e,t,i,s){this._header=e,this.element=n()('<li class="'+i+'" title="'+t+'"></li>'),this._header.on("destroy",this._$destroy,this),this._action=s,this.element.on("click touchstart",this._action),this._header.controlsContainer.append(this.element)},o.utils.copy(o.controls.HeaderButton.prototype,{_$destroy:function(){this.element.off(),this.element.remove()}}),o.controls.Splitter=function(e,t){this._isVertical=e,this._size=t,this.element=this._createElement(),this._dragListener=new o.utils.DragListener(this.element)},o.utils.copy(o.controls.Splitter.prototype,{on:function(e,t,i){this._dragListener.on(e,t,i)},_$destroy:function(){this.element.remove()},_createElement:function(){var e=n()('<div class="lm_splitter"><div class="lm_drag_handle"></div></div>');return e.addClass("lm_"+(this._isVertical?"vertical":"horizontal")),e[this._isVertical?"height":"width"](this._size),e}}),o.controls.Tab=function(e,t){this.header=e,this.contentItem=t,this.element=n()(o.controls.Tab._template),this.titleElement=this.element.find(".lm_title"),this.closeElement=this.element.find(".lm_close_tab"),this.closeElement[t.config.isClosable?"show":"hide"](),this.isActive=!1,this.setTitle(t.config.title),this.contentItem.on("titleChanged",this.setTitle,this),this._layoutManager=this.contentItem.layoutManager,!0===this._layoutManager.config.settings.reorderEnabled&&!0===t.config.reorderEnabled&&(this._dragListener=new o.utils.DragListener(this.element),this._dragListener.on("dragStart",this._onDragStart,this)),this._onTabClickFn=o.utils.fnBind(this._onTabClick,this),this._onCloseClickFn=o.utils.fnBind(this._onCloseClick,this),this.element.on("mousedown touchstart",this._onTabClickFn),this.contentItem.config.isClosable?this.closeElement.on("click touchstart",this._onCloseClickFn):this.closeElement.remove(),this.contentItem.tab=this,this.contentItem.emit("tab",this),this.contentItem.layoutManager.emit("tabCreated",this),this.contentItem.isComponent&&(this.contentItem.container.tab=this,this.contentItem.container.emit("tab",this))},o.controls.Tab._template='<li class="lm_tab"><i class="lm_left"></i><span class="lm_title"></span><div class="lm_close_tab"></div><i class="lm_right"></i></li>',o.utils.copy(o.controls.Tab.prototype,{setTitle:function(e){this.element.attr("title",o.utils.stripTags(e)),this.titleElement.html(e)},setActive:function(e){e!==this.isActive&&(this.isActive=e,e?this.element.addClass("lm_active"):this.element.removeClass("lm_active"))},_$destroy:function(){this.element.off("mousedown touchstart",this._onTabClickFn),this.closeElement.off("click touchstart",this._onCloseClickFn),this._dragListener&&(this._dragListener.off("dragStart",this._onDragStart),this._dragListener=null),this.element.remove()},_onDragStart:function(e,t){!0===this.contentItem.parent.isMaximised&&this.contentItem.parent.toggleMaximise(),new o.controls.DragProxy(e,t,this._dragListener,this._layoutManager,this.contentItem,this.header.parent)},_onTabClick:function(e){if(0===e.button||"touchstart"===e.type){var t=this.header.parent.getActiveContentItem();this.contentItem!==t&&this.header.parent.setActiveContentItem(this.contentItem)}else 1===e.button&&this.contentItem.config.isClosable&&this._onCloseClick(e)},_onCloseClick:function(e){e.stopPropagation(),this.header.parent.removeChild(this.contentItem)}}),o.controls.TransitionIndicator=function(){this._element=n()('<div class="lm_transition_indicator"></div>'),n()(document.body).append(this._element),this._toElement=null,this._fromDimensions=null,this._totalAnimationDuration=200,this._animationStartTime=null},o.utils.copy(o.controls.TransitionIndicator.prototype,{destroy:function(){this._element.remove()},transitionElements:function(e,t){},_nextAnimationFrame:function(){var e,t=this._measure(this._toElement),i=(o.utils.now()-this._animationStartTime)/this._totalAnimationDuration,s={};if(i>=1)this._element.hide();else{for(e in t.opacity=0,this._fromDimensions)s[e]=this._fromDimensions[e]+(t[e]-this._fromDimensions[e])*i;this._element.css(s),o.utils.animFrame(o.utils.fnBind(this._nextAnimationFrame,this))}},_measure:function(e){var t=e.offset();return{left:t.left,top:t.top,width:e.outerWidth(),height:e.outerHeight()}}}),o.errors.ConfigurationError=function(e,t){Error.call(this),this.name="Configuration Error",this.message=e,this.node=t},o.errors.ConfigurationError.prototype=new Error,o.items.AbstractContentItem=function(e,t,i){o.utils.EventEmitter.call(this),this.config=this._extendItemNode(t),this.type=t.type,this.contentItems=[],this.parent=i,this.isInitialised=!1,this.isMaximised=!1,this.isRoot=!1,this.isRow=!1,this.isColumn=!1,this.isStack=!1,this.isComponent=!1,this.layoutManager=e,this._pendingEventPropagations={},this._throttledEvents=["stateChanged"],this.on(o.utils.EventEmitter.ALL_EVENT,this._propagateEvent,this),t.content&&this._createContentItems(t)},o.utils.copy(o.items.AbstractContentItem.prototype,{setSize:function(){throw new Error("Abstract Method")},callDownwards:function(e,t,i,s){var n;for(!0!==i&&!0!==s&&this[e].apply(this,t||[]),n=0;n<this.contentItems.length;n++)this.contentItems[n].callDownwards(e,t,i);!0===i&&!0!==s&&this[e].apply(this,t||[])},removeChild:function(e,t){var i=o.utils.indexOf(e,this.contentItems);if(-1===i)throw new Error("Can't remove child item. Unknown content item");!0!==t&&this.contentItems[i]._$destroy(),this.contentItems.splice(i,1),this.config.content.splice(i,1),this.contentItems.length>0?this.callDownwards("setSize"):this instanceof o.items.Root||!0!==this.config.isClosable||this.parent.removeChild(this)},addChild:function(e,t){void 0===t&&(t=this.contentItems.length),this.contentItems.splice(t,0,e),void 0===this.config.content&&(this.config.content=[]),this.config.content.splice(t,0,e.config),e.parent=this,!0===e.parent.isInitialised&&!1===e.isInitialised&&e._$init()},replaceChild:function(e,t,i){t=this.layoutManager._$normalizeContentItem(t);var s=o.utils.indexOf(e,this.contentItems),n=e.element[0].parentNode;if(-1===s)throw new Error("Can't replace child. oldChild is not child of this");n.replaceChild(t.element[0],e.element[0]),!0===i&&(e.parent=null,e._$destroy()),this.contentItems[s]=t,t.parent=this,this.isStack&&(this.header.tabs[s].contentItem=t),!0===t.parent.isInitialised&&!1===t.isInitialised&&t._$init(),this.callDownwards("setSize")},remove:function(){this.parent.removeChild(this)},popout:function(){var e=this.layoutManager.createPopout(this);return this.emitBubblingEvent("stateChanged"),e},toggleMaximise:function(e){e&&e.preventDefault(),!0===this.isMaximised?this.layoutManager._$minimiseItem(this):this.layoutManager._$maximiseItem(this),this.isMaximised=!this.isMaximised,this.emitBubblingEvent("stateChanged")},select:function(){this.layoutManager.selectedItem!==this&&(this.layoutManager.selectItem(this,!0),this.element.addClass("lm_selected"))},deselect:function(){this.layoutManager.selectedItem===this&&(this.layoutManager.selectedItem=null,this.element.removeClass("lm_selected"))},setTitle:function(e){this.config.title=e,this.emit("titleChanged",e),this.emit("stateChanged")},hasId:function(e){return!!this.config.id&&("string"==typeof this.config.id?this.config.id===e:this.config.id instanceof Array?-1!==o.utils.indexOf(e,this.config.id):void 0)},addId:function(e){this.hasId(e)||(this.config.id?"string"==typeof this.config.id?this.config.id=[this.config.id,e]:this.config.id instanceof Array&&this.config.id.push(e):this.config.id=e)},removeId:function(e){if(!this.hasId(e))throw new Error("Id not found");if("string"==typeof this.config.id)delete this.config.id;else if(this.config.id instanceof Array){var t=o.utils.indexOf(e,this.config.id);this.config.id.splice(t,1)}},getItemsByFilter:function(e){var t=[],i=function(s){for(var n=0;n<s.contentItems.length;n++)!0===e(s.contentItems[n])&&t.push(s.contentItems[n]),i(s.contentItems[n])};return i(this),t},getItemsById:function(e){return this.getItemsByFilter((function(t){return t.config.id instanceof Array?-1!==o.utils.indexOf(e,t.config.id):t.config.id===e}))},getItemsByType:function(e){return this._$getItemsByProperty("type",e)},getComponentsByName:function(e){var t,i=this._$getItemsByProperty("componentName",e),s=[];for(t=0;t<i.length;t++)s.push(i[t].instance);return s},_$getItemsByProperty:function(e,t){return this.getItemsByFilter((function(i){return i[e]===t}))},_$setParent:function(e){this.parent=e},_$highlightDropZone:function(e,t,i){this.layoutManager.dropTargetIndicator.highlightArea(i)},_$onDrop:function(e){this.addChild(e)},_$hide:function(){this._callOnActiveComponents("hide"),this.element.hide(),this.layoutManager.updateSize()},_$show:function(){this._callOnActiveComponents("show"),this.element.show(),this.layoutManager.updateSize()},_callOnActiveComponents:function(e){var t,i,s=this.getItemsByType("stack");for(i=0;i<s.length;i++)(t=s[i].getActiveContentItem())&&t.isComponent&&t.container[e]()},_$destroy:function(){this.emitBubblingEvent("beforeItemDestroyed"),this.callDownwards("_$destroy",[],!0,!0),this.element.remove(),this.emitBubblingEvent("itemDestroyed")},_$getArea:function(e){var t=(e=e||this.element).offset(),i=e.width(),s=e.height();return{x1:t.left,y1:t.top,x2:t.left+i,y2:t.top+s,surface:i*s,contentItem:this}},_$init:function(){var e;for(this.setSize(),e=0;e<this.contentItems.length;e++)this.childElementContainer.append(this.contentItems[e].element);this.isInitialised=!0,this.emitBubblingEvent("itemCreated"),this.emitBubblingEvent(this.type+"Created")},emitBubblingEvent:function(e){var t=new o.utils.BubblingEvent(e,this);this.emit(e,t)},_createContentItems:function(e){var t,i;if(!(e.content instanceof Array))throw new o.errors.ConfigurationError("content must be an Array",e);for(i=0;i<e.content.length;i++)t=this.layoutManager.createContentItem(e.content[i],this),this.contentItems.push(t)},_extendItemNode:function(e){for(var t in o.config.itemDefaultConfig)void 0===e[t]&&(e[t]=o.config.itemDefaultConfig[t]);return e},_propagateEvent:function(e,t){t instanceof o.utils.BubblingEvent&&!1===t.isPropagationStopped&&!0===this.isInitialised&&(!1===this.isRoot&&this.parent?this.parent.emit.apply(this.parent,Array.prototype.slice.call(arguments,0)):this._scheduleEventPropagationToLayoutManager(e,t))},_scheduleEventPropagationToLayoutManager:function(e,t){-1===o.utils.indexOf(e,this._throttledEvents)?this.layoutManager.emit(e,t.origin):!0!==this._pendingEventPropagations[e]&&(this._pendingEventPropagations[e]=!0,o.utils.animFrame(o.utils.fnBind(this._propagateEventToLayoutManager,this,[e,t])))},_propagateEventToLayoutManager:function(e,t){this._pendingEventPropagations[e]=!1,this.layoutManager.emit(e,t)}}),o.items.Component=function(e,t,i){o.items.AbstractContentItem.call(this,e,t,i);var s=e.getComponent(this.config.componentName),r=n().extend(!0,{},this.config.componentState||{});r.componentName=this.config.componentName,this.componentName=this.config.componentName,""===this.config.title&&(this.config.title=this.config.componentName),this.isComponent=!0,this.container=new o.container.ItemContainer(this.config,this,e),this.instance=new s(this.container,r),this.element=this.container._element},o.utils.extend(o.items.Component,o.items.AbstractContentItem),o.utils.copy(o.items.Component.prototype,{close:function(){this.parent.removeChild(this)},setSize:function(){this.element.is(":visible")&&this.container._$setSize(this.element.width(),this.element.height())},_$init:function(){o.items.AbstractContentItem.prototype._$init.call(this),this.container.emit("open")},_$hide:function(){this.container.hide(),o.items.AbstractContentItem.prototype._$hide.call(this)},_$show:function(){this.container.show(),o.items.AbstractContentItem.prototype._$show.call(this)},_$shown:function(){this.container.shown(),o.items.AbstractContentItem.prototype._$shown.call(this)},_$destroy:function(){this.container.emit("destroy",this),o.items.AbstractContentItem.prototype._$destroy.call(this)},_$getArea:function(){return null}}),o.items.Root=function(e,t,i){o.items.AbstractContentItem.call(this,e,t,null),this.isRoot=!0,this.type="root",this.element=n()('<div class="lm_goldenlayout lm_item lm_root"></div>'),this.childElementContainer=this.element,this._containerElement=i,this._containerElement.append(this.element)},o.utils.extend(o.items.Root,o.items.AbstractContentItem),o.utils.copy(o.items.Root.prototype,{addChild:function(e){if(this.contentItems.length>0)throw new Error("Root node can only have a single child");e=this.layoutManager._$normalizeContentItem(e,this),this.childElementContainer.append(e.element),o.items.AbstractContentItem.prototype.addChild.call(this,e),this.callDownwards("setSize"),this.emitBubblingEvent("stateChanged")},setSize:function(e,t){e=void 0===e?this._containerElement.width():e,t=void 0===t?this._containerElement.height():t,this.element.width(e),this.element.height(t),this.contentItems[0]&&(this.contentItems[0].element.width(e),this.contentItems[0].element.height(t))},_$highlightDropZone:function(e,t,i){this.layoutManager.tabDropPlaceholder.remove(),o.items.AbstractContentItem.prototype._$highlightDropZone.apply(this,arguments)},_$onDrop:function(e,t){var i;if(e.isComponent&&((i=this.layoutManager.createContentItem({type:"stack",header:e.config.header||{}},this))._$init(),i.addChild(e),e=i),this.contentItems.length){var s="x"==t.side[0]?"row":"column",n="x"==t.side[0]?"width":"height",r="2"==t.side[1],a=this.contentItems[0];if(!a instanceof o.items.RowOrColumn||a.type!=s){var l=this.layoutManager.createContentItem({type:s},this);this.replaceChild(a,l),l.addChild(e,r?0:void 0,!0),l.addChild(a,r?void 0:0,!0),a.config[n]=50,e.config[n]=50,l.callDownwards("setSize")}else{var h=a.contentItems[r?0:a.contentItems.length-1];a.addChild(e,r?0:void 0,!0),h.config[n]*=.5,e.config[n]=h.config[n],a.callDownwards("setSize")}}else this.addChild(e)}}),o.items.RowOrColumn=function(e,t,i,s){o.items.AbstractContentItem.call(this,t,i,s),this.isRow=!e,this.isColumn=e,this.element=n()('<div class="lm_item lm_'+(e?"column":"row")+'"></div>'),this.childElementContainer=this.element,this._splitterSize=t.config.dimensions.borderWidth,this._isColumn=e,this._dimension=e?"height":"width",this._splitter=[],this._splitterPosition=null,this._splitterMinPosition=null,this._splitterMaxPosition=null},o.utils.extend(o.items.RowOrColumn,o.items.AbstractContentItem),o.utils.copy(o.items.RowOrColumn.prototype,{addChild:function(e,t,i){var s,n,r,a;if(e=this.layoutManager._$normalizeContentItem(e,this),void 0===t&&(t=this.contentItems.length),this.contentItems.length>0?(a=this._createSplitter(Math.max(0,t-1)).element,t>0?(this.contentItems[t-1].element.after(a),a.after(e.element)):(this.contentItems[0].element.before(a),a.before(e.element))):this.childElementContainer.append(e.element),o.items.AbstractContentItem.prototype.addChild.call(this,e,t),s=1/this.contentItems.length*100,!0!==i){for(r=0;r<this.contentItems.length;r++)this.contentItems[r]===e?e.config[this._dimension]=s:(n=this.contentItems[r].config[this._dimension]*=(100-s)/100,this.contentItems[r].config[this._dimension]=n);this.callDownwards("setSize"),this.emitBubblingEvent("stateChanged")}else this.emitBubblingEvent("stateChanged")},removeChild:function(e,t){var i,s,n=e.config[this._dimension],r=o.utils.indexOf(e,this.contentItems),a=Math.max(r-1,0);if(-1===r)throw new Error("Can't remove child. ContentItem is not child of this Row or Column");for(this._splitter[a]&&(this._splitter[a]._$destroy(),this._splitter.splice(a,1)),i=0;i<this.contentItems.length;i++)this.contentItems[i]!==e&&(this.contentItems[i].config[this._dimension]+=n/(this.contentItems.length-1));o.items.AbstractContentItem.prototype.removeChild.call(this,e,t),1===this.contentItems.length&&!0===this.config.isClosable?(s=this.contentItems[0],this.contentItems=[],this.parent.replaceChild(this,s,!0)):(this.callDownwards("setSize"),this.emitBubblingEvent("stateChanged"))},replaceChild:function(e,t){var i=e.config[this._dimension];o.items.AbstractContentItem.prototype.replaceChild.call(this,e,t),t.config[this._dimension]=i,this.callDownwards("setSize"),this.emitBubblingEvent("stateChanged")},setSize:function(){this.contentItems.length>0&&(this._calculateRelativeSizes(),this._setAbsoluteSizes()),this.emitBubblingEvent("stateChanged"),this.emit("resize")},_$init:function(){var e;if(!0!==this.isInitialised)for(o.items.AbstractContentItem.prototype._$init.call(this),e=0;e<this.contentItems.length-1;e++)this.contentItems[e].element.after(this._createSplitter(e).element)},_setAbsoluteSizes:function(){var e=0,t=this._calculateAbsoluteSizes();for(e=0;e<this.contentItems.length;e++)t.additionalPixel-e>0&&t.itemSizes[e]++,this._isColumn?(this.contentItems[e].element.width(t.totalWidth),this.contentItems[e].element.height(t.itemSizes[e])):(this.contentItems[e].element.width(t.itemSizes[e]),this.contentItems[e].element.height(t.totalHeight))},_calculateAbsoluteSizes:function(){var e=null,t=(this.contentItems.length-1)*this._splitterSize,i=this.element.width(),s=this.element.height(),n=0,r=null,o=[];for(this._isColumn?s-=t:i-=t,e=0;e<this.contentItems.length;e++)n+=r=this._isColumn?Math.floor(s*(this.contentItems[e].config.height/100)):Math.floor(i*(this.contentItems[e].config.width/100)),o.push(r);return{itemSizes:o,additionalPixel:Math.floor((this._isColumn?s:i)-n),totalWidth:i,totalHeight:s}},_calculateRelativeSizes:function(){var e,t=0,i=[],s=this._isColumn?"height":"width";for(e=0;e<this.contentItems.length;e++)void 0!==this.contentItems[e].config[s]?t+=this.contentItems[e].config[s]:i.push(this.contentItems[e]);if(100!==Math.round(t))if(Math.round(t)<100&&i.length>0){for(e=0;e<i.length;e++)i[e].config[s]=(100-t)/i.length;this._respectMinItemWidth()}else{if(Math.round(t)>100)for(e=0;e<i.length;e++)i[e].config[s]=50,t+=50;for(e=0;e<this.contentItems.length;e++)this.contentItems[e].config[s]=this.contentItems[e].config[s]/t*100;this._respectMinItemWidth()}else this._respectMinItemWidth()},_respectMinItemWidth:function(){var e,t,i,s,n=this.layoutManager.config.dimensions&&this.layoutManager.config.dimensions.minItemWidth||0,r=[],o=0,a=0,l=0,h=0,c=[];if(!(this._isColumn||!n||this.contentItems.length<=1)){e=this._calculateAbsoluteSizes();for(var d=0;d<this.contentItems.length;d++)this.contentItems[d],(h=e.itemSizes[d])<n?(a+=n-h,s={width:n}):(o+=h-n,s={width:h},r.push(s)),c.push(s);if(!(0===a||a>o)){for(t=a/o,l=a,d=0;d<r.length;d++)s=r[d],l-=i=Math.round((s.width-n)*t),s.width-=i;for(0!==l&&(c[c.length-1].width-=l),d=0;d<this.contentItems.length;d++)this.contentItems[d].config.width=c[d].width/e.totalWidth*100}}},_createSplitter:function(e){var t;return(t=new o.controls.Splitter(this._isColumn,this._splitterSize)).on("drag",o.utils.fnBind(this._onSplitterDrag,this,[t]),this),t.on("dragStop",o.utils.fnBind(this._onSplitterDragStop,this,[t]),this),t.on("dragStart",o.utils.fnBind(this._onSplitterDragStart,this,[t]),this),this._splitter.splice(e,0,t),t},_getItemsForSplitter:function(e){var t=o.utils.indexOf(e,this._splitter);return{before:this.contentItems[t],after:this.contentItems[t+1]}},_getMinimumDimensions:function(e){for(var t=0,i=0,s=0;s<e.length;++s)t=Math.max(e[s].minWidth||0,t),i=Math.max(e[s].minHeight||0,i);return{horizontal:t,vertical:i}},_onSplitterDragStart:function(e){var t=this._getItemsForSplitter(e),i=this.layoutManager.config.dimensions[this._isColumn?"minItemHeight":"minItemWidth"],s=this._getMinimumDimensions(t.before.config.content),n=this._isColumn?s.vertical:s.horizontal,r=this._getMinimumDimensions(t.after.config.content),o=this._isColumn?r.vertical:r.horizontal;this._splitterPosition=0,this._splitterMinPosition=-1*(t.before.element[this._dimension]()-(n||i)),this._splitterMaxPosition=t.after.element[this._dimension]()-(o||i)},_onSplitterDrag:function(e,t,i){var s=this._isColumn?i:t;s>this._splitterMinPosition&&s<this._splitterMaxPosition&&(this._splitterPosition=s,e.element.css(this._isColumn?"top":"left",s))},_onSplitterDragStop:function(e){var t=this._getItemsForSplitter(e),i=t.before.element[this._dimension](),s=t.after.element[this._dimension](),n=(this._splitterPosition+i)/(i+s),r=t.before.config[this._dimension]+t.after.config[this._dimension];t.before.config[this._dimension]=n*r,t.after.config[this._dimension]=(1-n)*r,e.element.css({top:0,left:0}),o.utils.animFrame(o.utils.fnBind(this.callDownwards,this,["setSize"]))}}),o.items.Stack=function(e,t,i){o.items.AbstractContentItem.call(this,e,t,i),this.element=n()('<div class="lm_item lm_stack"></div>'),this._activeContentItem=null;var s=e.config;this._header={show:!0===s.settings.hasHeaders&&!1!==t.hasHeaders,popout:s.settings.showPopoutIcon&&s.labels.popout,maximise:s.settings.showMaximiseIcon&&s.labels.maximise,close:s.settings.showCloseIcon&&s.labels.close,minimise:s.labels.minimise},s.header&&o.utils.copy(this._header,s.header),t.header&&o.utils.copy(this._header,t.header),t.content&&t.content[0]&&t.content[0].header&&o.utils.copy(this._header,t.content[0].header),this._dropZones={},this._dropSegment=null,this._contentAreaDimensions=null,this._dropIndex=null,this.isStack=!0,this.childElementContainer=n()('<div class="lm_items"></div>'),this.header=new o.controls.Header(e,this),this.element.append(this.header.element),this.element.append(this.childElementContainer),this._setupHeaderPosition(),this._$validateClosability()},o.utils.extend(o.items.Stack,o.items.AbstractContentItem),o.utils.copy(o.items.Stack.prototype,{setSize:function(){var e,t=this._header.show?this.layoutManager.config.dimensions.headerHeight:0,i=this.element.width()-(this._sided?t:0),s=this.element.height()-(this._sided?0:t);for(this.childElementContainer.width(i),this.childElementContainer.height(s),e=0;e<this.contentItems.length;e++)this.contentItems[e].element.width(i).height(s);this.emit("resize"),this.emitBubblingEvent("stateChanged")},_$init:function(){var e,t;if(!0!==this.isInitialised){for(o.items.AbstractContentItem.prototype._$init.call(this),e=0;e<this.contentItems.length;e++)this.header.createTab(this.contentItems[e]),this.contentItems[e]._$hide();if(this.contentItems.length>0){if(!(t=this.contentItems[this.config.activeItemIndex||0]))throw new Error("Configured activeItemIndex out of bounds");this.setActiveContentItem(t)}}},setActiveContentItem:function(e){if(-1===o.utils.indexOf(e,this.contentItems))throw new Error("contentItem is not a child of this stack");null!==this._activeContentItem&&this._activeContentItem._$hide(),this._activeContentItem=e,this.header.setActiveContentItem(e),e._$show(),this.emit("activeContentItemChanged",e),this.emitBubblingEvent("stateChanged")},getActiveContentItem:function(){return this.header.activeContentItem},addChild:function(e,t){e=this.layoutManager._$normalizeContentItem(e,this),o.items.AbstractContentItem.prototype.addChild.call(this,e,t),this.childElementContainer.append(e.element),this.header.createTab(e,t),this.setActiveContentItem(e),this.callDownwards("setSize"),this._$validateClosability(),this.emitBubblingEvent("stateChanged")},removeChild:function(e,t){var i=o.utils.indexOf(e,this.contentItems);o.items.AbstractContentItem.prototype.removeChild.call(this,e,t),this.header.removeTab(e),this.contentItems.length>0?this.setActiveContentItem(this.contentItems[Math.max(i-1,0)]):this._activeContentItem=null,this._$validateClosability(),this.emitBubblingEvent("stateChanged")},_$validateClosability:function(){var e,t,i;for(e=this.header._isClosable(),i=0,t=this.contentItems.length;i<t&&e;i++)e=this.contentItems[i].config.isClosable;this.header._$setClosable(e)},_$destroy:function(){o.items.AbstractContentItem.prototype._$destroy.call(this),this.header._$destroy()},_$onDrop:function(e){if("header"===this._dropSegment)return this._resetHeaderDropZone(),void this.addChild(e,this._dropIndex);if("body"!==this._dropSegment){var t,i,s,n="top"===this._dropSegment||"bottom"===this._dropSegment,r="left"===this._dropSegment||"right"===this._dropSegment,a="top"===this._dropSegment||"left"===this._dropSegment,l=n&&this.parent.isColumn||r&&this.parent.isRow,h=n?"column":"row",c=n?"height":"width";e.isComponent&&((i=this.layoutManager.createContentItem({type:"stack",header:e.config.header||{}},this))._$init(),i.addChild(e),e=i),l?(t=o.utils.indexOf(this,this.parent.contentItems),this.parent.addChild(e,a?t:t+1,!0),this.config[c]*=.5,e.config[c]=this.config[c],this.parent.callDownwards("setSize")):(h=n?"column":"row",s=this.layoutManager.createContentItem({type:h},this),this.parent.replaceChild(this,s),s.addChild(e,a?0:void 0,!0),s.addChild(this,a?void 0:0,!0),this.config[c]=50,e.config[c]=50,s.callDownwards("setSize"))}else this.addChild(e)},_$highlightDropZone:function(e,t){var i,s;for(i in this._contentAreaDimensions)if((s=this._contentAreaDimensions[i].hoverArea).x1<e&&s.x2>e&&s.y1<t&&s.y2>t)return void("header"===i?(this._dropSegment="header",this._highlightHeaderDropZone(this._sided?t:e)):(this._resetHeaderDropZone(),this._highlightBodyDropZone(i)))},_$getArea:function(){if(!1===this.element.is(":visible"))return null;var e=o.items.AbstractContentItem.prototype._$getArea,t=e.call(this,this.header.element),i=e.call(this,this.childElementContainer),s=i.x2-i.x1,n=i.y2-i.y1;return this._contentAreaDimensions={header:{hoverArea:{x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2},highlightArea:{x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2}}},this._activeContentItem&&!1===this._activeContentItem.isComponent?t:0===this.contentItems.length?(this._contentAreaDimensions.body={hoverArea:{x1:i.x1,y1:i.y1,x2:i.x2,y2:i.y2},highlightArea:{x1:i.x1,y1:i.y1,x2:i.x2,y2:i.y2}},e.call(this,this.element)):(this._contentAreaDimensions.left={hoverArea:{x1:i.x1,y1:i.y1,x2:i.x1+.25*s,y2:i.y2},highlightArea:{x1:i.x1,y1:i.y1,x2:i.x1+.5*s,y2:i.y2}},this._contentAreaDimensions.top={hoverArea:{x1:i.x1+.25*s,y1:i.y1,x2:i.x1+.75*s,y2:i.y1+.5*n},highlightArea:{x1:i.x1,y1:i.y1,x2:i.x2,y2:i.y1+.5*n}},this._contentAreaDimensions.right={hoverArea:{x1:i.x1+.75*s,y1:i.y1,x2:i.x2,y2:i.y2},highlightArea:{x1:i.x1+.5*s,y1:i.y1,x2:i.x2,y2:i.y2}},this._contentAreaDimensions.bottom={hoverArea:{x1:i.x1+.25*s,y1:i.y1+.5*n,x2:i.x1+.75*s,y2:i.y2},highlightArea:{x1:i.x1,y1:i.y1+.5*n,x2:i.x2,y2:i.y2}},e.call(this,this.element))},_highlightHeaderDropZone:function(e){var t,i,s,n,r,o,a,l,h=this.header.tabs.length,c=!1;if(0===h)return a=this.header.element.offset(),void this.layoutManager.dropTargetIndicator.highlightArea({x1:a.left,x2:a.left+100,y1:a.top+this.header.element.height()-20,y2:a.top+this.header.element.height()});for(t=0;t<h;t++)if(r=(i=this.header.tabs[t].element).offset(),this._sided?(n=r.top,s=r.left,l=i.height()):(n=r.left,s=r.top,l=i.width()),e>n&&e<n+l){c=!0;break}if(!(!1===c&&e<n)){if(e<n+l/2?(this._dropIndex=t,i.before(this.layoutManager.tabDropPlaceholder)):(this._dropIndex=Math.min(t+1,h),i.after(this.layoutManager.tabDropPlaceholder)),this._sided)return placeHolderTop=this.layoutManager.tabDropPlaceholder.offset().top,void this.layoutManager.dropTargetIndicator.highlightArea({x1:s,x2:s+i.innerHeight(),y1:placeHolderTop,y2:placeHolderTop+this.layoutManager.tabDropPlaceholder.width()});o=this.layoutManager.tabDropPlaceholder.offset().left,this.layoutManager.dropTargetIndicator.highlightArea({x1:o,x2:o+this.layoutManager.tabDropPlaceholder.width(),y1:s,y2:s+i.innerHeight()})}},_resetHeaderDropZone:function(){this.layoutManager.tabDropPlaceholder.remove()},_setupHeaderPosition:function(){var e=["right","left","bottom"].indexOf(this._header.show)>=0&&this._header.show;if(this.header.element.toggle(!!this._header.show),this._side=e,this._sided=["right","left"].indexOf(this._side)>=0,this.element.removeClass("lm_left lm_right lm_bottom"),this._side&&this.element.addClass("lm_"+this._side),this.element.find(".lm_header").length&&this.childElementContainer){var t=["right","bottom"].indexOf(this._side)>=0?"before":"after";this.header.element[t](this.childElementContainer),this.callDownwards("setSize")}},_highlightBodyDropZone:function(e){var t=this._contentAreaDimensions[e].highlightArea;this.layoutManager.dropTargetIndicator.highlightArea(t),this._dropSegment=e}}),o.utils.BubblingEvent=function(e,t){this.name=e,this.origin=t,this.isPropagationStopped=!1},o.utils.BubblingEvent.prototype.stopPropagation=function(){this.isPropagationStopped=!0},o.utils.ConfigMinifier=function(){this._keys=["settings","hasHeaders","constrainDragToContainer","selectionEnabled","dimensions","borderWidth","minItemHeight","minItemWidth","headerHeight","dragProxyWidth","dragProxyHeight","labels","close","maximise","minimise","popout","content","componentName","componentState","id","width","type","height","isClosable","title","popoutWholeStack","openPopouts","parentId","activeItemIndex","reorderEnabled"],this._values=[!0,!1,"row","column","stack","component","close","maximise","minimise","open in new window"]},o.utils.copy(o.utils.ConfigMinifier.prototype,{minifyConfig:function(e){var t={};return this._nextLevel(e,t,"_min"),t},unminifyConfig:function(e){var t={};return this._nextLevel(e,t,"_max"),t},_nextLevel:function(e,t,i){var s,n;for(s in e)e instanceof Array&&(s=parseInt(s,10)),e.hasOwnProperty(s)&&(n=this[i](s,this._keys),"object"===r(e[s])?(t[n]=e[s]instanceof Array?[]:{},this._nextLevel(e[s],t[n],i)):t[n]=this[i](e[s],this._values))},_min:function(e,t){if("string"==typeof e&&1===e.length)return"___"+e;var i=o.utils.indexOf(e,t);return-1===i?e:i.toString(36)},_max:function(e,t){return"string"==typeof e&&1===e.length?t[parseInt(e,36)]:"string"==typeof e&&"___"===e.substr(0,3)?e[3]:e}}),o.utils.EventHub=function(e){o.utils.EventEmitter.call(this),this._layoutManager=e,this._dontPropagateToParent=null,this._childEventSource=null,this.on(o.utils.EventEmitter.ALL_EVENT,o.utils.fnBind(this._onEventFromThis,this)),this._boundOnEventFromChild=o.utils.fnBind(this._onEventFromChild,this),n()(window).on("gl_child_event",this._boundOnEventFromChild)},o.utils.EventHub.prototype._onEventFromThis=function(){var e=Array.prototype.slice.call(arguments);this._layoutManager.isSubWindow&&e[0]!==this._dontPropagateToParent&&this._propagateToParent(e),this._propagateToChildren(e),this._dontPropagateToParent=null,this._childEventSource=null},o.utils.EventHub.prototype._$onEventFromParent=function(e){this._dontPropagateToParent=e[0],this.emit.apply(this,e)},o.utils.EventHub.prototype._onEventFromChild=function(e){this._childEventSource=e.originalEvent.__gl,this.emit.apply(this,e.originalEvent.__glArgs)},o.utils.EventHub.prototype._propagateToParent=function(e){var t,i="gl_child_event";document.createEvent?(t=window.opener.document.createEvent("HTMLEvents")).initEvent(i,!0,!0):(t=window.opener.document.createEventObject()).eventType=i,t.eventName=i,t.__glArgs=e,t.__gl=this._layoutManager,document.createEvent?window.opener.dispatchEvent(t):window.opener.fireEvent("on"+t.eventType,t)},o.utils.EventHub.prototype._propagateToChildren=function(e){var t,i;for(i=0;i<this._layoutManager.openPopouts.length;i++)(t=this._layoutManager.openPopouts[i].getGlInstance())&&t!==this._childEventSource&&t.eventHub._$onEventFromParent(e)},o.utils.EventHub.prototype.destroy=function(){n()(window).off("gl_child_event",this._boundOnEventFromChild)},o.utils.ReactComponentHandler=function(e,t){this._reactComponent=null,this._originalComponentWillUpdate=null,this._container=e,this._initialState=t,this._reactClass=this._getReactClass(),this._container.on("open",this._render,this),this._container.on("destroy",this._destroy,this)},o.utils.copy(o.utils.ReactComponentHandler.prototype,{_render:function(){this._reactComponent=ReactDOM.render(this._getReactComponent(),this._container.getElement()[0]),this._originalComponentWillUpdate=this._reactComponent.componentWillUpdate||function(){},this._reactComponent.componentWillUpdate=this._onUpdate.bind(this),this._container.getState()&&this._reactComponent.setState(this._container.getState())},_destroy:function(){ReactDOM.unmountComponentAtNode(this._container.getElement()[0]),this._container.off("open",this._render,this),this._container.off("destroy",this._destroy,this)},_onUpdate:function(e,t){this._container.setState(t),this._originalComponentWillUpdate.call(this._reactComponent,e,t)},_getReactClass:function(){var e,t=this._container._config.component;if(!t)throw new Error("No react component name. type: react-component needs a field `component`");if(!(e=this._container.layoutManager.getComponent(t)))throw new Error('React component "'+t+'" not found. Please register all components with GoldenLayout using `registerComponent(name, component)`');return e},_getReactComponent:function(){var e={glEventHub:this._container.layoutManager.eventHub,glContainer:this._container},t=n().extend(e,this._container._config.props);return React.createElement(this._reactClass,t)}});var a=o.LayoutManager},744:function(e,t,i){e.exports=function(){"use strict";var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)},t=function(){return(t=Object.assign||function(e){for(var t,i=1,s=arguments.length;i<s;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};function s(e,t,i){if(i||2===arguments.length)for(var s,n=0,r=t.length;n<r;n++)!s&&n in t||((s=s||Array.prototype.slice.call(t,0,n))[n]=t[n]);return e.concat(s||Array.prototype.slice.call(t))}var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:i.g,r=Object.keys,o=Array.isArray;function a(e,t){return"object"!=typeof t||r(t).forEach((function(i){e[i]=t[i]})),e}"undefined"==typeof Promise||n.Promise||(n.Promise=Promise);var l=Object.getPrototypeOf,h={}.hasOwnProperty;function c(e,t){return h.call(e,t)}function d(e,t){"function"==typeof t&&(t=t(l(e))),("undefined"==typeof Reflect?r:Reflect.ownKeys)(t).forEach((function(i){p(e,i,t[i])}))}var u=Object.defineProperty;function p(e,t,i,s){u(e,t,a(i&&c(i,"get")&&"function"==typeof i.get?{get:i.get,set:i.set,configurable:!0}:{value:i,configurable:!0,writable:!0},s))}function m(e){return{from:function(t){return e.prototype=Object.create(t.prototype),p(e.prototype,"constructor",e),{extend:d.bind(null,e.prototype)}}}}var f=Object.getOwnPropertyDescriptor,g=[].slice;function _(e,t,i){return g.call(e,t,i)}function v(e,t){return t(e)}function b(e){if(!e)throw new Error("Assertion Failed")}function y(e){n.setImmediate?setImmediate(e):setTimeout(e,0)}function C(e,t){if("string"==typeof t&&c(e,t))return e[t];if(!t)return e;if("string"!=typeof t){for(var i=[],s=0,n=t.length;s<n;++s){var r=C(e,t[s]);i.push(r)}return i}var o=t.indexOf(".");if(-1!==o){var a=e[t.substr(0,o)];return null==a?void 0:C(a,t.substr(o+1))}}function w(e,t,i){if(e&&void 0!==t&&(!("isFrozen"in Object)||!Object.isFrozen(e)))if("string"!=typeof t&&"length"in t){b("string"!=typeof i&&"length"in i);for(var s=0,n=t.length;s<n;++s)w(e,t[s],i[s])}else{var r,a,l=t.indexOf(".");-1!==l?(r=t.substr(0,l),""===(a=t.substr(l+1))?void 0===i?o(e)&&!isNaN(parseInt(r))?e.splice(r,1):delete e[r]:e[r]=i:w(l=(l=e[r])&&c(e,r)?l:e[r]={},a,i)):void 0===i?o(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=i}}function S(e){var t,i={};for(t in e)c(e,t)&&(i[t]=e[t]);return i}var E=[].concat;function x(e){return E.apply([],e)}var T="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(x([8,16,32,64].map((function(e){return["Int","Uint","Float"].map((function(t){return t+e+"Array"}))})))).filter((function(e){return n[e]})),O=new Set(T.map((function(e){return n[e]}))),k=null;function I(e){return k=new WeakMap,e=function e(t){if(!t||"object"!=typeof t)return t;var i=k.get(t);if(i)return i;if(o(t)){i=[],k.set(t,i);for(var s=0,n=t.length;s<n;++s)i.push(e(t[s]))}else if(O.has(t.constructor))i=t;else{var r,a=l(t);for(r in i=a===Object.prototype?{}:Object.create(a),k.set(t,i),t)c(t,r)&&(i[r]=e(t[r]))}return i}(e),k=null,e}var A={}.toString;function D(e){return A.call(e).slice(8,-1)}var R="undefined"!=typeof Symbol?Symbol.iterator:"@@iterator",P="symbol"==typeof R?function(e){var t;return null!=e&&(t=e[R])&&t.apply(e)}:function(){return null};function L(e,t){return 0<=(t=e.indexOf(t))&&e.splice(t,1),0<=t}var M={};function N(e){var t,i,s,n;if(1===arguments.length){if(o(e))return e.slice();if(this===M&&"string"==typeof e)return[e];if(n=P(e)){for(i=[];!(s=n.next()).done;)i.push(s.value);return i}if(null==e)return[e];if("number"!=typeof(t=e.length))return[e];for(i=new Array(t);t--;)i[t]=e[t];return i}for(t=arguments.length,i=new Array(t);t--;)i[t]=arguments[t];return i}var F="undefined"!=typeof Symbol?function(e){return"AsyncFunction"===e[Symbol.toStringTag]}:function(){return!1},B=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(ae=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"]),H={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function z(e,t){this.name=e,this.message=t}function $(e,t){return e+". Errors: "+Object.keys(t).map((function(e){return t[e].toString()})).filter((function(e,t,i){return i.indexOf(e)===t})).join("\n")}function V(e,t,i,s){this.failures=t,this.failedKeys=s,this.successCount=i,this.message=$(e,t)}function W(e,t){this.name="BulkError",this.failures=Object.keys(t).map((function(e){return t[e]})),this.failuresByPos=t,this.message=$(e,this.failures)}m(z).from(Error).extend({toString:function(){return this.name+": "+this.message}}),m(V).from(z),m(W).from(z);var U=B.reduce((function(e,t){return e[t]=t+"Error",e}),{}),j=z,G=B.reduce((function(e,t){var i=t+"Error";function s(e,s){this.name=i,e?"string"==typeof e?(this.message="".concat(e).concat(s?"\n "+s:""),this.inner=s||null):"object"==typeof e&&(this.message="".concat(e.name," ").concat(e.message),this.inner=e):(this.message=H[t]||i,this.inner=null)}return m(s).from(j),e[t]=s,e}),{});G.Syntax=SyntaxError,G.Type=TypeError,G.Range=RangeError;var q=ae.reduce((function(e,t){return e[t+"Error"]=G[t],e}),{}),K=B.reduce((function(e,t){return-1===["Syntax","Type","Range"].indexOf(t)&&(e[t+"Error"]=G[t]),e}),{});function Y(){}function X(e){return e}function Z(e,t){return null==e||e===X?t:function(i){return t(e(i))}}function Q(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function J(e,t){return e===Y?t:function(){var i=e.apply(this,arguments);void 0!==i&&(arguments[0]=i);var s=this.onsuccess,n=this.onerror;this.onsuccess=null,this.onerror=null;var r=t.apply(this,arguments);return s&&(this.onsuccess=this.onsuccess?Q(s,this.onsuccess):s),n&&(this.onerror=this.onerror?Q(n,this.onerror):n),void 0!==r?r:i}}function ee(e,t){return e===Y?t:function(){e.apply(this,arguments);var i=this.onsuccess,s=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),i&&(this.onsuccess=this.onsuccess?Q(i,this.onsuccess):i),s&&(this.onerror=this.onerror?Q(s,this.onerror):s)}}function te(e,t){return e===Y?t:function(i){var s=e.apply(this,arguments);a(i,s);var n=this.onsuccess,r=this.onerror;return this.onsuccess=null,this.onerror=null,i=t.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?Q(n,this.onsuccess):n),r&&(this.onerror=this.onerror?Q(r,this.onerror):r),void 0===s?void 0===i?void 0:i:a(s,i)}}function ie(e,t){return e===Y?t:function(){return!1!==t.apply(this,arguments)&&e.apply(this,arguments)}}function se(e,t){return e===Y?t:function(){var i=e.apply(this,arguments);if(i&&"function"==typeof i.then){for(var s=this,n=arguments.length,r=new Array(n);n--;)r[n]=arguments[n];return i.then((function(){return t.apply(s,r)}))}return t.apply(this,arguments)}}K.ModifyError=V,K.DexieError=z,K.BulkError=W;var ne="undefined"!=typeof location&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function re(e){ne=e}var oe={},ae=(T="undefined"==typeof Promise?[]:function(){var e=Promise.resolve();if("undefined"==typeof crypto||!crypto.subtle)return[e,l(e),e];var t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,l(t),e]}(),T[0]),le=(B=T[1],T=T[2],B=B&&B.then,ae&&ae.constructor),he=!!T,ce=function(e,t){ve.push([e,t]),ue&&(queueMicrotask(ke),ue=!1)},de=!0,ue=!0,pe=[],me=[],fe=X,ge={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:Y,pgp:!1,env:{},finalize:Y},_e=ge,ve=[],be=0,ye=[];function Ce(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var t=this._PSD=_e;if("function"!=typeof e){if(e!==oe)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(!1===this._state&&Ee(this,this._value))}this._state=null,this._value=null,++t.ref,function e(t,i){try{i((function(i){if(null===t._state){if(i===t)throw new TypeError("A promise cannot be resolved with itself.");var s=t._lib&&Ie();i&&"function"==typeof i.then?e(t,(function(e,t){i instanceof Ce?i._then(e,t):i.then(e,t)})):(t._state=!0,t._value=i,xe(t)),s&&Ae()}}),Ee.bind(null,t))}catch(i){Ee(t,i)}}(this,e)}var we={get:function(){var e=_e,t=Be;function i(i,s){var n=this,r=!e.global&&(e!==_e||t!==Be),o=r&&!Ve(),a=new Ce((function(t,a){Te(n,new Se(Ke(i,e,r,o),Ke(s,e,r,o),t,a,e))}));return this._consoleTask&&(a._consoleTask=this._consoleTask),a}return i.prototype=oe,i},set:function(e){p(this,"then",e&&e.prototype===oe?we:{get:function(){return e},set:we.set})}};function Se(e,t,i,s,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.resolve=i,this.reject=s,this.psd=n}function Ee(e,t){var i,s;me.push(t),null===e._state&&(i=e._lib&&Ie(),t=fe(t),e._state=!1,e._value=t,s=e,pe.some((function(e){return e._value===s._value}))||pe.push(s),xe(e),i&&Ae())}function xe(e){var t=e._listeners;e._listeners=[];for(var i=0,s=t.length;i<s;++i)Te(e,t[i]);var n=e._PSD;--n.ref||n.finalize(),0===be&&(++be,ce((function(){0==--be&&De()}),[]))}function Te(e,t){if(null!==e._state){var i=e._state?t.onFulfilled:t.onRejected;if(null===i)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++be,ce(Oe,[i,e,t])}else e._listeners.push(t)}function Oe(e,t,i){try{var s,n=t._value;!t._state&&me.length&&(me=[]),s=ne&&t._consoleTask?t._consoleTask.run((function(){return e(n)})):e(n),t._state||-1!==me.indexOf(n)||function(e){for(var t=pe.length;t;)if(pe[--t]._value===e._value)return pe.splice(t,1)}(t),i.resolve(s)}catch(e){i.reject(e)}finally{0==--be&&De(),--i.psd.ref||i.psd.finalize()}}function ke(){qe(ge,(function(){Ie()&&Ae()}))}function Ie(){var e=de;return ue=de=!1,e}function Ae(){var e,t,i;do{for(;0<ve.length;)for(e=ve,ve=[],i=e.length,t=0;t<i;++t){var s=e[t];s[0].apply(null,s[1])}}while(0<ve.length);ue=de=!0}function De(){var e=pe;pe=[],e.forEach((function(e){e._PSD.onunhandled.call(null,e._value,e)}));for(var t=ye.slice(0),i=t.length;i;)t[--i]()}function Re(e){return new Ce(oe,!1,e)}function Pe(e,t){var i=_e;return function(){var s=Ie(),n=_e;try{return je(i,!0),e.apply(this,arguments)}catch(s){t&&t(s)}finally{je(n,!1),s&&Ae()}}}d(Ce.prototype,{then:we,_then:function(e,t){Te(this,new Se(null,null,e,t,_e))},catch:function(e){if(1===arguments.length)return this.then(null,e);var t=e,i=arguments[1];return"function"==typeof t?this.then(null,(function(e){return(e instanceof t?i:Re)(e)})):this.then(null,(function(e){return(e&&e.name===t?i:Re)(e)}))},finally:function(e){return this.then((function(t){return Ce.resolve(e()).then((function(){return t}))}),(function(t){return Ce.resolve(e()).then((function(){return Re(t)}))}))},timeout:function(e,t){var i=this;return e<1/0?new Ce((function(s,n){var r=setTimeout((function(){return n(new G.Timeout(t))}),e);i.then(s,n).finally(clearTimeout.bind(null,r))})):this}}),"undefined"!=typeof Symbol&&Symbol.toStringTag&&p(Ce.prototype,Symbol.toStringTag,"Dexie.Promise"),ge.env=Ge(),d(Ce,{all:function(){var e=N.apply(null,arguments).map(We);return new Ce((function(t,i){0===e.length&&t([]);var s=e.length;e.forEach((function(n,r){return Ce.resolve(n).then((function(i){e[r]=i,--s||t(e)}),i)}))}))},resolve:function(e){return e instanceof Ce?e:e&&"function"==typeof e.then?new Ce((function(t,i){e.then(t,i)})):new Ce(oe,!0,e)},reject:Re,race:function(){var e=N.apply(null,arguments).map(We);return new Ce((function(t,i){e.map((function(e){return Ce.resolve(e).then(t,i)}))}))},PSD:{get:function(){return _e},set:function(e){return _e=e}},totalEchoes:{get:function(){return Be}},newPSD:ze,usePSD:qe,scheduler:{get:function(){return ce},set:function(e){ce=e}},rejectionMapper:{get:function(){return fe},set:function(e){fe=e}},follow:function(e,t){return new Ce((function(i,s){return ze((function(t,i){var s=_e;s.unhandleds=[],s.onunhandled=i,s.finalize=Q((function(){var e,s=this;e=function(){0===s.unhandleds.length?t():i(s.unhandleds[0])},ye.push((function t(){e(),ye.splice(ye.indexOf(t),1)})),++be,ce((function(){0==--be&&De()}),[])}),s.finalize),e()}),t,i,s)}))}}),le&&(le.allSettled&&p(Ce,"allSettled",(function(){var e=N.apply(null,arguments).map(We);return new Ce((function(t){0===e.length&&t([]);var i=e.length,s=new Array(i);e.forEach((function(e,n){return Ce.resolve(e).then((function(e){return s[n]={status:"fulfilled",value:e}}),(function(e){return s[n]={status:"rejected",reason:e}})).then((function(){return--i||t(s)}))}))}))})),le.any&&"undefined"!=typeof AggregateError&&p(Ce,"any",(function(){var e=N.apply(null,arguments).map(We);return new Ce((function(t,i){0===e.length&&i(new AggregateError([]));var s=e.length,n=new Array(s);e.forEach((function(e,r){return Ce.resolve(e).then((function(e){return t(e)}),(function(e){n[r]=e,--s||i(new AggregateError(n))}))}))}))})),le.withResolvers&&(Ce.withResolvers=le.withResolvers));var Le={awaits:0,echoes:0,id:0},Me=0,Ne=[],Fe=0,Be=0,He=0;function ze(e,t,i,s){var n=_e,r=Object.create(n);return r.parent=n,r.ref=0,r.global=!1,r.id=++He,ge.env,r.env=he?{Promise:Ce,PromiseProp:{value:Ce,configurable:!0,writable:!0},all:Ce.all,race:Ce.race,allSettled:Ce.allSettled,any:Ce.any,resolve:Ce.resolve,reject:Ce.reject}:{},t&&a(r,t),++n.ref,r.finalize=function(){--this.parent.ref||this.parent.finalize()},s=qe(r,e,i,s),0===r.ref&&r.finalize(),s}function $e(){return Le.id||(Le.id=++Me),++Le.awaits,Le.echoes+=100,Le.id}function Ve(){return!!Le.awaits&&(0==--Le.awaits&&(Le.id=0),Le.echoes=100*Le.awaits,!0)}function We(e){return Le.echoes&&e&&e.constructor===le?($e(),e.then((function(e){return Ve(),e}),(function(e){return Ve(),Xe(e)}))):e}function Ue(){var e=Ne[Ne.length-1];Ne.pop(),je(e,!1)}function je(e,t){var i,s=_e;(t?!Le.echoes||Fe++&&e===_e:!Fe||--Fe&&e===_e)||queueMicrotask(t?function(e){++Be,Le.echoes&&0!=--Le.echoes||(Le.echoes=Le.awaits=Le.id=0),Ne.push(_e),je(e,!0)}.bind(null,e):Ue),e!==_e&&(_e=e,s===ge&&(ge.env=Ge()),he&&(i=ge.env.Promise,t=e.env,(s.global||e.global)&&(Object.defineProperty(n,"Promise",t.PromiseProp),i.all=t.all,i.race=t.race,i.resolve=t.resolve,i.reject=t.reject,t.allSettled&&(i.allSettled=t.allSettled),t.any&&(i.any=t.any))))}function Ge(){var e=n.Promise;return he?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(n,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject}:{}}function qe(e,t,i,s,n){var r=_e;try{return je(e,!0),t(i,s,n)}finally{je(r,!1)}}function Ke(e,t,i,s){return"function"!=typeof e?e:function(){var n=_e;i&&$e(),je(t,!0);try{return e.apply(this,arguments)}finally{je(n,!1),s&&queueMicrotask(Ve)}}}function Ye(e){Promise===le&&0===Le.echoes?0===Fe?e():enqueueNativeMicroTask(e):setTimeout(e,0)}-1===(""+B).indexOf("[native code]")&&($e=Ve=Y);var Xe=Ce.reject,Ze=String.fromCharCode(65535),Qe="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Je="String expected.",et=[],tt="__dbnames",it="readonly",st="readwrite";function nt(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}var rt={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function ot(e){return"string"!=typeof e||/\./.test(e)?function(e){return e}:function(t){return void 0===t[e]&&e in t&&delete(t=I(t))[e],t}}function at(){throw G.Type()}function lt(e,t){try{var i=ht(e),s=ht(t);if(i!==s)return"Array"===i?1:"Array"===s?-1:"binary"===i?1:"binary"===s?-1:"string"===i?1:"string"===s?-1:"Date"===i?1:"Date"!==s?NaN:-1;switch(i){case"number":case"Date":case"string":return t<e?1:e<t?-1:0;case"binary":return function(e,t){for(var i=e.length,s=t.length,n=i<s?i:s,r=0;r<n;++r)if(e[r]!==t[r])return e[r]<t[r]?-1:1;return i===s?0:i<s?-1:1}(ct(e),ct(t));case"Array":return function(e,t){for(var i=e.length,s=t.length,n=i<s?i:s,r=0;r<n;++r){var o=lt(e[r],t[r]);if(0!==o)return o}return i===s?0:i<s?-1:1}(e,t)}}catch(e){}return NaN}function ht(e){var t=typeof e;return"object"!=t?t:ArrayBuffer.isView(e)||"ArrayBuffer"===(e=D(e))?"binary":e}function ct(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}var dt=(ut.prototype._trans=function(e,t,i){var s=this._tx||_e.trans,n=this.name,r=ne&&"undefined"!=typeof console&&console.createTask&&console.createTask("Dexie: ".concat("readonly"===e?"read":"write"," ").concat(this.name));function o(e,i,s){if(!s.schema[n])throw new G.NotFound("Table "+n+" not part of transaction");return t(s.idbtrans,s)}var a=Ie();try{var l=s&&s.db._novip===this.db._novip?s===_e.trans?s._promise(e,o,i):ze((function(){return s._promise(e,o,i)}),{trans:s,transless:_e.transless||_e}):function e(t,i,s,n){if(t.idbdb&&(t._state.openComplete||_e.letThrough||t._vip)){var r=t._createTransaction(i,s,t._dbSchema);try{r.create(),t._state.PR1398_maxLoop=3}catch(r){return r.name===U.InvalidState&&t.isOpen()&&0<--t._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),t.close({disableAutoOpen:!1}),t.open().then((function(){return e(t,i,s,n)}))):Xe(r)}return r._promise(i,(function(e,t){return ze((function(){return _e.trans=r,n(e,t,r)}))})).then((function(e){if("readwrite"===i)try{r.idbtrans.commit()}catch(e){}return"readonly"===i?e:r._completion.then((function(){return e}))}))}if(t._state.openComplete)return Xe(new G.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._state.autoOpen)return Xe(new G.DatabaseClosed);t.open().catch(Y)}return t._state.dbReadyPromise.then((function(){return e(t,i,s,n)}))}(this.db,e,[this.name],o);return r&&(l._consoleTask=r,l=l.catch((function(e){return console.trace(e),Xe(e)}))),l}finally{a&&Ae()}},ut.prototype.get=function(e,t){var i=this;return e&&e.constructor===Object?this.where(e).first(t):null==e?Xe(new G.Type("Invalid argument to Table.get()")):this._trans("readonly",(function(t){return i.core.get({trans:t,key:e}).then((function(e){return i.hook.reading.fire(e)}))})).then(t)},ut.prototype.where=function(e){if("string"==typeof e)return new this.db.WhereClause(this,e);if(o(e))return new this.db.WhereClause(this,"[".concat(e.join("+"),"]"));var t=r(e);if(1===t.length)return this.where(t[0]).equals(e[t[0]]);var i=this.schema.indexes.concat(this.schema.primKey).filter((function(e){if(e.compound&&t.every((function(t){return 0<=e.keyPath.indexOf(t)}))){for(var i=0;i<t.length;++i)if(-1===t.indexOf(e.keyPath[i]))return!1;return!0}return!1})).sort((function(e,t){return e.keyPath.length-t.keyPath.length}))[0];if(i&&this.db._maxKey!==Ze){var s=i.keyPath.slice(0,t.length);return this.where(s).equals(s.map((function(t){return e[t]})))}!i&&ne&&console.warn("The query ".concat(JSON.stringify(e)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(t.join("+"),"]"));var n=this.schema.idxByName;function a(e,t){return 0===lt(e,t)}var l=t.reduce((function(t,i){var s=t[0],r=t[1],l=(t=n[i],e[i]);return[s||t,s||!t?nt(r,t&&t.multi?function(e){return e=C(e,i),o(e)&&e.some((function(e){return a(l,e)}))}:function(e){return a(l,C(e,i))}):r]}),[null,null]);return s=l[0],l=l[1],s?this.where(s.name).equals(e[s.keyPath]).filter(l):i?this.filter(l):this.where(t).equals("")},ut.prototype.filter=function(e){return this.toCollection().and(e)},ut.prototype.count=function(e){return this.toCollection().count(e)},ut.prototype.offset=function(e){return this.toCollection().offset(e)},ut.prototype.limit=function(e){return this.toCollection().limit(e)},ut.prototype.each=function(e){return this.toCollection().each(e)},ut.prototype.toArray=function(e){return this.toCollection().toArray(e)},ut.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},ut.prototype.orderBy=function(e){return new this.db.Collection(new this.db.WhereClause(this,o(e)?"[".concat(e.join("+"),"]"):e))},ut.prototype.reverse=function(){return this.toCollection().reverse()},ut.prototype.mapToClass=function(t){var i,s=this.db,n=this.name;function r(){return null!==i&&i.apply(this,arguments)||this}(this.schema.mappedClass=t).prototype instanceof at&&(function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function s(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(s.prototype=i.prototype,new s)}(r,i=t),Object.defineProperty(r.prototype,"db",{get:function(){return s},enumerable:!1,configurable:!0}),r.prototype.table=function(){return n},t=r);for(var o=new Set,a=t.prototype;a;a=l(a))Object.getOwnPropertyNames(a).forEach((function(e){return o.add(e)}));function h(e){if(!e)return e;var i,s=Object.create(t.prototype);for(i in e)if(!o.has(i))try{s[i]=e[i]}catch(e){}return s}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=h,this.hook("reading",h),t},ut.prototype.defineClass=function(){return this.mapToClass((function(e){a(this,e)}))},ut.prototype.add=function(e,t){var i=this,s=this.schema.primKey,n=s.auto,r=s.keyPath,o=e;return r&&n&&(o=ot(r)(e)),this._trans("readwrite",(function(e){return i.core.mutate({trans:e,type:"add",keys:null!=t?[t]:null,values:[o]})})).then((function(e){return e.numFailures?Ce.reject(e.failures[0]):e.lastResult})).then((function(t){if(r)try{w(e,r,t)}catch(t){}return t}))},ut.prototype.update=function(e,t){return"object"!=typeof e||o(e)?this.where(":id").equals(e).modify(t):void 0===(e=C(e,this.schema.primKey.keyPath))?Xe(new G.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(e).modify(t)},ut.prototype.put=function(e,t){var i=this,s=this.schema.primKey,n=s.auto,r=s.keyPath,o=e;return r&&n&&(o=ot(r)(e)),this._trans("readwrite",(function(e){return i.core.mutate({trans:e,type:"put",values:[o],keys:null!=t?[t]:null})})).then((function(e){return e.numFailures?Ce.reject(e.failures[0]):e.lastResult})).then((function(t){if(r)try{w(e,r,t)}catch(t){}return t}))},ut.prototype.delete=function(e){var t=this;return this._trans("readwrite",(function(i){return t.core.mutate({trans:i,type:"delete",keys:[e]})})).then((function(e){return e.numFailures?Ce.reject(e.failures[0]):void 0}))},ut.prototype.clear=function(){var e=this;return this._trans("readwrite",(function(t){return e.core.mutate({trans:t,type:"deleteRange",range:rt})})).then((function(e){return e.numFailures?Ce.reject(e.failures[0]):void 0}))},ut.prototype.bulkGet=function(e){var t=this;return this._trans("readonly",(function(i){return t.core.getMany({keys:e,trans:i}).then((function(e){return e.map((function(e){return t.hook.reading.fire(e)}))}))}))},ut.prototype.bulkAdd=function(e,t,i){var s=this,n=Array.isArray(t)?t:void 0,r=(i=i||(n?void 0:t))?i.allKeys:void 0;return this._trans("readwrite",(function(t){var i=(a=s.schema.primKey).auto;if((a=a.keyPath)&&n)throw new G.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(n&&n.length!==e.length)throw new G.InvalidArgument("Arguments objects and keys must have the same length");var o=e.length,a=a&&i?e.map(ot(a)):e;return s.core.mutate({trans:t,type:"add",keys:n,values:a,wantResults:r}).then((function(e){var t=e.numFailures,i=e.results,n=e.lastResult;if(e=e.failures,0===t)return r?i:n;throw new W("".concat(s.name,".bulkAdd(): ").concat(t," of ").concat(o," operations failed"),e)}))}))},ut.prototype.bulkPut=function(e,t,i){var s=this,n=Array.isArray(t)?t:void 0,r=(i=i||(n?void 0:t))?i.allKeys:void 0;return this._trans("readwrite",(function(t){var i=(a=s.schema.primKey).auto;if((a=a.keyPath)&&n)throw new G.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(n&&n.length!==e.length)throw new G.InvalidArgument("Arguments objects and keys must have the same length");var o=e.length,a=a&&i?e.map(ot(a)):e;return s.core.mutate({trans:t,type:"put",keys:n,values:a,wantResults:r}).then((function(e){var t=e.numFailures,i=e.results,n=e.lastResult;if(e=e.failures,0===t)return r?i:n;throw new W("".concat(s.name,".bulkPut(): ").concat(t," of ").concat(o," operations failed"),e)}))}))},ut.prototype.bulkUpdate=function(e){var t=this,i=this.core,s=e.map((function(e){return e.key})),n=e.map((function(e){return e.changes})),r=[];return this._trans("readwrite",(function(o){return i.getMany({trans:o,keys:s,cache:"clone"}).then((function(a){var l=[],h=[];e.forEach((function(e,i){var s=e.key,n=e.changes,o=a[i];if(o){for(var c=0,d=Object.keys(n);c<d.length;c++){var u=d[c],p=n[u];if(u===t.schema.primKey.keyPath){if(0!==lt(p,s))throw new G.Constraint("Cannot update primary key in bulkUpdate()")}else w(o,u,p)}r.push(i),l.push(s),h.push(o)}}));var c=l.length;return i.mutate({trans:o,type:"put",keys:l,values:h,updates:{keys:s,changeSpecs:n}}).then((function(e){var i=e.numFailures,s=e.failures;if(0===i)return c;for(var n=0,o=Object.keys(s);n<o.length;n++){var a,l=o[n],h=r[Number(l)];null!=h&&(a=s[l],delete s[l],s[h]=a)}throw new W("".concat(t.name,".bulkUpdate(): ").concat(i," of ").concat(c," operations failed"),s)}))}))}))},ut.prototype.bulkDelete=function(e){var t=this,i=e.length;return this._trans("readwrite",(function(i){return t.core.mutate({trans:i,type:"delete",keys:e})})).then((function(e){var s=e.numFailures,n=e.lastResult;if(e=e.failures,0===s)return n;throw new W("".concat(t.name,".bulkDelete(): ").concat(s," of ").concat(i," operations failed"),e)}))},ut);function ut(){}function pt(e){function t(t,s){if(s){for(var n=arguments.length,r=new Array(n-1);--n;)r[n-1]=arguments[n];return i[t].subscribe.apply(null,r),e}if("string"==typeof t)return i[t]}var i={};t.addEventType=a;for(var s=1,n=arguments.length;s<n;++s)a(arguments[s]);return t;function a(e,s,n){if("object"!=typeof e){var l;s=s||ie;var h={subscribers:[],fire:n=n||Y,subscribe:function(e){-1===h.subscribers.indexOf(e)&&(h.subscribers.push(e),h.fire=s(h.fire,e))},unsubscribe:function(e){h.subscribers=h.subscribers.filter((function(t){return t!==e})),h.fire=h.subscribers.reduce(s,n)}};return i[e]=t[e]=h}r(l=e).forEach((function(e){var t=l[e];if(o(t))a(e,l[e][0],l[e][1]);else{if("asap"!==t)throw new G.InvalidArgument("Invalid event config");var i=a(e,X,(function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];i.subscribers.forEach((function(e){y((function(){e.apply(null,t)}))}))}))}}))}}function mt(e,t){return m(t).from({prototype:e}),t}function ft(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function gt(e,t){e.filter=nt(e.filter,t)}function _t(e,t,i){var s=e.replayFilter;e.replayFilter=s?function(){return nt(s(),t())}:t,e.justLimit=i&&!s}function vt(e,t){if(e.isPrimKey)return t.primaryKey;var i=t.getIndexByKeyPath(e.index);if(!i)throw new G.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return i}function bt(e,t,i){var s=vt(e,t.schema);return t.openCursor({trans:i,values:!e.keysOnly,reverse:"prev"===e.dir,unique:!!e.unique,query:{index:s,range:e.range}})}function yt(e,t,i,s){var n=e.replayFilter?nt(e.filter,e.replayFilter()):e.filter;if(e.or){var r={},o=function(e,i,s){var o,a;n&&!n(i,s,(function(e){return i.stop(e)}),(function(e){return i.fail(e)}))||("[object ArrayBuffer]"==(a=""+(o=i.primaryKey))&&(a=""+new Uint8Array(o)),c(r,a)||(r[a]=!0,t(e,i,s)))};return Promise.all([e.or._iterate(o,i),Ct(bt(e,s,i),e.algorithm,o,!e.keysOnly&&e.valueMapper)])}return Ct(bt(e,s,i),nt(e.algorithm,n),t,!e.keysOnly&&e.valueMapper)}function Ct(e,t,i,s){var n=Pe(s?function(e,t,n){return i(s(e),t,n)}:i);return e.then((function(e){if(e)return e.start((function(){var i=function(){return e.continue()};t&&!t(e,(function(e){return i=e}),(function(t){e.stop(t),i=Y}),(function(t){e.fail(t),i=Y}))||n(e.value,e,(function(e){return i=e})),i()}))}))}T=Symbol();var wt=(St.prototype.execute=function(e){if(void 0!==this.add){var t=this.add;if(o(t))return s(s([],o(e)?e:[],!0),t,!0).sort();if("number"==typeof t)return(Number(e)||0)+t;if("bigint"==typeof t)try{return BigInt(e)+t}catch(e){return BigInt(0)+t}throw new TypeError("Invalid term ".concat(t))}if(void 0!==this.remove){var i=this.remove;if(o(i))return o(e)?e.filter((function(e){return!i.includes(e)})).sort():[];if("number"==typeof i)return Number(e)-i;if("bigint"==typeof i)try{return BigInt(e)-i}catch(e){return BigInt(0)-i}throw new TypeError("Invalid subtrahend ".concat(i))}return(t=null===(t=this.replacePrefix)||void 0===t?void 0:t[0])&&"string"==typeof e&&e.startsWith(t)?this.replacePrefix[1]+e.substring(t.length):e},St);function St(e){Object.assign(this,e)}var Et=(xt.prototype._read=function(e,t){var i=this._ctx;return i.error?i.table._trans(null,Xe.bind(null,i.error)):i.table._trans("readonly",e).then(t)},xt.prototype._write=function(e){var t=this._ctx;return t.error?t.table._trans(null,Xe.bind(null,t.error)):t.table._trans("readwrite",e,"locked")},xt.prototype._addAlgorithm=function(e){var t=this._ctx;t.algorithm=nt(t.algorithm,e)},xt.prototype._iterate=function(e,t){return yt(this._ctx,e,t,this._ctx.table.core)},xt.prototype.clone=function(e){var t=Object.create(this.constructor.prototype),i=Object.create(this._ctx);return e&&a(i,e),t._ctx=i,t},xt.prototype.raw=function(){return this._ctx.valueMapper=null,this},xt.prototype.each=function(e){var t=this._ctx;return this._read((function(i){return yt(t,e,i,t.table.core)}))},xt.prototype.count=function(e){var t=this;return this._read((function(e){var i=t._ctx,s=i.table.core;if(ft(i,!0))return s.count({trans:e,query:{index:vt(i,s.schema),range:i.range}}).then((function(e){return Math.min(e,i.limit)}));var n=0;return yt(i,(function(){return++n,!1}),e,s).then((function(){return n}))})).then(e)},xt.prototype.sortBy=function(e,t){var i=e.split(".").reverse(),s=i[0],n=i.length-1;function r(e,t){return t?r(e[i[t]],t-1):e[s]}var o="next"===this._ctx.dir?1:-1;function a(e,t){return lt(r(e,n),r(t,n))*o}return this.toArray((function(e){return e.sort(a)})).then(t)},xt.prototype.toArray=function(e){var t=this;return this._read((function(e){var i=t._ctx;if("next"===i.dir&&ft(i,!0)&&0<i.limit){var s=i.valueMapper,n=vt(i,i.table.core.schema);return i.table.core.query({trans:e,limit:i.limit,values:!0,query:{index:n,range:i.range}}).then((function(e){return e=e.result,s?e.map(s):e}))}var r=[];return yt(i,(function(e){return r.push(e)}),e,i.table.core).then((function(){return r}))}),e)},xt.prototype.offset=function(e){var t=this._ctx;return e<=0||(t.offset+=e,ft(t)?_t(t,(function(){var t=e;return function(e,i){return 0===t||(1===t?--t:i((function(){e.advance(t),t=0})),!1)}})):_t(t,(function(){var t=e;return function(){return--t<0}}))),this},xt.prototype.limit=function(e){return this._ctx.limit=Math.min(this._ctx.limit,e),_t(this._ctx,(function(){var t=e;return function(e,i,s){return--t<=0&&i(s),0<=t}}),!0),this},xt.prototype.until=function(e,t){return gt(this._ctx,(function(i,s,n){return!e(i.value)||(s(n),t)})),this},xt.prototype.first=function(e){return this.limit(1).toArray((function(e){return e[0]})).then(e)},xt.prototype.last=function(e){return this.reverse().first(e)},xt.prototype.filter=function(e){var t;return gt(this._ctx,(function(t){return e(t.value)})),(t=this._ctx).isMatch=nt(t.isMatch,e),this},xt.prototype.and=function(e){return this.filter(e)},xt.prototype.or=function(e){return new this.db.WhereClause(this._ctx.table,e,this)},xt.prototype.reverse=function(){return this._ctx.dir="prev"===this._ctx.dir?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},xt.prototype.desc=function(){return this.reverse()},xt.prototype.eachKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each((function(t,i){e(i.key,i)}))},xt.prototype.eachUniqueKey=function(e){return this._ctx.unique="unique",this.eachKey(e)},xt.prototype.eachPrimaryKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each((function(t,i){e(i.primaryKey,i)}))},xt.prototype.keys=function(e){var t=this._ctx;t.keysOnly=!t.isMatch;var i=[];return this.each((function(e,t){i.push(t.key)})).then((function(){return i})).then(e)},xt.prototype.primaryKeys=function(e){var t=this._ctx;if("next"===t.dir&&ft(t,!0)&&0<t.limit)return this._read((function(e){var i=vt(t,t.table.core.schema);return t.table.core.query({trans:e,values:!1,limit:t.limit,query:{index:i,range:t.range}})})).then((function(e){return e.result})).then(e);t.keysOnly=!t.isMatch;var i=[];return this.each((function(e,t){i.push(t.primaryKey)})).then((function(){return i})).then(e)},xt.prototype.uniqueKeys=function(e){return this._ctx.unique="unique",this.keys(e)},xt.prototype.firstKey=function(e){return this.limit(1).keys((function(e){return e[0]})).then(e)},xt.prototype.lastKey=function(e){return this.reverse().firstKey(e)},xt.prototype.distinct=function(){var e;if(!(e=(e=this._ctx).index&&e.table.schema.idxByName[e.index])||!e.multi)return this;var t={};return gt(this._ctx,(function(e){var i=e.primaryKey.toString();return e=c(t,i),t[i]=!0,!e})),this},xt.prototype.modify=function(e){var t=this,i=this._ctx;return this._write((function(s){var n,o,a;function l(e,t){var i=t.failures;t=t.numFailures,f+=e-t;for(var s=0,n=r(i);s<n.length;s++){var o=n[s];m.push(i[o])}}a="function"==typeof e?e:(n=r(e),o=n.length,function(t){for(var i=!1,s=0;s<o;++s){var r=n[s],a=e[r],l=C(t,r);a instanceof wt?(w(t,r,a.execute(l)),i=!0):l!==a&&(w(t,r,a),i=!0)}return i});var h=i.table.core,c=h.schema.primaryKey,d=c.outbound,u=c.extractKey,p=t.db._options.modifyChunkSize||200,m=[],f=0,g=[];return t.clone().primaryKeys().then((function(t){var n=ft(i)&&i.limit===1/0&&("function"!=typeof e||e===Tt)&&{index:i.index,range:i.range};return function i(r){var o=Math.min(p,t.length-r);return h.getMany({trans:s,keys:t.slice(r,r+o),cache:"immutable"}).then((function(c){for(var m=[],f=[],g=d?[]:null,_=[],v=0;v<o;++v){var b=c[v],y={value:I(b),primKey:t[r+v]};!1!==a.call(y,y.value,y)&&(null==y.value?_.push(t[r+v]):d||0===lt(u(b),u(y.value))?(f.push(y.value),d&&g.push(t[r+v])):(_.push(t[r+v]),m.push(y.value)))}return Promise.resolve(0<m.length&&h.mutate({trans:s,type:"add",values:m}).then((function(e){for(var t in e.failures)_.splice(parseInt(t),1);l(m.length,e)}))).then((function(){return(0<f.length||n&&"object"==typeof e)&&h.mutate({trans:s,type:"put",keys:g,values:f,criteria:n,changeSpec:"function"!=typeof e&&e,isAdditionalChunk:0<r}).then((function(e){return l(f.length,e)}))})).then((function(){return(0<_.length||n&&e===Tt)&&h.mutate({trans:s,type:"delete",keys:_,criteria:n,isAdditionalChunk:0<r}).then((function(e){return l(_.length,e)}))})).then((function(){return t.length>r+o&&i(r+p)}))}))}(0).then((function(){if(0<m.length)throw new V("Error modifying one or more objects",m,f,g);return t.length}))}))}))},xt.prototype.delete=function(){var e=this._ctx,t=e.range;return ft(e)&&(e.isPrimKey||3===t.type)?this._write((function(i){var s=e.table.core.schema.primaryKey,n=t;return e.table.core.count({trans:i,query:{index:s,range:n}}).then((function(t){return e.table.core.mutate({trans:i,type:"deleteRange",range:n}).then((function(e){var i=e.failures;if(e.lastResult,e.results,e=e.numFailures)throw new V("Could not delete some values",Object.keys(i).map((function(e){return i[e]})),t-e);return t-e}))}))})):this.modify(Tt)},xt);function xt(){}var Tt=function(e,t){return t.value=null};function Ot(e,t){return e<t?-1:e===t?0:1}function kt(e,t){return t<e?-1:e===t?0:1}function It(e,t,i){return(e=e instanceof Lt?new e.Collection(e):e)._ctx.error=new(i||TypeError)(t),e}function At(e){return new e.Collection(e,(function(){return Pt("")})).limit(0)}function Dt(e,t,i,s){var n,r,o,a,l,h,c,d=i.length;if(!i.every((function(e){return"string"==typeof e})))return It(e,Je);function u(e){n="next"===e?function(e){return e.toUpperCase()}:function(e){return e.toLowerCase()},r="next"===e?function(e){return e.toLowerCase()}:function(e){return e.toUpperCase()},o="next"===e?Ot:kt;var t=i.map((function(e){return{lower:r(e),upper:n(e)}})).sort((function(e,t){return o(e.lower,t.lower)}));a=t.map((function(e){return e.upper})),l=t.map((function(e){return e.lower})),c="next"===(h=e)?"":s}u("next"),(e=new e.Collection(e,(function(){return Rt(a[0],l[d-1]+s)})))._ondirectionchange=function(e){u(e)};var p=0;return e._addAlgorithm((function(e,i,s){var n=e.key;if("string"!=typeof n)return!1;var u=r(n);if(t(u,l,p))return!0;for(var m=null,f=p;f<d;++f){var g=function(e,t,i,s,n,r){for(var o=Math.min(e.length,s.length),a=-1,l=0;l<o;++l){var h=t[l];if(h!==s[l])return n(e[l],i[l])<0?e.substr(0,l)+i[l]+i.substr(l+1):n(e[l],s[l])<0?e.substr(0,l)+s[l]+i.substr(l+1):0<=a?e.substr(0,a)+t[a]+i.substr(a+1):null;n(e[l],h)<0&&(a=l)}return o<s.length&&"next"===r?e+i.substr(e.length):o<e.length&&"prev"===r?e.substr(0,i.length):a<0?null:e.substr(0,a)+s[a]+i.substr(a+1)}(n,u,a[f],l[f],o,h);null===g&&null===m?p=f+1:(null===m||0<o(m,g))&&(m=g)}return i(null!==m?function(){e.continue(m+c)}:s),!1})),e}function Rt(e,t,i,s){return{type:2,lower:e,upper:t,lowerOpen:i,upperOpen:s}}function Pt(e){return{type:1,lower:e,upper:e}}var Lt=(Object.defineProperty(Mt.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),Mt.prototype.between=function(e,t,i,s){i=!1!==i,s=!0===s;try{return 0<this._cmp(e,t)||0===this._cmp(e,t)&&(i||s)&&(!i||!s)?At(this):new this.Collection(this,(function(){return Rt(e,t,!i,!s)}))}catch(e){return It(this,Qe)}},Mt.prototype.equals=function(e){return null==e?It(this,Qe):new this.Collection(this,(function(){return Pt(e)}))},Mt.prototype.above=function(e){return null==e?It(this,Qe):new this.Collection(this,(function(){return Rt(e,void 0,!0)}))},Mt.prototype.aboveOrEqual=function(e){return null==e?It(this,Qe):new this.Collection(this,(function(){return Rt(e,void 0,!1)}))},Mt.prototype.below=function(e){return null==e?It(this,Qe):new this.Collection(this,(function(){return Rt(void 0,e,!1,!0)}))},Mt.prototype.belowOrEqual=function(e){return null==e?It(this,Qe):new this.Collection(this,(function(){return Rt(void 0,e)}))},Mt.prototype.startsWith=function(e){return"string"!=typeof e?It(this,Je):this.between(e,e+Ze,!0,!0)},Mt.prototype.startsWithIgnoreCase=function(e){return""===e?this.startsWith(e):Dt(this,(function(e,t){return 0===e.indexOf(t[0])}),[e],Ze)},Mt.prototype.equalsIgnoreCase=function(e){return Dt(this,(function(e,t){return e===t[0]}),[e],"")},Mt.prototype.anyOfIgnoreCase=function(){var e=N.apply(M,arguments);return 0===e.length?At(this):Dt(this,(function(e,t){return-1!==t.indexOf(e)}),e,"")},Mt.prototype.startsWithAnyOfIgnoreCase=function(){var e=N.apply(M,arguments);return 0===e.length?At(this):Dt(this,(function(e,t){return t.some((function(t){return 0===e.indexOf(t)}))}),e,Ze)},Mt.prototype.anyOf=function(){var e=this,t=N.apply(M,arguments),i=this._cmp;try{t.sort(i)}catch(s){return It(this,Qe)}if(0===t.length)return At(this);var s=new this.Collection(this,(function(){return Rt(t[0],t[t.length-1])}));s._ondirectionchange=function(s){i="next"===s?e._ascending:e._descending,t.sort(i)};var n=0;return s._addAlgorithm((function(e,s,r){for(var o=e.key;0<i(o,t[n]);)if(++n===t.length)return s(r),!1;return 0===i(o,t[n])||(s((function(){e.continue(t[n])})),!1)})),s},Mt.prototype.notEqual=function(e){return this.inAnyRange([[-1/0,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},Mt.prototype.noneOf=function(){var e=N.apply(M,arguments);if(0===e.length)return new this.Collection(this);try{e.sort(this._ascending)}catch(e){return It(this,Qe)}var t=e.reduce((function(e,t){return e?e.concat([[e[e.length-1][1],t]]):[[-1/0,t]]}),null);return t.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(t,{includeLowers:!1,includeUppers:!1})},Mt.prototype.inAnyRange=function(e,t){var i=this,s=this._cmp,n=this._ascending,r=this._descending,o=this._min,a=this._max;if(0===e.length)return At(this);if(!e.every((function(e){return void 0!==e[0]&&void 0!==e[1]&&n(e[0],e[1])<=0})))return It(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",G.InvalidArgument);var l,h=!t||!1!==t.includeLowers,c=t&&!0===t.includeUppers,d=n;function u(e,t){return d(e[0],t[0])}try{(l=e.reduce((function(e,t){for(var i=0,n=e.length;i<n;++i){var r=e[i];if(s(t[0],r[1])<0&&0<s(t[1],r[0])){r[0]=o(r[0],t[0]),r[1]=a(r[1],t[1]);break}}return i===n&&e.push(t),e}),[])).sort(u)}catch(e){return It(this,Qe)}var p=0,m=c?function(e){return 0<n(e,l[p][1])}:function(e){return 0<=n(e,l[p][1])},f=h?function(e){return 0<r(e,l[p][0])}:function(e){return 0<=r(e,l[p][0])},g=m;return(e=new this.Collection(this,(function(){return Rt(l[0][0],l[l.length-1][1],!h,!c)})))._ondirectionchange=function(e){d="next"===e?(g=m,n):(g=f,r),l.sort(u)},e._addAlgorithm((function(e,t,s){for(var r,o=e.key;g(o);)if(++p===l.length)return t(s),!1;return!m(r=o)&&!f(r)||(0===i._cmp(o,l[p][1])||0===i._cmp(o,l[p][0])||t((function(){d===n?e.continue(l[p][0]):e.continue(l[p][1])})),!1)})),e},Mt.prototype.startsWithAnyOf=function(){var e=N.apply(M,arguments);return e.every((function(e){return"string"==typeof e}))?0===e.length?At(this):this.inAnyRange(e.map((function(e){return[e,e+Ze]}))):It(this,"startsWithAnyOf() only works with strings")},Mt);function Mt(){}function Nt(e){return Pe((function(t){return Ft(t),e(t.target.error),!1}))}function Ft(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}var Bt="storagemutated",Ht="x-storagemutated-1",zt=pt(null,Bt),$t=(Vt.prototype._lock=function(){return b(!_e.global),++this._reculock,1!==this._reculock||_e.global||(_e.lockOwnerFor=this),this},Vt.prototype._unlock=function(){if(b(!_e.global),0==--this._reculock)for(_e.global||(_e.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var e=this._blockedFuncs.shift();try{qe(e[1],e[0])}catch(e){}}return this},Vt.prototype._locked=function(){return this._reculock&&_e.lockOwnerFor!==this},Vt.prototype.create=function(e){var t=this;if(!this.mode)return this;var i=this.db.idbdb,s=this.db._state.dbOpenError;if(b(!this.idbtrans),!e&&!i)switch(s&&s.name){case"DatabaseClosedError":throw new G.DatabaseClosed(s);case"MissingAPIError":throw new G.MissingAPI(s.message,s);default:throw new G.OpenFailed(s)}if(!this.active)throw new G.TransactionInactive;return b(null===this._completion._state),(e=this.idbtrans=e||(this.db.core||i).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=Pe((function(i){Ft(i),t._reject(e.error)})),e.onabort=Pe((function(i){Ft(i),t.active&&t._reject(new G.Abort(e.error)),t.active=!1,t.on("abort").fire(i)})),e.oncomplete=Pe((function(){t.active=!1,t._resolve(),"mutatedParts"in e&&zt.storagemutated.fire(e.mutatedParts)})),this},Vt.prototype._promise=function(e,t,i){var s=this;if("readwrite"===e&&"readwrite"!==this.mode)return Xe(new G.ReadOnly("Transaction is readonly"));if(!this.active)return Xe(new G.TransactionInactive);if(this._locked())return new Ce((function(n,r){s._blockedFuncs.push([function(){s._promise(e,t,i).then(n,r)},_e])}));if(i)return ze((function(){var e=new Ce((function(e,i){s._lock();var n=t(e,i,s);n&&n.then&&n.then(e,i)}));return e.finally((function(){return s._unlock()})),e._lib=!0,e}));var n=new Ce((function(e,i){var n=t(e,i,s);n&&n.then&&n.then(e,i)}));return n._lib=!0,n},Vt.prototype._root=function(){return this.parent?this.parent._root():this},Vt.prototype.waitFor=function(e){var t,i=this._root(),s=Ce.resolve(e);i._waitingFor?i._waitingFor=i._waitingFor.then((function(){return s})):(i._waitingFor=s,i._waitingQueue=[],t=i.idbtrans.objectStore(i.storeNames[0]),function e(){for(++i._spinCount;i._waitingQueue.length;)i._waitingQueue.shift()();i._waitingFor&&(t.get(-1/0).onsuccess=e)}());var n=i._waitingFor;return new Ce((function(e,t){s.then((function(t){return i._waitingQueue.push(Pe(e.bind(null,t)))}),(function(e){return i._waitingQueue.push(Pe(t.bind(null,e)))})).finally((function(){i._waitingFor===n&&(i._waitingFor=null)}))}))},Vt.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new G.Abort))},Vt.prototype.table=function(e){var t=this._memoizedTables||(this._memoizedTables={});if(c(t,e))return t[e];var i=this.schema[e];if(!i)throw new G.NotFound("Table "+e+" not part of transaction");return(i=new this.db.Table(e,i,this)).core=this.db.core.table(e),t[e]=i},Vt);function Vt(){}function Wt(e,t,i,s,n,r,o){return{name:e,keyPath:t,unique:i,multi:s,auto:n,compound:r,src:(i&&!o?"&":"")+(s?"*":"")+(n?"++":"")+Ut(t)}}function Ut(e){return"string"==typeof e?e:e?"["+[].join.call(e,"+")+"]":""}function jt(e,t,i){return{name:e,primKey:t,indexes:i,mappedClass:null,idxByName:(s=function(e){return[e.name,e]},i.reduce((function(e,t,i){return(i=s(t))&&(e[i[0]]=i[1]),e}),{}))};var s}var Gt=function(e){try{return e.only([[]]),Gt=function(){return[[]]},[[]]}catch(e){return Gt=function(){return Ze},Ze}};function qt(e){return null==e?function(){}:"string"==typeof e?1===(t=e).split(".").length?function(e){return e[t]}:function(e){return C(e,t)}:function(t){return C(t,e)};var t}function Kt(e){return[].slice.call(e)}var Yt=0;function Xt(e){return null==e?":id":"string"==typeof e?e:"[".concat(e.join("+"),"]")}function Zt(e,t,i){function s(e){if(3===e.type)return null;if(4===e.type)throw new Error("Cannot convert never type to IDBKeyRange");var i=e.lower,s=e.upper,n=e.lowerOpen;return e=e.upperOpen,void 0===i?void 0===s?null:t.upperBound(s,!!e):void 0===s?t.lowerBound(i,!!n):t.bound(i,s,!!n,!!e)}var n,r,a,l=(r=i,a=Kt((n=e).objectStoreNames),{schema:{name:n.name,tables:a.map((function(e){return r.objectStore(e)})).map((function(e){var t=e.keyPath,i=e.autoIncrement,s=o(t),n={};return i={name:e.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:null==t,compound:s,keyPath:t,autoIncrement:i,unique:!0,extractKey:qt(t)},indexes:Kt(e.indexNames).map((function(t){return e.index(t)})).map((function(e){var t=e.name,i=e.unique,s=e.multiEntry;return e=e.keyPath,s={name:t,compound:o(e),keyPath:e,unique:i,multiEntry:s,extractKey:qt(e)},n[Xt(e)]=s})),getIndexByKeyPath:function(e){return n[Xt(e)]}},n[":id"]=i.primaryKey,null!=t&&(n[Xt(t)]=i.primaryKey),i}))},hasGetAll:0<a.length&&"getAll"in r.objectStore(a[0])&&!("undefined"!=typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),h=(i=l.schema,l.hasGetAll),c=(l=i.tables.map((function(e){var t,i=e.name;return{name:i,schema:e,mutate:function(e){var t=e.trans,n=e.type,r=e.keys,o=e.values,a=e.range;return new Promise((function(e,l){e=Pe(e);var h=t.objectStore(i),c=null==h.keyPath,d="put"===n||"add"===n;if(!d&&"delete"!==n&&"deleteRange"!==n)throw new Error("Invalid operation type: "+n);var u,p=(r||o||{length:1}).length;if(r&&o&&r.length!==o.length)throw new Error("Given keys array must have same length as given values array.");if(0===p)return e({numFailures:0,failures:{},results:[],lastResult:void 0});function m(e){++_,Ft(e)}var f=[],g=[],_=0;if("deleteRange"===n){if(4===a.type)return e({numFailures:_,failures:g,results:[],lastResult:void 0});3===a.type?f.push(u=h.clear()):f.push(u=h.delete(s(a)))}else{var v=(c=d?c?[o,r]:[o,null]:[r,null])[0],b=c[1];if(d)for(var y=0;y<p;++y)f.push(u=b&&void 0!==b[y]?h[n](v[y],b[y]):h[n](v[y])),u.onerror=m;else for(y=0;y<p;++y)f.push(u=h[n](v[y])),u.onerror=m}function C(t){t=t.target.result,f.forEach((function(e,t){return null!=e.error&&(g[t]=e.error)})),e({numFailures:_,failures:g,results:"delete"===n?r:f.map((function(e){return e.result})),lastResult:t})}u.onerror=function(e){m(e),C(e)},u.onsuccess=C}))},getMany:function(e){var t=e.trans,s=e.keys;return new Promise((function(e,n){e=Pe(e);for(var r,o=t.objectStore(i),a=s.length,l=new Array(a),h=0,c=0,d=function(t){t=t.target,l[t._pos]=t.result,++c===h&&e(l)},u=Nt(n),p=0;p<a;++p)null!=s[p]&&((r=o.get(s[p]))._pos=p,r.onsuccess=d,r.onerror=u,++h);0===h&&e(l)}))},get:function(e){var t=e.trans,s=e.key;return new Promise((function(e,n){e=Pe(e);var r=t.objectStore(i).get(s);r.onsuccess=function(t){return e(t.target.result)},r.onerror=Nt(n)}))},query:(t=h,function(e){return new Promise((function(n,r){n=Pe(n);var o,a,l,h=e.trans,c=e.values,d=e.limit,u=e.query,p=d===1/0?void 0:d,m=u.index;if(u=u.range,h=h.objectStore(i),m=m.isPrimaryKey?h:h.index(m.name),u=s(u),0===d)return n({result:[]});t?((p=c?m.getAll(u,p):m.getAllKeys(u,p)).onsuccess=function(e){return n({result:e.target.result})},p.onerror=Nt(r)):(o=0,a=!c&&"openKeyCursor"in m?m.openKeyCursor(u):m.openCursor(u),l=[],a.onsuccess=function(e){var t=a.result;return t?(l.push(c?t.value:t.primaryKey),++o===d?n({result:l}):void t.continue()):n({result:l})},a.onerror=Nt(r))}))}),openCursor:function(e){var t=e.trans,n=e.values,r=e.query,o=e.reverse,a=e.unique;return new Promise((function(e,l){e=Pe(e);var h=r.index,c=r.range,d=t.objectStore(i),u=(d=h.isPrimaryKey?d:d.index(h.name),h=o?a?"prevunique":"prev":a?"nextunique":"next",!n&&"openKeyCursor"in d?d.openKeyCursor(s(c),h):d.openCursor(s(c),h));u.onerror=Nt(l),u.onsuccess=Pe((function(i){var s,n,r,o,a=u.result;a?(a.___id=++Yt,a.done=!1,s=a.continue.bind(a),n=(n=a.continuePrimaryKey)&&n.bind(a),r=a.advance.bind(a),o=function(){throw new Error("Cursor not stopped")},a.trans=t,a.stop=a.continue=a.continuePrimaryKey=a.advance=function(){throw new Error("Cursor not started")},a.fail=Pe(l),a.next=function(){var e=this,t=1;return this.start((function(){return t--?e.continue():e.stop()})).then((function(){return e}))},a.start=function(e){function t(){if(u.result)try{e()}catch(e){a.fail(e)}else a.done=!0,a.start=function(){throw new Error("Cursor behind last entry")},a.stop()}var i=new Promise((function(e,t){e=Pe(e),u.onerror=Nt(t),a.fail=t,a.stop=function(t){a.stop=a.continue=a.continuePrimaryKey=a.advance=o,e(t)}}));return u.onsuccess=Pe((function(e){u.onsuccess=t,t()})),a.continue=s,a.continuePrimaryKey=n,a.advance=r,t(),i},e(a)):e(null)}),l)}))},count:function(e){var t=e.query,n=e.trans,r=t.index,o=t.range;return new Promise((function(e,t){var a=n.objectStore(i),l=r.isPrimaryKey?a:a.index(r.name);(l=(a=s(o))?l.count(a):l.count()).onsuccess=Pe((function(t){return e(t.target.result)})),l.onerror=Nt(t)}))}}})),{});return l.forEach((function(e){return c[e.name]=e})),{stack:"dbcore",transaction:e.transaction.bind(e),table:function(e){if(!c[e])throw new Error("Table '".concat(e,"' not found"));return c[e]},MIN_KEY:-1/0,MAX_KEY:Gt(t),schema:i}}function Qt(e,i){var s=i.db;i=function(e,i,s,n){var r=s.IDBKeyRange;return s.indexedDB,{dbcore:(n=Zt(i,r,n),e.dbcore.reduce((function(e,i){return i=i.create,t(t({},e),i(e))}),n))}}(e._middlewares,s,e._deps,i),e.core=i.dbcore,e.tables.forEach((function(t){var i=t.name;e.core.schema.tables.some((function(e){return e.name===i}))&&(t.core=e.core.table(i),e[i]instanceof e.Table&&(e[i].core=t.core))}))}function Jt(e,t,i,s){i.forEach((function(i){var n=s[i];t.forEach((function(t){var s=function e(t,i){return f(t,i)||(t=l(t))&&e(t,i)}(t,i);(!s||"value"in s&&void 0===s.value)&&(t===e.Transaction.prototype||t instanceof e.Transaction?p(t,i,{get:function(){return this.table(i)},set:function(e){u(this,i,{value:e,writable:!0,configurable:!0,enumerable:!0})}}):t[i]=new e.Table(i,n))}))}))}function ei(e,t){t.forEach((function(t){for(var i in t)t[i]instanceof e.Table&&delete t[i]}))}function ti(e,t){return e._cfg.version-t._cfg.version}function ii(e,t){var i,s={del:[],add:[],change:[]};for(i in e)t[i]||s.del.push(i);for(i in t){var n=e[i],r=t[i];if(n){var o={name:i,def:r,recreate:!1,del:[],add:[],change:[]};if(""+(n.primKey.keyPath||"")!=""+(r.primKey.keyPath||"")||n.primKey.auto!==r.primKey.auto)o.recreate=!0,s.change.push(o);else{var a=n.idxByName,l=r.idxByName,h=void 0;for(h in a)l[h]||o.del.push(h);for(h in l){var c=a[h],d=l[h];c?c.src!==d.src&&o.change.push(d):o.add.push(d)}(0<o.del.length||0<o.add.length||0<o.change.length)&&s.change.push(o)}}else s.add.push([i,r])}return s}function si(e,t,i,s){var n=e.db.createObjectStore(t,i.keyPath?{keyPath:i.keyPath,autoIncrement:i.auto}:{autoIncrement:i.auto});return s.forEach((function(e){return ri(n,e)})),n}function ni(e,t){r(e).forEach((function(i){t.db.objectStoreNames.contains(i)||(ne&&console.debug("Dexie: Creating missing table",i),si(t,i,e[i].primKey,e[i].indexes))}))}function ri(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function oi(e,t,i){var s={};return _(t.objectStoreNames,0).forEach((function(e){for(var t=i.objectStore(e),n=Wt(Ut(a=t.keyPath),a||"",!0,!1,!!t.autoIncrement,a&&"string"!=typeof a,!0),r=[],o=0;o<t.indexNames.length;++o){var a=(l=t.index(t.indexNames[o])).keyPath,l=Wt(l.name,a,!!l.unique,!!l.multiEntry,!1,a&&"string"!=typeof a,!1);r.push(l)}s[e]=jt(e,n,r)})),s}function ai(e,t,i){for(var s=i.db.objectStoreNames,r=0;r<s.length;++r){var o=s[r],a=i.objectStore(o);e._hasGetAll="getAll"in a;for(var l=0;l<a.indexNames.length;++l){var h=a.indexNames[l],c=a.index(h).keyPath,d="string"==typeof c?c:"["+_(c).join("+")+"]";!t[o]||(c=t[o].idxByName[d])&&(c.name=h,delete t[o].idxByName[d],t[o].idxByName[h]=c)}}"undefined"!=typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&n.WorkerGlobalScope&&n instanceof n.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}function li(e){return e.split(",").map((function(e,t){var i=(e=e.trim()).replace(/([&*]|\+\+)/g,""),s=/^\[/.test(i)?i.match(/^\[(.*)\]$/)[1].split("+"):i;return Wt(i,s||null,/\&/.test(e),/\*/.test(e),/\+\+/.test(e),o(s),0===t)}))}var hi=(ci.prototype._parseStoresSpec=function(e,t){r(e).forEach((function(i){if(null!==e[i]){var s=li(e[i]),n=s.shift();if(n.unique=!0,n.multi)throw new G.Schema("Primary key cannot be multi-valued");s.forEach((function(e){if(e.auto)throw new G.Schema("Only primary key can be marked as autoIncrement (++)");if(!e.keyPath)throw new G.Schema("Index must have a name and cannot be an empty string")})),t[i]=jt(i,n,s)}}))},ci.prototype.stores=function(e){var t=this.db;this._cfg.storesSource=this._cfg.storesSource?a(this._cfg.storesSource,e):e,e=t._versions;var i={},s={};return e.forEach((function(e){a(i,e._cfg.storesSource),s=e._cfg.dbschema={},e._parseStoresSpec(i,s)})),t._dbSchema=s,ei(t,[t._allTables,t,t.Transaction.prototype]),Jt(t,[t._allTables,t,t.Transaction.prototype,this._cfg.tables],r(s),s),t._storeNames=r(s),this},ci.prototype.upgrade=function(e){return this._cfg.contentUpgrade=se(this._cfg.contentUpgrade||Y,e),this},ci);function ci(){}function di(e,t){var i=e._dbNamesDB;return i||(i=e._dbNamesDB=new Ki(tt,{addons:[],indexedDB:e,IDBKeyRange:t})).version(1).stores({dbnames:"name"}),i.table("dbnames")}function ui(e){return e&&"function"==typeof e.databases}function pi(e){return ze((function(){return _e.letThrough=!0,e()}))}function mi(e){return!("from"in e)}var fi=function(e,t){if(!this){var i=new fi;return e&&"d"in e&&a(i,e),i}a(this,arguments.length?{d:1,from:e,to:1<arguments.length?t:e}:{d:0})};function gi(e,t,i){var s=lt(t,i);if(!isNaN(s)){if(0<s)throw RangeError();if(mi(e))return a(e,{from:t,to:i,d:1});var n=e.l;if(s=e.r,lt(i,e.from)<0)return n?gi(n,t,i):e.l={from:t,to:i,d:1,l:null,r:null},yi(e);if(0<lt(t,e.to))return s?gi(s,t,i):e.r={from:t,to:i,d:1,l:null,r:null},yi(e);lt(t,e.from)<0&&(e.from=t,e.l=null,e.d=s?s.d+1:1),0<lt(i,e.to)&&(e.to=i,e.r=null,e.d=e.l?e.l.d+1:1),i=!e.r,n&&!e.l&&_i(e,n),s&&i&&_i(e,s)}}function _i(e,t){mi(t)||function e(t,i){var s=i.from,n=i.to,r=i.l;i=i.r,gi(t,s,n),r&&e(t,r),i&&e(t,i)}(e,t)}function vi(e,t){var i=bi(t),s=i.next();if(s.done)return!1;for(var n=s.value,r=bi(e),o=r.next(n.from),a=o.value;!s.done&&!o.done;){if(lt(a.from,n.to)<=0&&0<=lt(a.to,n.from))return!0;lt(n.from,a.from)<0?n=(s=i.next(a.from)).value:a=(o=r.next(n.from)).value}return!1}function bi(e){var t=mi(e)?null:{s:0,n:e};return{next:function(e){for(var i=0<arguments.length;t;)switch(t.s){case 0:if(t.s=1,i)for(;t.n.l&&lt(e,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!i||lt(e,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function yi(e){var i,s,n=((null===(i=e.r)||void 0===i?void 0:i.d)||0)-((null===(s=e.l)||void 0===s?void 0:s.d)||0),r=1<n?"r":n<-1?"l":"";r&&(i="r"==r?"l":"r",s=t({},e),n=e[r],e.from=n.from,e.to=n.to,e[r]=n[r],s[r]=n[i],(e[i]=s).d=Ci(s)),e.d=Ci(e)}function Ci(e){var t=e.r;return e=e.l,(t?e?Math.max(t.d,e.d):t.d:e?e.d:0)+1}function wi(e,t){return r(t).forEach((function(i){e[i]?_i(e[i],t[i]):e[i]=function e(t){var i,s,n={};for(i in t)c(t,i)&&(s=t[i],n[i]=!s||"object"!=typeof s||O.has(s.constructor)?s:e(s));return n}(t[i])})),e}function Si(e,t){return e.all||t.all||Object.keys(e).some((function(i){return t[i]&&vi(t[i],e[i])}))}d(fi.prototype,((B={add:function(e){return _i(this,e),this},addKey:function(e){return gi(this,e,e),this},addKeys:function(e){var t=this;return e.forEach((function(e){return gi(t,e,e)})),this},hasKey:function(e){var t=bi(this).next(e).value;return t&&lt(t.from,e)<=0&&0<=lt(t.to,e)}})[R]=function(){return bi(this)},B));var Ei={},xi={},Ti=!1;function Oi(e){wi(xi,e),Ti||(Ti=!0,setTimeout((function(){Ti=!1,ki(xi,!(xi={}))}),0))}function ki(e,t){void 0===t&&(t=!1);var i=new Set;if(e.all)for(var s=0,n=Object.values(Ei);s<n.length;s++)Ii(o=n[s],e,i,t);else for(var r in e){var o,a=/^idb\:\/\/(.*)\/(.*)\//.exec(r);a&&(r=a[1],a=a[2],(o=Ei["idb://".concat(r,"/").concat(a)])&&Ii(o,e,i,t))}i.forEach((function(e){return e()}))}function Ii(e,t,i,s){for(var n=[],r=0,o=Object.entries(e.queries.query);r<o.length;r++){for(var a=o[r],l=a[0],h=[],c=0,d=a[1];c<d.length;c++){var u=d[c];Si(t,u.obsSet)?u.subscribers.forEach((function(e){return i.add(e)})):s&&h.push(u)}s&&n.push([l,h])}if(s)for(var p=0,m=n;p<m.length;p++){var f=m[p];l=f[0],h=f[1],e.queries.query[l]=h}}function Ai(e){var t=e._state,i=e._deps.indexedDB;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then((function(){return t.dbOpenError?Xe(t.dbOpenError):e}));t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;var s=t.openCanceller,n=Math.round(10*e.verno),o=!1;function a(){if(t.openCanceller!==s)throw new G.DatabaseClosed("db.open() was cancelled")}var l,h=t.dbReadyResolve,c=null,d=!1;return Ce.race([s,("undefined"==typeof navigator?Ce.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise((function(e){function t(){return indexedDB.databases().finally(e)}l=setInterval(t,100),t()})).finally((function(){return clearInterval(l)})):Promise.resolve()).then((function s(){return new Ce((function(l,h){if(a(),!i)throw new G.MissingAPI;var u=e.name,p=t.autoSchema||!n?i.open(u):i.open(u,n);if(!p)throw new G.MissingAPI;p.onerror=Nt(h),p.onblocked=Pe(e._fireOnBlocked),p.onupgradeneeded=Pe((function(s){var n;c=p.transaction,t.autoSchema&&!e._options.allowEmptyDB?(p.onerror=Ft,c.abort(),p.result.close(),(n=i.deleteDatabase(u)).onsuccess=n.onerror=Pe((function(){h(new G.NoSuchDatabase("Database ".concat(u," doesnt exist")))}))):(c.onerror=Nt(h),s=s.oldVersion>Math.pow(2,62)?0:s.oldVersion,d=s<1,e.idbdb=p.result,o&&function(e,t){ni(e._dbSchema,t),t.db.version%10!=0||t.objectStoreNames.contains("$meta")||t.db.createObjectStore("$meta").add(Math.ceil(t.db.version/10-1),"version");var i=oi(0,e.idbdb,t);ai(e,e._dbSchema,t);for(var s=0,n=ii(i,e._dbSchema).change;s<n.length;s++){var r=function(e){if(e.change.length||e.recreate)return console.warn("Unable to patch indexes of table ".concat(e.name," because it has changes on the type of index or primary key.")),{value:void 0};var i=t.objectStore(e.name);e.add.forEach((function(t){ne&&console.debug("Dexie upgrade patch: Creating missing index ".concat(e.name,".").concat(t.src)),ri(i,t)}))}(n[s]);if("object"==typeof r)return r.value}}(e,c),function(e,t,i,s){var n=e._dbSchema;i.objectStoreNames.contains("$meta")&&!n.$meta&&(n.$meta=jt("$meta",li("")[0],[]),e._storeNames.push("$meta"));var o=e._createTransaction("readwrite",e._storeNames,n);o.create(i),o._completion.catch(s);var a=o._reject.bind(o),l=_e.transless||_e;ze((function(){return _e.trans=o,_e.transless=l,0!==t?(Qt(e,i),h=t,((s=o).storeNames.includes("$meta")?s.table("$meta").get("version").then((function(e){return null!=e?e:h})):Ce.resolve(h)).then((function(t){return n=t,a=o,l=i,h=[],t=(s=e)._versions,c=s._dbSchema=oi(0,s.idbdb,l),0!==(t=t.filter((function(e){return e._cfg.version>=n}))).length?(t.forEach((function(e){h.push((function(){var t=c,i=e._cfg.dbschema;ai(s,t,l),ai(s,i,l),c=s._dbSchema=i;var o=ii(t,i);o.add.forEach((function(e){si(l,e[0],e[1].primKey,e[1].indexes)})),o.change.forEach((function(e){if(e.recreate)throw new G.Upgrade("Not yet support for changing primary key");var t=l.objectStore(e.name);e.add.forEach((function(e){return ri(t,e)})),e.change.forEach((function(e){t.deleteIndex(e.name),ri(t,e)})),e.del.forEach((function(e){return t.deleteIndex(e)}))}));var h=e._cfg.contentUpgrade;if(h&&e._cfg.version>n){Qt(s,l),a._memoizedTables={};var d=S(i);o.del.forEach((function(e){d[e]=t[e]})),ei(s,[s.Transaction.prototype]),Jt(s,[s.Transaction.prototype],r(d),d),a.schema=d;var u,p=F(h);return p&&$e(),o=Ce.follow((function(){var e;(u=h(a))&&p&&(e=Ve.bind(null,null),u.then(e,e))})),u&&"function"==typeof u.then?Ce.resolve(u):o.then((function(){return u}))}})),h.push((function(t){var i,n,r=e._cfg.dbschema;i=r,n=t,[].slice.call(n.db.objectStoreNames).forEach((function(e){return null==i[e]&&n.db.deleteObjectStore(e)})),ei(s,[s.Transaction.prototype]),Jt(s,[s.Transaction.prototype],s._storeNames,s._dbSchema),a.schema=s._dbSchema})),h.push((function(t){s.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(s.idbdb.version/10)===e._cfg.version?(s.idbdb.deleteObjectStore("$meta"),delete s._dbSchema.$meta,s._storeNames=s._storeNames.filter((function(e){return"$meta"!==e}))):t.objectStore("$meta").put(e._cfg.version,"version"))}))})),function e(){return h.length?Ce.resolve(h.shift()(a.idbtrans)).then(e):Ce.resolve()}().then((function(){ni(c,l)}))):Ce.resolve();var s,n,a,l,h,c})).catch(a)):(r(n).forEach((function(e){si(i,e,n[e].primKey,n[e].indexes)})),Qt(e,i),void Ce.follow((function(){return e.on.populate.fire(o)})).catch(a));var s,h}))}(e,s/10,c,h))}),h),p.onsuccess=Pe((function(){c=null;var i,a,h,m,f,g=e.idbdb=p.result,v=_(g.objectStoreNames);if(0<v.length)try{var b=g.transaction(1===(m=v).length?m[0]:m,"readonly");if(t.autoSchema)a=g,h=b,(i=e).verno=a.version/10,h=i._dbSchema=oi(0,a,h),i._storeNames=_(a.objectStoreNames,0),Jt(i,[i._allTables],r(h),h);else if(ai(e,e._dbSchema,b),((f=ii(oi(0,(f=e).idbdb,b),f._dbSchema)).add.length||f.change.some((function(e){return e.add.length||e.change.length})))&&!o)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),g.close(),n=g.version+1,o=!0,l(s());Qt(e,b)}catch(i){}et.push(e),g.onversionchange=Pe((function(i){t.vcFired=!0,e.on("versionchange").fire(i)})),g.onclose=Pe((function(t){e.on("close").fire(t)})),d&&(f=e._deps,b=u,g=f.indexedDB,f=f.IDBKeyRange,ui(g)||b===tt||di(g,f).put({name:b}).catch(Y)),l()}),h)})).catch((function(e){switch(null==e?void 0:e.name){case"UnknownError":if(0<t.PR1398_maxLoop)return t.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),s();break;case"VersionError":if(0<n)return n=0,s()}return Ce.reject(e)}))}))]).then((function(){return a(),t.onReadyBeingFired=[],Ce.resolve(pi((function(){return e.on.ready.fire(e.vip)}))).then((function i(){if(0<t.onReadyBeingFired.length){var s=t.onReadyBeingFired.reduce(se,Y);return t.onReadyBeingFired=[],Ce.resolve(pi((function(){return s(e.vip)}))).then(i)}}))})).finally((function(){t.openCanceller===s&&(t.onReadyBeingFired=null,t.isBeingOpened=!1)})).catch((function(i){t.dbOpenError=i;try{c&&c.abort()}catch(i){}return s===t.openCanceller&&e._close(),Xe(i)})).finally((function(){t.openComplete=!0,h()})).then((function(){var t;return d&&(t={},e.tables.forEach((function(i){i.schema.indexes.forEach((function(s){s.name&&(t["idb://".concat(e.name,"/").concat(i.name,"/").concat(s.name)]=new fi(-1/0,[[[]]]))})),t["idb://".concat(e.name,"/").concat(i.name,"/")]=t["idb://".concat(e.name,"/").concat(i.name,"/:dels")]=new fi(-1/0,[[[]]])})),zt(Bt).fire(t),ki(t,!0)),e}))}function Di(e){function t(t){return e.next(t)}var i=n(t),s=n((function(t){return e.throw(t)}));function n(e){return function(t){var n=e(t);return t=n.value,n.done?t:t&&"function"==typeof t.then?t.then(i,s):o(t)?Promise.all(t).then(i,s):i(t)}}return n(t)()}function Ri(e,t,i){for(var s=o(e)?e.slice():[e],n=0;n<i;++n)s.push(t);return s}var Pi={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(e){return t(t({},e),{table:function(i){var s=e.table(i),n=s.schema,r={},o=[];function a(e,i,s){var n=Xt(e),l=r[n]=r[n]||[],h=null==e?0:"string"==typeof e?1:e.length,c=0<i;return c=t(t({},s),{name:c?"".concat(n,"(virtual-from:").concat(s.name,")"):s.name,lowLevelIndex:s,isVirtual:c,keyTail:i,keyLength:h,extractKey:qt(e),unique:!c&&s.unique}),l.push(c),c.isPrimaryKey||o.push(c),1<h&&a(2===h?e[0]:e.slice(0,h-1),i+1,s),l.sort((function(e,t){return e.keyTail-t.keyTail})),c}i=a(n.primaryKey.keyPath,0,n.primaryKey),r[":id"]=[i];for(var l=0,h=n.indexes;l<h.length;l++){var c=h[l];a(c.keyPath,0,c)}function d(i){var s,n=i.query.index;return n.isVirtual?t(t({},i),{query:{index:n.lowLevelIndex,range:(s=i.query.range,n=n.keyTail,{type:1===s.type?2:s.type,lower:Ri(s.lower,s.lowerOpen?e.MAX_KEY:e.MIN_KEY,n),lowerOpen:!0,upper:Ri(s.upper,s.upperOpen?e.MIN_KEY:e.MAX_KEY,n),upperOpen:!0})}}):i}return t(t({},s),{schema:t(t({},n),{primaryKey:i,indexes:o,getIndexByKeyPath:function(e){return(e=r[Xt(e)])&&e[0]}}),count:function(e){return s.count(d(e))},query:function(e){return s.query(d(e))},openCursor:function(t){var i=t.query.index,n=i.keyTail,r=i.isVirtual,o=i.keyLength;return r?s.openCursor(d(t)).then((function(i){return i&&function(i){return Object.create(i,{continue:{value:function(s){null!=s?i.continue(Ri(s,t.reverse?e.MAX_KEY:e.MIN_KEY,n)):t.unique?i.continue(i.key.slice(0,o).concat(t.reverse?e.MIN_KEY:e.MAX_KEY,n)):i.continue()}},continuePrimaryKey:{value:function(t,s){i.continuePrimaryKey(Ri(t,e.MAX_KEY,n),s)}},primaryKey:{get:function(){return i.primaryKey}},key:{get:function(){var e=i.key;return 1===o?e[0]:e.slice(0,o)}},value:{get:function(){return i.value}}})}(i)})):s.openCursor(t)}})}})}};function Li(e,t,i,s){return i=i||{},s=s||"",r(e).forEach((function(n){var r,o,a;c(t,n)?(r=e[n],o=t[n],"object"==typeof r&&"object"==typeof o&&r&&o?(a=D(r))!==D(o)?i[s+n]=t[n]:"Object"===a?Li(r,o,i,s+n+"."):r!==o&&(i[s+n]=t[n]):r!==o&&(i[s+n]=t[n])):i[s+n]=void 0})),r(t).forEach((function(n){c(e,n)||(i[s+n]=t[n])})),i}function Mi(e,t){return"delete"===t.type?t.keys:t.keys||t.values.map(e.extractKey)}var Ni={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(e){return t(t({},e),{table:function(i){var n=e.table(i),r=n.schema.primaryKey;return t(t({},n),{mutate:function(e){var o=_e.trans,a=o.table(i).hook,l=a.deleting,h=a.creating,d=a.updating;switch(e.type){case"add":if(h.fire===Y)break;return o._promise("readwrite",(function(){return u(e)}),!0);case"put":if(h.fire===Y&&d.fire===Y)break;return o._promise("readwrite",(function(){return u(e)}),!0);case"delete":if(l.fire===Y)break;return o._promise("readwrite",(function(){return u(e)}),!0);case"deleteRange":if(l.fire===Y)break;return o._promise("readwrite",(function(){return function e(i,s,o){return n.query({trans:i,values:!1,query:{index:r,range:s},limit:o}).then((function(n){var r=n.result;return u({type:"delete",keys:r,trans:i}).then((function(n){return 0<n.numFailures?Promise.reject(n.failures[0]):r.length<o?{failures:[],numFailures:0,lastResult:void 0}:e(i,t(t({},s),{lower:r[r.length-1],lowerOpen:!0}),o)}))}))}(e.trans,e.range,1e4)}),!0)}return n.mutate(e);function u(e){var i,o,a,u=_e.trans,p=e.keys||Mi(r,e);if(!p)throw new Error("Keys missing");return"delete"!==(e="add"===e.type||"put"===e.type?t(t({},e),{keys:p}):t({},e)).type&&(e.values=s([],e.values,!0)),e.keys&&(e.keys=s([],e.keys,!0)),i=n,a=p,("add"===(o=e).type?Promise.resolve([]):i.getMany({trans:o.trans,keys:a,cache:"immutable"})).then((function(t){var i=p.map((function(i,s){var n,o,a,p=t[s],m={onerror:null,onsuccess:null};return"delete"===e.type?l.fire.call(m,i,p,u):"add"===e.type||void 0===p?(n=h.fire.call(m,i,e.values[s],u),null==i&&null!=n&&(e.keys[s]=i=n,r.outbound||w(e.values[s],r.keyPath,i))):(n=Li(p,e.values[s]),(o=d.fire.call(m,n,i,p,u))&&(a=e.values[s],Object.keys(o).forEach((function(e){c(a,e)?a[e]=o[e]:w(a,e,o[e])})))),m}));return n.mutate(e).then((function(s){for(var n=s.failures,r=s.results,o=s.numFailures,a=(s=s.lastResult,0);a<p.length;++a){var l=(r||p)[a],h=i[a];null==l?h.onerror&&h.onerror(n[a]):h.onsuccess&&h.onsuccess("put"===e.type&&t[a]?e.values[a]:l)}return{failures:n,results:r,numFailures:o,lastResult:s}})).catch((function(e){return i.forEach((function(t){return t.onerror&&t.onerror(e)})),Promise.reject(e)}))}))}}})}})}};function Fi(e,t,i){try{if(!t)return null;if(t.keys.length<e.length)return null;for(var s=[],n=0,r=0;n<t.keys.length&&r<e.length;++n)0===lt(t.keys[n],e[r])&&(s.push(i?I(t.values[n]):t.values[n]),++r);return s.length===e.length?s:null}catch(e){return null}}var Bi={stack:"dbcore",level:-1,create:function(e){return{table:function(i){var s=e.table(i);return t(t({},s),{getMany:function(e){if(!e.cache)return s.getMany(e);var t=Fi(e.keys,e.trans._cache,"clone"===e.cache);return t?Ce.resolve(t):s.getMany(e).then((function(t){return e.trans._cache={keys:e.keys,values:"clone"===e.cache?I(t):t},t}))},mutate:function(e){return"add"!==e.type&&(e.trans._cache=null),s.mutate(e)}})}}}};function Hi(e,t){return"readonly"===e.trans.mode&&!!e.subscr&&!e.trans.explicit&&"disabled"!==e.trans.db._options.cache&&!t.schema.primaryKey.outbound}function zi(e,t){switch(e){case"query":return t.values&&!t.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var $i={stack:"dbcore",level:0,name:"Observability",create:function(e){var i=e.schema.name,s=new fi(e.MIN_KEY,e.MAX_KEY);return t(t({},e),{transaction:function(t,i,s){if(_e.subscr&&"readonly"!==i)throw new G.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(_e.querier));return e.transaction(t,i,s)},table:function(n){var a=e.table(n),l=a.schema,h=l.primaryKey,c=l.indexes,d=h.extractKey,u=h.outbound,p=h.autoIncrement&&c.filter((function(e){return e.compound&&e.keyPath.includes(h.keyPath)})),m=t(t({},a),{mutate:function(t){function r(e){return e="idb://".concat(i,"/").concat(n,"/").concat(e),f[e]||(f[e]=new fi)}var c,d,u,m=t.trans,f=t.mutatedParts||(t.mutatedParts={}),g=r(""),_=r(":dels"),v=t.type,b="deleteRange"===t.type?[t.range]:"delete"===t.type?[t.keys]:t.values.length<50?[Mi(h,t).filter((function(e){return e})),t.values]:[],y=b[0],C=b[1];return b=t.trans._cache,o(y)?(g.addKeys(y),(b="delete"===v||y.length===C.length?Fi(y,b):null)||_.addKeys(y),(b||C)&&(c=r,d=b,u=C,l.indexes.forEach((function(e){var t=c(e.name||"");function i(t){return null!=t?e.extractKey(t):null}function s(i){return e.multiEntry&&o(i)?i.forEach((function(e){return t.addKey(e)})):t.addKey(i)}(d||u).forEach((function(e,t){var n=d&&i(d[t]);0!==lt(n,t=u&&i(u[t]))&&(null!=n&&s(n),null!=t&&s(t))}))})))):y?(C={from:null!==(C=y.lower)&&void 0!==C?C:e.MIN_KEY,to:null!==(C=y.upper)&&void 0!==C?C:e.MAX_KEY},_.add(C),g.add(C)):(g.add(s),_.add(s),l.indexes.forEach((function(e){return r(e.name).add(s)}))),a.mutate(t).then((function(e){return!y||"add"!==t.type&&"put"!==t.type||(g.addKeys(e.results),p&&p.forEach((function(i){var s=t.values.map((function(e){return i.extractKey(e)})),n=i.keyPath.findIndex((function(e){return e===h.keyPath}));e.results.forEach((function(e){return s[n]=e})),r(i.name).addKeys(s)}))),m.mutatedParts=wi(m.mutatedParts||{},f),e}))}}),f=(c=function(t){t=(i=t.query).index;var i=i.range;return[t,new fi(null!==(t=i.lower)&&void 0!==t?t:e.MIN_KEY,null!==(i=i.upper)&&void 0!==i?i:e.MAX_KEY)]},{get:function(e){return[h,new fi(e.key)]},getMany:function(e){return[h,(new fi).addKeys(e.keys)]},count:c,query:c,openCursor:c});return r(f).forEach((function(e){m[e]=function(r){var o=!!(m=_e.subscr),l=Hi(_e,a)&&zi(e,r)?r.obsSet={}:m;if(o){var h=function(e){return e="idb://".concat(i,"/").concat(n,"/").concat(e),l[e]||(l[e]=new fi)},c=h(""),p=h(":dels"),m=(o=(m=f[e](r))[0],m[1]);if(("query"===e&&o.isPrimaryKey&&!r.values?p:h(o.name||"")).add(m),!o.isPrimaryKey){if("count"!==e){var g="query"===e&&u&&r.values&&a.query(t(t({},r),{values:!1}));return a[e].apply(this,arguments).then((function(t){if("query"===e){if(u&&r.values)return g.then((function(e){return e=e.result,c.addKeys(e),t}));var i=r.values?t.result.map(d):t.result;(r.values?c:p).addKeys(i)}else if("openCursor"===e){var s=t,n=r.values;return s&&Object.create(s,{key:{get:function(){return p.addKey(s.primaryKey),s.key}},primaryKey:{get:function(){var e=s.primaryKey;return p.addKey(e),e}},value:{get:function(){return n&&c.addKey(s.primaryKey),s.value}}})}return t}))}p.add(s)}}return a[e].apply(this,arguments)}})),m}})}};function Vi(e,i,s){if(0===s.numFailures)return i;if("deleteRange"===i.type)return null;var n=i.keys?i.keys.length:"values"in i&&i.values?i.values.length:1;return s.numFailures===n?null:(i=t({},i),o(i.keys)&&(i.keys=i.keys.filter((function(e,t){return!(t in s.failures)}))),"values"in i&&o(i.values)&&(i.values=i.values.filter((function(e,t){return!(t in s.failures)}))),i)}function Wi(e,t){return i=e,(void 0===(s=t).lower||(s.lowerOpen?0<lt(i,s.lower):0<=lt(i,s.lower)))&&(void 0===t.upper||(t.upperOpen?lt(e,t.upper)<0:lt(e,t.upper)<=0));var i,s}function Ui(e,t,i,s,n,r){if(!i||0===i.length)return e;var a=t.query.index,l=a.multiEntry,h=t.query.range,c=s.schema.primaryKey.extractKey,d=a.extractKey,u=(a.lowLevelIndex||a).extractKey;return i=i.reduce((function(e,i){var s=e,n=[];if("add"===i.type||"put"===i.type)for(var r=new fi,a=i.values.length-1;0<=a;--a){var u,p=i.values[a],m=c(p);r.hasKey(m)||(u=d(p),(l&&o(u)?u.some((function(e){return Wi(e,h)})):Wi(u,h))&&(r.addKey(m),n.push(p)))}switch(i.type){case"add":var f=(new fi).addKeys(t.values?e.map((function(e){return c(e)})):e);s=e.concat(t.values?n.filter((function(e){return e=c(e),!f.hasKey(e)&&(f.addKey(e),!0)})):n.map((function(e){return c(e)})).filter((function(e){return!f.hasKey(e)&&(f.addKey(e),!0)})));break;case"put":var g=(new fi).addKeys(i.values.map((function(e){return c(e)})));s=e.filter((function(e){return!g.hasKey(t.values?c(e):e)})).concat(t.values?n:n.map((function(e){return c(e)})));break;case"delete":var _=(new fi).addKeys(i.keys);s=e.filter((function(e){return!_.hasKey(t.values?c(e):e)}));break;case"deleteRange":var v=i.range;s=e.filter((function(e){return!Wi(c(e),v)}))}return s}),e),i===e?e:(i.sort((function(e,t){return lt(u(e),u(t))||lt(c(e),c(t))})),t.limit&&t.limit<1/0&&(i.length>t.limit?i.length=t.limit:e.length===t.limit&&i.length<t.limit&&(n.dirty=!0)),r?Object.freeze(i):i)}function ji(e,t){return 0===lt(e.lower,t.lower)&&0===lt(e.upper,t.upper)&&!!e.lowerOpen==!!t.lowerOpen&&!!e.upperOpen==!!t.upperOpen}var Gi={stack:"dbcore",level:0,name:"Cache",create:function(e){var i=e.schema.name;return t(t({},e),{transaction:function(t,s,n){var r,o,a=e.transaction(t,s,n);return"readwrite"===s&&(o=(r=new AbortController).signal,n=function(n){return function(){if(r.abort(),"readwrite"===s){for(var o=new Set,l=0,h=t;l<h.length;l++){var c=h[l],d=Ei["idb://".concat(i,"/").concat(c)];if(d){var u=e.table(c),p=d.optimisticOps.filter((function(e){return e.trans===a}));if(a._explicit&&n&&a.mutatedParts)for(var m=0,f=Object.values(d.queries.query);m<f.length;m++)for(var g=0,_=(y=f[m]).slice();g<_.length;g++)Si((C=_[g]).obsSet,a.mutatedParts)&&(L(y,C),C.subscribers.forEach((function(e){return o.add(e)})));else if(0<p.length){d.optimisticOps=d.optimisticOps.filter((function(e){return e.trans!==a}));for(var v=0,b=Object.values(d.queries.query);v<b.length;v++)for(var y,C,w,S=0,E=(y=b[v]).slice();S<E.length;S++)null!=(C=E[S]).res&&a.mutatedParts&&(n&&!C.dirty?(w=Object.isFrozen(C.res),w=Ui(C.res,C.req,p,u,C,w),C.dirty?(L(y,C),C.subscribers.forEach((function(e){return o.add(e)}))):w!==C.res&&(C.res=w,C.promise=Ce.resolve({result:w}))):(C.dirty&&L(y,C),C.subscribers.forEach((function(e){return o.add(e)}))))}}}o.forEach((function(e){return e()}))}}},a.addEventListener("abort",n(!1),{signal:o}),a.addEventListener("error",n(!1),{signal:o}),a.addEventListener("complete",n(!0),{signal:o})),a},table:function(s){var n=e.table(s),r=n.schema.primaryKey;return t(t({},n),{mutate:function(e){var o=_e.trans;if(r.outbound||"disabled"===o.db._options.cache||o.explicit||"readwrite"!==o.idbtrans.mode)return n.mutate(e);var a=Ei["idb://".concat(i,"/").concat(s)];return a?(o=n.mutate(e),"add"!==e.type&&"put"!==e.type||!(50<=e.values.length||Mi(r,e).some((function(e){return null==e})))?(a.optimisticOps.push(e),e.mutatedParts&&Oi(e.mutatedParts),o.then((function(t){0<t.numFailures&&(L(a.optimisticOps,e),(t=Vi(0,e,t))&&a.optimisticOps.push(t),e.mutatedParts&&Oi(e.mutatedParts))})),o.catch((function(){L(a.optimisticOps,e),e.mutatedParts&&Oi(e.mutatedParts)}))):o.then((function(i){var s=Vi(0,t(t({},e),{values:e.values.map((function(e,s){var n;return i.failures[s]||w(e=null!==(n=r.keyPath)&&void 0!==n&&n.includes(".")?I(e):t({},e),r.keyPath,i.results[s]),e}))}),i);a.optimisticOps.push(s),queueMicrotask((function(){return e.mutatedParts&&Oi(e.mutatedParts)}))})),o):n.mutate(e)},query:function(e){if(!Hi(_e,n)||!zi("query",e))return n.query(e);var t="immutable"===(null===(a=_e.trans)||void 0===a?void 0:a.db._options.cache),r=(h=_e).requery,o=h.signal,a=function(e,t,i,s){var n=Ei["idb://".concat(e,"/").concat(t)];if(!n)return[];if(!(t=n.queries[i]))return[null,!1,n,null];var r=t[(s.query?s.query.index.name:null)||""];if(!r)return[null,!1,n,null];switch(i){case"query":var o=r.find((function(e){return e.req.limit===s.limit&&e.req.values===s.values&&ji(e.req.query.range,s.query.range)}));return o?[o,!0,n,r]:[r.find((function(e){return("limit"in e.req?e.req.limit:1/0)>=s.limit&&(!s.values||e.req.values)&&function(e,t){return function(e,t,i,s){if(void 0===e)return void 0!==t?-1:0;if(void 0===t)return 1;if(0===(t=lt(e,t))){if(i&&s)return 0;if(i)return 1;if(s)return-1}return t}(e.lower,t.lower,e.lowerOpen,t.lowerOpen)<=0&&0<=function(e,t,i,s){if(void 0===e)return void 0!==t?1:0;if(void 0===t)return-1;if(0===(t=lt(e,t))){if(i&&s)return 0;if(i)return-1;if(s)return 1}return t}(e.upper,t.upper,e.upperOpen,t.upperOpen)}(e.req.query.range,s.query.range)})),!1,n,r];case"count":return o=r.find((function(e){return ji(e.req.query.range,s.query.range)})),[o,!!o,n,r]}}(i,s,"query",e),l=a[0],h=a[1],c=a[2],d=a[3];return l&&h?l.obsSet=e.obsSet:(h=n.query(e).then((function(e){var i=e.result;if(l&&(l.res=i),t){for(var s=0,n=i.length;s<n;++s)Object.freeze(i[s]);Object.freeze(i)}else e.result=I(i);return e})).catch((function(e){return d&&l&&L(d,l),Promise.reject(e)})),l={obsSet:e.obsSet,promise:h,subscribers:new Set,type:"query",req:e,dirty:!1},d?d.push(l):(d=[l],(c=c||(Ei["idb://".concat(i,"/").concat(s)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[e.query.index.name||""]=d)),function(e,t,i,s){e.subscribers.add(i),s.addEventListener("abort",(function(){var s,n;e.subscribers.delete(i),0===e.subscribers.size&&(s=e,n=t,setTimeout((function(){0===s.subscribers.size&&L(n,s)}),3e3))}))}(l,d,r,o),l.promise.then((function(i){return{result:Ui(i.result,e,null==c?void 0:c.optimisticOps,n,l,t)}}))}})}})}};function qi(e,t){return new Proxy(e,{get:function(e,i,s){return"db"===i?t:Reflect.get(e,i,s)}})}var Ki=(Yi.prototype.version=function(e){if(isNaN(e)||e<.1)throw new G.Type("Given version is not a positive number");if(e=Math.round(10*e)/10,this.idbdb||this._state.isBeingOpened)throw new G.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);var t=this._versions,i=t.filter((function(t){return t._cfg.version===e}))[0];return i||(i=new this.Version(e),t.push(i),t.sort(ti),i.stores({}),this._state.autoSchema=!1,i)},Yi.prototype._whenReady=function(e){var t=this;return this.idbdb&&(this._state.openComplete||_e.letThrough||this._vip)?e():new Ce((function(e,i){if(t._state.openComplete)return i(new G.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._state.autoOpen)return void i(new G.DatabaseClosed);t.open().catch(Y)}t._state.dbReadyPromise.then(e,i)})).then(e)},Yi.prototype.use=function(e){var t=e.stack,i=e.create,s=e.level,n=e.name;return n&&this.unuse({stack:t,name:n}),(e=this._middlewares[t]||(this._middlewares[t]=[])).push({stack:t,create:i,level:null==s?10:s,name:n}),e.sort((function(e,t){return e.level-t.level})),this},Yi.prototype.unuse=function(e){var t=e.stack,i=e.name,s=e.create;return t&&this._middlewares[t]&&(this._middlewares[t]=this._middlewares[t].filter((function(e){return s?e.create!==s:!!i&&e.name!==i}))),this},Yi.prototype.open=function(){var e=this;return qe(ge,(function(){return Ai(e)}))},Yi.prototype._close=function(){var e=this._state,t=et.indexOf(this);if(0<=t&&et.splice(t,1),this.idbdb){try{this.idbdb.close()}catch(t){}this.idbdb=null}e.isBeingOpened||(e.dbReadyPromise=new Ce((function(t){e.dbReadyResolve=t})),e.openCanceller=new Ce((function(t,i){e.cancelOpen=i})))},Yi.prototype.close=function(e){var t=(void 0===e?{disableAutoOpen:!0}:e).disableAutoOpen;e=this._state,t?(e.isBeingOpened&&e.cancelOpen(new G.DatabaseClosed),this._close(),e.autoOpen=!1,e.dbOpenError=new G.DatabaseClosed):(this._close(),e.autoOpen=this._options.autoOpen||e.isBeingOpened,e.openComplete=!1,e.dbOpenError=null)},Yi.prototype.delete=function(e){var t=this;void 0===e&&(e={disableAutoOpen:!0});var i=0<arguments.length&&"object"!=typeof arguments[0],s=this._state;return new Ce((function(n,r){function o(){t.close(e);var i=t._deps.indexedDB.deleteDatabase(t.name);i.onsuccess=Pe((function(){var e,i,s;e=t._deps,i=t.name,s=e.indexedDB,e=e.IDBKeyRange,ui(s)||i===tt||di(s,e).delete(i).catch(Y),n()})),i.onerror=Nt(r),i.onblocked=t._fireOnBlocked}if(i)throw new G.InvalidArgument("Invalid closeOptions argument to db.delete()");s.isBeingOpened?s.dbReadyPromise.then(o):o()}))},Yi.prototype.backendDB=function(){return this.idbdb},Yi.prototype.isOpen=function(){return null!==this.idbdb},Yi.prototype.hasBeenClosed=function(){var e=this._state.dbOpenError;return e&&"DatabaseClosed"===e.name},Yi.prototype.hasFailed=function(){return null!==this._state.dbOpenError},Yi.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(Yi.prototype,"tables",{get:function(){var e=this;return r(this._allTables).map((function(t){return e._allTables[t]}))},enumerable:!1,configurable:!0}),Yi.prototype.transaction=function(){var e=function(e,t,i){var s=arguments.length;if(s<2)throw new G.InvalidArgument("Too few arguments");for(var n=new Array(s-1);--s;)n[s-1]=arguments[s];return i=n.pop(),[e,x(n),i]}.apply(this,arguments);return this._transaction.apply(this,e)},Yi.prototype._transaction=function(e,t,i){var s=this,n=_e.trans;n&&n.db===this&&-1===e.indexOf("!")||(n=null);var r,o,a=-1!==e.indexOf("?");e=e.replace("!","").replace("?","");try{if(o=t.map((function(e){if("string"!=typeof(e=e instanceof s.Table?e.name:e))throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return e})),"r"==e||e===it)r=it;else{if("rw"!=e&&e!=st)throw new G.InvalidArgument("Invalid transaction mode: "+e);r=st}if(n){if(n.mode===it&&r===st){if(!a)throw new G.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");n=null}n&&o.forEach((function(e){if(n&&-1===n.storeNames.indexOf(e)){if(!a)throw new G.SubTransaction("Table "+e+" not included in parent transaction.");n=null}})),a&&n&&!n.active&&(n=null)}}catch(i){return n?n._promise(null,(function(e,t){t(i)})):Xe(i)}var l=function e(t,i,s,n,r){return Ce.resolve().then((function(){var o=_e.transless||_e,a=t._createTransaction(i,s,t._dbSchema,n);if(a.explicit=!0,o={trans:a,transless:o},n)a.idbtrans=n.idbtrans;else try{a.create(),a.idbtrans._explicit=!0,t._state.PR1398_maxLoop=3}catch(o){return o.name===U.InvalidState&&t.isOpen()&&0<--t._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),t.close({disableAutoOpen:!1}),t.open().then((function(){return e(t,i,s,null,r)}))):Xe(o)}var l,h=F(r);return h&&$e(),o=Ce.follow((function(){var e;(l=r.call(a,a))&&(h?(e=Ve.bind(null,null),l.then(e,e)):"function"==typeof l.next&&"function"==typeof l.throw&&(l=Di(l)))}),o),(l&&"function"==typeof l.then?Ce.resolve(l).then((function(e){return a.active?e:Xe(new G.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))})):o.then((function(){return l}))).then((function(e){return n&&a._resolve(),a._completion.then((function(){return e}))})).catch((function(e){return a._reject(e),Xe(e)}))}))}.bind(null,this,r,o,n,i);return n?n._promise(r,l,"lock"):_e.trans?qe(_e.transless,(function(){return s._whenReady(l)})):this._whenReady(l)},Yi.prototype.table=function(e){if(!c(this._allTables,e))throw new G.InvalidTable("Table ".concat(e," does not exist"));return this._allTables[e]},Yi);function Yi(e,i){var s=this;this._middlewares={},this.verno=0;var n=Yi.dependencies;this._options=i=t({addons:Yi.addons,autoOpen:!0,indexedDB:n.indexedDB,IDBKeyRange:n.IDBKeyRange,cache:"cloned"},i),this._deps={indexedDB:i.indexedDB,IDBKeyRange:i.IDBKeyRange},n=i.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var r,o,a,l,h,c={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:Y,dbReadyPromise:null,cancelOpen:Y,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:i.autoOpen};c.dbReadyPromise=new Ce((function(e){c.dbReadyResolve=e})),c.openCanceller=new Ce((function(e,t){c.cancelOpen=t})),this._state=c,this.name=e,this.on=pt(this,"populate","blocked","versionchange","close",{ready:[se,Y]}),this.on.ready.subscribe=v(this.on.ready.subscribe,(function(e){return function(t,i){Yi.vip((function(){var n,r=s._state;r.openComplete?(r.dbOpenError||Ce.resolve().then(t),i&&e(t)):r.onReadyBeingFired?(r.onReadyBeingFired.push(t),i&&e(t)):(e(t),n=s,i||e((function e(){n.on.ready.unsubscribe(t),n.on.ready.unsubscribe(e)})))}))}})),this.Collection=(r=this,mt(Et.prototype,(function(e,t){this.db=r;var i=rt,s=null;if(t)try{i=t()}catch(e){s=e}var n=e._ctx;e=(t=n.table).hook.reading.fire,this._ctx={table:t,index:n.index,isPrimKey:!n.index||t.schema.primKey.keyPath&&n.index===t.schema.primKey.name,range:i,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:s,or:n.or,valueMapper:e!==X?e:null}}))),this.Table=(o=this,mt(dt.prototype,(function(e,t,i){this.db=o,this._tx=i,this.name=e,this.schema=t,this.hook=o._allTables[e]?o._allTables[e].hook:pt(null,{creating:[J,Y],reading:[Z,X],updating:[te,Y],deleting:[ee,Y]})}))),this.Transaction=(a=this,mt($t.prototype,(function(e,t,i,s,n){var r=this;this.db=a,this.mode=e,this.storeNames=t,this.schema=i,this.chromeTransactionDurability=s,this.idbtrans=null,this.on=pt(this,"complete","error","abort"),this.parent=n||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new Ce((function(e,t){r._resolve=e,r._reject=t})),this._completion.then((function(){r.active=!1,r.on.complete.fire()}),(function(e){var t=r.active;return r.active=!1,r.on.error.fire(e),r.parent?r.parent._reject(e):t&&r.idbtrans&&r.idbtrans.abort(),Xe(e)}))}))),this.Version=(l=this,mt(hi.prototype,(function(e){this.db=l,this._cfg={version:e,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}}))),this.WhereClause=(h=this,mt(Lt.prototype,(function(e,t,i){if(this.db=h,this._ctx={table:e,index:":id"===t?null:t,or:i},this._cmp=this._ascending=lt,this._descending=function(e,t){return lt(t,e)},this._max=function(e,t){return 0<lt(e,t)?e:t},this._min=function(e,t){return lt(e,t)<0?e:t},this._IDBKeyRange=h._deps.IDBKeyRange,!this._IDBKeyRange)throw new G.MissingAPI}))),this.on("versionchange",(function(e){0<e.newVersion?console.warn("Another connection wants to upgrade database '".concat(s.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(s.name,"'. Closing db now to resume the delete request.")),s.close({disableAutoOpen:!1})})),this.on("blocked",(function(e){!e.newVersion||e.newVersion<e.oldVersion?console.warn("Dexie.delete('".concat(s.name,"') was blocked")):console.warn("Upgrade '".concat(s.name,"' blocked by other connection holding version ").concat(e.oldVersion/10))})),this._maxKey=Gt(i.IDBKeyRange),this._createTransaction=function(e,t,i,n){return new s.Transaction(e,t,i,s._options.chromeTransactionDurability,n)},this._fireOnBlocked=function(e){s.on("blocked").fire(e),et.filter((function(e){return e.name===s.name&&e!==s&&!e._state.vcFired})).map((function(t){return t.on("versionchange").fire(e)}))},this.use(Bi),this.use(Gi),this.use($i),this.use(Pi),this.use(Ni);var d=new Proxy(this,{get:function(e,t,i){if("_vip"===t)return!0;if("table"===t)return function(e){return qi(s.table(e),d)};var n=Reflect.get(e,t,i);return n instanceof dt?qi(n,d):"tables"===t?n.map((function(e){return qi(e,d)})):"_createTransaction"===t?function(){return qi(n.apply(this,arguments),d)}:n}});this.vip=d,n.forEach((function(e){return e(s)}))}B="undefined"!=typeof Symbol&&"observable"in Symbol?Symbol.observable:"@@observable";var Xi,Zi=(Qi.prototype.subscribe=function(e,t,i){return this._subscribe(e&&"function"!=typeof e?e:{next:e,error:t,complete:i})},Qi.prototype[B]=function(){return this},Qi);function Qi(e){this._subscribe=e}try{Xi={indexedDB:n.indexedDB||n.mozIndexedDB||n.webkitIndexedDB||n.msIndexedDB,IDBKeyRange:n.IDBKeyRange||n.webkitIDBKeyRange}}catch(T){Xi={indexedDB:null,IDBKeyRange:null}}function Ji(e){var t,i=!1,s=new Zi((function(s){var n,r=F(e),o=!1,a={},l={},h={get closed(){return o},unsubscribe:function(){o||(o=!0,n&&n.abort(),d&&zt.storagemutated.unsubscribe(p))}};s.start&&s.start(h);var d=!1,u=function(){return Ye(m)},p=function(e){wi(a,e),Si(l,a)&&u()},m=function(){var h,m,f;!o&&Xi.indexedDB&&(a={},h={},n&&n.abort(),n=new AbortController,f=function(t){var i=Ie();try{r&&$e();var s=ze(e,t);return s=r?s.finally(Ve):s}finally{i&&Ae()}}(m={subscr:h,signal:n.signal,requery:u,querier:e,trans:null}),Promise.resolve(f).then((function(e){i=!0,t=e,o||m.signal.aborted||(a={},function(e){for(var t in e)if(c(e,t))return;return 1}(l=h)||d||(zt(Bt,p),d=!0),Ye((function(){return!o&&s.next&&s.next(e)})))}),(function(e){i=!1,["DatabaseClosedError","AbortError"].includes(null==e?void 0:e.name)||o||Ye((function(){o||s.error&&s.error(e)}))})))};return setTimeout(u,0),h}));return s.hasValue=function(){return i},s.getValue=function(){return t},s}var es=Ki;function ts(e){var t=ss;try{ss=!0,zt.storagemutated.fire(e),ki(e,!0)}finally{ss=t}}d(es,t(t({},K),{delete:function(e){return new es(e,{addons:[]}).delete()},exists:function(e){return new es(e,{addons:[]}).open().then((function(e){return e.close(),!0})).catch("NoSuchDatabaseError",(function(){return!1}))},getDatabaseNames:function(e){try{return i=(t=es.dependencies).indexedDB,t=t.IDBKeyRange,(ui(i)?Promise.resolve(i.databases()).then((function(e){return e.map((function(e){return e.name})).filter((function(e){return e!==tt}))})):di(i,t).toCollection().primaryKeys()).then(e)}catch(e){return Xe(new G.MissingAPI)}var t,i},defineClass:function(){return function(e){a(this,e)}},ignoreTransaction:function(e){return _e.trans?qe(_e.transless,e):e()},vip:pi,async:function(e){return function(){try{var t=Di(e.apply(this,arguments));return t&&"function"==typeof t.then?t:Ce.resolve(t)}catch(t){return Xe(t)}}},spawn:function(e,t,i){try{var s=Di(e.apply(i,t||[]));return s&&"function"==typeof s.then?s:Ce.resolve(s)}catch(e){return Xe(e)}},currentTransaction:{get:function(){return _e.trans||null}},waitFor:function(e,t){return t=Ce.resolve("function"==typeof e?es.ignoreTransaction(e):e).timeout(t||6e4),_e.trans?_e.trans.waitFor(t):t},Promise:Ce,debug:{get:function(){return ne},set:function(e){re(e)}},derive:m,extend:a,props:d,override:v,Events:pt,on:zt,liveQuery:Ji,extendObservabilitySet:wi,getByKeyPath:C,setByKeyPath:w,delByKeyPath:function(e,t){"string"==typeof t?w(e,t,void 0):"length"in t&&[].map.call(t,(function(t){w(e,t,void 0)}))},shallowClone:S,deepClone:I,getObjectDiff:Li,cmp:lt,asap:y,minKey:-1/0,addons:[],connections:et,errnames:U,dependencies:Xi,cache:Ei,semVer:"4.0.9",version:"4.0.9".split(".").map((function(e){return parseInt(e)})).reduce((function(e,t,i){return e+t/Math.pow(10,2*i)}))})),es.maxKey=Gt(es.dependencies.IDBKeyRange),"undefined"!=typeof dispatchEvent&&"undefined"!=typeof addEventListener&&(zt(Bt,(function(e){ss||(e=new CustomEvent(Ht,{detail:e}),ss=!0,dispatchEvent(e),ss=!1)})),addEventListener(Ht,(function(e){e=e.detail,ss||ts(e)})));var is,ss=!1,ns=function(){};return"undefined"!=typeof BroadcastChannel&&((ns=function(){(is=new BroadcastChannel(Ht)).onmessage=function(e){return e.data&&ts(e.data)}})(),"function"==typeof is.unref&&is.unref(),zt(Bt,(function(e){ss||is.postMessage(e)}))),"undefined"!=typeof addEventListener&&(addEventListener("pagehide",(function(e){if(!Ki.disableBfCache&&e.persisted){ne&&console.debug("Dexie: handling persisted pagehide"),null!=is&&is.close();for(var t=0,i=et;t<i.length;t++)i[t].close({disableAutoOpen:!1})}})),addEventListener("pageshow",(function(e){!Ki.disableBfCache&&e.persisted&&(ne&&console.debug("Dexie: handling persisted pageshow"),ns(),ts({all:new fi(-1/0,[[]])}))}))),Ce.rejectionMapper=function(e,t){return!e||e instanceof z||e instanceof TypeError||e instanceof SyntaxError||!e.name||!q[e.name]?e:(t=new q[e.name](t||e.message,e),"stack"in e&&p(t,"stack",{get:function(){return this.inner.stack}}),t)},re(ne),t(Ki,Object.freeze({__proto__:null,Dexie:Ki,liveQuery:Ji,Entity:at,cmp:lt,PropModSymbol:T,PropModification:wt,replacePrefix:function(e,t){return new wt({replacePrefix:[e,t]})},add:function(e){return new wt({add:e})},remove:function(e){return new wt({remove:e})},default:Ki,RangeSet:fi,mergeRanges:_i,rangesOverlap:vi}),{default:Ki}),Ki}()},189:e=>{var t=function(){this.Diff_Timeout=1,this.Diff_EditCost=4,this.Match_Threshold=.5,this.Match_Distance=1e3,this.Patch_DeleteThreshold=.5,this.Patch_Margin=4,this.Match_MaxBits=32},i=-1;t.Diff=function(e,t){return[e,t]},t.prototype.diff_main=function(e,i,s,n){void 0===n&&(n=this.Diff_Timeout<=0?Number.MAX_VALUE:(new Date).getTime()+1e3*this.Diff_Timeout);var r=n;if(null==e||null==i)throw new Error("Null input. (diff_main)");if(e==i)return e?[new t.Diff(0,e)]:[];void 0===s&&(s=!0);var o=s,a=this.diff_commonPrefix(e,i),l=e.substring(0,a);e=e.substring(a),i=i.substring(a),a=this.diff_commonSuffix(e,i);var h=e.substring(e.length-a);e=e.substring(0,e.length-a),i=i.substring(0,i.length-a);var c=this.diff_compute_(e,i,o,r);return l&&c.unshift(new t.Diff(0,l)),h&&c.push(new t.Diff(0,h)),this.diff_cleanupMerge(c),c},t.prototype.diff_compute_=function(e,s,n,r){var o;if(!e)return[new t.Diff(1,s)];if(!s)return[new t.Diff(i,e)];var a=e.length>s.length?e:s,l=e.length>s.length?s:e,h=a.indexOf(l);if(-1!=h)return o=[new t.Diff(1,a.substring(0,h)),new t.Diff(0,l),new t.Diff(1,a.substring(h+l.length))],e.length>s.length&&(o[0][0]=o[2][0]=i),o;if(1==l.length)return[new t.Diff(i,e),new t.Diff(1,s)];var c=this.diff_halfMatch_(e,s);if(c){var d=c[0],u=c[1],p=c[2],m=c[3],f=c[4],g=this.diff_main(d,p,n,r),_=this.diff_main(u,m,n,r);return g.concat([new t.Diff(0,f)],_)}return n&&e.length>100&&s.length>100?this.diff_lineMode_(e,s,r):this.diff_bisect_(e,s,r)},t.prototype.diff_lineMode_=function(e,s,n){var r=this.diff_linesToChars_(e,s);e=r.chars1,s=r.chars2;var o=r.lineArray,a=this.diff_main(e,s,!1,n);this.diff_charsToLines_(a,o),this.diff_cleanupSemantic(a),a.push(new t.Diff(0,""));for(var l=0,h=0,c=0,d="",u="";l<a.length;){switch(a[l][0]){case 1:c++,u+=a[l][1];break;case i:h++,d+=a[l][1];break;case 0:if(h>=1&&c>=1){a.splice(l-h-c,h+c),l=l-h-c;for(var p=this.diff_main(d,u,!1,n),m=p.length-1;m>=0;m--)a.splice(l,0,p[m]);l+=p.length}c=0,h=0,d="",u=""}l++}return a.pop(),a},t.prototype.diff_bisect_=function(e,s,n){for(var r=e.length,o=s.length,a=Math.ceil((r+o)/2),l=a,h=2*a,c=new Array(h),d=new Array(h),u=0;u<h;u++)c[u]=-1,d[u]=-1;c[l+1]=0,d[l+1]=0;for(var p=r-o,m=p%2!=0,f=0,g=0,_=0,v=0,b=0;b<a&&!((new Date).getTime()>n);b++){for(var y=-b+f;y<=b-g;y+=2){for(var C=l+y,w=(O=y==-b||y!=b&&c[C-1]<c[C+1]?c[C+1]:c[C-1]+1)-y;O<r&&w<o&&e.charAt(O)==s.charAt(w);)O++,w++;if(c[C]=O,O>r)g+=2;else if(w>o)f+=2;else if(m&&(x=l+p-y)>=0&&x<h&&-1!=d[x]&&O>=(E=r-d[x]))return this.diff_bisectSplit_(e,s,O,w,n)}for(var S=-b+_;S<=b-v;S+=2){for(var E,x=l+S,T=(E=S==-b||S!=b&&d[x-1]<d[x+1]?d[x+1]:d[x-1]+1)-S;E<r&&T<o&&e.charAt(r-E-1)==s.charAt(o-T-1);)E++,T++;if(d[x]=E,E>r)v+=2;else if(T>o)_+=2;else if(!m){var O;if((C=l+p-S)>=0&&C<h&&-1!=c[C])if(w=l+(O=c[C])-C,O>=(E=r-E))return this.diff_bisectSplit_(e,s,O,w,n)}}}return[new t.Diff(i,e),new t.Diff(1,s)]},t.prototype.diff_bisectSplit_=function(e,t,i,s,n){var r=e.substring(0,i),o=t.substring(0,s),a=e.substring(i),l=t.substring(s),h=this.diff_main(r,o,!1,n),c=this.diff_main(a,l,!1,n);return h.concat(c)},t.prototype.diff_linesToChars_=function(e,t){var i=[],s={};function n(e){for(var t="",n=0,o=-1,a=i.length;o<e.length-1;){-1==(o=e.indexOf("\n",n))&&(o=e.length-1);var l=e.substring(n,o+1);(s.hasOwnProperty?s.hasOwnProperty(l):void 0!==s[l])?t+=String.fromCharCode(s[l]):(a==r&&(l=e.substring(n),o=e.length),t+=String.fromCharCode(a),s[l]=a,i[a++]=l),n=o+1}return t}i[0]="";var r=4e4,o=n(e);return r=65535,{chars1:o,chars2:n(t),lineArray:i}},t.prototype.diff_charsToLines_=function(e,t){for(var i=0;i<e.length;i++){for(var s=e[i][1],n=[],r=0;r<s.length;r++)n[r]=t[s.charCodeAt(r)];e[i][1]=n.join("")}},t.prototype.diff_commonPrefix=function(e,t){if(!e||!t||e.charAt(0)!=t.charAt(0))return 0;for(var i=0,s=Math.min(e.length,t.length),n=s,r=0;i<n;)e.substring(r,n)==t.substring(r,n)?r=i=n:s=n,n=Math.floor((s-i)/2+i);return n},t.prototype.diff_commonSuffix=function(e,t){if(!e||!t||e.charAt(e.length-1)!=t.charAt(t.length-1))return 0;for(var i=0,s=Math.min(e.length,t.length),n=s,r=0;i<n;)e.substring(e.length-n,e.length-r)==t.substring(t.length-n,t.length-r)?r=i=n:s=n,n=Math.floor((s-i)/2+i);return n},t.prototype.diff_commonOverlap_=function(e,t){var i=e.length,s=t.length;if(0==i||0==s)return 0;i>s?e=e.substring(i-s):i<s&&(t=t.substring(0,i));var n=Math.min(i,s);if(e==t)return n;for(var r=0,o=1;;){var a=e.substring(n-o),l=t.indexOf(a);if(-1==l)return r;o+=l,0!=l&&e.substring(n-o)!=t.substring(0,o)||(r=o,o++)}},t.prototype.diff_halfMatch_=function(e,t){if(this.Diff_Timeout<=0)return null;var i=e.length>t.length?e:t,s=e.length>t.length?t:e;if(i.length<4||2*s.length<i.length)return null;var n=this;function r(e,t,i){for(var s,r,o,a,l=e.substring(i,i+Math.floor(e.length/4)),h=-1,c="";-1!=(h=t.indexOf(l,h+1));){var d=n.diff_commonPrefix(e.substring(i),t.substring(h)),u=n.diff_commonSuffix(e.substring(0,i),t.substring(0,h));c.length<u+d&&(c=t.substring(h-u,h)+t.substring(h,h+d),s=e.substring(0,i-u),r=e.substring(i+d),o=t.substring(0,h-u),a=t.substring(h+d))}return 2*c.length>=e.length?[s,r,o,a,c]:null}var o,a,l,h,c,d=r(i,s,Math.ceil(i.length/4)),u=r(i,s,Math.ceil(i.length/2));return d||u?(o=u?d&&d[4].length>u[4].length?d:u:d,e.length>t.length?(a=o[0],l=o[1],h=o[2],c=o[3]):(h=o[0],c=o[1],a=o[2],l=o[3]),[a,l,h,c,o[4]]):null},t.prototype.diff_cleanupSemantic=function(e){for(var s=!1,n=[],r=0,o=null,a=0,l=0,h=0,c=0,d=0;a<e.length;)0==e[a][0]?(n[r++]=a,l=c,h=d,c=0,d=0,o=e[a][1]):(1==e[a][0]?c+=e[a][1].length:d+=e[a][1].length,o&&o.length<=Math.max(l,h)&&o.length<=Math.max(c,d)&&(e.splice(n[r-1],0,new t.Diff(i,o)),e[n[r-1]+1][0]=1,r--,a=--r>0?n[r-1]:-1,l=0,h=0,c=0,d=0,o=null,s=!0)),a++;for(s&&this.diff_cleanupMerge(e),this.diff_cleanupSemanticLossless(e),a=1;a<e.length;){if(e[a-1][0]==i&&1==e[a][0]){var u=e[a-1][1],p=e[a][1],m=this.diff_commonOverlap_(u,p),f=this.diff_commonOverlap_(p,u);m>=f?(m>=u.length/2||m>=p.length/2)&&(e.splice(a,0,new t.Diff(0,p.substring(0,m))),e[a-1][1]=u.substring(0,u.length-m),e[a+1][1]=p.substring(m),a++):(f>=u.length/2||f>=p.length/2)&&(e.splice(a,0,new t.Diff(0,u.substring(0,f))),e[a-1][0]=1,e[a-1][1]=p.substring(0,p.length-f),e[a+1][0]=i,e[a+1][1]=u.substring(f),a++),a++}a++}},t.prototype.diff_cleanupSemanticLossless=function(e){function i(e,i){if(!e||!i)return 6;var s=e.charAt(e.length-1),n=i.charAt(0),r=s.match(t.nonAlphaNumericRegex_),o=n.match(t.nonAlphaNumericRegex_),a=r&&s.match(t.whitespaceRegex_),l=o&&n.match(t.whitespaceRegex_),h=a&&s.match(t.linebreakRegex_),c=l&&n.match(t.linebreakRegex_),d=h&&e.match(t.blanklineEndRegex_),u=c&&i.match(t.blanklineStartRegex_);return d||u?5:h||c?4:r&&!a&&l?3:a||l?2:r||o?1:0}for(var s=1;s<e.length-1;){if(0==e[s-1][0]&&0==e[s+1][0]){var n=e[s-1][1],r=e[s][1],o=e[s+1][1],a=this.diff_commonSuffix(n,r);if(a){var l=r.substring(r.length-a);n=n.substring(0,n.length-a),r=l+r.substring(0,r.length-a),o=l+o}for(var h=n,c=r,d=o,u=i(n,r)+i(r,o);r.charAt(0)===o.charAt(0);){n+=r.charAt(0),r=r.substring(1)+o.charAt(0),o=o.substring(1);var p=i(n,r)+i(r,o);p>=u&&(u=p,h=n,c=r,d=o)}e[s-1][1]!=h&&(h?e[s-1][1]=h:(e.splice(s-1,1),s--),e[s][1]=c,d?e[s+1][1]=d:(e.splice(s+1,1),s--))}s++}},t.nonAlphaNumericRegex_=/[^a-zA-Z0-9]/,t.whitespaceRegex_=/\s/,t.linebreakRegex_=/[\r\n]/,t.blanklineEndRegex_=/\n\r?\n$/,t.blanklineStartRegex_=/^\r?\n\r?\n/,t.prototype.diff_cleanupEfficiency=function(e){for(var s=!1,n=[],r=0,o=null,a=0,l=!1,h=!1,c=!1,d=!1;a<e.length;)0==e[a][0]?(e[a][1].length<this.Diff_EditCost&&(c||d)?(n[r++]=a,l=c,h=d,o=e[a][1]):(r=0,o=null),c=d=!1):(e[a][0]==i?d=!0:c=!0,o&&(l&&h&&c&&d||o.length<this.Diff_EditCost/2&&l+h+c+d==3)&&(e.splice(n[r-1],0,new t.Diff(i,o)),e[n[r-1]+1][0]=1,r--,o=null,l&&h?(c=d=!0,r=0):(a=--r>0?n[r-1]:-1,c=d=!1),s=!0)),a++;s&&this.diff_cleanupMerge(e)},t.prototype.diff_cleanupMerge=function(e){e.push(new t.Diff(0,""));for(var s,n=0,r=0,o=0,a="",l="";n<e.length;)switch(e[n][0]){case 1:o++,l+=e[n][1],n++;break;case i:r++,a+=e[n][1],n++;break;case 0:r+o>1?(0!==r&&0!==o&&(0!==(s=this.diff_commonPrefix(l,a))&&(n-r-o>0&&0==e[n-r-o-1][0]?e[n-r-o-1][1]+=l.substring(0,s):(e.splice(0,0,new t.Diff(0,l.substring(0,s))),n++),l=l.substring(s),a=a.substring(s)),0!==(s=this.diff_commonSuffix(l,a))&&(e[n][1]=l.substring(l.length-s)+e[n][1],l=l.substring(0,l.length-s),a=a.substring(0,a.length-s))),n-=r+o,e.splice(n,r+o),a.length&&(e.splice(n,0,new t.Diff(i,a)),n++),l.length&&(e.splice(n,0,new t.Diff(1,l)),n++),n++):0!==n&&0==e[n-1][0]?(e[n-1][1]+=e[n][1],e.splice(n,1)):n++,o=0,r=0,a="",l=""}""===e[e.length-1][1]&&e.pop();var h=!1;for(n=1;n<e.length-1;)0==e[n-1][0]&&0==e[n+1][0]&&(e[n][1].substring(e[n][1].length-e[n-1][1].length)==e[n-1][1]?(e[n][1]=e[n-1][1]+e[n][1].substring(0,e[n][1].length-e[n-1][1].length),e[n+1][1]=e[n-1][1]+e[n+1][1],e.splice(n-1,1),h=!0):e[n][1].substring(0,e[n+1][1].length)==e[n+1][1]&&(e[n-1][1]+=e[n+1][1],e[n][1]=e[n][1].substring(e[n+1][1].length)+e[n+1][1],e.splice(n+1,1),h=!0)),n++;h&&this.diff_cleanupMerge(e)},t.prototype.diff_xIndex=function(e,t){var s,n=0,r=0,o=0,a=0;for(s=0;s<e.length&&(1!==e[s][0]&&(n+=e[s][1].length),e[s][0]!==i&&(r+=e[s][1].length),!(n>t));s++)o=n,a=r;return e.length!=s&&e[s][0]===i?a:a+(t-o)},t.prototype.diff_prettyHtml=function(e){for(var t=[],s=/&/g,n=/</g,r=/>/g,o=/\n/g,a=0;a<e.length;a++){var l=e[a][0],h=e[a][1].replace(s,"&amp;").replace(n,"&lt;").replace(r,"&gt;").replace(o,"&para;<br>");switch(l){case 1:t[a]='<ins style="background:#e6ffe6;">'+h+"</ins>";break;case i:t[a]='<del style="background:#ffe6e6;">'+h+"</del>";break;case 0:t[a]="<span>"+h+"</span>"}}return t.join("")},t.prototype.diff_text1=function(e){for(var t=[],i=0;i<e.length;i++)1!==e[i][0]&&(t[i]=e[i][1]);return t.join("")},t.prototype.diff_text2=function(e){for(var t=[],s=0;s<e.length;s++)e[s][0]!==i&&(t[s]=e[s][1]);return t.join("")},t.prototype.diff_levenshtein=function(e){for(var t=0,s=0,n=0,r=0;r<e.length;r++){var o=e[r][0],a=e[r][1];switch(o){case 1:s+=a.length;break;case i:n+=a.length;break;case 0:t+=Math.max(s,n),s=0,n=0}}return t+Math.max(s,n)},t.prototype.diff_toDelta=function(e){for(var t=[],s=0;s<e.length;s++)switch(e[s][0]){case 1:t[s]="+"+encodeURI(e[s][1]);break;case i:t[s]="-"+e[s][1].length;break;case 0:t[s]="="+e[s][1].length}return t.join("\t").replace(/%20/g," ")},t.prototype.diff_fromDelta=function(e,s){for(var n=[],r=0,o=0,a=s.split(/\t/g),l=0;l<a.length;l++){var h=a[l].substring(1);switch(a[l].charAt(0)){case"+":try{n[r++]=new t.Diff(1,decodeURI(h))}catch(e){throw new Error("Illegal escape in diff_fromDelta: "+h)}break;case"-":case"=":var c=parseInt(h,10);if(isNaN(c)||c<0)throw new Error("Invalid number in diff_fromDelta: "+h);var d=e.substring(o,o+=c);"="==a[l].charAt(0)?n[r++]=new t.Diff(0,d):n[r++]=new t.Diff(i,d);break;default:if(a[l])throw new Error("Invalid diff operation in diff_fromDelta: "+a[l])}}if(o!=e.length)throw new Error("Delta length ("+o+") does not equal source text length ("+e.length+").");return n},t.prototype.match_main=function(e,t,i){if(null==e||null==t||null==i)throw new Error("Null input. (match_main)");return i=Math.max(0,Math.min(i,e.length)),e==t?0:e.length?e.substring(i,i+t.length)==t?i:this.match_bitap_(e,t,i):-1},t.prototype.match_bitap_=function(e,t,i){if(t.length>this.Match_MaxBits)throw new Error("Pattern too long for this browser.");var s=this.match_alphabet_(t),n=this;function r(e,s){var r=e/t.length,o=Math.abs(i-s);return n.Match_Distance?r+o/n.Match_Distance:o?1:r}var o=this.Match_Threshold,a=e.indexOf(t,i);-1!=a&&(o=Math.min(r(0,a),o),-1!=(a=e.lastIndexOf(t,i+t.length))&&(o=Math.min(r(0,a),o)));var l,h,c=1<<t.length-1;a=-1;for(var d,u=t.length+e.length,p=0;p<t.length;p++){for(l=0,h=u;l<h;)r(p,i+h)<=o?l=h:u=h,h=Math.floor((u-l)/2+l);u=h;var m=Math.max(1,i-h+1),f=Math.min(i+h,e.length)+t.length,g=Array(f+2);g[f+1]=(1<<p)-1;for(var _=f;_>=m;_--){var v=s[e.charAt(_-1)];if(g[_]=0===p?(g[_+1]<<1|1)&v:(g[_+1]<<1|1)&v|(d[_+1]|d[_])<<1|1|d[_+1],g[_]&c){var b=r(p,_-1);if(b<=o){if(o=b,!((a=_-1)>i))break;m=Math.max(1,2*i-a)}}}if(r(p+1,i)>o)break;d=g}return a},t.prototype.match_alphabet_=function(e){for(var t={},i=0;i<e.length;i++)t[e.charAt(i)]=0;for(i=0;i<e.length;i++)t[e.charAt(i)]|=1<<e.length-i-1;return t},t.prototype.patch_addContext_=function(e,i){if(0!=i.length){if(null===e.start2)throw Error("patch not initialized");for(var s=i.substring(e.start2,e.start2+e.length1),n=0;i.indexOf(s)!=i.lastIndexOf(s)&&s.length<this.Match_MaxBits-this.Patch_Margin-this.Patch_Margin;)n+=this.Patch_Margin,s=i.substring(e.start2-n,e.start2+e.length1+n);n+=this.Patch_Margin;var r=i.substring(e.start2-n,e.start2);r&&e.diffs.unshift(new t.Diff(0,r));var o=i.substring(e.start2+e.length1,e.start2+e.length1+n);o&&e.diffs.push(new t.Diff(0,o)),e.start1-=r.length,e.start2-=r.length,e.length1+=r.length+o.length,e.length2+=r.length+o.length}},t.prototype.patch_make=function(e,s,n){var r,o;if("string"==typeof e&&"string"==typeof s&&void 0===n)r=e,(o=this.diff_main(r,s,!0)).length>2&&(this.diff_cleanupSemantic(o),this.diff_cleanupEfficiency(o));else if(e&&"object"==typeof e&&void 0===s&&void 0===n)o=e,r=this.diff_text1(o);else if("string"==typeof e&&s&&"object"==typeof s&&void 0===n)r=e,o=s;else{if("string"!=typeof e||"string"!=typeof s||!n||"object"!=typeof n)throw new Error("Unknown call format to patch_make.");r=e,o=n}if(0===o.length)return[];for(var a=[],l=new t.patch_obj,h=0,c=0,d=0,u=r,p=r,m=0;m<o.length;m++){var f=o[m][0],g=o[m][1];switch(h||0===f||(l.start1=c,l.start2=d),f){case 1:l.diffs[h++]=o[m],l.length2+=g.length,p=p.substring(0,d)+g+p.substring(d);break;case i:l.length1+=g.length,l.diffs[h++]=o[m],p=p.substring(0,d)+p.substring(d+g.length);break;case 0:g.length<=2*this.Patch_Margin&&h&&o.length!=m+1?(l.diffs[h++]=o[m],l.length1+=g.length,l.length2+=g.length):g.length>=2*this.Patch_Margin&&h&&(this.patch_addContext_(l,u),a.push(l),l=new t.patch_obj,h=0,u=p,c=d)}1!==f&&(c+=g.length),f!==i&&(d+=g.length)}return h&&(this.patch_addContext_(l,u),a.push(l)),a},t.prototype.patch_deepCopy=function(e){for(var i=[],s=0;s<e.length;s++){var n=e[s],r=new t.patch_obj;r.diffs=[];for(var o=0;o<n.diffs.length;o++)r.diffs[o]=new t.Diff(n.diffs[o][0],n.diffs[o][1]);r.start1=n.start1,r.start2=n.start2,r.length1=n.length1,r.length2=n.length2,i[s]=r}return i},t.prototype.patch_apply=function(e,t){if(0==e.length)return[t,[]];e=this.patch_deepCopy(e);var s=this.patch_addPadding(e);t=s+t+s,this.patch_splitMax(e);for(var n=0,r=[],o=0;o<e.length;o++){var a,l,h=e[o].start2+n,c=this.diff_text1(e[o].diffs),d=-1;if(c.length>this.Match_MaxBits?-1!=(a=this.match_main(t,c.substring(0,this.Match_MaxBits),h))&&(-1==(d=this.match_main(t,c.substring(c.length-this.Match_MaxBits),h+c.length-this.Match_MaxBits))||a>=d)&&(a=-1):a=this.match_main(t,c,h),-1==a)r[o]=!1,n-=e[o].length2-e[o].length1;else if(r[o]=!0,n=a-h,c==(l=-1==d?t.substring(a,a+c.length):t.substring(a,d+this.Match_MaxBits)))t=t.substring(0,a)+this.diff_text2(e[o].diffs)+t.substring(a+c.length);else{var u=this.diff_main(c,l,!1);if(c.length>this.Match_MaxBits&&this.diff_levenshtein(u)/c.length>this.Patch_DeleteThreshold)r[o]=!1;else{this.diff_cleanupSemanticLossless(u);for(var p,m=0,f=0;f<e[o].diffs.length;f++){var g=e[o].diffs[f];0!==g[0]&&(p=this.diff_xIndex(u,m)),1===g[0]?t=t.substring(0,a+p)+g[1]+t.substring(a+p):g[0]===i&&(t=t.substring(0,a+p)+t.substring(a+this.diff_xIndex(u,m+g[1].length))),g[0]!==i&&(m+=g[1].length)}}}}return[t=t.substring(s.length,t.length-s.length),r]},t.prototype.patch_addPadding=function(e){for(var i=this.Patch_Margin,s="",n=1;n<=i;n++)s+=String.fromCharCode(n);for(n=0;n<e.length;n++)e[n].start1+=i,e[n].start2+=i;var r=e[0],o=r.diffs;if(0==o.length||0!=o[0][0])o.unshift(new t.Diff(0,s)),r.start1-=i,r.start2-=i,r.length1+=i,r.length2+=i;else if(i>o[0][1].length){var a=i-o[0][1].length;o[0][1]=s.substring(o[0][1].length)+o[0][1],r.start1-=a,r.start2-=a,r.length1+=a,r.length2+=a}return 0==(o=(r=e[e.length-1]).diffs).length||0!=o[o.length-1][0]?(o.push(new t.Diff(0,s)),r.length1+=i,r.length2+=i):i>o[o.length-1][1].length&&(a=i-o[o.length-1][1].length,o[o.length-1][1]+=s.substring(0,a),r.length1+=a,r.length2+=a),s},t.prototype.patch_splitMax=function(e){for(var s=this.Match_MaxBits,n=0;n<e.length;n++)if(!(e[n].length1<=s)){var r=e[n];e.splice(n--,1);for(var o=r.start1,a=r.start2,l="";0!==r.diffs.length;){var h=new t.patch_obj,c=!0;for(h.start1=o-l.length,h.start2=a-l.length,""!==l&&(h.length1=h.length2=l.length,h.diffs.push(new t.Diff(0,l)));0!==r.diffs.length&&h.length1<s-this.Patch_Margin;){var d=r.diffs[0][0],u=r.diffs[0][1];1===d?(h.length2+=u.length,a+=u.length,h.diffs.push(r.diffs.shift()),c=!1):d===i&&1==h.diffs.length&&0==h.diffs[0][0]&&u.length>2*s?(h.length1+=u.length,o+=u.length,c=!1,h.diffs.push(new t.Diff(d,u)),r.diffs.shift()):(u=u.substring(0,s-h.length1-this.Patch_Margin),h.length1+=u.length,o+=u.length,0===d?(h.length2+=u.length,a+=u.length):c=!1,h.diffs.push(new t.Diff(d,u)),u==r.diffs[0][1]?r.diffs.shift():r.diffs[0][1]=r.diffs[0][1].substring(u.length))}l=(l=this.diff_text2(h.diffs)).substring(l.length-this.Patch_Margin);var p=this.diff_text1(r.diffs).substring(0,this.Patch_Margin);""!==p&&(h.length1+=p.length,h.length2+=p.length,0!==h.diffs.length&&0===h.diffs[h.diffs.length-1][0]?h.diffs[h.diffs.length-1][1]+=p:h.diffs.push(new t.Diff(0,p))),c||e.splice(++n,0,h)}}},t.prototype.patch_toText=function(e){for(var t=[],i=0;i<e.length;i++)t[i]=e[i];return t.join("")},t.prototype.patch_fromText=function(e){var s=[];if(!e)return s;for(var n=e.split("\n"),r=0,o=/^@@ -(\d+),?(\d*) \+(\d+),?(\d*) @@$/;r<n.length;){var a=n[r].match(o);if(!a)throw new Error("Invalid patch string: "+n[r]);var l=new t.patch_obj;for(s.push(l),l.start1=parseInt(a[1],10),""===a[2]?(l.start1--,l.length1=1):"0"==a[2]?l.length1=0:(l.start1--,l.length1=parseInt(a[2],10)),l.start2=parseInt(a[3],10),""===a[4]?(l.start2--,l.length2=1):"0"==a[4]?l.length2=0:(l.start2--,l.length2=parseInt(a[4],10)),r++;r<n.length;){var h=n[r].charAt(0);try{var c=decodeURI(n[r].substring(1))}catch(e){throw new Error("Illegal escape in patch_fromText: "+c)}if("-"==h)l.diffs.push(new t.Diff(i,c));else if("+"==h)l.diffs.push(new t.Diff(1,c));else if(" "==h)l.diffs.push(new t.Diff(0,c));else{if("@"==h)break;if(""!==h)throw new Error('Invalid patch mode "'+h+'" in: '+c)}r++}}return s},(t.patch_obj=function(){this.diffs=[],this.start1=null,this.start2=null,this.length1=0,this.length2=0}).prototype.toString=function(){for(var e,t=["@@ -"+(0===this.length1?this.start1+",0":1==this.length1?this.start1+1:this.start1+1+","+this.length1)+" +"+(0===this.length2?this.start2+",0":1==this.length2?this.start2+1:this.start2+1+","+this.length2)+" @@\n"],s=0;s<this.diffs.length;s++){switch(this.diffs[s][0]){case 1:e="+";break;case i:e="-";break;case 0:e=" "}t[s+1]=e+encodeURI(this.diffs[s][1])+"\n"}return t.join("").replace(/%20/g," ")},e.exports=t,e.exports.diff_match_patch=t,e.exports.DIFF_DELETE=i,e.exports.DIFF_INSERT=1,e.exports.DIFF_EQUAL=0},838:function(e){e.exports=function(){"use strict";const{entries:e,setPrototypeOf:t,isFrozen:i,getPrototypeOf:s,getOwnPropertyDescriptor:n}=Object;let{freeze:r,seal:o,create:a}=Object,{apply:l,construct:h}="undefined"!=typeof Reflect&&Reflect;r||(r=function(e){return e}),o||(o=function(e){return e}),l||(l=function(e,t,i){return e.apply(t,i)}),h||(h=function(e,t){return new e(...t)});const c=S(Array.prototype.forEach),d=S(Array.prototype.pop),u=S(Array.prototype.push),p=S(String.prototype.toLowerCase),m=S(String.prototype.toString),f=S(String.prototype.match),g=S(String.prototype.replace),_=S(String.prototype.indexOf),v=S(String.prototype.trim),b=S(Object.prototype.hasOwnProperty),y=S(RegExp.prototype.test),C=(w=TypeError,function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return h(w,t)});var w;function S(e){return function(t){for(var i=arguments.length,s=new Array(i>1?i-1:0),n=1;n<i;n++)s[n-1]=arguments[n];return l(e,t,s)}}function E(e,s){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:p;t&&t(e,null);let r=s.length;for(;r--;){let t=s[r];if("string"==typeof t){const e=n(t);e!==t&&(i(s)||(s[r]=e),t=e)}e[t]=!0}return e}function x(e){for(let t=0;t<e.length;t++)b(e,t)||(e[t]=null);return e}function T(t){const i=a(null);for(const[s,n]of e(t))b(t,s)&&(Array.isArray(n)?i[s]=x(n):n&&"object"==typeof n&&n.constructor===Object?i[s]=T(n):i[s]=n);return i}function O(e,t){for(;null!==e;){const i=n(e,t);if(i){if(i.get)return S(i.get);if("function"==typeof i.value)return S(i.value)}e=s(e)}return function(){return null}}const k=r(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),I=r(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),A=r(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),D=r(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),R=r(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),P=r(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),L=r(["#text"]),M=r(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),N=r(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),F=r(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),B=r(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),H=o(/\{\{[\w\W]*|[\w\W]*\}\}/gm),z=o(/<%[\w\W]*|[\w\W]*%>/gm),$=o(/\${[\w\W]*}/gm),V=o(/^data-[\-\w.\u00B7-\uFFFF]/),W=o(/^aria-[\-\w]+$/),U=o(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),j=o(/^(?:\w+script|data):/i),G=o(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),q=o(/^html$/i),K=o(/^[a-z][.\w]*(-[.\w]+)+$/i);var Y=Object.freeze({__proto__:null,MUSTACHE_EXPR:H,ERB_EXPR:z,TMPLIT_EXPR:$,DATA_ATTR:V,ARIA_ATTR:W,IS_ALLOWED_URI:U,IS_SCRIPT_OR_DATA:j,ATTR_WHITESPACE:G,DOCTYPE_NAME:q,CUSTOM_ELEMENT:K});const X=1,Z=3,Q=7,J=8,ee=9,te=function(){return"undefined"==typeof window?null:window};return function t(){let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:te();const s=e=>t(e);if(s.version="3.1.7",s.removed=[],!i||!i.document||i.document.nodeType!==ee)return s.isSupported=!1,s;let{document:n}=i;const o=n,l=o.currentScript,{DocumentFragment:h,HTMLTemplateElement:w,Node:S,Element:x,NodeFilter:H,NamedNodeMap:z=i.NamedNodeMap||i.MozNamedAttrMap,HTMLFormElement:$,DOMParser:V,trustedTypes:W}=i,j=x.prototype,G=O(j,"cloneNode"),K=O(j,"remove"),ie=O(j,"nextSibling"),se=O(j,"childNodes"),ne=O(j,"parentNode");if("function"==typeof w){const e=n.createElement("template");e.content&&e.content.ownerDocument&&(n=e.content.ownerDocument)}let re,oe="";const{implementation:ae,createNodeIterator:le,createDocumentFragment:he,getElementsByTagName:ce}=n,{importNode:de}=o;let ue={};s.isSupported="function"==typeof e&&"function"==typeof ne&&ae&&void 0!==ae.createHTMLDocument;const{MUSTACHE_EXPR:pe,ERB_EXPR:me,TMPLIT_EXPR:fe,DATA_ATTR:ge,ARIA_ATTR:_e,IS_SCRIPT_OR_DATA:ve,ATTR_WHITESPACE:be,CUSTOM_ELEMENT:ye}=Y;let{IS_ALLOWED_URI:Ce}=Y,we=null;const Se=E({},[...k,...I,...A,...R,...L]);let Ee=null;const xe=E({},[...M,...N,...F,...B]);let Te=Object.seal(a(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Oe=null,ke=null,Ie=!0,Ae=!0,De=!1,Re=!0,Pe=!1,Le=!0,Me=!1,Ne=!1,Fe=!1,Be=!1,He=!1,ze=!1,$e=!0,Ve=!1,We=!0,Ue=!1,je={},Ge=null;const qe=E({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Ke=null;const Ye=E({},["audio","video","img","source","image","track"]);let Xe=null;const Ze=E({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Qe="http://www.w3.org/1998/Math/MathML",Je="http://www.w3.org/2000/svg",et="http://www.w3.org/1999/xhtml";let tt=et,it=!1,st=null;const nt=E({},[Qe,Je,et],m);let rt=null;const ot=["application/xhtml+xml","text/html"];let at=null,lt=null;const ht=n.createElement("form"),ct=function(e){return e instanceof RegExp||e instanceof Function},dt=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!lt||lt!==e){if(e&&"object"==typeof e||(e={}),e=T(e),rt=-1===ot.indexOf(e.PARSER_MEDIA_TYPE)?"text/html":e.PARSER_MEDIA_TYPE,at="application/xhtml+xml"===rt?m:p,we=b(e,"ALLOWED_TAGS")?E({},e.ALLOWED_TAGS,at):Se,Ee=b(e,"ALLOWED_ATTR")?E({},e.ALLOWED_ATTR,at):xe,st=b(e,"ALLOWED_NAMESPACES")?E({},e.ALLOWED_NAMESPACES,m):nt,Xe=b(e,"ADD_URI_SAFE_ATTR")?E(T(Ze),e.ADD_URI_SAFE_ATTR,at):Ze,Ke=b(e,"ADD_DATA_URI_TAGS")?E(T(Ye),e.ADD_DATA_URI_TAGS,at):Ye,Ge=b(e,"FORBID_CONTENTS")?E({},e.FORBID_CONTENTS,at):qe,Oe=b(e,"FORBID_TAGS")?E({},e.FORBID_TAGS,at):{},ke=b(e,"FORBID_ATTR")?E({},e.FORBID_ATTR,at):{},je=!!b(e,"USE_PROFILES")&&e.USE_PROFILES,Ie=!1!==e.ALLOW_ARIA_ATTR,Ae=!1!==e.ALLOW_DATA_ATTR,De=e.ALLOW_UNKNOWN_PROTOCOLS||!1,Re=!1!==e.ALLOW_SELF_CLOSE_IN_ATTR,Pe=e.SAFE_FOR_TEMPLATES||!1,Le=!1!==e.SAFE_FOR_XML,Me=e.WHOLE_DOCUMENT||!1,Be=e.RETURN_DOM||!1,He=e.RETURN_DOM_FRAGMENT||!1,ze=e.RETURN_TRUSTED_TYPE||!1,Fe=e.FORCE_BODY||!1,$e=!1!==e.SANITIZE_DOM,Ve=e.SANITIZE_NAMED_PROPS||!1,We=!1!==e.KEEP_CONTENT,Ue=e.IN_PLACE||!1,Ce=e.ALLOWED_URI_REGEXP||U,tt=e.NAMESPACE||et,Te=e.CUSTOM_ELEMENT_HANDLING||{},e.CUSTOM_ELEMENT_HANDLING&&ct(e.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Te.tagNameCheck=e.CUSTOM_ELEMENT_HANDLING.tagNameCheck),e.CUSTOM_ELEMENT_HANDLING&&ct(e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Te.attributeNameCheck=e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),e.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(Te.allowCustomizedBuiltInElements=e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Pe&&(Ae=!1),He&&(Be=!0),je&&(we=E({},L),Ee=[],!0===je.html&&(E(we,k),E(Ee,M)),!0===je.svg&&(E(we,I),E(Ee,N),E(Ee,B)),!0===je.svgFilters&&(E(we,A),E(Ee,N),E(Ee,B)),!0===je.mathMl&&(E(we,R),E(Ee,F),E(Ee,B))),e.ADD_TAGS&&(we===Se&&(we=T(we)),E(we,e.ADD_TAGS,at)),e.ADD_ATTR&&(Ee===xe&&(Ee=T(Ee)),E(Ee,e.ADD_ATTR,at)),e.ADD_URI_SAFE_ATTR&&E(Xe,e.ADD_URI_SAFE_ATTR,at),e.FORBID_CONTENTS&&(Ge===qe&&(Ge=T(Ge)),E(Ge,e.FORBID_CONTENTS,at)),We&&(we["#text"]=!0),Me&&E(we,["html","head","body"]),we.table&&(E(we,["tbody"]),delete Oe.tbody),e.TRUSTED_TYPES_POLICY){if("function"!=typeof e.TRUSTED_TYPES_POLICY.createHTML)throw C('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if("function"!=typeof e.TRUSTED_TYPES_POLICY.createScriptURL)throw C('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');re=e.TRUSTED_TYPES_POLICY,oe=re.createHTML("")}else void 0===re&&(re=function(e,t){if("object"!=typeof e||"function"!=typeof e.createPolicy)return null;let i=null;const s="data-tt-policy-suffix";t&&t.hasAttribute(s)&&(i=t.getAttribute(s));const n="dompurify"+(i?"#"+i:"");try{return e.createPolicy(n,{createHTML:e=>e,createScriptURL:e=>e})}catch(e){return console.warn("TrustedTypes policy "+n+" could not be created."),null}}(W,l)),null!==re&&"string"==typeof oe&&(oe=re.createHTML(""));r&&r(e),lt=e}},ut=E({},["mi","mo","mn","ms","mtext"]),pt=E({},["annotation-xml"]),mt=E({},["title","style","font","a","script"]),ft=E({},[...I,...A,...D]),gt=E({},[...R,...P]),_t=function(e){u(s.removed,{element:e});try{ne(e).removeChild(e)}catch(t){K(e)}},vt=function(e,t){try{u(s.removed,{attribute:t.getAttributeNode(e),from:t})}catch(e){u(s.removed,{attribute:null,from:t})}if(t.removeAttribute(e),"is"===e&&!Ee[e])if(Be||He)try{_t(t)}catch(e){}else try{t.setAttribute(e,"")}catch(e){}},bt=function(e){let t=null,i=null;if(Fe)e="<remove></remove>"+e;else{const t=f(e,/^[\r\n\t ]+/);i=t&&t[0]}"application/xhtml+xml"===rt&&tt===et&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");const s=re?re.createHTML(e):e;if(tt===et)try{t=(new V).parseFromString(s,rt)}catch(e){}if(!t||!t.documentElement){t=ae.createDocument(tt,"template",null);try{t.documentElement.innerHTML=it?oe:s}catch(e){}}const r=t.body||t.documentElement;return e&&i&&r.insertBefore(n.createTextNode(i),r.childNodes[0]||null),tt===et?ce.call(t,Me?"html":"body")[0]:Me?t.documentElement:r},yt=function(e){return le.call(e.ownerDocument||e,e,H.SHOW_ELEMENT|H.SHOW_COMMENT|H.SHOW_TEXT|H.SHOW_PROCESSING_INSTRUCTION|H.SHOW_CDATA_SECTION,null)},Ct=function(e){return e instanceof $&&("string"!=typeof e.nodeName||"string"!=typeof e.textContent||"function"!=typeof e.removeChild||!(e.attributes instanceof z)||"function"!=typeof e.removeAttribute||"function"!=typeof e.setAttribute||"string"!=typeof e.namespaceURI||"function"!=typeof e.insertBefore||"function"!=typeof e.hasChildNodes)},wt=function(e){return"function"==typeof S&&e instanceof S},St=function(e,t,i){ue[e]&&c(ue[e],(e=>{e.call(s,t,i,lt)}))},Et=function(e){let t=null;if(St("beforeSanitizeElements",e,null),Ct(e))return _t(e),!0;const i=at(e.nodeName);if(St("uponSanitizeElement",e,{tagName:i,allowedTags:we}),e.hasChildNodes()&&!wt(e.firstElementChild)&&y(/<[/\w]/g,e.innerHTML)&&y(/<[/\w]/g,e.textContent))return _t(e),!0;if(e.nodeType===Q)return _t(e),!0;if(Le&&e.nodeType===J&&y(/<[/\w]/g,e.data))return _t(e),!0;if(!we[i]||Oe[i]){if(!Oe[i]&&Tt(i)){if(Te.tagNameCheck instanceof RegExp&&y(Te.tagNameCheck,i))return!1;if(Te.tagNameCheck instanceof Function&&Te.tagNameCheck(i))return!1}if(We&&!Ge[i]){const t=ne(e)||e.parentNode,i=se(e)||e.childNodes;if(i&&t)for(let s=i.length-1;s>=0;--s){const n=G(i[s],!0);n.__removalCount=(e.__removalCount||0)+1,t.insertBefore(n,ie(e))}}return _t(e),!0}return e instanceof x&&!function(e){let t=ne(e);t&&t.tagName||(t={namespaceURI:tt,tagName:"template"});const i=p(e.tagName),s=p(t.tagName);return!!st[e.namespaceURI]&&(e.namespaceURI===Je?t.namespaceURI===et?"svg"===i:t.namespaceURI===Qe?"svg"===i&&("annotation-xml"===s||ut[s]):Boolean(ft[i]):e.namespaceURI===Qe?t.namespaceURI===et?"math"===i:t.namespaceURI===Je?"math"===i&&pt[s]:Boolean(gt[i]):e.namespaceURI===et?!(t.namespaceURI===Je&&!pt[s])&&!(t.namespaceURI===Qe&&!ut[s])&&!gt[i]&&(mt[i]||!ft[i]):!("application/xhtml+xml"!==rt||!st[e.namespaceURI]))}(e)?(_t(e),!0):"noscript"!==i&&"noembed"!==i&&"noframes"!==i||!y(/<\/no(script|embed|frames)/i,e.innerHTML)?(Pe&&e.nodeType===Z&&(t=e.textContent,c([pe,me,fe],(e=>{t=g(t,e," ")})),e.textContent!==t&&(u(s.removed,{element:e.cloneNode()}),e.textContent=t)),St("afterSanitizeElements",e,null),!1):(_t(e),!0)},xt=function(e,t,i){if($e&&("id"===t||"name"===t)&&(i in n||i in ht))return!1;if(Ae&&!ke[t]&&y(ge,t));else if(Ie&&y(_e,t));else if(!Ee[t]||ke[t]){if(!(Tt(e)&&(Te.tagNameCheck instanceof RegExp&&y(Te.tagNameCheck,e)||Te.tagNameCheck instanceof Function&&Te.tagNameCheck(e))&&(Te.attributeNameCheck instanceof RegExp&&y(Te.attributeNameCheck,t)||Te.attributeNameCheck instanceof Function&&Te.attributeNameCheck(t))||"is"===t&&Te.allowCustomizedBuiltInElements&&(Te.tagNameCheck instanceof RegExp&&y(Te.tagNameCheck,i)||Te.tagNameCheck instanceof Function&&Te.tagNameCheck(i))))return!1}else if(Xe[t]);else if(y(Ce,g(i,be,"")));else if("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==_(i,"data:")||!Ke[e])if(De&&!y(ve,g(i,be,"")));else if(i)return!1;return!0},Tt=function(e){return"annotation-xml"!==e&&f(e,ye)},Ot=function(e){St("beforeSanitizeAttributes",e,null);const{attributes:t}=e;if(!t)return;const i={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Ee};let n=t.length;for(;n--;){const r=t[n],{name:o,namespaceURI:a,value:l}=r,h=at(o);let u="value"===o?l:v(l);if(i.attrName=h,i.attrValue=u,i.keepAttr=!0,i.forceKeepAttr=void 0,St("uponSanitizeAttribute",e,i),u=i.attrValue,i.forceKeepAttr)continue;if(vt(o,e),!i.keepAttr)continue;if(!Re&&y(/\/>/i,u)){vt(o,e);continue}Pe&&c([pe,me,fe],(e=>{u=g(u,e," ")}));const p=at(e.nodeName);if(xt(p,h,u))if(!Ve||"id"!==h&&"name"!==h||(vt(o,e),u="user-content-"+u),Le&&y(/((--!?|])>)|<\/(style|title)/i,u))vt(o,e);else{if(re&&"object"==typeof W&&"function"==typeof W.getAttributeType)if(a);else switch(W.getAttributeType(p,h)){case"TrustedHTML":u=re.createHTML(u);break;case"TrustedScriptURL":u=re.createScriptURL(u)}try{a?e.setAttributeNS(a,o,u):e.setAttribute(o,u),Ct(e)?_t(e):d(s.removed)}catch(e){}}}St("afterSanitizeAttributes",e,null)},kt=function e(t){let i=null;const s=yt(t);for(St("beforeSanitizeShadowDOM",t,null);i=s.nextNode();)St("uponSanitizeShadowNode",i,null),Et(i)||(i.content instanceof h&&e(i.content),Ot(i));St("afterSanitizeShadowDOM",t,null)};return s.sanitize=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=null,n=null,r=null,a=null;if(it=!e,it&&(e="\x3c!--\x3e"),"string"!=typeof e&&!wt(e)){if("function"!=typeof e.toString)throw C("toString is not a function");if("string"!=typeof(e=e.toString()))throw C("dirty is not a string, aborting")}if(!s.isSupported)return e;if(Ne||dt(t),s.removed=[],"string"==typeof e&&(Ue=!1),Ue){if(e.nodeName){const t=at(e.nodeName);if(!we[t]||Oe[t])throw C("root node is forbidden and cannot be sanitized in-place")}}else if(e instanceof S)i=bt("\x3c!----\x3e"),n=i.ownerDocument.importNode(e,!0),n.nodeType===X&&"BODY"===n.nodeName||"HTML"===n.nodeName?i=n:i.appendChild(n);else{if(!Be&&!Pe&&!Me&&-1===e.indexOf("<"))return re&&ze?re.createHTML(e):e;if(i=bt(e),!i)return Be?null:ze?oe:""}i&&Fe&&_t(i.firstChild);const l=yt(Ue?e:i);for(;r=l.nextNode();)Et(r)||(r.content instanceof h&&kt(r.content),Ot(r));if(Ue)return e;if(Be){if(He)for(a=he.call(i.ownerDocument);i.firstChild;)a.appendChild(i.firstChild);else a=i;return(Ee.shadowroot||Ee.shadowrootmode)&&(a=de.call(o,a,!0)),a}let d=Me?i.outerHTML:i.innerHTML;return Me&&we["!doctype"]&&i.ownerDocument&&i.ownerDocument.doctype&&i.ownerDocument.doctype.name&&y(q,i.ownerDocument.doctype.name)&&(d="<!DOCTYPE "+i.ownerDocument.doctype.name+">\n"+d),Pe&&c([pe,me,fe],(e=>{d=g(d,e," ")})),re&&ze?re.createHTML(d):d},s.setConfig=function(){dt(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),Ne=!0},s.clearConfig=function(){lt=null,Ne=!1},s.isValidAttribute=function(e,t,i){lt||dt({});const s=at(e),n=at(t);return xt(s,n,i)},s.addHook=function(e,t){"function"==typeof t&&(ue[e]=ue[e]||[],u(ue[e],t))},s.removeHook=function(e){if(ue[e])return d(ue[e])},s.removeHooks=function(e){ue[e]&&(ue[e]=[])},s.removeAllHooks=function(){ue={}},s}()}()},140:function(e,t){var i,s;void 0===(s="function"==typeof(i=function(){return function e(t,i,s){var n,r,o=window,a="application/octet-stream",l=s||a,h=t,c=!i&&!s&&h,d=document.createElement("a"),u=function(e){return String(e)},p=o.Blob||o.MozBlob||o.WebKitBlob||u,m=i||"download";if(p=p.call?p.bind(o):Blob,"true"===String(this)&&(l=(h=[h,l])[0],h=h[1]),c&&c.length<2048&&(m=c.split("/").pop().split("?")[0],d.href=c,-1!==d.href.indexOf(c))){var f=new XMLHttpRequest;return f.open("GET",c,!0),f.responseType="blob",f.onload=function(t){e(t.target.response,m,a)},setTimeout((function(){f.send()}),0),f}if(/^data:([\w+-]+\/[\w+.-]+)?[,;]/.test(h)){if(!(h.length>2096103.424&&p!==u))return navigator.msSaveBlob?navigator.msSaveBlob(b(h),m):y(h);l=(h=b(h)).type||a}else if(/([\x80-\xff])/.test(h)){for(var g=0,_=new Uint8Array(h.length),v=_.length;g<v;++g)_[g]=h.charCodeAt(g);h=new p([_],{type:l})}function b(e){for(var t=e.split(/[:;,]/),i=t[1],s=("base64"==t[2]?atob:decodeURIComponent)(t.pop()),n=s.length,r=0,o=new Uint8Array(n);r<n;++r)o[r]=s.charCodeAt(r);return new p([o],{type:i})}function y(e,t){if("download"in d)return d.href=e,d.setAttribute("download",m),d.className="download-js-link",d.innerHTML="downloading...",d.style.display="none",document.body.appendChild(d),setTimeout((function(){d.click(),document.body.removeChild(d),!0===t&&setTimeout((function(){o.URL.revokeObjectURL(d.href)}),250)}),66),!0;if(/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//.test(navigator.userAgent))return/^data:/.test(e)&&(e="data:"+e.replace(/^data:([\w\/\-\+]+)/,a)),window.open(e)||confirm("Displaying New Document\n\nUse Save As... to download, then click back to return to this page.")&&(location.href=e),!0;var i=document.createElement("iframe");document.body.appendChild(i),!t&&/^data:/.test(e)&&(e="data:"+e.replace(/^data:([\w\/\-\+]+)/,a)),i.src=e,setTimeout((function(){document.body.removeChild(i)}),333)}if(n=h instanceof p?h:new p([h],{type:l}),navigator.msSaveBlob)return navigator.msSaveBlob(n,m);if(o.URL)y(o.URL.createObjectURL(n),!0);else{if("string"==typeof n||n.constructor===u)try{return y("data:"+l+";base64,"+o.btoa(n))}catch(e){return y("data:"+l+","+encodeURIComponent(n))}(r=new FileReader).onload=function(e){y(this.result)},r.readAsDataURL(n)}return!0}})?i.apply(t,[]):i)||(e.exports=s)},692:function(e,t){var i;!function(t,i){"use strict";"object"==typeof e.exports?e.exports=t.document?i(t,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return i(e)}:i(t)}("undefined"!=typeof window?window:this,(function(s,n){"use strict";var r=[],o=Object.getPrototypeOf,a=r.slice,l=r.flat?function(e){return r.flat.call(e)}:function(e){return r.concat.apply([],e)},h=r.push,c=r.indexOf,d={},u=d.toString,p=d.hasOwnProperty,m=p.toString,f=m.call(Object),g={},_=function(e){return"function"==typeof e&&"number"!=typeof e.nodeType&&"function"!=typeof e.item},v=function(e){return null!=e&&e===e.window},b=s.document,y={type:!0,src:!0,nonce:!0,noModule:!0};function C(e,t,i){var s,n,r=(i=i||b).createElement("script");if(r.text=e,t)for(s in y)(n=t[s]||t.getAttribute&&t.getAttribute(s))&&r.setAttribute(s,n);i.head.appendChild(r).parentNode.removeChild(r)}function w(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?d[u.call(e)]||"object":typeof e}var S="3.7.1",E=/HTML$/i,x=function(e,t){return new x.fn.init(e,t)};function T(e){var t=!!e&&"length"in e&&e.length,i=w(e);return!_(e)&&!v(e)&&("array"===i||0===t||"number"==typeof t&&t>0&&t-1 in e)}function O(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()}x.fn=x.prototype={jquery:S,constructor:x,length:0,toArray:function(){return a.call(this)},get:function(e){return null==e?a.call(this):e<0?this[e+this.length]:this[e]},pushStack:function(e){var t=x.merge(this.constructor(),e);return t.prevObject=this,t},each:function(e){return x.each(this,e)},map:function(e){return this.pushStack(x.map(this,(function(t,i){return e.call(t,i,t)})))},slice:function(){return this.pushStack(a.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(x.grep(this,(function(e,t){return(t+1)%2})))},odd:function(){return this.pushStack(x.grep(this,(function(e,t){return t%2})))},eq:function(e){var t=this.length,i=+e+(e<0?t:0);return this.pushStack(i>=0&&i<t?[this[i]]:[])},end:function(){return this.prevObject||this.constructor()},push:h,sort:r.sort,splice:r.splice},x.extend=x.fn.extend=function(){var e,t,i,s,n,r,o=arguments[0]||{},a=1,l=arguments.length,h=!1;for("boolean"==typeof o&&(h=o,o=arguments[a]||{},a++),"object"==typeof o||_(o)||(o={}),a===l&&(o=this,a--);a<l;a++)if(null!=(e=arguments[a]))for(t in e)s=e[t],"__proto__"!==t&&o!==s&&(h&&s&&(x.isPlainObject(s)||(n=Array.isArray(s)))?(i=o[t],r=n&&!Array.isArray(i)?[]:n||x.isPlainObject(i)?i:{},n=!1,o[t]=x.extend(h,r,s)):void 0!==s&&(o[t]=s));return o},x.extend({expando:"jQuery"+(S+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isPlainObject:function(e){var t,i;return!(!e||"[object Object]"!==u.call(e)||(t=o(e))&&("function"!=typeof(i=p.call(t,"constructor")&&t.constructor)||m.call(i)!==f))},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},globalEval:function(e,t,i){C(e,{nonce:t&&t.nonce},i)},each:function(e,t){var i,s=0;if(T(e))for(i=e.length;s<i&&!1!==t.call(e[s],s,e[s]);s++);else for(s in e)if(!1===t.call(e[s],s,e[s]))break;return e},text:function(e){var t,i="",s=0,n=e.nodeType;if(!n)for(;t=e[s++];)i+=x.text(t);return 1===n||11===n?e.textContent:9===n?e.documentElement.textContent:3===n||4===n?e.nodeValue:i},makeArray:function(e,t){var i=t||[];return null!=e&&(T(Object(e))?x.merge(i,"string"==typeof e?[e]:e):h.call(i,e)),i},inArray:function(e,t,i){return null==t?-1:c.call(t,e,i)},isXMLDoc:function(e){var t=e&&e.namespaceURI,i=e&&(e.ownerDocument||e).documentElement;return!E.test(t||i&&i.nodeName||"HTML")},merge:function(e,t){for(var i=+t.length,s=0,n=e.length;s<i;s++)e[n++]=t[s];return e.length=n,e},grep:function(e,t,i){for(var s=[],n=0,r=e.length,o=!i;n<r;n++)!t(e[n],n)!==o&&s.push(e[n]);return s},map:function(e,t,i){var s,n,r=0,o=[];if(T(e))for(s=e.length;r<s;r++)null!=(n=t(e[r],r,i))&&o.push(n);else for(r in e)null!=(n=t(e[r],r,i))&&o.push(n);return l(o)},guid:1,support:g}),"function"==typeof Symbol&&(x.fn[Symbol.iterator]=r[Symbol.iterator]),x.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),(function(e,t){d["[object "+t+"]"]=t.toLowerCase()}));var k=r.pop,I=r.sort,A=r.splice,D="[\\x20\\t\\r\\n\\f]",R=new RegExp("^"+D+"+|((?:^|[^\\\\])(?:\\\\.)*)"+D+"+$","g");x.contains=function(e,t){var i=t&&t.parentNode;return e===i||!(!i||1!==i.nodeType||!(e.contains?e.contains(i):e.compareDocumentPosition&&16&e.compareDocumentPosition(i)))};var P=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\x80-\uFFFF\w-]/g;function L(e,t){return t?"\0"===e?"ï¿½":e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" ":"\\"+e}x.escapeSelector=function(e){return(e+"").replace(P,L)};var M=b,N=h;!function(){var e,t,i,n,o,l,h,d,u,m,f=N,_=x.expando,v=0,b=0,y=ee(),C=ee(),w=ee(),S=ee(),E=function(e,t){return e===t&&(o=!0),0},T="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",P="(?:\\\\[\\da-fA-F]{1,6}"+D+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",L="\\["+D+"*("+P+")(?:"+D+"*([*^$|!~]?=)"+D+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+P+"))|)"+D+"*\\]",F=":("+P+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+L+")*)|.*)\\)|)",B=new RegExp(D+"+","g"),H=new RegExp("^"+D+"*,"+D+"*"),z=new RegExp("^"+D+"*([>+~]|"+D+")"+D+"*"),$=new RegExp(D+"|>"),V=new RegExp(F),W=new RegExp("^"+P+"$"),U={ID:new RegExp("^#("+P+")"),CLASS:new RegExp("^\\.("+P+")"),TAG:new RegExp("^("+P+"|[*])"),ATTR:new RegExp("^"+L),PSEUDO:new RegExp("^"+F),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+D+"*(even|odd|(([+-]|)(\\d*)n|)"+D+"*(?:([+-]|)"+D+"*(\\d+)|))"+D+"*\\)|)","i"),bool:new RegExp("^(?:"+T+")$","i"),needsContext:new RegExp("^"+D+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+D+"*((?:-\\d)?\\d*)"+D+"*\\)|)(?=[^-]|$)","i")},j=/^(?:input|select|textarea|button)$/i,G=/^h\d$/i,q=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,K=/[+~]/,Y=new RegExp("\\\\[\\da-fA-F]{1,6}"+D+"?|\\\\([^\\r\\n\\f])","g"),X=function(e,t){var i="0x"+e.slice(1)-65536;return t||(i<0?String.fromCharCode(i+65536):String.fromCharCode(i>>10|55296,1023&i|56320))},Z=function(){le()},Q=ue((function(e){return!0===e.disabled&&O(e,"fieldset")}),{dir:"parentNode",next:"legend"});try{f.apply(r=a.call(M.childNodes),M.childNodes),r[M.childNodes.length].nodeType}catch(e){f={apply:function(e,t){N.apply(e,a.call(t))},call:function(e){N.apply(e,a.call(arguments,1))}}}function J(e,t,i,s){var n,r,o,a,h,c,p,m=t&&t.ownerDocument,v=t?t.nodeType:9;if(i=i||[],"string"!=typeof e||!e||1!==v&&9!==v&&11!==v)return i;if(!s&&(le(t),t=t||l,d)){if(11!==v&&(h=q.exec(e)))if(n=h[1]){if(9===v){if(!(o=t.getElementById(n)))return i;if(o.id===n)return f.call(i,o),i}else if(m&&(o=m.getElementById(n))&&J.contains(t,o)&&o.id===n)return f.call(i,o),i}else{if(h[2])return f.apply(i,t.getElementsByTagName(e)),i;if((n=h[3])&&t.getElementsByClassName)return f.apply(i,t.getElementsByClassName(n)),i}if(!(S[e+" "]||u&&u.test(e))){if(p=e,m=t,1===v&&($.test(e)||z.test(e))){for((m=K.test(e)&&ae(t.parentNode)||t)==t&&g.scope||((a=t.getAttribute("id"))?a=x.escapeSelector(a):t.setAttribute("id",a=_)),r=(c=ce(e)).length;r--;)c[r]=(a?"#"+a:":scope")+" "+de(c[r]);p=c.join(",")}try{return f.apply(i,m.querySelectorAll(p)),i}catch(t){S(e,!0)}finally{a===_&&t.removeAttribute("id")}}}return ve(e.replace(R,"$1"),t,i,s)}function ee(){var e=[];return function i(s,n){return e.push(s+" ")>t.cacheLength&&delete i[e.shift()],i[s+" "]=n}}function te(e){return e[_]=!0,e}function ie(e){var t=l.createElement("fieldset");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function se(e){return function(t){return O(t,"input")&&t.type===e}}function ne(e){return function(t){return(O(t,"input")||O(t,"button"))&&t.type===e}}function re(e){return function(t){return"form"in t?t.parentNode&&!1===t.disabled?"label"in t?"label"in t.parentNode?t.parentNode.disabled===e:t.disabled===e:t.isDisabled===e||t.isDisabled!==!e&&Q(t)===e:t.disabled===e:"label"in t&&t.disabled===e}}function oe(e){return te((function(t){return t=+t,te((function(i,s){for(var n,r=e([],i.length,t),o=r.length;o--;)i[n=r[o]]&&(i[n]=!(s[n]=i[n]))}))}))}function ae(e){return e&&void 0!==e.getElementsByTagName&&e}function le(e){var i,s=e?e.ownerDocument||e:M;return s!=l&&9===s.nodeType&&s.documentElement?(h=(l=s).documentElement,d=!x.isXMLDoc(l),m=h.matches||h.webkitMatchesSelector||h.msMatchesSelector,h.msMatchesSelector&&M!=l&&(i=l.defaultView)&&i.top!==i&&i.addEventListener("unload",Z),g.getById=ie((function(e){return h.appendChild(e).id=x.expando,!l.getElementsByName||!l.getElementsByName(x.expando).length})),g.disconnectedMatch=ie((function(e){return m.call(e,"*")})),g.scope=ie((function(){return l.querySelectorAll(":scope")})),g.cssHas=ie((function(){try{return l.querySelector(":has(*,:jqfake)"),!1}catch(e){return!0}})),g.getById?(t.filter.ID=function(e){var t=e.replace(Y,X);return function(e){return e.getAttribute("id")===t}},t.find.ID=function(e,t){if(void 0!==t.getElementById&&d){var i=t.getElementById(e);return i?[i]:[]}}):(t.filter.ID=function(e){var t=e.replace(Y,X);return function(e){var i=void 0!==e.getAttributeNode&&e.getAttributeNode("id");return i&&i.value===t}},t.find.ID=function(e,t){if(void 0!==t.getElementById&&d){var i,s,n,r=t.getElementById(e);if(r){if((i=r.getAttributeNode("id"))&&i.value===e)return[r];for(n=t.getElementsByName(e),s=0;r=n[s++];)if((i=r.getAttributeNode("id"))&&i.value===e)return[r]}return[]}}),t.find.TAG=function(e,t){return void 0!==t.getElementsByTagName?t.getElementsByTagName(e):t.querySelectorAll(e)},t.find.CLASS=function(e,t){if(void 0!==t.getElementsByClassName&&d)return t.getElementsByClassName(e)},u=[],ie((function(e){var t;h.appendChild(e).innerHTML="<a id='"+_+"' href='' disabled='disabled'></a><select id='"+_+"-\r\\' disabled='disabled'><option selected=''></option></select>",e.querySelectorAll("[selected]").length||u.push("\\["+D+"*(?:value|"+T+")"),e.querySelectorAll("[id~="+_+"-]").length||u.push("~="),e.querySelectorAll("a#"+_+"+*").length||u.push(".#.+[+~]"),e.querySelectorAll(":checked").length||u.push(":checked"),(t=l.createElement("input")).setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),h.appendChild(e).disabled=!0,2!==e.querySelectorAll(":disabled").length&&u.push(":enabled",":disabled"),(t=l.createElement("input")).setAttribute("name",""),e.appendChild(t),e.querySelectorAll("[name='']").length||u.push("\\["+D+"*name"+D+"*="+D+"*(?:''|\"\")")})),g.cssHas||u.push(":has"),u=u.length&&new RegExp(u.join("|")),E=function(e,t){if(e===t)return o=!0,0;var i=!e.compareDocumentPosition-!t.compareDocumentPosition;return i||(1&(i=(e.ownerDocument||e)==(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!g.sortDetached&&t.compareDocumentPosition(e)===i?e===l||e.ownerDocument==M&&J.contains(M,e)?-1:t===l||t.ownerDocument==M&&J.contains(M,t)?1:n?c.call(n,e)-c.call(n,t):0:4&i?-1:1)},l):l}for(e in J.matches=function(e,t){return J(e,null,null,t)},J.matchesSelector=function(e,t){if(le(e),d&&!S[t+" "]&&(!u||!u.test(t)))try{var i=m.call(e,t);if(i||g.disconnectedMatch||e.document&&11!==e.document.nodeType)return i}catch(e){S(t,!0)}return J(t,l,null,[e]).length>0},J.contains=function(e,t){return(e.ownerDocument||e)!=l&&le(e),x.contains(e,t)},J.attr=function(e,i){(e.ownerDocument||e)!=l&&le(e);var s=t.attrHandle[i.toLowerCase()],n=s&&p.call(t.attrHandle,i.toLowerCase())?s(e,i,!d):void 0;return void 0!==n?n:e.getAttribute(i)},J.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},x.uniqueSort=function(e){var t,i=[],s=0,r=0;if(o=!g.sortStable,n=!g.sortStable&&a.call(e,0),I.call(e,E),o){for(;t=e[r++];)t===e[r]&&(s=i.push(r));for(;s--;)A.call(e,i[s],1)}return n=null,e},x.fn.uniqueSort=function(){return this.pushStack(x.uniqueSort(a.apply(this)))},t=x.expr={cacheLength:50,createPseudo:te,match:U,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(Y,X),e[3]=(e[3]||e[4]||e[5]||"").replace(Y,X),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||J.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&J.error(e[0]),e},PSEUDO:function(e){var t,i=!e[6]&&e[2];return U.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":i&&V.test(i)&&(t=ce(i,!0))&&(t=i.indexOf(")",i.length-t)-i.length)&&(e[0]=e[0].slice(0,t),e[2]=i.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(Y,X).toLowerCase();return"*"===e?function(){return!0}:function(e){return O(e,t)}},CLASS:function(e){var t=y[e+" "];return t||(t=new RegExp("(^|"+D+")"+e+"("+D+"|$)"))&&y(e,(function(e){return t.test("string"==typeof e.className&&e.className||void 0!==e.getAttribute&&e.getAttribute("class")||"")}))},ATTR:function(e,t,i){return function(s){var n=J.attr(s,e);return null==n?"!="===t:!t||(n+="","="===t?n===i:"!="===t?n!==i:"^="===t?i&&0===n.indexOf(i):"*="===t?i&&n.indexOf(i)>-1:"$="===t?i&&n.slice(-i.length)===i:"~="===t?(" "+n.replace(B," ")+" ").indexOf(i)>-1:"|="===t&&(n===i||n.slice(0,i.length+1)===i+"-"))}},CHILD:function(e,t,i,s,n){var r="nth"!==e.slice(0,3),o="last"!==e.slice(-4),a="of-type"===t;return 1===s&&0===n?function(e){return!!e.parentNode}:function(t,i,l){var h,c,d,u,p,m=r!==o?"nextSibling":"previousSibling",f=t.parentNode,g=a&&t.nodeName.toLowerCase(),b=!l&&!a,y=!1;if(f){if(r){for(;m;){for(d=t;d=d[m];)if(a?O(d,g):1===d.nodeType)return!1;p=m="only"===e&&!p&&"nextSibling"}return!0}if(p=[o?f.firstChild:f.lastChild],o&&b){for(y=(u=(h=(c=f[_]||(f[_]={}))[e]||[])[0]===v&&h[1])&&h[2],d=u&&f.childNodes[u];d=++u&&d&&d[m]||(y=u=0)||p.pop();)if(1===d.nodeType&&++y&&d===t){c[e]=[v,u,y];break}}else if(b&&(y=u=(h=(c=t[_]||(t[_]={}))[e]||[])[0]===v&&h[1]),!1===y)for(;(d=++u&&d&&d[m]||(y=u=0)||p.pop())&&(!(a?O(d,g):1===d.nodeType)||!++y||(b&&((c=d[_]||(d[_]={}))[e]=[v,y]),d!==t)););return(y-=n)===s||y%s==0&&y/s>=0}}},PSEUDO:function(e,i){var s,n=t.pseudos[e]||t.setFilters[e.toLowerCase()]||J.error("unsupported pseudo: "+e);return n[_]?n(i):n.length>1?(s=[e,e,"",i],t.setFilters.hasOwnProperty(e.toLowerCase())?te((function(e,t){for(var s,r=n(e,i),o=r.length;o--;)e[s=c.call(e,r[o])]=!(t[s]=r[o])})):function(e){return n(e,0,s)}):n}},pseudos:{not:te((function(e){var t=[],i=[],s=_e(e.replace(R,"$1"));return s[_]?te((function(e,t,i,n){for(var r,o=s(e,null,n,[]),a=e.length;a--;)(r=o[a])&&(e[a]=!(t[a]=r))})):function(e,n,r){return t[0]=e,s(t,null,r,i),t[0]=null,!i.pop()}})),has:te((function(e){return function(t){return J(e,t).length>0}})),contains:te((function(e){return e=e.replace(Y,X),function(t){return(t.textContent||x.text(t)).indexOf(e)>-1}})),lang:te((function(e){return W.test(e||"")||J.error("unsupported lang: "+e),e=e.replace(Y,X).toLowerCase(),function(t){var i;do{if(i=d?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return(i=i.toLowerCase())===e||0===i.indexOf(e+"-")}while((t=t.parentNode)&&1===t.nodeType);return!1}})),target:function(e){var t=s.location&&s.location.hash;return t&&t.slice(1)===e.id},root:function(e){return e===h},focus:function(e){return e===function(){try{return l.activeElement}catch(e){}}()&&l.hasFocus()&&!!(e.type||e.href||~e.tabIndex)},enabled:re(!1),disabled:re(!0),checked:function(e){return O(e,"input")&&!!e.checked||O(e,"option")&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!t.pseudos.empty(e)},header:function(e){return G.test(e.nodeName)},input:function(e){return j.test(e.nodeName)},button:function(e){return O(e,"input")&&"button"===e.type||O(e,"button")},text:function(e){var t;return O(e,"input")&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:oe((function(){return[0]})),last:oe((function(e,t){return[t-1]})),eq:oe((function(e,t,i){return[i<0?i+t:i]})),even:oe((function(e,t){for(var i=0;i<t;i+=2)e.push(i);return e})),odd:oe((function(e,t){for(var i=1;i<t;i+=2)e.push(i);return e})),lt:oe((function(e,t,i){var s;for(s=i<0?i+t:i>t?t:i;--s>=0;)e.push(s);return e})),gt:oe((function(e,t,i){for(var s=i<0?i+t:i;++s<t;)e.push(s);return e}))}},t.pseudos.nth=t.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})t.pseudos[e]=se(e);for(e in{submit:!0,reset:!0})t.pseudos[e]=ne(e);function he(){}function ce(e,i){var s,n,r,o,a,l,h,c=C[e+" "];if(c)return i?0:c.slice(0);for(a=e,l=[],h=t.preFilter;a;){for(o in s&&!(n=H.exec(a))||(n&&(a=a.slice(n[0].length)||a),l.push(r=[])),s=!1,(n=z.exec(a))&&(s=n.shift(),r.push({value:s,type:n[0].replace(R," ")}),a=a.slice(s.length)),t.filter)!(n=U[o].exec(a))||h[o]&&!(n=h[o](n))||(s=n.shift(),r.push({value:s,type:o,matches:n}),a=a.slice(s.length));if(!s)break}return i?a.length:a?J.error(e):C(e,l).slice(0)}function de(e){for(var t=0,i=e.length,s="";t<i;t++)s+=e[t].value;return s}function ue(e,t,i){var s=t.dir,n=t.next,r=n||s,o=i&&"parentNode"===r,a=b++;return t.first?function(t,i,n){for(;t=t[s];)if(1===t.nodeType||o)return e(t,i,n);return!1}:function(t,i,l){var h,c,d=[v,a];if(l){for(;t=t[s];)if((1===t.nodeType||o)&&e(t,i,l))return!0}else for(;t=t[s];)if(1===t.nodeType||o)if(c=t[_]||(t[_]={}),n&&O(t,n))t=t[s]||t;else{if((h=c[r])&&h[0]===v&&h[1]===a)return d[2]=h[2];if(c[r]=d,d[2]=e(t,i,l))return!0}return!1}}function pe(e){return e.length>1?function(t,i,s){for(var n=e.length;n--;)if(!e[n](t,i,s))return!1;return!0}:e[0]}function me(e,t,i,s,n){for(var r,o=[],a=0,l=e.length,h=null!=t;a<l;a++)(r=e[a])&&(i&&!i(r,s,n)||(o.push(r),h&&t.push(a)));return o}function fe(e,t,i,s,n,r){return s&&!s[_]&&(s=fe(s)),n&&!n[_]&&(n=fe(n,r)),te((function(r,o,a,l){var h,d,u,p,m=[],g=[],_=o.length,v=r||function(e,t,i){for(var s=0,n=t.length;s<n;s++)J(e,t[s],i);return i}(t||"*",a.nodeType?[a]:a,[]),b=!e||!r&&t?v:me(v,m,e,a,l);if(i?i(b,p=n||(r?e:_||s)?[]:o,a,l):p=b,s)for(h=me(p,g),s(h,[],a,l),d=h.length;d--;)(u=h[d])&&(p[g[d]]=!(b[g[d]]=u));if(r){if(n||e){if(n){for(h=[],d=p.length;d--;)(u=p[d])&&h.push(b[d]=u);n(null,p=[],h,l)}for(d=p.length;d--;)(u=p[d])&&(h=n?c.call(r,u):m[d])>-1&&(r[h]=!(o[h]=u))}}else p=me(p===o?p.splice(_,p.length):p),n?n(null,o,p,l):f.apply(o,p)}))}function ge(e){for(var s,n,r,o=e.length,a=t.relative[e[0].type],l=a||t.relative[" "],h=a?1:0,d=ue((function(e){return e===s}),l,!0),u=ue((function(e){return c.call(s,e)>-1}),l,!0),p=[function(e,t,n){var r=!a&&(n||t!=i)||((s=t).nodeType?d(e,t,n):u(e,t,n));return s=null,r}];h<o;h++)if(n=t.relative[e[h].type])p=[ue(pe(p),n)];else{if((n=t.filter[e[h].type].apply(null,e[h].matches))[_]){for(r=++h;r<o&&!t.relative[e[r].type];r++);return fe(h>1&&pe(p),h>1&&de(e.slice(0,h-1).concat({value:" "===e[h-2].type?"*":""})).replace(R,"$1"),n,h<r&&ge(e.slice(h,r)),r<o&&ge(e=e.slice(r)),r<o&&de(e))}p.push(n)}return pe(p)}function _e(e,s){var n,r=[],o=[],a=w[e+" "];if(!a){for(s||(s=ce(e)),n=s.length;n--;)(a=ge(s[n]))[_]?r.push(a):o.push(a);a=w(e,function(e,s){var n=s.length>0,r=e.length>0,o=function(o,a,h,c,u){var p,m,g,_=0,b="0",y=o&&[],C=[],w=i,S=o||r&&t.find.TAG("*",u),E=v+=null==w?1:Math.random()||.1,T=S.length;for(u&&(i=a==l||a||u);b!==T&&null!=(p=S[b]);b++){if(r&&p){for(m=0,a||p.ownerDocument==l||(le(p),h=!d);g=e[m++];)if(g(p,a||l,h)){f.call(c,p);break}u&&(v=E)}n&&((p=!g&&p)&&_--,o&&y.push(p))}if(_+=b,n&&b!==_){for(m=0;g=s[m++];)g(y,C,a,h);if(o){if(_>0)for(;b--;)y[b]||C[b]||(C[b]=k.call(c));C=me(C)}f.apply(c,C),u&&!o&&C.length>0&&_+s.length>1&&x.uniqueSort(c)}return u&&(v=E,i=w),y};return n?te(o):o}(o,r)),a.selector=e}return a}function ve(e,i,s,n){var r,o,a,l,h,c="function"==typeof e&&e,u=!n&&ce(e=c.selector||e);if(s=s||[],1===u.length){if((o=u[0]=u[0].slice(0)).length>2&&"ID"===(a=o[0]).type&&9===i.nodeType&&d&&t.relative[o[1].type]){if(!(i=(t.find.ID(a.matches[0].replace(Y,X),i)||[])[0]))return s;c&&(i=i.parentNode),e=e.slice(o.shift().value.length)}for(r=U.needsContext.test(e)?0:o.length;r--&&(a=o[r],!t.relative[l=a.type]);)if((h=t.find[l])&&(n=h(a.matches[0].replace(Y,X),K.test(o[0].type)&&ae(i.parentNode)||i))){if(o.splice(r,1),!(e=n.length&&de(o)))return f.apply(s,n),s;break}}return(c||_e(e,u))(n,i,!d,s,!i||K.test(e)&&ae(i.parentNode)||i),s}he.prototype=t.filters=t.pseudos,t.setFilters=new he,g.sortStable=_.split("").sort(E).join("")===_,le(),g.sortDetached=ie((function(e){return 1&e.compareDocumentPosition(l.createElement("fieldset"))})),x.find=J,x.expr[":"]=x.expr.pseudos,x.unique=x.uniqueSort,J.compile=_e,J.select=ve,J.setDocument=le,J.tokenize=ce,J.escape=x.escapeSelector,J.getText=x.text,J.isXML=x.isXMLDoc,J.selectors=x.expr,J.support=x.support,J.uniqueSort=x.uniqueSort}();var F=function(e,t,i){for(var s=[],n=void 0!==i;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(n&&x(e).is(i))break;s.push(e)}return s},B=function(e,t){for(var i=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&i.push(e);return i},H=x.expr.match.needsContext,z=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function $(e,t,i){return _(t)?x.grep(e,(function(e,s){return!!t.call(e,s,e)!==i})):t.nodeType?x.grep(e,(function(e){return e===t!==i})):"string"!=typeof t?x.grep(e,(function(e){return c.call(t,e)>-1!==i})):x.filter(t,e,i)}x.filter=function(e,t,i){var s=t[0];return i&&(e=":not("+e+")"),1===t.length&&1===s.nodeType?x.find.matchesSelector(s,e)?[s]:[]:x.find.matches(e,x.grep(t,(function(e){return 1===e.nodeType})))},x.fn.extend({find:function(e){var t,i,s=this.length,n=this;if("string"!=typeof e)return this.pushStack(x(e).filter((function(){for(t=0;t<s;t++)if(x.contains(n[t],this))return!0})));for(i=this.pushStack([]),t=0;t<s;t++)x.find(e,n[t],i);return s>1?x.uniqueSort(i):i},filter:function(e){return this.pushStack($(this,e||[],!1))},not:function(e){return this.pushStack($(this,e||[],!0))},is:function(e){return!!$(this,"string"==typeof e&&H.test(e)?x(e):e||[],!1).length}});var V,W=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(x.fn.init=function(e,t,i){var s,n;if(!e)return this;if(i=i||V,"string"==typeof e){if(!(s="<"===e[0]&&">"===e[e.length-1]&&e.length>=3?[null,e,null]:W.exec(e))||!s[1]&&t)return!t||t.jquery?(t||i).find(e):this.constructor(t).find(e);if(s[1]){if(t=t instanceof x?t[0]:t,x.merge(this,x.parseHTML(s[1],t&&t.nodeType?t.ownerDocument||t:b,!0)),z.test(s[1])&&x.isPlainObject(t))for(s in t)_(this[s])?this[s](t[s]):this.attr(s,t[s]);return this}return(n=b.getElementById(s[2]))&&(this[0]=n,this.length=1),this}return e.nodeType?(this[0]=e,this.length=1,this):_(e)?void 0!==i.ready?i.ready(e):e(x):x.makeArray(e,this)}).prototype=x.fn,V=x(b);var U=/^(?:parents|prev(?:Until|All))/,j={children:!0,contents:!0,next:!0,prev:!0};function G(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}x.fn.extend({has:function(e){var t=x(e,this),i=t.length;return this.filter((function(){for(var e=0;e<i;e++)if(x.contains(this,t[e]))return!0}))},closest:function(e,t){var i,s=0,n=this.length,r=[],o="string"!=typeof e&&x(e);if(!H.test(e))for(;s<n;s++)for(i=this[s];i&&i!==t;i=i.parentNode)if(i.nodeType<11&&(o?o.index(i)>-1:1===i.nodeType&&x.find.matchesSelector(i,e))){r.push(i);break}return this.pushStack(r.length>1?x.uniqueSort(r):r)},index:function(e){return e?"string"==typeof e?c.call(x(e),this[0]):c.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(x.uniqueSort(x.merge(this.get(),x(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),x.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return F(e,"parentNode")},parentsUntil:function(e,t,i){return F(e,"parentNode",i)},next:function(e){return G(e,"nextSibling")},prev:function(e){return G(e,"previousSibling")},nextAll:function(e){return F(e,"nextSibling")},prevAll:function(e){return F(e,"previousSibling")},nextUntil:function(e,t,i){return F(e,"nextSibling",i)},prevUntil:function(e,t,i){return F(e,"previousSibling",i)},siblings:function(e){return B((e.parentNode||{}).firstChild,e)},children:function(e){return B(e.firstChild)},contents:function(e){return null!=e.contentDocument&&o(e.contentDocument)?e.contentDocument:(O(e,"template")&&(e=e.content||e),x.merge([],e.childNodes))}},(function(e,t){x.fn[e]=function(i,s){var n=x.map(this,t,i);return"Until"!==e.slice(-5)&&(s=i),s&&"string"==typeof s&&(n=x.filter(s,n)),this.length>1&&(j[e]||x.uniqueSort(n),U.test(e)&&n.reverse()),this.pushStack(n)}}));var q=/[^\x20\t\r\n\f]+/g;function K(e){return e}function Y(e){throw e}function X(e,t,i,s){var n;try{e&&_(n=e.promise)?n.call(e).done(t).fail(i):e&&_(n=e.then)?n.call(e,t,i):t.apply(void 0,[e].slice(s))}catch(e){i.apply(void 0,[e])}}x.Callbacks=function(e){e="string"==typeof e?function(e){var t={};return x.each(e.match(q)||[],(function(e,i){t[i]=!0})),t}(e):x.extend({},e);var t,i,s,n,r=[],o=[],a=-1,l=function(){for(n=n||e.once,s=t=!0;o.length;a=-1)for(i=o.shift();++a<r.length;)!1===r[a].apply(i[0],i[1])&&e.stopOnFalse&&(a=r.length,i=!1);e.memory||(i=!1),t=!1,n&&(r=i?[]:"")},h={add:function(){return r&&(i&&!t&&(a=r.length-1,o.push(i)),function t(i){x.each(i,(function(i,s){_(s)?e.unique&&h.has(s)||r.push(s):s&&s.length&&"string"!==w(s)&&t(s)}))}(arguments),i&&!t&&l()),this},remove:function(){return x.each(arguments,(function(e,t){for(var i;(i=x.inArray(t,r,i))>-1;)r.splice(i,1),i<=a&&a--})),this},has:function(e){return e?x.inArray(e,r)>-1:r.length>0},empty:function(){return r&&(r=[]),this},disable:function(){return n=o=[],r=i="",this},disabled:function(){return!r},lock:function(){return n=o=[],i||t||(r=i=""),this},locked:function(){return!!n},fireWith:function(e,i){return n||(i=[e,(i=i||[]).slice?i.slice():i],o.push(i),t||l()),this},fire:function(){return h.fireWith(this,arguments),this},fired:function(){return!!s}};return h},x.extend({Deferred:function(e){var t=[["notify","progress",x.Callbacks("memory"),x.Callbacks("memory"),2],["resolve","done",x.Callbacks("once memory"),x.Callbacks("once memory"),0,"resolved"],["reject","fail",x.Callbacks("once memory"),x.Callbacks("once memory"),1,"rejected"]],i="pending",n={state:function(){return i},always:function(){return r.done(arguments).fail(arguments),this},catch:function(e){return n.then(null,e)},pipe:function(){var e=arguments;return x.Deferred((function(i){x.each(t,(function(t,s){var n=_(e[s[4]])&&e[s[4]];r[s[1]]((function(){var e=n&&n.apply(this,arguments);e&&_(e.promise)?e.promise().progress(i.notify).done(i.resolve).fail(i.reject):i[s[0]+"With"](this,n?[e]:arguments)}))})),e=null})).promise()},then:function(e,i,n){var r=0;function o(e,t,i,n){return function(){var a=this,l=arguments,h=function(){var s,h;if(!(e<r)){if((s=i.apply(a,l))===t.promise())throw new TypeError("Thenable self-resolution");h=s&&("object"==typeof s||"function"==typeof s)&&s.then,_(h)?n?h.call(s,o(r,t,K,n),o(r,t,Y,n)):(r++,h.call(s,o(r,t,K,n),o(r,t,Y,n),o(r,t,K,t.notifyWith))):(i!==K&&(a=void 0,l=[s]),(n||t.resolveWith)(a,l))}},c=n?h:function(){try{h()}catch(s){x.Deferred.exceptionHook&&x.Deferred.exceptionHook(s,c.error),e+1>=r&&(i!==Y&&(a=void 0,l=[s]),t.rejectWith(a,l))}};e?c():(x.Deferred.getErrorHook?c.error=x.Deferred.getErrorHook():x.Deferred.getStackHook&&(c.error=x.Deferred.getStackHook()),s.setTimeout(c))}}return x.Deferred((function(s){t[0][3].add(o(0,s,_(n)?n:K,s.notifyWith)),t[1][3].add(o(0,s,_(e)?e:K)),t[2][3].add(o(0,s,_(i)?i:Y))})).promise()},promise:function(e){return null!=e?x.extend(e,n):n}},r={};return x.each(t,(function(e,s){var o=s[2],a=s[5];n[s[1]]=o.add,a&&o.add((function(){i=a}),t[3-e][2].disable,t[3-e][3].disable,t[0][2].lock,t[0][3].lock),o.add(s[3].fire),r[s[0]]=function(){return r[s[0]+"With"](this===r?void 0:this,arguments),this},r[s[0]+"With"]=o.fireWith})),n.promise(r),e&&e.call(r,r),r},when:function(e){var t=arguments.length,i=t,s=Array(i),n=a.call(arguments),r=x.Deferred(),o=function(e){return function(i){s[e]=this,n[e]=arguments.length>1?a.call(arguments):i,--t||r.resolveWith(s,n)}};if(t<=1&&(X(e,r.done(o(i)).resolve,r.reject,!t),"pending"===r.state()||_(n[i]&&n[i].then)))return r.then();for(;i--;)X(n[i],o(i),r.reject);return r.promise()}});var Z=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;x.Deferred.exceptionHook=function(e,t){s.console&&s.console.warn&&e&&Z.test(e.name)&&s.console.warn("jQuery.Deferred exception: "+e.message,e.stack,t)},x.readyException=function(e){s.setTimeout((function(){throw e}))};var Q=x.Deferred();function J(){b.removeEventListener("DOMContentLoaded",J),s.removeEventListener("load",J),x.ready()}x.fn.ready=function(e){return Q.then(e).catch((function(e){x.readyException(e)})),this},x.extend({isReady:!1,readyWait:1,ready:function(e){(!0===e?--x.readyWait:x.isReady)||(x.isReady=!0,!0!==e&&--x.readyWait>0||Q.resolveWith(b,[x]))}}),x.ready.then=Q.then,"complete"===b.readyState||"loading"!==b.readyState&&!b.documentElement.doScroll?s.setTimeout(x.ready):(b.addEventListener("DOMContentLoaded",J),s.addEventListener("load",J));var ee=function(e,t,i,s,n,r,o){var a=0,l=e.length,h=null==i;if("object"===w(i))for(a in n=!0,i)ee(e,t,a,i[a],!0,r,o);else if(void 0!==s&&(n=!0,_(s)||(o=!0),h&&(o?(t.call(e,s),t=null):(h=t,t=function(e,t,i){return h.call(x(e),i)})),t))for(;a<l;a++)t(e[a],i,o?s:s.call(e[a],a,t(e[a],i)));return n?e:h?t.call(e):l?t(e[0],i):r},te=/^-ms-/,ie=/-([a-z])/g;function se(e,t){return t.toUpperCase()}function ne(e){return e.replace(te,"ms-").replace(ie,se)}var re=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType};function oe(){this.expando=x.expando+oe.uid++}oe.uid=1,oe.prototype={cache:function(e){var t=e[this.expando];return t||(t={},re(e)&&(e.nodeType?e[this.expando]=t:Object.defineProperty(e,this.expando,{value:t,configurable:!0}))),t},set:function(e,t,i){var s,n=this.cache(e);if("string"==typeof t)n[ne(t)]=i;else for(s in t)n[ne(s)]=t[s];return n},get:function(e,t){return void 0===t?this.cache(e):e[this.expando]&&e[this.expando][ne(t)]},access:function(e,t,i){return void 0===t||t&&"string"==typeof t&&void 0===i?this.get(e,t):(this.set(e,t,i),void 0!==i?i:t)},remove:function(e,t){var i,s=e[this.expando];if(void 0!==s){if(void 0!==t){i=(t=Array.isArray(t)?t.map(ne):(t=ne(t))in s?[t]:t.match(q)||[]).length;for(;i--;)delete s[t[i]]}(void 0===t||x.isEmptyObject(s))&&(e.nodeType?e[this.expando]=void 0:delete e[this.expando])}},hasData:function(e){var t=e[this.expando];return void 0!==t&&!x.isEmptyObject(t)}};var ae=new oe,le=new oe,he=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,ce=/[A-Z]/g;function de(e,t,i){var s;if(void 0===i&&1===e.nodeType)if(s="data-"+t.replace(ce,"-$&").toLowerCase(),"string"==typeof(i=e.getAttribute(s))){try{i=function(e){return"true"===e||"false"!==e&&("null"===e?null:e===+e+""?+e:he.test(e)?JSON.parse(e):e)}(i)}catch(e){}le.set(e,t,i)}else i=void 0;return i}x.extend({hasData:function(e){return le.hasData(e)||ae.hasData(e)},data:function(e,t,i){return le.access(e,t,i)},removeData:function(e,t){le.remove(e,t)},_data:function(e,t,i){return ae.access(e,t,i)},_removeData:function(e,t){ae.remove(e,t)}}),x.fn.extend({data:function(e,t){var i,s,n,r=this[0],o=r&&r.attributes;if(void 0===e){if(this.length&&(n=le.get(r),1===r.nodeType&&!ae.get(r,"hasDataAttrs"))){for(i=o.length;i--;)o[i]&&0===(s=o[i].name).indexOf("data-")&&(s=ne(s.slice(5)),de(r,s,n[s]));ae.set(r,"hasDataAttrs",!0)}return n}return"object"==typeof e?this.each((function(){le.set(this,e)})):ee(this,(function(t){var i;if(r&&void 0===t)return void 0!==(i=le.get(r,e))||void 0!==(i=de(r,e))?i:void 0;this.each((function(){le.set(this,e,t)}))}),null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each((function(){le.remove(this,e)}))}}),x.extend({queue:function(e,t,i){var s;if(e)return t=(t||"fx")+"queue",s=ae.get(e,t),i&&(!s||Array.isArray(i)?s=ae.access(e,t,x.makeArray(i)):s.push(i)),s||[]},dequeue:function(e,t){t=t||"fx";var i=x.queue(e,t),s=i.length,n=i.shift(),r=x._queueHooks(e,t);"inprogress"===n&&(n=i.shift(),s--),n&&("fx"===t&&i.unshift("inprogress"),delete r.stop,n.call(e,(function(){x.dequeue(e,t)}),r)),!s&&r&&r.empty.fire()},_queueHooks:function(e,t){var i=t+"queueHooks";return ae.get(e,i)||ae.access(e,i,{empty:x.Callbacks("once memory").add((function(){ae.remove(e,[t+"queue",i])}))})}}),x.fn.extend({queue:function(e,t){var i=2;return"string"!=typeof e&&(t=e,e="fx",i--),arguments.length<i?x.queue(this[0],e):void 0===t?this:this.each((function(){var i=x.queue(this,e,t);x._queueHooks(this,e),"fx"===e&&"inprogress"!==i[0]&&x.dequeue(this,e)}))},dequeue:function(e){return this.each((function(){x.dequeue(this,e)}))},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var i,s=1,n=x.Deferred(),r=this,o=this.length,a=function(){--s||n.resolveWith(r,[r])};for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";o--;)(i=ae.get(r[o],e+"queueHooks"))&&i.empty&&(s++,i.empty.add(a));return a(),n.promise(t)}});var ue=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,pe=new RegExp("^(?:([+-])=|)("+ue+")([a-z%]*)$","i"),me=["Top","Right","Bottom","Left"],fe=b.documentElement,ge=function(e){return x.contains(e.ownerDocument,e)},_e={composed:!0};fe.getRootNode&&(ge=function(e){return x.contains(e.ownerDocument,e)||e.getRootNode(_e)===e.ownerDocument});var ve=function(e,t){return"none"===(e=t||e).style.display||""===e.style.display&&ge(e)&&"none"===x.css(e,"display")};function be(e,t,i,s){var n,r,o=20,a=s?function(){return s.cur()}:function(){return x.css(e,t,"")},l=a(),h=i&&i[3]||(x.cssNumber[t]?"":"px"),c=e.nodeType&&(x.cssNumber[t]||"px"!==h&&+l)&&pe.exec(x.css(e,t));if(c&&c[3]!==h){for(l/=2,h=h||c[3],c=+l||1;o--;)x.style(e,t,c+h),(1-r)*(1-(r=a()/l||.5))<=0&&(o=0),c/=r;c*=2,x.style(e,t,c+h),i=i||[]}return i&&(c=+c||+l||0,n=i[1]?c+(i[1]+1)*i[2]:+i[2],s&&(s.unit=h,s.start=c,s.end=n)),n}var ye={};function Ce(e){var t,i=e.ownerDocument,s=e.nodeName,n=ye[s];return n||(t=i.body.appendChild(i.createElement(s)),n=x.css(t,"display"),t.parentNode.removeChild(t),"none"===n&&(n="block"),ye[s]=n,n)}function we(e,t){for(var i,s,n=[],r=0,o=e.length;r<o;r++)(s=e[r]).style&&(i=s.style.display,t?("none"===i&&(n[r]=ae.get(s,"display")||null,n[r]||(s.style.display="")),""===s.style.display&&ve(s)&&(n[r]=Ce(s))):"none"!==i&&(n[r]="none",ae.set(s,"display",i)));for(r=0;r<o;r++)null!=n[r]&&(e[r].style.display=n[r]);return e}x.fn.extend({show:function(){return we(this,!0)},hide:function(){return we(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each((function(){ve(this)?x(this).show():x(this).hide()}))}});var Se,Ee,xe=/^(?:checkbox|radio)$/i,Te=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,Oe=/^$|^module$|\/(?:java|ecma)script/i;Se=b.createDocumentFragment().appendChild(b.createElement("div")),(Ee=b.createElement("input")).setAttribute("type","radio"),Ee.setAttribute("checked","checked"),Ee.setAttribute("name","t"),Se.appendChild(Ee),g.checkClone=Se.cloneNode(!0).cloneNode(!0).lastChild.checked,Se.innerHTML="<textarea>x</textarea>",g.noCloneChecked=!!Se.cloneNode(!0).lastChild.defaultValue,Se.innerHTML="<option></option>",g.option=!!Se.lastChild;var ke={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function Ie(e,t){var i;return i=void 0!==e.getElementsByTagName?e.getElementsByTagName(t||"*"):void 0!==e.querySelectorAll?e.querySelectorAll(t||"*"):[],void 0===t||t&&O(e,t)?x.merge([e],i):i}function Ae(e,t){for(var i=0,s=e.length;i<s;i++)ae.set(e[i],"globalEval",!t||ae.get(t[i],"globalEval"))}ke.tbody=ke.tfoot=ke.colgroup=ke.caption=ke.thead,ke.th=ke.td,g.option||(ke.optgroup=ke.option=[1,"<select multiple='multiple'>","</select>"]);var De=/<|&#?\w+;/;function Re(e,t,i,s,n){for(var r,o,a,l,h,c,d=t.createDocumentFragment(),u=[],p=0,m=e.length;p<m;p++)if((r=e[p])||0===r)if("object"===w(r))x.merge(u,r.nodeType?[r]:r);else if(De.test(r)){for(o=o||d.appendChild(t.createElement("div")),a=(Te.exec(r)||["",""])[1].toLowerCase(),l=ke[a]||ke._default,o.innerHTML=l[1]+x.htmlPrefilter(r)+l[2],c=l[0];c--;)o=o.lastChild;x.merge(u,o.childNodes),(o=d.firstChild).textContent=""}else u.push(t.createTextNode(r));for(d.textContent="",p=0;r=u[p++];)if(s&&x.inArray(r,s)>-1)n&&n.push(r);else if(h=ge(r),o=Ie(d.appendChild(r),"script"),h&&Ae(o),i)for(c=0;r=o[c++];)Oe.test(r.type||"")&&i.push(r);return d}var Pe=/^([^.]*)(?:\.(.+)|)/;function Le(){return!0}function Me(){return!1}function Ne(e,t,i,s,n,r){var o,a;if("object"==typeof t){for(a in"string"!=typeof i&&(s=s||i,i=void 0),t)Ne(e,a,i,s,t[a],r);return e}if(null==s&&null==n?(n=i,s=i=void 0):null==n&&("string"==typeof i?(n=s,s=void 0):(n=s,s=i,i=void 0)),!1===n)n=Me;else if(!n)return e;return 1===r&&(o=n,n=function(e){return x().off(e),o.apply(this,arguments)},n.guid=o.guid||(o.guid=x.guid++)),e.each((function(){x.event.add(this,t,n,s,i)}))}function Fe(e,t,i){i?(ae.set(e,t,!1),x.event.add(e,t,{namespace:!1,handler:function(e){var i,s=ae.get(this,t);if(1&e.isTrigger&&this[t]){if(s)(x.event.special[t]||{}).delegateType&&e.stopPropagation();else if(s=a.call(arguments),ae.set(this,t,s),this[t](),i=ae.get(this,t),ae.set(this,t,!1),s!==i)return e.stopImmediatePropagation(),e.preventDefault(),i}else s&&(ae.set(this,t,x.event.trigger(s[0],s.slice(1),this)),e.stopPropagation(),e.isImmediatePropagationStopped=Le)}})):void 0===ae.get(e,t)&&x.event.add(e,t,Le)}x.event={global:{},add:function(e,t,i,s,n){var r,o,a,l,h,c,d,u,p,m,f,g=ae.get(e);if(re(e))for(i.handler&&(i=(r=i).handler,n=r.selector),n&&x.find.matchesSelector(fe,n),i.guid||(i.guid=x.guid++),(l=g.events)||(l=g.events=Object.create(null)),(o=g.handle)||(o=g.handle=function(t){return void 0!==x&&x.event.triggered!==t.type?x.event.dispatch.apply(e,arguments):void 0}),h=(t=(t||"").match(q)||[""]).length;h--;)p=f=(a=Pe.exec(t[h])||[])[1],m=(a[2]||"").split(".").sort(),p&&(d=x.event.special[p]||{},p=(n?d.delegateType:d.bindType)||p,d=x.event.special[p]||{},c=x.extend({type:p,origType:f,data:s,handler:i,guid:i.guid,selector:n,needsContext:n&&x.expr.match.needsContext.test(n),namespace:m.join(".")},r),(u=l[p])||((u=l[p]=[]).delegateCount=0,d.setup&&!1!==d.setup.call(e,s,m,o)||e.addEventListener&&e.addEventListener(p,o)),d.add&&(d.add.call(e,c),c.handler.guid||(c.handler.guid=i.guid)),n?u.splice(u.delegateCount++,0,c):u.push(c),x.event.global[p]=!0)},remove:function(e,t,i,s,n){var r,o,a,l,h,c,d,u,p,m,f,g=ae.hasData(e)&&ae.get(e);if(g&&(l=g.events)){for(h=(t=(t||"").match(q)||[""]).length;h--;)if(p=f=(a=Pe.exec(t[h])||[])[1],m=(a[2]||"").split(".").sort(),p){for(d=x.event.special[p]||{},u=l[p=(s?d.delegateType:d.bindType)||p]||[],a=a[2]&&new RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"),o=r=u.length;r--;)c=u[r],!n&&f!==c.origType||i&&i.guid!==c.guid||a&&!a.test(c.namespace)||s&&s!==c.selector&&("**"!==s||!c.selector)||(u.splice(r,1),c.selector&&u.delegateCount--,d.remove&&d.remove.call(e,c));o&&!u.length&&(d.teardown&&!1!==d.teardown.call(e,m,g.handle)||x.removeEvent(e,p,g.handle),delete l[p])}else for(p in l)x.event.remove(e,p+t[h],i,s,!0);x.isEmptyObject(l)&&ae.remove(e,"handle events")}},dispatch:function(e){var t,i,s,n,r,o,a=new Array(arguments.length),l=x.event.fix(e),h=(ae.get(this,"events")||Object.create(null))[l.type]||[],c=x.event.special[l.type]||{};for(a[0]=l,t=1;t<arguments.length;t++)a[t]=arguments[t];if(l.delegateTarget=this,!c.preDispatch||!1!==c.preDispatch.call(this,l)){for(o=x.event.handlers.call(this,l,h),t=0;(n=o[t++])&&!l.isPropagationStopped();)for(l.currentTarget=n.elem,i=0;(r=n.handlers[i++])&&!l.isImmediatePropagationStopped();)l.rnamespace&&!1!==r.namespace&&!l.rnamespace.test(r.namespace)||(l.handleObj=r,l.data=r.data,void 0!==(s=((x.event.special[r.origType]||{}).handle||r.handler).apply(n.elem,a))&&!1===(l.result=s)&&(l.preventDefault(),l.stopPropagation()));return c.postDispatch&&c.postDispatch.call(this,l),l.result}},handlers:function(e,t){var i,s,n,r,o,a=[],l=t.delegateCount,h=e.target;if(l&&h.nodeType&&!("click"===e.type&&e.button>=1))for(;h!==this;h=h.parentNode||this)if(1===h.nodeType&&("click"!==e.type||!0!==h.disabled)){for(r=[],o={},i=0;i<l;i++)void 0===o[n=(s=t[i]).selector+" "]&&(o[n]=s.needsContext?x(n,this).index(h)>-1:x.find(n,this,null,[h]).length),o[n]&&r.push(s);r.length&&a.push({elem:h,handlers:r})}return h=this,l<t.length&&a.push({elem:h,handlers:t.slice(l)}),a},addProp:function(e,t){Object.defineProperty(x.Event.prototype,e,{enumerable:!0,configurable:!0,get:_(t)?function(){if(this.originalEvent)return t(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[e]},set:function(t){Object.defineProperty(this,e,{enumerable:!0,configurable:!0,writable:!0,value:t})}})},fix:function(e){return e[x.expando]?e:new x.Event(e)},special:{load:{noBubble:!0},click:{setup:function(e){var t=this||e;return xe.test(t.type)&&t.click&&O(t,"input")&&Fe(t,"click",!0),!1},trigger:function(e){var t=this||e;return xe.test(t.type)&&t.click&&O(t,"input")&&Fe(t,"click"),!0},_default:function(e){var t=e.target;return xe.test(t.type)&&t.click&&O(t,"input")&&ae.get(t,"click")||O(t,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}},x.removeEvent=function(e,t,i){e.removeEventListener&&e.removeEventListener(t,i)},x.Event=function(e,t){if(!(this instanceof x.Event))return new x.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?Le:Me,this.target=e.target&&3===e.target.nodeType?e.target.parentNode:e.target,this.currentTarget=e.currentTarget,this.relatedTarget=e.relatedTarget):this.type=e,t&&x.extend(this,t),this.timeStamp=e&&e.timeStamp||Date.now(),this[x.expando]=!0},x.Event.prototype={constructor:x.Event,isDefaultPrevented:Me,isPropagationStopped:Me,isImmediatePropagationStopped:Me,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=Le,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=Le,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=Le,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},x.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},x.event.addProp),x.each({focus:"focusin",blur:"focusout"},(function(e,t){function i(e){if(b.documentMode){var i=ae.get(this,"handle"),s=x.event.fix(e);s.type="focusin"===e.type?"focus":"blur",s.isSimulated=!0,i(e),s.target===s.currentTarget&&i(s)}else x.event.simulate(t,e.target,x.event.fix(e))}x.event.special[e]={setup:function(){var s;if(Fe(this,e,!0),!b.documentMode)return!1;(s=ae.get(this,t))||this.addEventListener(t,i),ae.set(this,t,(s||0)+1)},trigger:function(){return Fe(this,e),!0},teardown:function(){var e;if(!b.documentMode)return!1;(e=ae.get(this,t)-1)?ae.set(this,t,e):(this.removeEventListener(t,i),ae.remove(this,t))},_default:function(t){return ae.get(t.target,e)},delegateType:t},x.event.special[t]={setup:function(){var s=this.ownerDocument||this.document||this,n=b.documentMode?this:s,r=ae.get(n,t);r||(b.documentMode?this.addEventListener(t,i):s.addEventListener(e,i,!0)),ae.set(n,t,(r||0)+1)},teardown:function(){var s=this.ownerDocument||this.document||this,n=b.documentMode?this:s,r=ae.get(n,t)-1;r?ae.set(n,t,r):(b.documentMode?this.removeEventListener(t,i):s.removeEventListener(e,i,!0),ae.remove(n,t))}}})),x.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},(function(e,t){x.event.special[e]={delegateType:t,bindType:t,handle:function(e){var i,s=e.relatedTarget,n=e.handleObj;return s&&(s===this||x.contains(this,s))||(e.type=n.origType,i=n.handler.apply(this,arguments),e.type=t),i}}})),x.fn.extend({on:function(e,t,i,s){return Ne(this,e,t,i,s)},one:function(e,t,i,s){return Ne(this,e,t,i,s,1)},off:function(e,t,i){var s,n;if(e&&e.preventDefault&&e.handleObj)return s=e.handleObj,x(e.delegateTarget).off(s.namespace?s.origType+"."+s.namespace:s.origType,s.selector,s.handler),this;if("object"==typeof e){for(n in e)this.off(n,t,e[n]);return this}return!1!==t&&"function"!=typeof t||(i=t,t=void 0),!1===i&&(i=Me),this.each((function(){x.event.remove(this,e,i,t)}))}});var Be=/<script|<style|<link/i,He=/checked\s*(?:[^=]|=\s*.checked.)/i,ze=/^\s*<!\[CDATA\[|\]\]>\s*$/g;function $e(e,t){return O(e,"table")&&O(11!==t.nodeType?t:t.firstChild,"tr")&&x(e).children("tbody")[0]||e}function Ve(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function We(e){return"true/"===(e.type||"").slice(0,5)?e.type=e.type.slice(5):e.removeAttribute("type"),e}function Ue(e,t){var i,s,n,r,o,a;if(1===t.nodeType){if(ae.hasData(e)&&(a=ae.get(e).events))for(n in ae.remove(t,"handle events"),a)for(i=0,s=a[n].length;i<s;i++)x.event.add(t,n,a[n][i]);le.hasData(e)&&(r=le.access(e),o=x.extend({},r),le.set(t,o))}}function je(e,t){var i=t.nodeName.toLowerCase();"input"===i&&xe.test(e.type)?t.checked=e.checked:"input"!==i&&"textarea"!==i||(t.defaultValue=e.defaultValue)}function Ge(e,t,i,s){t=l(t);var n,r,o,a,h,c,d=0,u=e.length,p=u-1,m=t[0],f=_(m);if(f||u>1&&"string"==typeof m&&!g.checkClone&&He.test(m))return e.each((function(n){var r=e.eq(n);f&&(t[0]=m.call(this,n,r.html())),Ge(r,t,i,s)}));if(u&&(r=(n=Re(t,e[0].ownerDocument,!1,e,s)).firstChild,1===n.childNodes.length&&(n=r),r||s)){for(a=(o=x.map(Ie(n,"script"),Ve)).length;d<u;d++)h=n,d!==p&&(h=x.clone(h,!0,!0),a&&x.merge(o,Ie(h,"script"))),i.call(e[d],h,d);if(a)for(c=o[o.length-1].ownerDocument,x.map(o,We),d=0;d<a;d++)h=o[d],Oe.test(h.type||"")&&!ae.access(h,"globalEval")&&x.contains(c,h)&&(h.src&&"module"!==(h.type||"").toLowerCase()?x._evalUrl&&!h.noModule&&x._evalUrl(h.src,{nonce:h.nonce||h.getAttribute("nonce")},c):C(h.textContent.replace(ze,""),h,c))}return e}function qe(e,t,i){for(var s,n=t?x.filter(t,e):e,r=0;null!=(s=n[r]);r++)i||1!==s.nodeType||x.cleanData(Ie(s)),s.parentNode&&(i&&ge(s)&&Ae(Ie(s,"script")),s.parentNode.removeChild(s));return e}x.extend({htmlPrefilter:function(e){return e},clone:function(e,t,i){var s,n,r,o,a=e.cloneNode(!0),l=ge(e);if(!(g.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||x.isXMLDoc(e)))for(o=Ie(a),s=0,n=(r=Ie(e)).length;s<n;s++)je(r[s],o[s]);if(t)if(i)for(r=r||Ie(e),o=o||Ie(a),s=0,n=r.length;s<n;s++)Ue(r[s],o[s]);else Ue(e,a);return(o=Ie(a,"script")).length>0&&Ae(o,!l&&Ie(e,"script")),a},cleanData:function(e){for(var t,i,s,n=x.event.special,r=0;void 0!==(i=e[r]);r++)if(re(i)){if(t=i[ae.expando]){if(t.events)for(s in t.events)n[s]?x.event.remove(i,s):x.removeEvent(i,s,t.handle);i[ae.expando]=void 0}i[le.expando]&&(i[le.expando]=void 0)}}}),x.fn.extend({detach:function(e){return qe(this,e,!0)},remove:function(e){return qe(this,e)},text:function(e){return ee(this,(function(e){return void 0===e?x.text(this):this.empty().each((function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=e)}))}),null,e,arguments.length)},append:function(){return Ge(this,arguments,(function(e){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||$e(this,e).appendChild(e)}))},prepend:function(){return Ge(this,arguments,(function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=$e(this,e);t.insertBefore(e,t.firstChild)}}))},before:function(){return Ge(this,arguments,(function(e){this.parentNode&&this.parentNode.insertBefore(e,this)}))},after:function(){return Ge(this,arguments,(function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)}))},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(x.cleanData(Ie(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map((function(){return x.clone(this,e,t)}))},html:function(e){return ee(this,(function(e){var t=this[0]||{},i=0,s=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!Be.test(e)&&!ke[(Te.exec(e)||["",""])[1].toLowerCase()]){e=x.htmlPrefilter(e);try{for(;i<s;i++)1===(t=this[i]||{}).nodeType&&(x.cleanData(Ie(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)}),null,e,arguments.length)},replaceWith:function(){var e=[];return Ge(this,arguments,(function(t){var i=this.parentNode;x.inArray(this,e)<0&&(x.cleanData(Ie(this)),i&&i.replaceChild(t,this))}),e)}}),x.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},(function(e,t){x.fn[e]=function(e){for(var i,s=[],n=x(e),r=n.length-1,o=0;o<=r;o++)i=o===r?this:this.clone(!0),x(n[o])[t](i),h.apply(s,i.get());return this.pushStack(s)}}));var Ke=new RegExp("^("+ue+")(?!px)[a-z%]+$","i"),Ye=/^--/,Xe=function(e){var t=e.ownerDocument.defaultView;return t&&t.opener||(t=s),t.getComputedStyle(e)},Ze=function(e,t,i){var s,n,r={};for(n in t)r[n]=e.style[n],e.style[n]=t[n];for(n in s=i.call(e),t)e.style[n]=r[n];return s},Qe=new RegExp(me.join("|"),"i");function Je(e,t,i){var s,n,r,o,a=Ye.test(t),l=e.style;return(i=i||Xe(e))&&(o=i.getPropertyValue(t)||i[t],a&&o&&(o=o.replace(R,"$1")||void 0),""!==o||ge(e)||(o=x.style(e,t)),!g.pixelBoxStyles()&&Ke.test(o)&&Qe.test(t)&&(s=l.width,n=l.minWidth,r=l.maxWidth,l.minWidth=l.maxWidth=l.width=o,o=i.width,l.width=s,l.minWidth=n,l.maxWidth=r)),void 0!==o?o+"":o}function et(e,t){return{get:function(){if(!e())return(this.get=t).apply(this,arguments);delete this.get}}}!function(){function e(){if(c){h.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",c.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",fe.appendChild(h).appendChild(c);var e=s.getComputedStyle(c);i="1%"!==e.top,l=12===t(e.marginLeft),c.style.right="60%",o=36===t(e.right),n=36===t(e.width),c.style.position="absolute",r=12===t(c.offsetWidth/3),fe.removeChild(h),c=null}}function t(e){return Math.round(parseFloat(e))}var i,n,r,o,a,l,h=b.createElement("div"),c=b.createElement("div");c.style&&(c.style.backgroundClip="content-box",c.cloneNode(!0).style.backgroundClip="",g.clearCloneStyle="content-box"===c.style.backgroundClip,x.extend(g,{boxSizingReliable:function(){return e(),n},pixelBoxStyles:function(){return e(),o},pixelPosition:function(){return e(),i},reliableMarginLeft:function(){return e(),l},scrollboxSize:function(){return e(),r},reliableTrDimensions:function(){var e,t,i,n;return null==a&&(e=b.createElement("table"),t=b.createElement("tr"),i=b.createElement("div"),e.style.cssText="position:absolute;left:-11111px;border-collapse:separate",t.style.cssText="box-sizing:content-box;border:1px solid",t.style.height="1px",i.style.height="9px",i.style.display="block",fe.appendChild(e).appendChild(t).appendChild(i),n=s.getComputedStyle(t),a=parseInt(n.height,10)+parseInt(n.borderTopWidth,10)+parseInt(n.borderBottomWidth,10)===t.offsetHeight,fe.removeChild(e)),a}}))}();var tt=["Webkit","Moz","ms"],it=b.createElement("div").style,st={};function nt(e){return x.cssProps[e]||st[e]||(e in it?e:st[e]=function(e){for(var t=e[0].toUpperCase()+e.slice(1),i=tt.length;i--;)if((e=tt[i]+t)in it)return e}(e)||e)}var rt=/^(none|table(?!-c[ea]).+)/,ot={position:"absolute",visibility:"hidden",display:"block"},at={letterSpacing:"0",fontWeight:"400"};function lt(e,t,i){var s=pe.exec(t);return s?Math.max(0,s[2]-(i||0))+(s[3]||"px"):t}function ht(e,t,i,s,n,r){var o="width"===t?1:0,a=0,l=0,h=0;if(i===(s?"border":"content"))return 0;for(;o<4;o+=2)"margin"===i&&(h+=x.css(e,i+me[o],!0,n)),s?("content"===i&&(l-=x.css(e,"padding"+me[o],!0,n)),"margin"!==i&&(l-=x.css(e,"border"+me[o]+"Width",!0,n))):(l+=x.css(e,"padding"+me[o],!0,n),"padding"!==i?l+=x.css(e,"border"+me[o]+"Width",!0,n):a+=x.css(e,"border"+me[o]+"Width",!0,n));return!s&&r>=0&&(l+=Math.max(0,Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-r-l-a-.5))||0),l+h}function ct(e,t,i){var s=Xe(e),n=(!g.boxSizingReliable()||i)&&"border-box"===x.css(e,"boxSizing",!1,s),r=n,o=Je(e,t,s),a="offset"+t[0].toUpperCase()+t.slice(1);if(Ke.test(o)){if(!i)return o;o="auto"}return(!g.boxSizingReliable()&&n||!g.reliableTrDimensions()&&O(e,"tr")||"auto"===o||!parseFloat(o)&&"inline"===x.css(e,"display",!1,s))&&e.getClientRects().length&&(n="border-box"===x.css(e,"boxSizing",!1,s),(r=a in e)&&(o=e[a])),(o=parseFloat(o)||0)+ht(e,t,i||(n?"border":"content"),r,s,o)+"px"}function dt(e,t,i,s,n){return new dt.prototype.init(e,t,i,s,n)}x.extend({cssHooks:{opacity:{get:function(e,t){if(t){var i=Je(e,"opacity");return""===i?"1":i}}}},cssNumber:{animationIterationCount:!0,aspectRatio:!0,borderImageSlice:!0,columnCount:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,scale:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeMiterlimit:!0,strokeOpacity:!0},cssProps:{},style:function(e,t,i,s){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var n,r,o,a=ne(t),l=Ye.test(t),h=e.style;if(l||(t=nt(a)),o=x.cssHooks[t]||x.cssHooks[a],void 0===i)return o&&"get"in o&&void 0!==(n=o.get(e,!1,s))?n:h[t];"string"==(r=typeof i)&&(n=pe.exec(i))&&n[1]&&(i=be(e,t,n),r="number"),null!=i&&i==i&&("number"!==r||l||(i+=n&&n[3]||(x.cssNumber[a]?"":"px")),g.clearCloneStyle||""!==i||0!==t.indexOf("background")||(h[t]="inherit"),o&&"set"in o&&void 0===(i=o.set(e,i,s))||(l?h.setProperty(t,i):h[t]=i))}},css:function(e,t,i,s){var n,r,o,a=ne(t);return Ye.test(t)||(t=nt(a)),(o=x.cssHooks[t]||x.cssHooks[a])&&"get"in o&&(n=o.get(e,!0,i)),void 0===n&&(n=Je(e,t,s)),"normal"===n&&t in at&&(n=at[t]),""===i||i?(r=parseFloat(n),!0===i||isFinite(r)?r||0:n):n}}),x.each(["height","width"],(function(e,t){x.cssHooks[t]={get:function(e,i,s){if(i)return!rt.test(x.css(e,"display"))||e.getClientRects().length&&e.getBoundingClientRect().width?ct(e,t,s):Ze(e,ot,(function(){return ct(e,t,s)}))},set:function(e,i,s){var n,r=Xe(e),o=!g.scrollboxSize()&&"absolute"===r.position,a=(o||s)&&"border-box"===x.css(e,"boxSizing",!1,r),l=s?ht(e,t,s,a,r):0;return a&&o&&(l-=Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-parseFloat(r[t])-ht(e,t,"border",!1,r)-.5)),l&&(n=pe.exec(i))&&"px"!==(n[3]||"px")&&(e.style[t]=i,i=x.css(e,t)),lt(0,i,l)}}})),x.cssHooks.marginLeft=et(g.reliableMarginLeft,(function(e,t){if(t)return(parseFloat(Je(e,"marginLeft"))||e.getBoundingClientRect().left-Ze(e,{marginLeft:0},(function(){return e.getBoundingClientRect().left})))+"px"})),x.each({margin:"",padding:"",border:"Width"},(function(e,t){x.cssHooks[e+t]={expand:function(i){for(var s=0,n={},r="string"==typeof i?i.split(" "):[i];s<4;s++)n[e+me[s]+t]=r[s]||r[s-2]||r[0];return n}},"margin"!==e&&(x.cssHooks[e+t].set=lt)})),x.fn.extend({css:function(e,t){return ee(this,(function(e,t,i){var s,n,r={},o=0;if(Array.isArray(t)){for(s=Xe(e),n=t.length;o<n;o++)r[t[o]]=x.css(e,t[o],!1,s);return r}return void 0!==i?x.style(e,t,i):x.css(e,t)}),e,t,arguments.length>1)}}),x.Tween=dt,dt.prototype={constructor:dt,init:function(e,t,i,s,n,r){this.elem=e,this.prop=i,this.easing=n||x.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=s,this.unit=r||(x.cssNumber[i]?"":"px")},cur:function(){var e=dt.propHooks[this.prop];return e&&e.get?e.get(this):dt.propHooks._default.get(this)},run:function(e){var t,i=dt.propHooks[this.prop];return this.options.duration?this.pos=t=x.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),i&&i.set?i.set(this):dt.propHooks._default.set(this),this}},dt.prototype.init.prototype=dt.prototype,dt.propHooks={_default:{get:function(e){var t;return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(t=x.css(e.elem,e.prop,""))&&"auto"!==t?t:0},set:function(e){x.fx.step[e.prop]?x.fx.step[e.prop](e):1!==e.elem.nodeType||!x.cssHooks[e.prop]&&null==e.elem.style[nt(e.prop)]?e.elem[e.prop]=e.now:x.style(e.elem,e.prop,e.now+e.unit)}}},dt.propHooks.scrollTop=dt.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},x.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},x.fx=dt.prototype.init,x.fx.step={};var ut,pt,mt=/^(?:toggle|show|hide)$/,ft=/queueHooks$/;function gt(){pt&&(!1===b.hidden&&s.requestAnimationFrame?s.requestAnimationFrame(gt):s.setTimeout(gt,x.fx.interval),x.fx.tick())}function _t(){return s.setTimeout((function(){ut=void 0})),ut=Date.now()}function vt(e,t){var i,s=0,n={height:e};for(t=t?1:0;s<4;s+=2-t)n["margin"+(i=me[s])]=n["padding"+i]=e;return t&&(n.opacity=n.width=e),n}function bt(e,t,i){for(var s,n=(yt.tweeners[t]||[]).concat(yt.tweeners["*"]),r=0,o=n.length;r<o;r++)if(s=n[r].call(i,t,e))return s}function yt(e,t,i){var s,n,r=0,o=yt.prefilters.length,a=x.Deferred().always((function(){delete l.elem})),l=function(){if(n)return!1;for(var t=ut||_t(),i=Math.max(0,h.startTime+h.duration-t),s=1-(i/h.duration||0),r=0,o=h.tweens.length;r<o;r++)h.tweens[r].run(s);return a.notifyWith(e,[h,s,i]),s<1&&o?i:(o||a.notifyWith(e,[h,1,0]),a.resolveWith(e,[h]),!1)},h=a.promise({elem:e,props:x.extend({},t),opts:x.extend(!0,{specialEasing:{},easing:x.easing._default},i),originalProperties:t,originalOptions:i,startTime:ut||_t(),duration:i.duration,tweens:[],createTween:function(t,i){var s=x.Tween(e,h.opts,t,i,h.opts.specialEasing[t]||h.opts.easing);return h.tweens.push(s),s},stop:function(t){var i=0,s=t?h.tweens.length:0;if(n)return this;for(n=!0;i<s;i++)h.tweens[i].run(1);return t?(a.notifyWith(e,[h,1,0]),a.resolveWith(e,[h,t])):a.rejectWith(e,[h,t]),this}}),c=h.props;for(function(e,t){var i,s,n,r,o;for(i in e)if(n=t[s=ne(i)],r=e[i],Array.isArray(r)&&(n=r[1],r=e[i]=r[0]),i!==s&&(e[s]=r,delete e[i]),(o=x.cssHooks[s])&&"expand"in o)for(i in r=o.expand(r),delete e[s],r)i in e||(e[i]=r[i],t[i]=n);else t[s]=n}(c,h.opts.specialEasing);r<o;r++)if(s=yt.prefilters[r].call(h,e,c,h.opts))return _(s.stop)&&(x._queueHooks(h.elem,h.opts.queue).stop=s.stop.bind(s)),s;return x.map(c,bt,h),_(h.opts.start)&&h.opts.start.call(e,h),h.progress(h.opts.progress).done(h.opts.done,h.opts.complete).fail(h.opts.fail).always(h.opts.always),x.fx.timer(x.extend(l,{elem:e,anim:h,queue:h.opts.queue})),h}x.Animation=x.extend(yt,{tweeners:{"*":[function(e,t){var i=this.createTween(e,t);return be(i.elem,e,pe.exec(t),i),i}]},tweener:function(e,t){_(e)?(t=e,e=["*"]):e=e.match(q);for(var i,s=0,n=e.length;s<n;s++)i=e[s],yt.tweeners[i]=yt.tweeners[i]||[],yt.tweeners[i].unshift(t)},prefilters:[function(e,t,i){var s,n,r,o,a,l,h,c,d="width"in t||"height"in t,u=this,p={},m=e.style,f=e.nodeType&&ve(e),g=ae.get(e,"fxshow");for(s in i.queue||(null==(o=x._queueHooks(e,"fx")).unqueued&&(o.unqueued=0,a=o.empty.fire,o.empty.fire=function(){o.unqueued||a()}),o.unqueued++,u.always((function(){u.always((function(){o.unqueued--,x.queue(e,"fx").length||o.empty.fire()}))}))),t)if(n=t[s],mt.test(n)){if(delete t[s],r=r||"toggle"===n,n===(f?"hide":"show")){if("show"!==n||!g||void 0===g[s])continue;f=!0}p[s]=g&&g[s]||x.style(e,s)}if((l=!x.isEmptyObject(t))||!x.isEmptyObject(p))for(s in d&&1===e.nodeType&&(i.overflow=[m.overflow,m.overflowX,m.overflowY],null==(h=g&&g.display)&&(h=ae.get(e,"display")),"none"===(c=x.css(e,"display"))&&(h?c=h:(we([e],!0),h=e.style.display||h,c=x.css(e,"display"),we([e]))),("inline"===c||"inline-block"===c&&null!=h)&&"none"===x.css(e,"float")&&(l||(u.done((function(){m.display=h})),null==h&&(c=m.display,h="none"===c?"":c)),m.display="inline-block")),i.overflow&&(m.overflow="hidden",u.always((function(){m.overflow=i.overflow[0],m.overflowX=i.overflow[1],m.overflowY=i.overflow[2]}))),l=!1,p)l||(g?"hidden"in g&&(f=g.hidden):g=ae.access(e,"fxshow",{display:h}),r&&(g.hidden=!f),f&&we([e],!0),u.done((function(){for(s in f||we([e]),ae.remove(e,"fxshow"),p)x.style(e,s,p[s])}))),l=bt(f?g[s]:0,s,u),s in g||(g[s]=l.start,f&&(l.end=l.start,l.start=0))}],prefilter:function(e,t){t?yt.prefilters.unshift(e):yt.prefilters.push(e)}}),x.speed=function(e,t,i){var s=e&&"object"==typeof e?x.extend({},e):{complete:i||!i&&t||_(e)&&e,duration:e,easing:i&&t||t&&!_(t)&&t};return x.fx.off?s.duration=0:"number"!=typeof s.duration&&(s.duration in x.fx.speeds?s.duration=x.fx.speeds[s.duration]:s.duration=x.fx.speeds._default),null!=s.queue&&!0!==s.queue||(s.queue="fx"),s.old=s.complete,s.complete=function(){_(s.old)&&s.old.call(this),s.queue&&x.dequeue(this,s.queue)},s},x.fn.extend({fadeTo:function(e,t,i,s){return this.filter(ve).css("opacity",0).show().end().animate({opacity:t},e,i,s)},animate:function(e,t,i,s){var n=x.isEmptyObject(e),r=x.speed(t,i,s),o=function(){var t=yt(this,x.extend({},e),r);(n||ae.get(this,"finish"))&&t.stop(!0)};return o.finish=o,n||!1===r.queue?this.each(o):this.queue(r.queue,o)},stop:function(e,t,i){var s=function(e){var t=e.stop;delete e.stop,t(i)};return"string"!=typeof e&&(i=t,t=e,e=void 0),t&&this.queue(e||"fx",[]),this.each((function(){var t=!0,n=null!=e&&e+"queueHooks",r=x.timers,o=ae.get(this);if(n)o[n]&&o[n].stop&&s(o[n]);else for(n in o)o[n]&&o[n].stop&&ft.test(n)&&s(o[n]);for(n=r.length;n--;)r[n].elem!==this||null!=e&&r[n].queue!==e||(r[n].anim.stop(i),t=!1,r.splice(n,1));!t&&i||x.dequeue(this,e)}))},finish:function(e){return!1!==e&&(e=e||"fx"),this.each((function(){var t,i=ae.get(this),s=i[e+"queue"],n=i[e+"queueHooks"],r=x.timers,o=s?s.length:0;for(i.finish=!0,x.queue(this,e,[]),n&&n.stop&&n.stop.call(this,!0),t=r.length;t--;)r[t].elem===this&&r[t].queue===e&&(r[t].anim.stop(!0),r.splice(t,1));for(t=0;t<o;t++)s[t]&&s[t].finish&&s[t].finish.call(this);delete i.finish}))}}),x.each(["toggle","show","hide"],(function(e,t){var i=x.fn[t];x.fn[t]=function(e,s,n){return null==e||"boolean"==typeof e?i.apply(this,arguments):this.animate(vt(t,!0),e,s,n)}})),x.each({slideDown:vt("show"),slideUp:vt("hide"),slideToggle:vt("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},(function(e,t){x.fn[e]=function(e,i,s){return this.animate(t,e,i,s)}})),x.timers=[],x.fx.tick=function(){var e,t=0,i=x.timers;for(ut=Date.now();t<i.length;t++)(e=i[t])()||i[t]!==e||i.splice(t--,1);i.length||x.fx.stop(),ut=void 0},x.fx.timer=function(e){x.timers.push(e),x.fx.start()},x.fx.interval=13,x.fx.start=function(){pt||(pt=!0,gt())},x.fx.stop=function(){pt=null},x.fx.speeds={slow:600,fast:200,_default:400},x.fn.delay=function(e,t){return e=x.fx&&x.fx.speeds[e]||e,t=t||"fx",this.queue(t,(function(t,i){var n=s.setTimeout(t,e);i.stop=function(){s.clearTimeout(n)}}))},function(){var e=b.createElement("input"),t=b.createElement("select").appendChild(b.createElement("option"));e.type="checkbox",g.checkOn=""!==e.value,g.optSelected=t.selected,(e=b.createElement("input")).value="t",e.type="radio",g.radioValue="t"===e.value}();var Ct,wt=x.expr.attrHandle;x.fn.extend({attr:function(e,t){return ee(this,x.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each((function(){x.removeAttr(this,e)}))}}),x.extend({attr:function(e,t,i){var s,n,r=e.nodeType;if(3!==r&&8!==r&&2!==r)return void 0===e.getAttribute?x.prop(e,t,i):(1===r&&x.isXMLDoc(e)||(n=x.attrHooks[t.toLowerCase()]||(x.expr.match.bool.test(t)?Ct:void 0)),void 0!==i?null===i?void x.removeAttr(e,t):n&&"set"in n&&void 0!==(s=n.set(e,i,t))?s:(e.setAttribute(t,i+""),i):n&&"get"in n&&null!==(s=n.get(e,t))?s:null==(s=x.find.attr(e,t))?void 0:s)},attrHooks:{type:{set:function(e,t){if(!g.radioValue&&"radio"===t&&O(e,"input")){var i=e.value;return e.setAttribute("type",t),i&&(e.value=i),t}}}},removeAttr:function(e,t){var i,s=0,n=t&&t.match(q);if(n&&1===e.nodeType)for(;i=n[s++];)e.removeAttribute(i)}}),Ct={set:function(e,t,i){return!1===t?x.removeAttr(e,i):e.setAttribute(i,i),i}},x.each(x.expr.match.bool.source.match(/\w+/g),(function(e,t){var i=wt[t]||x.find.attr;wt[t]=function(e,t,s){var n,r,o=t.toLowerCase();return s||(r=wt[o],wt[o]=n,n=null!=i(e,t,s)?o:null,wt[o]=r),n}}));var St=/^(?:input|select|textarea|button)$/i,Et=/^(?:a|area)$/i;function xt(e){return(e.match(q)||[]).join(" ")}function Tt(e){return e.getAttribute&&e.getAttribute("class")||""}function Ot(e){return Array.isArray(e)?e:"string"==typeof e&&e.match(q)||[]}x.fn.extend({prop:function(e,t){return ee(this,x.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each((function(){delete this[x.propFix[e]||e]}))}}),x.extend({prop:function(e,t,i){var s,n,r=e.nodeType;if(3!==r&&8!==r&&2!==r)return 1===r&&x.isXMLDoc(e)||(t=x.propFix[t]||t,n=x.propHooks[t]),void 0!==i?n&&"set"in n&&void 0!==(s=n.set(e,i,t))?s:e[t]=i:n&&"get"in n&&null!==(s=n.get(e,t))?s:e[t]},propHooks:{tabIndex:{get:function(e){var t=x.find.attr(e,"tabindex");return t?parseInt(t,10):St.test(e.nodeName)||Et.test(e.nodeName)&&e.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),g.optSelected||(x.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null},set:function(e){var t=e.parentNode;t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex)}}),x.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],(function(){x.propFix[this.toLowerCase()]=this})),x.fn.extend({addClass:function(e){var t,i,s,n,r,o;return _(e)?this.each((function(t){x(this).addClass(e.call(this,t,Tt(this)))})):(t=Ot(e)).length?this.each((function(){if(s=Tt(this),i=1===this.nodeType&&" "+xt(s)+" "){for(r=0;r<t.length;r++)n=t[r],i.indexOf(" "+n+" ")<0&&(i+=n+" ");o=xt(i),s!==o&&this.setAttribute("class",o)}})):this},removeClass:function(e){var t,i,s,n,r,o;return _(e)?this.each((function(t){x(this).removeClass(e.call(this,t,Tt(this)))})):arguments.length?(t=Ot(e)).length?this.each((function(){if(s=Tt(this),i=1===this.nodeType&&" "+xt(s)+" "){for(r=0;r<t.length;r++)for(n=t[r];i.indexOf(" "+n+" ")>-1;)i=i.replace(" "+n+" "," ");o=xt(i),s!==o&&this.setAttribute("class",o)}})):this:this.attr("class","")},toggleClass:function(e,t){var i,s,n,r,o=typeof e,a="string"===o||Array.isArray(e);return _(e)?this.each((function(i){x(this).toggleClass(e.call(this,i,Tt(this),t),t)})):"boolean"==typeof t&&a?t?this.addClass(e):this.removeClass(e):(i=Ot(e),this.each((function(){if(a)for(r=x(this),n=0;n<i.length;n++)s=i[n],r.hasClass(s)?r.removeClass(s):r.addClass(s);else void 0!==e&&"boolean"!==o||((s=Tt(this))&&ae.set(this,"__className__",s),this.setAttribute&&this.setAttribute("class",s||!1===e?"":ae.get(this,"__className__")||""))})))},hasClass:function(e){var t,i,s=0;for(t=" "+e+" ";i=this[s++];)if(1===i.nodeType&&(" "+xt(Tt(i))+" ").indexOf(t)>-1)return!0;return!1}});var kt=/\r/g;x.fn.extend({val:function(e){var t,i,s,n=this[0];return arguments.length?(s=_(e),this.each((function(i){var n;1===this.nodeType&&(null==(n=s?e.call(this,i,x(this).val()):e)?n="":"number"==typeof n?n+="":Array.isArray(n)&&(n=x.map(n,(function(e){return null==e?"":e+""}))),(t=x.valHooks[this.type]||x.valHooks[this.nodeName.toLowerCase()])&&"set"in t&&void 0!==t.set(this,n,"value")||(this.value=n))}))):n?(t=x.valHooks[n.type]||x.valHooks[n.nodeName.toLowerCase()])&&"get"in t&&void 0!==(i=t.get(n,"value"))?i:"string"==typeof(i=n.value)?i.replace(kt,""):null==i?"":i:void 0}}),x.extend({valHooks:{option:{get:function(e){var t=x.find.attr(e,"value");return null!=t?t:xt(x.text(e))}},select:{get:function(e){var t,i,s,n=e.options,r=e.selectedIndex,o="select-one"===e.type,a=o?null:[],l=o?r+1:n.length;for(s=r<0?l:o?r:0;s<l;s++)if(((i=n[s]).selected||s===r)&&!i.disabled&&(!i.parentNode.disabled||!O(i.parentNode,"optgroup"))){if(t=x(i).val(),o)return t;a.push(t)}return a},set:function(e,t){for(var i,s,n=e.options,r=x.makeArray(t),o=n.length;o--;)((s=n[o]).selected=x.inArray(x.valHooks.option.get(s),r)>-1)&&(i=!0);return i||(e.selectedIndex=-1),r}}}}),x.each(["radio","checkbox"],(function(){x.valHooks[this]={set:function(e,t){if(Array.isArray(t))return e.checked=x.inArray(x(e).val(),t)>-1}},g.checkOn||(x.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})}));var It=s.location,At={guid:Date.now()},Dt=/\?/;x.parseXML=function(e){var t,i;if(!e||"string"!=typeof e)return null;try{t=(new s.DOMParser).parseFromString(e,"text/xml")}catch(e){}return i=t&&t.getElementsByTagName("parsererror")[0],t&&!i||x.error("Invalid XML: "+(i?x.map(i.childNodes,(function(e){return e.textContent})).join("\n"):e)),t};var Rt=/^(?:focusinfocus|focusoutblur)$/,Pt=function(e){e.stopPropagation()};x.extend(x.event,{trigger:function(e,t,i,n){var r,o,a,l,h,c,d,u,m=[i||b],f=p.call(e,"type")?e.type:e,g=p.call(e,"namespace")?e.namespace.split("."):[];if(o=u=a=i=i||b,3!==i.nodeType&&8!==i.nodeType&&!Rt.test(f+x.event.triggered)&&(f.indexOf(".")>-1&&(g=f.split("."),f=g.shift(),g.sort()),h=f.indexOf(":")<0&&"on"+f,(e=e[x.expando]?e:new x.Event(f,"object"==typeof e&&e)).isTrigger=n?2:3,e.namespace=g.join("."),e.rnamespace=e.namespace?new RegExp("(^|\\.)"+g.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=i),t=null==t?[e]:x.makeArray(t,[e]),d=x.event.special[f]||{},n||!d.trigger||!1!==d.trigger.apply(i,t))){if(!n&&!d.noBubble&&!v(i)){for(l=d.delegateType||f,Rt.test(l+f)||(o=o.parentNode);o;o=o.parentNode)m.push(o),a=o;a===(i.ownerDocument||b)&&m.push(a.defaultView||a.parentWindow||s)}for(r=0;(o=m[r++])&&!e.isPropagationStopped();)u=o,e.type=r>1?l:d.bindType||f,(c=(ae.get(o,"events")||Object.create(null))[e.type]&&ae.get(o,"handle"))&&c.apply(o,t),(c=h&&o[h])&&c.apply&&re(o)&&(e.result=c.apply(o,t),!1===e.result&&e.preventDefault());return e.type=f,n||e.isDefaultPrevented()||d._default&&!1!==d._default.apply(m.pop(),t)||!re(i)||h&&_(i[f])&&!v(i)&&((a=i[h])&&(i[h]=null),x.event.triggered=f,e.isPropagationStopped()&&u.addEventListener(f,Pt),i[f](),e.isPropagationStopped()&&u.removeEventListener(f,Pt),x.event.triggered=void 0,a&&(i[h]=a)),e.result}},simulate:function(e,t,i){var s=x.extend(new x.Event,i,{type:e,isSimulated:!0});x.event.trigger(s,null,t)}}),x.fn.extend({trigger:function(e,t){return this.each((function(){x.event.trigger(e,t,this)}))},triggerHandler:function(e,t){var i=this[0];if(i)return x.event.trigger(e,t,i,!0)}});var Lt=/\[\]$/,Mt=/\r?\n/g,Nt=/^(?:submit|button|image|reset|file)$/i,Ft=/^(?:input|select|textarea|keygen)/i;function Bt(e,t,i,s){var n;if(Array.isArray(t))x.each(t,(function(t,n){i||Lt.test(e)?s(e,n):Bt(e+"["+("object"==typeof n&&null!=n?t:"")+"]",n,i,s)}));else if(i||"object"!==w(t))s(e,t);else for(n in t)Bt(e+"["+n+"]",t[n],i,s)}x.param=function(e,t){var i,s=[],n=function(e,t){var i=_(t)?t():t;s[s.length]=encodeURIComponent(e)+"="+encodeURIComponent(null==i?"":i)};if(null==e)return"";if(Array.isArray(e)||e.jquery&&!x.isPlainObject(e))x.each(e,(function(){n(this.name,this.value)}));else for(i in e)Bt(i,e[i],t,n);return s.join("&")},x.fn.extend({serialize:function(){return x.param(this.serializeArray())},serializeArray:function(){return this.map((function(){var e=x.prop(this,"elements");return e?x.makeArray(e):this})).filter((function(){var e=this.type;return this.name&&!x(this).is(":disabled")&&Ft.test(this.nodeName)&&!Nt.test(e)&&(this.checked||!xe.test(e))})).map((function(e,t){var i=x(this).val();return null==i?null:Array.isArray(i)?x.map(i,(function(e){return{name:t.name,value:e.replace(Mt,"\r\n")}})):{name:t.name,value:i.replace(Mt,"\r\n")}})).get()}});var Ht=/%20/g,zt=/#.*$/,$t=/([?&])_=[^&]*/,Vt=/^(.*?):[ \t]*([^\r\n]*)$/gm,Wt=/^(?:GET|HEAD)$/,Ut=/^\/\//,jt={},Gt={},qt="*/".concat("*"),Kt=b.createElement("a");function Yt(e){return function(t,i){"string"!=typeof t&&(i=t,t="*");var s,n=0,r=t.toLowerCase().match(q)||[];if(_(i))for(;s=r[n++];)"+"===s[0]?(s=s.slice(1)||"*",(e[s]=e[s]||[]).unshift(i)):(e[s]=e[s]||[]).push(i)}}function Xt(e,t,i,s){var n={},r=e===Gt;function o(a){var l;return n[a]=!0,x.each(e[a]||[],(function(e,a){var h=a(t,i,s);return"string"!=typeof h||r||n[h]?r?!(l=h):void 0:(t.dataTypes.unshift(h),o(h),!1)})),l}return o(t.dataTypes[0])||!n["*"]&&o("*")}function Zt(e,t){var i,s,n=x.ajaxSettings.flatOptions||{};for(i in t)void 0!==t[i]&&((n[i]?e:s||(s={}))[i]=t[i]);return s&&x.extend(!0,e,s),e}Kt.href=It.href,x.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:It.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(It.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":qt,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":x.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?Zt(Zt(e,x.ajaxSettings),t):Zt(x.ajaxSettings,e)},ajaxPrefilter:Yt(jt),ajaxTransport:Yt(Gt),ajax:function(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};var i,n,r,o,a,l,h,c,d,u,p=x.ajaxSetup({},t),m=p.context||p,f=p.context&&(m.nodeType||m.jquery)?x(m):x.event,g=x.Deferred(),_=x.Callbacks("once memory"),v=p.statusCode||{},y={},C={},w="canceled",S={readyState:0,getResponseHeader:function(e){var t;if(h){if(!o)for(o={};t=Vt.exec(r);)o[t[1].toLowerCase()+" "]=(o[t[1].toLowerCase()+" "]||[]).concat(t[2]);t=o[e.toLowerCase()+" "]}return null==t?null:t.join(", ")},getAllResponseHeaders:function(){return h?r:null},setRequestHeader:function(e,t){return null==h&&(e=C[e.toLowerCase()]=C[e.toLowerCase()]||e,y[e]=t),this},overrideMimeType:function(e){return null==h&&(p.mimeType=e),this},statusCode:function(e){var t;if(e)if(h)S.always(e[S.status]);else for(t in e)v[t]=[v[t],e[t]];return this},abort:function(e){var t=e||w;return i&&i.abort(t),E(0,t),this}};if(g.promise(S),p.url=((e||p.url||It.href)+"").replace(Ut,It.protocol+"//"),p.type=t.method||t.type||p.method||p.type,p.dataTypes=(p.dataType||"*").toLowerCase().match(q)||[""],null==p.crossDomain){l=b.createElement("a");try{l.href=p.url,l.href=l.href,p.crossDomain=Kt.protocol+"//"+Kt.host!=l.protocol+"//"+l.host}catch(e){p.crossDomain=!0}}if(p.data&&p.processData&&"string"!=typeof p.data&&(p.data=x.param(p.data,p.traditional)),Xt(jt,p,t,S),h)return S;for(d in(c=x.event&&p.global)&&0==x.active++&&x.event.trigger("ajaxStart"),p.type=p.type.toUpperCase(),p.hasContent=!Wt.test(p.type),n=p.url.replace(zt,""),p.hasContent?p.data&&p.processData&&0===(p.contentType||"").indexOf("application/x-www-form-urlencoded")&&(p.data=p.data.replace(Ht,"+")):(u=p.url.slice(n.length),p.data&&(p.processData||"string"==typeof p.data)&&(n+=(Dt.test(n)?"&":"?")+p.data,delete p.data),!1===p.cache&&(n=n.replace($t,"$1"),u=(Dt.test(n)?"&":"?")+"_="+At.guid+++u),p.url=n+u),p.ifModified&&(x.lastModified[n]&&S.setRequestHeader("If-Modified-Since",x.lastModified[n]),x.etag[n]&&S.setRequestHeader("If-None-Match",x.etag[n])),(p.data&&p.hasContent&&!1!==p.contentType||t.contentType)&&S.setRequestHeader("Content-Type",p.contentType),S.setRequestHeader("Accept",p.dataTypes[0]&&p.accepts[p.dataTypes[0]]?p.accepts[p.dataTypes[0]]+("*"!==p.dataTypes[0]?", "+qt+"; q=0.01":""):p.accepts["*"]),p.headers)S.setRequestHeader(d,p.headers[d]);if(p.beforeSend&&(!1===p.beforeSend.call(m,S,p)||h))return S.abort();if(w="abort",_.add(p.complete),S.done(p.success),S.fail(p.error),i=Xt(Gt,p,t,S)){if(S.readyState=1,c&&f.trigger("ajaxSend",[S,p]),h)return S;p.async&&p.timeout>0&&(a=s.setTimeout((function(){S.abort("timeout")}),p.timeout));try{h=!1,i.send(y,E)}catch(e){if(h)throw e;E(-1,e)}}else E(-1,"No Transport");function E(e,t,o,l){var d,u,b,y,C,w=t;h||(h=!0,a&&s.clearTimeout(a),i=void 0,r=l||"",S.readyState=e>0?4:0,d=e>=200&&e<300||304===e,o&&(y=function(e,t,i){for(var s,n,r,o,a=e.contents,l=e.dataTypes;"*"===l[0];)l.shift(),void 0===s&&(s=e.mimeType||t.getResponseHeader("Content-Type"));if(s)for(n in a)if(a[n]&&a[n].test(s)){l.unshift(n);break}if(l[0]in i)r=l[0];else{for(n in i){if(!l[0]||e.converters[n+" "+l[0]]){r=n;break}o||(o=n)}r=r||o}if(r)return r!==l[0]&&l.unshift(r),i[r]}(p,S,o)),!d&&x.inArray("script",p.dataTypes)>-1&&x.inArray("json",p.dataTypes)<0&&(p.converters["text script"]=function(){}),y=function(e,t,i,s){var n,r,o,a,l,h={},c=e.dataTypes.slice();if(c[1])for(o in e.converters)h[o.toLowerCase()]=e.converters[o];for(r=c.shift();r;)if(e.responseFields[r]&&(i[e.responseFields[r]]=t),!l&&s&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),l=r,r=c.shift())if("*"===r)r=l;else if("*"!==l&&l!==r){if(!(o=h[l+" "+r]||h["* "+r]))for(n in h)if((a=n.split(" "))[1]===r&&(o=h[l+" "+a[0]]||h["* "+a[0]])){!0===o?o=h[n]:!0!==h[n]&&(r=a[0],c.unshift(a[1]));break}if(!0!==o)if(o&&e.throws)t=o(t);else try{t=o(t)}catch(e){return{state:"parsererror",error:o?e:"No conversion from "+l+" to "+r}}}return{state:"success",data:t}}(p,y,S,d),d?(p.ifModified&&((C=S.getResponseHeader("Last-Modified"))&&(x.lastModified[n]=C),(C=S.getResponseHeader("etag"))&&(x.etag[n]=C)),204===e||"HEAD"===p.type?w="nocontent":304===e?w="notmodified":(w=y.state,u=y.data,d=!(b=y.error))):(b=w,!e&&w||(w="error",e<0&&(e=0))),S.status=e,S.statusText=(t||w)+"",d?g.resolveWith(m,[u,w,S]):g.rejectWith(m,[S,w,b]),S.statusCode(v),v=void 0,c&&f.trigger(d?"ajaxSuccess":"ajaxError",[S,p,d?u:b]),_.fireWith(m,[S,w]),c&&(f.trigger("ajaxComplete",[S,p]),--x.active||x.event.trigger("ajaxStop")))}return S},getJSON:function(e,t,i){return x.get(e,t,i,"json")},getScript:function(e,t){return x.get(e,void 0,t,"script")}}),x.each(["get","post"],(function(e,t){x[t]=function(e,i,s,n){return _(i)&&(n=n||s,s=i,i=void 0),x.ajax(x.extend({url:e,type:t,dataType:n,data:i,success:s},x.isPlainObject(e)&&e))}})),x.ajaxPrefilter((function(e){var t;for(t in e.headers)"content-type"===t.toLowerCase()&&(e.contentType=e.headers[t]||"")})),x._evalUrl=function(e,t,i){return x.ajax({url:e,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(e){x.globalEval(e,t,i)}})},x.fn.extend({wrapAll:function(e){var t;return this[0]&&(_(e)&&(e=e.call(this[0])),t=x(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map((function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e})).append(this)),this},wrapInner:function(e){return _(e)?this.each((function(t){x(this).wrapInner(e.call(this,t))})):this.each((function(){var t=x(this),i=t.contents();i.length?i.wrapAll(e):t.append(e)}))},wrap:function(e){var t=_(e);return this.each((function(i){x(this).wrapAll(t?e.call(this,i):e)}))},unwrap:function(e){return this.parent(e).not("body").each((function(){x(this).replaceWith(this.childNodes)})),this}}),x.expr.pseudos.hidden=function(e){return!x.expr.pseudos.visible(e)},x.expr.pseudos.visible=function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)},x.ajaxSettings.xhr=function(){try{return new s.XMLHttpRequest}catch(e){}};var Qt={0:200,1223:204},Jt=x.ajaxSettings.xhr();g.cors=!!Jt&&"withCredentials"in Jt,g.ajax=Jt=!!Jt,x.ajaxTransport((function(e){var t,i;if(g.cors||Jt&&!e.crossDomain)return{send:function(n,r){var o,a=e.xhr();if(a.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(o in e.xhrFields)a[o]=e.xhrFields[o];for(o in e.mimeType&&a.overrideMimeType&&a.overrideMimeType(e.mimeType),e.crossDomain||n["X-Requested-With"]||(n["X-Requested-With"]="XMLHttpRequest"),n)a.setRequestHeader(o,n[o]);t=function(e){return function(){t&&(t=i=a.onload=a.onerror=a.onabort=a.ontimeout=a.onreadystatechange=null,"abort"===e?a.abort():"error"===e?"number"!=typeof a.status?r(0,"error"):r(a.status,a.statusText):r(Qt[a.status]||a.status,a.statusText,"text"!==(a.responseType||"text")||"string"!=typeof a.responseText?{binary:a.response}:{text:a.responseText},a.getAllResponseHeaders()))}},a.onload=t(),i=a.onerror=a.ontimeout=t("error"),void 0!==a.onabort?a.onabort=i:a.onreadystatechange=function(){4===a.readyState&&s.setTimeout((function(){t&&i()}))},t=t("abort");try{a.send(e.hasContent&&e.data||null)}catch(e){if(t)throw e}},abort:function(){t&&t()}}})),x.ajaxPrefilter((function(e){e.crossDomain&&(e.contents.script=!1)})),x.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return x.globalEval(e),e}}}),x.ajaxPrefilter("script",(function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")})),x.ajaxTransport("script",(function(e){var t,i;if(e.crossDomain||e.scriptAttrs)return{send:function(s,n){t=x("<script>").attr(e.scriptAttrs||{}).prop({charset:e.scriptCharset,src:e.url}).on("load error",i=function(e){t.remove(),i=null,e&&n("error"===e.type?404:200,e.type)}),b.head.appendChild(t[0])},abort:function(){i&&i()}}}));var ei,ti=[],ii=/(=)\?(?=&|$)|\?\?/;x.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=ti.pop()||x.expando+"_"+At.guid++;return this[e]=!0,e}}),x.ajaxPrefilter("json jsonp",(function(e,t,i){var n,r,o,a=!1!==e.jsonp&&(ii.test(e.url)?"url":"string"==typeof e.data&&0===(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&ii.test(e.data)&&"data");if(a||"jsonp"===e.dataTypes[0])return n=e.jsonpCallback=_(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,a?e[a]=e[a].replace(ii,"$1"+n):!1!==e.jsonp&&(e.url+=(Dt.test(e.url)?"&":"?")+e.jsonp+"="+n),e.converters["script json"]=function(){return o||x.error(n+" was not called"),o[0]},e.dataTypes[0]="json",r=s[n],s[n]=function(){o=arguments},i.always((function(){void 0===r?x(s).removeProp(n):s[n]=r,e[n]&&(e.jsonpCallback=t.jsonpCallback,ti.push(n)),o&&_(r)&&r(o[0]),o=r=void 0})),"script"})),g.createHTMLDocument=((ei=b.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===ei.childNodes.length),x.parseHTML=function(e,t,i){return"string"!=typeof e?[]:("boolean"==typeof t&&(i=t,t=!1),t||(g.createHTMLDocument?((s=(t=b.implementation.createHTMLDocument("")).createElement("base")).href=b.location.href,t.head.appendChild(s)):t=b),r=!i&&[],(n=z.exec(e))?[t.createElement(n[1])]:(n=Re([e],t,r),r&&r.length&&x(r).remove(),x.merge([],n.childNodes)));var s,n,r},x.fn.load=function(e,t,i){var s,n,r,o=this,a=e.indexOf(" ");return a>-1&&(s=xt(e.slice(a)),e=e.slice(0,a)),_(t)?(i=t,t=void 0):t&&"object"==typeof t&&(n="POST"),o.length>0&&x.ajax({url:e,type:n||"GET",dataType:"html",data:t}).done((function(e){r=arguments,o.html(s?x("<div>").append(x.parseHTML(e)).find(s):e)})).always(i&&function(e,t){o.each((function(){i.apply(this,r||[e.responseText,t,e])}))}),this},x.expr.pseudos.animated=function(e){return x.grep(x.timers,(function(t){return e===t.elem})).length},x.offset={setOffset:function(e,t,i){var s,n,r,o,a,l,h=x.css(e,"position"),c=x(e),d={};"static"===h&&(e.style.position="relative"),a=c.offset(),r=x.css(e,"top"),l=x.css(e,"left"),("absolute"===h||"fixed"===h)&&(r+l).indexOf("auto")>-1?(o=(s=c.position()).top,n=s.left):(o=parseFloat(r)||0,n=parseFloat(l)||0),_(t)&&(t=t.call(e,i,x.extend({},a))),null!=t.top&&(d.top=t.top-a.top+o),null!=t.left&&(d.left=t.left-a.left+n),"using"in t?t.using.call(e,d):c.css(d)}},x.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each((function(t){x.offset.setOffset(this,e,t)}));var t,i,s=this[0];return s?s.getClientRects().length?(t=s.getBoundingClientRect(),i=s.ownerDocument.defaultView,{top:t.top+i.pageYOffset,left:t.left+i.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var e,t,i,s=this[0],n={top:0,left:0};if("fixed"===x.css(s,"position"))t=s.getBoundingClientRect();else{for(t=this.offset(),i=s.ownerDocument,e=s.offsetParent||i.documentElement;e&&(e===i.body||e===i.documentElement)&&"static"===x.css(e,"position");)e=e.parentNode;e&&e!==s&&1===e.nodeType&&((n=x(e).offset()).top+=x.css(e,"borderTopWidth",!0),n.left+=x.css(e,"borderLeftWidth",!0))}return{top:t.top-n.top-x.css(s,"marginTop",!0),left:t.left-n.left-x.css(s,"marginLeft",!0)}}},offsetParent:function(){return this.map((function(){for(var e=this.offsetParent;e&&"static"===x.css(e,"position");)e=e.offsetParent;return e||fe}))}}),x.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},(function(e,t){var i="pageYOffset"===t;x.fn[e]=function(s){return ee(this,(function(e,s,n){var r;if(v(e)?r=e:9===e.nodeType&&(r=e.defaultView),void 0===n)return r?r[t]:e[s];r?r.scrollTo(i?r.pageXOffset:n,i?n:r.pageYOffset):e[s]=n}),e,s,arguments.length)}})),x.each(["top","left"],(function(e,t){x.cssHooks[t]=et(g.pixelPosition,(function(e,i){if(i)return i=Je(e,t),Ke.test(i)?x(e).position()[t]+"px":i}))})),x.each({Height:"height",Width:"width"},(function(e,t){x.each({padding:"inner"+e,content:t,"":"outer"+e},(function(i,s){x.fn[s]=function(n,r){var o=arguments.length&&(i||"boolean"!=typeof n),a=i||(!0===n||!0===r?"margin":"border");return ee(this,(function(t,i,n){var r;return v(t)?0===s.indexOf("outer")?t["inner"+e]:t.document.documentElement["client"+e]:9===t.nodeType?(r=t.documentElement,Math.max(t.body["scroll"+e],r["scroll"+e],t.body["offset"+e],r["offset"+e],r["client"+e])):void 0===n?x.css(t,i,a):x.style(t,i,n,a)}),t,o?n:void 0,o)}}))})),x.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],(function(e,t){x.fn[t]=function(e){return this.on(t,e)}})),x.fn.extend({bind:function(e,t,i){return this.on(e,null,t,i)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,i,s){return this.on(t,e,i,s)},undelegate:function(e,t,i){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",i)},hover:function(e,t){return this.on("mouseenter",e).on("mouseleave",t||e)}}),x.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),(function(e,t){x.fn[t]=function(e,i){return arguments.length>0?this.on(t,null,e,i):this.trigger(t)}}));var si=/^[\s\uFEFF\xA0]+|([^\s\uFEFF\xA0])[\s\uFEFF\xA0]+$/g;x.proxy=function(e,t){var i,s,n;if("string"==typeof t&&(i=e[t],t=e,e=i),_(e))return s=a.call(arguments,2),n=function(){return e.apply(t||this,s.concat(a.call(arguments)))},n.guid=e.guid=e.guid||x.guid++,n},x.holdReady=function(e){e?x.readyWait++:x.ready(!0)},x.isArray=Array.isArray,x.parseJSON=JSON.parse,x.nodeName=O,x.isFunction=_,x.isWindow=v,x.camelCase=ne,x.type=w,x.now=Date.now,x.isNumeric=function(e){var t=x.type(e);return("number"===t||"string"===t)&&!isNaN(e-parseFloat(e))},x.trim=function(e){return null==e?"":(e+"").replace(si,"$1")},void 0===(i=function(){return x}.apply(t,[]))||(e.exports=i);var ni=s.jQuery,ri=s.$;return x.noConflict=function(e){return s.$===x&&(s.$=ri),e&&s.jQuery===x&&(s.jQuery=ni),x},void 0===n&&(s.jQuery=s.$=x),x}))},965:function(e){e.exports=function(){"use strict";var e=Object.prototype.toString,t=Array.isArray||function(t){return"[object Array]"===e.call(t)};function i(e){return"function"==typeof e}function s(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function n(e,t){return null!=e&&"object"==typeof e&&t in e}var r=RegExp.prototype.test;var o=/\S/;function a(e){return!function(e,t){return r.call(e,t)}(o,e)}var l={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};var h=/\s*/,c=/\s+/,d=/\s*=/,u=/\s*\}/,p=/#|\^|\/|>|\{|&|=|!/;function m(e){this.string=e,this.tail=e,this.pos=0}function f(e,t){this.view=e,this.cache={".":this.view},this.parent=t}function g(){this.templateCache={_cache:{},set:function(e,t){this._cache[e]=t},get:function(e){return this._cache[e]},clear:function(){this._cache={}}}}m.prototype.eos=function(){return""===this.tail},m.prototype.scan=function(e){var t=this.tail.match(e);if(!t||0!==t.index)return"";var i=t[0];return this.tail=this.tail.substring(i.length),this.pos+=i.length,i},m.prototype.scanUntil=function(e){var t,i=this.tail.search(e);switch(i){case-1:t=this.tail,this.tail="";break;case 0:t="";break;default:t=this.tail.substring(0,i),this.tail=this.tail.substring(i)}return this.pos+=t.length,t},f.prototype.push=function(e){return new f(e,this)},f.prototype.lookup=function(e){var t,s,r,o=this.cache;if(o.hasOwnProperty(e))t=o[e];else{for(var a,l,h,c=this,d=!1;c;){if(e.indexOf(".")>0)for(a=c.view,l=e.split("."),h=0;null!=a&&h<l.length;)h===l.length-1&&(d=n(a,l[h])||(s=a,r=l[h],null!=s&&"object"!=typeof s&&s.hasOwnProperty&&s.hasOwnProperty(r))),a=a[l[h++]];else a=c.view[e],d=n(c.view,e);if(d){t=a;break}c=c.parent}o[e]=t}return i(t)&&(t=t.call(this.view)),t},g.prototype.clearCache=function(){void 0!==this.templateCache&&this.templateCache.clear()},g.prototype.parse=function(e,i){var n=this.templateCache,r=e+":"+(i||_.tags).join(":"),o=void 0!==n,l=o?n.get(r):void 0;return null==l&&(l=function(e,i){if(!e)return[];var n,r,o,l=!1,f=[],g=[],v=[],b=!1,y=!1,C="",w=0;function S(){if(b&&!y)for(;v.length;)delete g[v.pop()];else v=[];b=!1,y=!1}function E(e){if("string"==typeof e&&(e=e.split(c,2)),!t(e)||2!==e.length)throw new Error("Invalid tags: "+e);n=new RegExp(s(e[0])+"\\s*"),r=new RegExp("\\s*"+s(e[1])),o=new RegExp("\\s*"+s("}"+e[1]))}E(i||_.tags);for(var x,T,O,k,I,A,D=new m(e);!D.eos();){if(x=D.pos,O=D.scanUntil(n))for(var R=0,P=O.length;R<P;++R)a(k=O.charAt(R))?(v.push(g.length),C+=k):(y=!0,l=!0,C+=" "),g.push(["text",k,x,x+1]),x+=1,"\n"===k&&(S(),C="",w=0,l=!1);if(!D.scan(n))break;if(b=!0,T=D.scan(p)||"name",D.scan(h),"="===T?(O=D.scanUntil(d),D.scan(d),D.scanUntil(r)):"{"===T?(O=D.scanUntil(o),D.scan(u),D.scanUntil(r),T="&"):O=D.scanUntil(r),!D.scan(r))throw new Error("Unclosed tag at "+D.pos);if(I=">"==T?[T,O,x,D.pos,C,w,l]:[T,O,x,D.pos],w++,g.push(I),"#"===T||"^"===T)f.push(I);else if("/"===T){if(!(A=f.pop()))throw new Error('Unopened section "'+O+'" at '+x);if(A[1]!==O)throw new Error('Unclosed section "'+A[1]+'" at '+x)}else"name"===T||"{"===T||"&"===T?y=!0:"="===T&&E(O)}if(S(),A=f.pop())throw new Error('Unclosed section "'+A[1]+'" at '+D.pos);return function(e){for(var t,i=[],s=i,n=[],r=0,o=e.length;r<o;++r)switch((t=e[r])[0]){case"#":case"^":s.push(t),n.push(t),s=t[4]=[];break;case"/":n.pop()[5]=t[2],s=n.length>0?n[n.length-1][4]:i;break;default:s.push(t)}return i}(function(e){for(var t,i,s=[],n=0,r=e.length;n<r;++n)(t=e[n])&&("text"===t[0]&&i&&"text"===i[0]?(i[1]+=t[1],i[3]=t[3]):(s.push(t),i=t));return s}(g))}(e,i),o&&n.set(r,l)),l},g.prototype.render=function(e,t,i,s){var n=this.getConfigTags(s),r=this.parse(e,n),o=t instanceof f?t:new f(t,void 0);return this.renderTokens(r,o,i,e,s)},g.prototype.renderTokens=function(e,t,i,s,n){for(var r,o,a,l="",h=0,c=e.length;h<c;++h)a=void 0,"#"===(o=(r=e[h])[0])?a=this.renderSection(r,t,i,s,n):"^"===o?a=this.renderInverted(r,t,i,s,n):">"===o?a=this.renderPartial(r,t,i,n):"&"===o?a=this.unescapedValue(r,t):"name"===o?a=this.escapedValue(r,t,n):"text"===o&&(a=this.rawValue(r)),void 0!==a&&(l+=a);return l},g.prototype.renderSection=function(e,s,n,r,o){var a=this,l="",h=s.lookup(e[1]);if(h){if(t(h))for(var c=0,d=h.length;c<d;++c)l+=this.renderTokens(e[4],s.push(h[c]),n,r,o);else if("object"==typeof h||"string"==typeof h||"number"==typeof h)l+=this.renderTokens(e[4],s.push(h),n,r,o);else if(i(h)){if("string"!=typeof r)throw new Error("Cannot use higher-order sections without the original template");null!=(h=h.call(s.view,r.slice(e[3],e[5]),(function(e){return a.render(e,s,n,o)})))&&(l+=h)}else l+=this.renderTokens(e[4],s,n,r,o);return l}},g.prototype.renderInverted=function(e,i,s,n,r){var o=i.lookup(e[1]);if(!o||t(o)&&0===o.length)return this.renderTokens(e[4],i,s,n,r)},g.prototype.indentPartial=function(e,t,i){for(var s=t.replace(/[^ \t]/g,""),n=e.split("\n"),r=0;r<n.length;r++)n[r].length&&(r>0||!i)&&(n[r]=s+n[r]);return n.join("\n")},g.prototype.renderPartial=function(e,t,s,n){if(s){var r=this.getConfigTags(n),o=i(s)?s(e[1]):s[e[1]];if(null!=o){var a=e[6],l=e[5],h=e[4],c=o;0==l&&h&&(c=this.indentPartial(o,h,a));var d=this.parse(c,r);return this.renderTokens(d,t,s,c,n)}}},g.prototype.unescapedValue=function(e,t){var i=t.lookup(e[1]);if(null!=i)return i},g.prototype.escapedValue=function(e,t,i){var s=this.getConfigEscape(i)||_.escape,n=t.lookup(e[1]);if(null!=n)return"number"==typeof n&&s===_.escape?String(n):s(n)},g.prototype.rawValue=function(e){return e[1]},g.prototype.getConfigTags=function(e){return t(e)?e:e&&"object"==typeof e?e.tags:void 0},g.prototype.getConfigEscape=function(e){return e&&"object"==typeof e&&!t(e)?e.escape:void 0};var _={name:"mustache.js",version:"4.2.0",tags:["{{","}}"],clearCache:void 0,escape:void 0,parse:void 0,render:void 0,Scanner:void 0,Context:void 0,Writer:void 0,set templateCache(e){v.templateCache=e},get templateCache(){return v.templateCache}},v=new g;return _.clearCache=function(){return v.clearCache()},_.parse=function(e,t){return v.parse(e,t)},_.render=function(e,i,s,n){if("string"!=typeof e)throw new TypeError('Invalid template! Template should be a "string" but "'+((t(r=e)?"array":typeof r)+'" was given as the first argument for mustache#render(template, view, partials)'));var r;return v.render(e,i,s,n)},_.escape=function(e){return String(e).replace(/[&<>"'`=\/]/g,(function(e){return l[e]}))},_.Scanner=m,_.Context=f,_.Writer=g,_}()},668:(e,t,i)=>{"use strict";const{Deflate:s,deflate:n,deflateRaw:r,gzip:o}=i(303),{Inflate:a,inflate:l,inflateRaw:h,ungzip:c}=i(83),d=i(681);e.exports.Deflate=s,e.exports.deflate=n,e.exports.deflateRaw=r,e.exports.gzip=o,e.exports.Inflate=a,e.exports.inflate=l,e.exports.inflateRaw=h,e.exports.ungzip=c,e.exports.constants=d},303:(e,t,i)=>{"use strict";const s=i(411),n=i(805),r=i(996),o=i(674),a=i(442),l=Object.prototype.toString,{Z_NO_FLUSH:h,Z_SYNC_FLUSH:c,Z_FULL_FLUSH:d,Z_FINISH:u,Z_OK:p,Z_STREAM_END:m,Z_DEFAULT_COMPRESSION:f,Z_DEFAULT_STRATEGY:g,Z_DEFLATED:_}=i(681);function v(e){this.options=n.assign({level:f,method:_,chunkSize:16384,windowBits:15,memLevel:8,strategy:g},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new a,this.strm.avail_out=0;let i=s.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(i!==p)throw new Error(o[i]);if(t.header&&s.deflateSetHeader(this.strm,t.header),t.dictionary){let e;if(e="string"==typeof t.dictionary?r.string2buf(t.dictionary):"[object ArrayBuffer]"===l.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,i=s.deflateSetDictionary(this.strm,e),i!==p)throw new Error(o[i]);this._dict_set=!0}}function b(e,t){const i=new v(t);if(i.push(e,!0),i.err)throw i.msg||o[i.err];return i.result}v.prototype.push=function(e,t){const i=this.strm,n=this.options.chunkSize;let o,a;if(this.ended)return!1;for(a=t===~~t?t:!0===t?u:h,"string"==typeof e?i.input=r.string2buf(e):"[object ArrayBuffer]"===l.call(e)?i.input=new Uint8Array(e):i.input=e,i.next_in=0,i.avail_in=i.input.length;;)if(0===i.avail_out&&(i.output=new Uint8Array(n),i.next_out=0,i.avail_out=n),(a===c||a===d)&&i.avail_out<=6)this.onData(i.output.subarray(0,i.next_out)),i.avail_out=0;else{if(o=s.deflate(i,a),o===m)return i.next_out>0&&this.onData(i.output.subarray(0,i.next_out)),o=s.deflateEnd(this.strm),this.onEnd(o),this.ended=!0,o===p;if(0!==i.avail_out){if(a>0&&i.next_out>0)this.onData(i.output.subarray(0,i.next_out)),i.avail_out=0;else if(0===i.avail_in)break}else this.onData(i.output)}return!0},v.prototype.onData=function(e){this.chunks.push(e)},v.prototype.onEnd=function(e){e===p&&(this.result=n.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},e.exports.Deflate=v,e.exports.deflate=b,e.exports.deflateRaw=function(e,t){return(t=t||{}).raw=!0,b(e,t)},e.exports.gzip=function(e,t){return(t=t||{}).gzip=!0,b(e,t)},e.exports.constants=i(681)},83:(e,t,i)=>{"use strict";const s=i(447),n=i(805),r=i(996),o=i(674),a=i(442),l=i(414),h=Object.prototype.toString,{Z_NO_FLUSH:c,Z_FINISH:d,Z_OK:u,Z_STREAM_END:p,Z_NEED_DICT:m,Z_STREAM_ERROR:f,Z_DATA_ERROR:g,Z_MEM_ERROR:_}=i(681);function v(e){this.options=n.assign({chunkSize:65536,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(15&t.windowBits||(t.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new a,this.strm.avail_out=0;let i=s.inflateInit2(this.strm,t.windowBits);if(i!==u)throw new Error(o[i]);if(this.header=new l,s.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=r.string2buf(t.dictionary):"[object ArrayBuffer]"===h.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(i=s.inflateSetDictionary(this.strm,t.dictionary),i!==u)))throw new Error(o[i])}function b(e,t){const i=new v(t);if(i.push(e),i.err)throw i.msg||o[i.err];return i.result}v.prototype.push=function(e,t){const i=this.strm,n=this.options.chunkSize,o=this.options.dictionary;let a,l,v;if(this.ended)return!1;for(l=t===~~t?t:!0===t?d:c,"[object ArrayBuffer]"===h.call(e)?i.input=new Uint8Array(e):i.input=e,i.next_in=0,i.avail_in=i.input.length;;){for(0===i.avail_out&&(i.output=new Uint8Array(n),i.next_out=0,i.avail_out=n),a=s.inflate(i,l),a===m&&o&&(a=s.inflateSetDictionary(i,o),a===u?a=s.inflate(i,l):a===g&&(a=m));i.avail_in>0&&a===p&&i.state.wrap>0&&0!==e[i.next_in];)s.inflateReset(i),a=s.inflate(i,l);switch(a){case f:case g:case m:case _:return this.onEnd(a),this.ended=!0,!1}if(v=i.avail_out,i.next_out&&(0===i.avail_out||a===p))if("string"===this.options.to){let e=r.utf8border(i.output,i.next_out),t=i.next_out-e,s=r.buf2string(i.output,e);i.next_out=t,i.avail_out=n-t,t&&i.output.set(i.output.subarray(e,e+t),0),this.onData(s)}else this.onData(i.output.length===i.next_out?i.output:i.output.subarray(0,i.next_out));if(a!==u||0!==v){if(a===p)return a=s.inflateEnd(this.strm),this.onEnd(a),this.ended=!0,!0;if(0===i.avail_in)break}}return!0},v.prototype.onData=function(e){this.chunks.push(e)},v.prototype.onEnd=function(e){e===u&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=n.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},e.exports.Inflate=v,e.exports.inflate=b,e.exports.inflateRaw=function(e,t){return(t=t||{}).raw=!0,b(e,t)},e.exports.ungzip=b,e.exports.constants=i(681)},805:e=>{"use strict";const t=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);e.exports.assign=function(e){const i=Array.prototype.slice.call(arguments,1);for(;i.length;){const s=i.shift();if(s){if("object"!=typeof s)throw new TypeError(s+"must be non-object");for(const i in s)t(s,i)&&(e[i]=s[i])}}return e},e.exports.flattenChunks=e=>{let t=0;for(let i=0,s=e.length;i<s;i++)t+=e[i].length;const i=new Uint8Array(t);for(let t=0,s=0,n=e.length;t<n;t++){let n=e[t];i.set(n,s),s+=n.length}return i}},996:e=>{"use strict";let t=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){t=!1}const i=new Uint8Array(256);for(let e=0;e<256;e++)i[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;i[254]=i[254]=1,e.exports.string2buf=e=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(e);let t,i,s,n,r,o=e.length,a=0;for(n=0;n<o;n++)i=e.charCodeAt(n),55296==(64512&i)&&n+1<o&&(s=e.charCodeAt(n+1),56320==(64512&s)&&(i=65536+(i-55296<<10)+(s-56320),n++)),a+=i<128?1:i<2048?2:i<65536?3:4;for(t=new Uint8Array(a),r=0,n=0;r<a;n++)i=e.charCodeAt(n),55296==(64512&i)&&n+1<o&&(s=e.charCodeAt(n+1),56320==(64512&s)&&(i=65536+(i-55296<<10)+(s-56320),n++)),i<128?t[r++]=i:i<2048?(t[r++]=192|i>>>6,t[r++]=128|63&i):i<65536?(t[r++]=224|i>>>12,t[r++]=128|i>>>6&63,t[r++]=128|63&i):(t[r++]=240|i>>>18,t[r++]=128|i>>>12&63,t[r++]=128|i>>>6&63,t[r++]=128|63&i);return t},e.exports.buf2string=(e,s)=>{const n=s||e.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(e.subarray(0,s));let r,o;const a=new Array(2*n);for(o=0,r=0;r<n;){let t=e[r++];if(t<128){a[o++]=t;continue}let s=i[t];if(s>4)a[o++]=65533,r+=s-1;else{for(t&=2===s?31:3===s?15:7;s>1&&r<n;)t=t<<6|63&e[r++],s--;s>1?a[o++]=65533:t<65536?a[o++]=t:(t-=65536,a[o++]=55296|t>>10&1023,a[o++]=56320|1023&t)}}return((e,i)=>{if(i<65534&&e.subarray&&t)return String.fromCharCode.apply(null,e.length===i?e:e.subarray(0,i));let s="";for(let t=0;t<i;t++)s+=String.fromCharCode(e[t]);return s})(a,o)},e.exports.utf8border=(e,t)=>{(t=t||e.length)>e.length&&(t=e.length);let s=t-1;for(;s>=0&&128==(192&e[s]);)s--;return s<0||0===s?t:s+i[e[s]]>t?s:t}},269:e=>{"use strict";e.exports=(e,t,i,s)=>{let n=65535&e,r=e>>>16&65535,o=0;for(;0!==i;){o=i>2e3?2e3:i,i-=o;do{n=n+t[s++]|0,r=r+n|0}while(--o);n%=65521,r%=65521}return n|r<<16}},681:e=>{"use strict";e.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},823:e=>{"use strict";const t=new Uint32Array((()=>{let e,t=[];for(var i=0;i<256;i++){e=i;for(var s=0;s<8;s++)e=1&e?3988292384^e>>>1:e>>>1;t[i]=e}return t})());e.exports=(e,i,s,n)=>{const r=t,o=n+s;e^=-1;for(let t=n;t<o;t++)e=e>>>8^r[255&(e^i[t])];return~e}},411:(e,t,i)=>{"use strict";const{_tr_init:s,_tr_stored_block:n,_tr_flush_block:r,_tr_tally:o,_tr_align:a}=i(665),l=i(269),h=i(823),c=i(674),{Z_NO_FLUSH:d,Z_PARTIAL_FLUSH:u,Z_FULL_FLUSH:p,Z_FINISH:m,Z_BLOCK:f,Z_OK:g,Z_STREAM_END:_,Z_STREAM_ERROR:v,Z_DATA_ERROR:b,Z_BUF_ERROR:y,Z_DEFAULT_COMPRESSION:C,Z_FILTERED:w,Z_HUFFMAN_ONLY:S,Z_RLE:E,Z_FIXED:x,Z_DEFAULT_STRATEGY:T,Z_UNKNOWN:O,Z_DEFLATED:k}=i(681),I=258,A=262,D=42,R=113,P=666,L=(e,t)=>(e.msg=c[t],t),M=e=>2*e-(e>4?9:0),N=e=>{let t=e.length;for(;--t>=0;)e[t]=0},F=e=>{let t,i,s,n=e.w_size;t=e.hash_size,s=t;do{i=e.head[--s],e.head[s]=i>=n?i-n:0}while(--t);t=n,s=t;do{i=e.prev[--s],e.prev[s]=i>=n?i-n:0}while(--t)};let B=(e,t,i)=>(t<<e.hash_shift^i)&e.hash_mask;const H=e=>{const t=e.state;let i=t.pending;i>e.avail_out&&(i=e.avail_out),0!==i&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+i),e.next_out),e.next_out+=i,t.pending_out+=i,e.total_out+=i,e.avail_out-=i,t.pending-=i,0===t.pending&&(t.pending_out=0))},z=(e,t)=>{r(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,H(e.strm)},$=(e,t)=>{e.pending_buf[e.pending++]=t},V=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t},W=(e,t,i,s)=>{let n=e.avail_in;return n>s&&(n=s),0===n?0:(e.avail_in-=n,t.set(e.input.subarray(e.next_in,e.next_in+n),i),1===e.state.wrap?e.adler=l(e.adler,t,n,i):2===e.state.wrap&&(e.adler=h(e.adler,t,n,i)),e.next_in+=n,e.total_in+=n,n)},U=(e,t)=>{let i,s,n=e.max_chain_length,r=e.strstart,o=e.prev_length,a=e.nice_match;const l=e.strstart>e.w_size-A?e.strstart-(e.w_size-A):0,h=e.window,c=e.w_mask,d=e.prev,u=e.strstart+I;let p=h[r+o-1],m=h[r+o];e.prev_length>=e.good_match&&(n>>=2),a>e.lookahead&&(a=e.lookahead);do{if(i=t,h[i+o]===m&&h[i+o-1]===p&&h[i]===h[r]&&h[++i]===h[r+1]){r+=2,i++;do{}while(h[++r]===h[++i]&&h[++r]===h[++i]&&h[++r]===h[++i]&&h[++r]===h[++i]&&h[++r]===h[++i]&&h[++r]===h[++i]&&h[++r]===h[++i]&&h[++r]===h[++i]&&r<u);if(s=I-(u-r),r=u-I,s>o){if(e.match_start=t,o=s,s>=a)break;p=h[r+o-1],m=h[r+o]}}}while((t=d[t&c])>l&&0!=--n);return o<=e.lookahead?o:e.lookahead},j=e=>{const t=e.w_size;let i,s,n;do{if(s=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-A)&&(e.window.set(e.window.subarray(t,t+t-s),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,e.insert>e.strstart&&(e.insert=e.strstart),F(e),s+=t),0===e.strm.avail_in)break;if(i=W(e.strm,e.window,e.strstart+e.lookahead,s),e.lookahead+=i,e.lookahead+e.insert>=3)for(n=e.strstart-e.insert,e.ins_h=e.window[n],e.ins_h=B(e,e.ins_h,e.window[n+1]);e.insert&&(e.ins_h=B(e,e.ins_h,e.window[n+3-1]),e.prev[n&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=n,n++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<A&&0!==e.strm.avail_in)},G=(e,t)=>{let i,s,r,o=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,a=0,l=e.strm.avail_in;do{if(i=65535,r=e.bi_valid+42>>3,e.strm.avail_out<r)break;if(r=e.strm.avail_out-r,s=e.strstart-e.block_start,i>s+e.strm.avail_in&&(i=s+e.strm.avail_in),i>r&&(i=r),i<o&&(0===i&&t!==m||t===d||i!==s+e.strm.avail_in))break;a=t===m&&i===s+e.strm.avail_in?1:0,n(e,0,0,a),e.pending_buf[e.pending-4]=i,e.pending_buf[e.pending-3]=i>>8,e.pending_buf[e.pending-2]=~i,e.pending_buf[e.pending-1]=~i>>8,H(e.strm),s&&(s>i&&(s=i),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+s),e.strm.next_out),e.strm.next_out+=s,e.strm.avail_out-=s,e.strm.total_out+=s,e.block_start+=s,i-=s),i&&(W(e.strm,e.strm.output,e.strm.next_out,i),e.strm.next_out+=i,e.strm.avail_out-=i,e.strm.total_out+=i)}while(0===a);return l-=e.strm.avail_in,l&&(l>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=l&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-l,e.strm.next_in),e.strstart),e.strstart+=l,e.insert+=l>e.w_size-e.insert?e.w_size-e.insert:l),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),a?4:t!==d&&t!==m&&0===e.strm.avail_in&&e.strstart===e.block_start?2:(r=e.window_size-e.strstart,e.strm.avail_in>r&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,r+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),r>e.strm.avail_in&&(r=e.strm.avail_in),r&&(W(e.strm,e.window,e.strstart,r),e.strstart+=r,e.insert+=r>e.w_size-e.insert?e.w_size-e.insert:r),e.high_water<e.strstart&&(e.high_water=e.strstart),r=e.bi_valid+42>>3,r=e.pending_buf_size-r>65535?65535:e.pending_buf_size-r,o=r>e.w_size?e.w_size:r,s=e.strstart-e.block_start,(s>=o||(s||t===m)&&t!==d&&0===e.strm.avail_in&&s<=r)&&(i=s>r?r:s,a=t===m&&0===e.strm.avail_in&&i===s?1:0,n(e,e.block_start,i,a),e.block_start+=i,H(e.strm)),a?3:1)},q=(e,t)=>{let i,s;for(;;){if(e.lookahead<A){if(j(e),e.lookahead<A&&t===d)return 1;if(0===e.lookahead)break}if(i=0,e.lookahead>=3&&(e.ins_h=B(e,e.ins_h,e.window[e.strstart+3-1]),i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==i&&e.strstart-i<=e.w_size-A&&(e.match_length=U(e,i)),e.match_length>=3)if(s=o(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=B(e,e.ins_h,e.window[e.strstart+3-1]),i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=B(e,e.ins_h,e.window[e.strstart+1]);else s=o(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(s&&(z(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,t===m?(z(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(z(e,!1),0===e.strm.avail_out)?1:2},K=(e,t)=>{let i,s,n;for(;;){if(e.lookahead<A){if(j(e),e.lookahead<A&&t===d)return 1;if(0===e.lookahead)break}if(i=0,e.lookahead>=3&&(e.ins_h=B(e,e.ins_h,e.window[e.strstart+3-1]),i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==i&&e.prev_length<e.max_lazy_match&&e.strstart-i<=e.w_size-A&&(e.match_length=U(e,i),e.match_length<=5&&(e.strategy===w||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){n=e.strstart+e.lookahead-3,s=o(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=n&&(e.ins_h=B(e,e.ins_h,e.window[e.strstart+3-1]),i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,s&&(z(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if(s=o(e,0,e.window[e.strstart-1]),s&&z(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(s=o(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,t===m?(z(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(z(e,!1),0===e.strm.avail_out)?1:2};function Y(e,t,i,s,n){this.good_length=e,this.max_lazy=t,this.nice_length=i,this.max_chain=s,this.func=n}const X=[new Y(0,0,0,0,G),new Y(4,4,8,4,q),new Y(4,5,16,8,q),new Y(4,6,32,32,q),new Y(4,4,16,16,K),new Y(8,16,32,32,K),new Y(8,16,128,128,K),new Y(8,32,128,256,K),new Y(32,128,258,1024,K),new Y(32,258,258,4096,K)];function Z(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=k,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),N(this.dyn_ltree),N(this.dyn_dtree),N(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),N(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),N(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const Q=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.status!==D&&57!==t.status&&69!==t.status&&73!==t.status&&91!==t.status&&103!==t.status&&t.status!==R&&t.status!==P?1:0},J=e=>{if(Q(e))return L(e,v);e.total_in=e.total_out=0,e.data_type=O;const t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=2===t.wrap?57:t.wrap?D:R,e.adler=2===t.wrap?0:1,t.last_flush=-2,s(t),g},ee=e=>{const t=J(e);var i;return t===g&&((i=e.state).window_size=2*i.w_size,N(i.head),i.max_lazy_match=X[i.level].max_lazy,i.good_match=X[i.level].good_length,i.nice_match=X[i.level].nice_length,i.max_chain_length=X[i.level].max_chain,i.strstart=0,i.block_start=0,i.lookahead=0,i.insert=0,i.match_length=i.prev_length=2,i.match_available=0,i.ins_h=0),t},te=(e,t,i,s,n,r)=>{if(!e)return v;let o=1;if(t===C&&(t=6),s<0?(o=0,s=-s):s>15&&(o=2,s-=16),n<1||n>9||i!==k||s<8||s>15||t<0||t>9||r<0||r>x||8===s&&1!==o)return L(e,v);8===s&&(s=9);const a=new Z;return e.state=a,a.strm=e,a.status=D,a.wrap=o,a.gzhead=null,a.w_bits=s,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=n+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+3-1)/3),a.window=new Uint8Array(2*a.w_size),a.head=new Uint16Array(a.hash_size),a.prev=new Uint16Array(a.w_size),a.lit_bufsize=1<<n+6,a.pending_buf_size=4*a.lit_bufsize,a.pending_buf=new Uint8Array(a.pending_buf_size),a.sym_buf=a.lit_bufsize,a.sym_end=3*(a.lit_bufsize-1),a.level=t,a.strategy=r,a.method=i,ee(e)};e.exports.deflateInit=(e,t)=>te(e,t,k,15,8,T),e.exports.deflateInit2=te,e.exports.deflateReset=ee,e.exports.deflateResetKeep=J,e.exports.deflateSetHeader=(e,t)=>Q(e)||2!==e.state.wrap?v:(e.state.gzhead=t,g),e.exports.deflate=(e,t)=>{if(Q(e)||t>f||t<0)return e?L(e,v):v;const i=e.state;if(!e.output||0!==e.avail_in&&!e.input||i.status===P&&t!==m)return L(e,0===e.avail_out?y:v);const s=i.last_flush;if(i.last_flush=t,0!==i.pending){if(H(e),0===e.avail_out)return i.last_flush=-1,g}else if(0===e.avail_in&&M(t)<=M(s)&&t!==m)return L(e,y);if(i.status===P&&0!==e.avail_in)return L(e,y);if(i.status===D&&0===i.wrap&&(i.status=R),i.status===D){let t=k+(i.w_bits-8<<4)<<8,s=-1;if(s=i.strategy>=S||i.level<2?0:i.level<6?1:6===i.level?2:3,t|=s<<6,0!==i.strstart&&(t|=32),t+=31-t%31,V(i,t),0!==i.strstart&&(V(i,e.adler>>>16),V(i,65535&e.adler)),e.adler=1,i.status=R,H(e),0!==i.pending)return i.last_flush=-1,g}if(57===i.status)if(e.adler=0,$(i,31),$(i,139),$(i,8),i.gzhead)$(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),$(i,255&i.gzhead.time),$(i,i.gzhead.time>>8&255),$(i,i.gzhead.time>>16&255),$(i,i.gzhead.time>>24&255),$(i,9===i.level?2:i.strategy>=S||i.level<2?4:0),$(i,255&i.gzhead.os),i.gzhead.extra&&i.gzhead.extra.length&&($(i,255&i.gzhead.extra.length),$(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(e.adler=h(e.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=69;else if($(i,0),$(i,0),$(i,0),$(i,0),$(i,0),$(i,9===i.level?2:i.strategy>=S||i.level<2?4:0),$(i,3),i.status=R,H(e),0!==i.pending)return i.last_flush=-1,g;if(69===i.status){if(i.gzhead.extra){let t=i.pending,s=(65535&i.gzhead.extra.length)-i.gzindex;for(;i.pending+s>i.pending_buf_size;){let n=i.pending_buf_size-i.pending;if(i.pending_buf.set(i.gzhead.extra.subarray(i.gzindex,i.gzindex+n),i.pending),i.pending=i.pending_buf_size,i.gzhead.hcrc&&i.pending>t&&(e.adler=h(e.adler,i.pending_buf,i.pending-t,t)),i.gzindex+=n,H(e),0!==i.pending)return i.last_flush=-1,g;t=0,s-=n}let n=new Uint8Array(i.gzhead.extra);i.pending_buf.set(n.subarray(i.gzindex,i.gzindex+s),i.pending),i.pending+=s,i.gzhead.hcrc&&i.pending>t&&(e.adler=h(e.adler,i.pending_buf,i.pending-t,t)),i.gzindex=0}i.status=73}if(73===i.status){if(i.gzhead.name){let t,s=i.pending;do{if(i.pending===i.pending_buf_size){if(i.gzhead.hcrc&&i.pending>s&&(e.adler=h(e.adler,i.pending_buf,i.pending-s,s)),H(e),0!==i.pending)return i.last_flush=-1,g;s=0}t=i.gzindex<i.gzhead.name.length?255&i.gzhead.name.charCodeAt(i.gzindex++):0,$(i,t)}while(0!==t);i.gzhead.hcrc&&i.pending>s&&(e.adler=h(e.adler,i.pending_buf,i.pending-s,s)),i.gzindex=0}i.status=91}if(91===i.status){if(i.gzhead.comment){let t,s=i.pending;do{if(i.pending===i.pending_buf_size){if(i.gzhead.hcrc&&i.pending>s&&(e.adler=h(e.adler,i.pending_buf,i.pending-s,s)),H(e),0!==i.pending)return i.last_flush=-1,g;s=0}t=i.gzindex<i.gzhead.comment.length?255&i.gzhead.comment.charCodeAt(i.gzindex++):0,$(i,t)}while(0!==t);i.gzhead.hcrc&&i.pending>s&&(e.adler=h(e.adler,i.pending_buf,i.pending-s,s))}i.status=103}if(103===i.status){if(i.gzhead.hcrc){if(i.pending+2>i.pending_buf_size&&(H(e),0!==i.pending))return i.last_flush=-1,g;$(i,255&e.adler),$(i,e.adler>>8&255),e.adler=0}if(i.status=R,H(e),0!==i.pending)return i.last_flush=-1,g}if(0!==e.avail_in||0!==i.lookahead||t!==d&&i.status!==P){let s=0===i.level?G(i,t):i.strategy===S?((e,t)=>{let i;for(;;){if(0===e.lookahead&&(j(e),0===e.lookahead)){if(t===d)return 1;break}if(e.match_length=0,i=o(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,i&&(z(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===m?(z(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(z(e,!1),0===e.strm.avail_out)?1:2})(i,t):i.strategy===E?((e,t)=>{let i,s,n,r;const a=e.window;for(;;){if(e.lookahead<=I){if(j(e),e.lookahead<=I&&t===d)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(n=e.strstart-1,s=a[n],s===a[++n]&&s===a[++n]&&s===a[++n])){r=e.strstart+I;do{}while(s===a[++n]&&s===a[++n]&&s===a[++n]&&s===a[++n]&&s===a[++n]&&s===a[++n]&&s===a[++n]&&s===a[++n]&&n<r);e.match_length=I-(r-n),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(i=o(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(i=o(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),i&&(z(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===m?(z(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(z(e,!1),0===e.strm.avail_out)?1:2})(i,t):X[i.level].func(i,t);if(3!==s&&4!==s||(i.status=P),1===s||3===s)return 0===e.avail_out&&(i.last_flush=-1),g;if(2===s&&(t===u?a(i):t!==f&&(n(i,0,0,!1),t===p&&(N(i.head),0===i.lookahead&&(i.strstart=0,i.block_start=0,i.insert=0))),H(e),0===e.avail_out))return i.last_flush=-1,g}return t!==m?g:i.wrap<=0?_:(2===i.wrap?($(i,255&e.adler),$(i,e.adler>>8&255),$(i,e.adler>>16&255),$(i,e.adler>>24&255),$(i,255&e.total_in),$(i,e.total_in>>8&255),$(i,e.total_in>>16&255),$(i,e.total_in>>24&255)):(V(i,e.adler>>>16),V(i,65535&e.adler)),H(e),i.wrap>0&&(i.wrap=-i.wrap),0!==i.pending?g:_)},e.exports.deflateEnd=e=>{if(Q(e))return v;const t=e.state.status;return e.state=null,t===R?L(e,b):g},e.exports.deflateSetDictionary=(e,t)=>{let i=t.length;if(Q(e))return v;const s=e.state,n=s.wrap;if(2===n||1===n&&s.status!==D||s.lookahead)return v;if(1===n&&(e.adler=l(e.adler,t,i,0)),s.wrap=0,i>=s.w_size){0===n&&(N(s.head),s.strstart=0,s.block_start=0,s.insert=0);let e=new Uint8Array(s.w_size);e.set(t.subarray(i-s.w_size,i),0),t=e,i=s.w_size}const r=e.avail_in,o=e.next_in,a=e.input;for(e.avail_in=i,e.next_in=0,e.input=t,j(s);s.lookahead>=3;){let e=s.strstart,t=s.lookahead-2;do{s.ins_h=B(s,s.ins_h,s.window[e+3-1]),s.prev[e&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=e,e++}while(--t);s.strstart=e,s.lookahead=2,j(s)}return s.strstart+=s.lookahead,s.block_start=s.strstart,s.insert=s.lookahead,s.lookahead=0,s.match_length=s.prev_length=2,s.match_available=0,e.next_in=o,e.input=a,e.avail_in=r,s.wrap=n,g},e.exports.deflateInfo="pako deflate (from Nodeca project)"},414:e=>{"use strict";e.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},293:e=>{"use strict";const t=16209;e.exports=function(e,i){let s,n,r,o,a,l,h,c,d,u,p,m,f,g,_,v,b,y,C,w,S,E,x,T;const O=e.state;s=e.next_in,x=e.input,n=s+(e.avail_in-5),r=e.next_out,T=e.output,o=r-(i-e.avail_out),a=r+(e.avail_out-257),l=O.dmax,h=O.wsize,c=O.whave,d=O.wnext,u=O.window,p=O.hold,m=O.bits,f=O.lencode,g=O.distcode,_=(1<<O.lenbits)-1,v=(1<<O.distbits)-1;e:do{m<15&&(p+=x[s++]<<m,m+=8,p+=x[s++]<<m,m+=8),b=f[p&_];t:for(;;){if(y=b>>>24,p>>>=y,m-=y,y=b>>>16&255,0===y)T[r++]=65535&b;else{if(!(16&y)){if(64&y){if(32&y){O.mode=16191;break e}e.msg="invalid literal/length code",O.mode=t;break e}b=f[(65535&b)+(p&(1<<y)-1)];continue t}for(C=65535&b,y&=15,y&&(m<y&&(p+=x[s++]<<m,m+=8),C+=p&(1<<y)-1,p>>>=y,m-=y),m<15&&(p+=x[s++]<<m,m+=8,p+=x[s++]<<m,m+=8),b=g[p&v];;){if(y=b>>>24,p>>>=y,m-=y,y=b>>>16&255,16&y){if(w=65535&b,y&=15,m<y&&(p+=x[s++]<<m,m+=8,m<y&&(p+=x[s++]<<m,m+=8)),w+=p&(1<<y)-1,w>l){e.msg="invalid distance too far back",O.mode=t;break e}if(p>>>=y,m-=y,y=r-o,w>y){if(y=w-y,y>c&&O.sane){e.msg="invalid distance too far back",O.mode=t;break e}if(S=0,E=u,0===d){if(S+=h-y,y<C){C-=y;do{T[r++]=u[S++]}while(--y);S=r-w,E=T}}else if(d<y){if(S+=h+d-y,y-=d,y<C){C-=y;do{T[r++]=u[S++]}while(--y);if(S=0,d<C){y=d,C-=y;do{T[r++]=u[S++]}while(--y);S=r-w,E=T}}}else if(S+=d-y,y<C){C-=y;do{T[r++]=u[S++]}while(--y);S=r-w,E=T}for(;C>2;)T[r++]=E[S++],T[r++]=E[S++],T[r++]=E[S++],C-=3;C&&(T[r++]=E[S++],C>1&&(T[r++]=E[S++]))}else{S=r-w;do{T[r++]=T[S++],T[r++]=T[S++],T[r++]=T[S++],C-=3}while(C>2);C&&(T[r++]=T[S++],C>1&&(T[r++]=T[S++]))}break}if(64&y){e.msg="invalid distance code",O.mode=t;break e}b=g[(65535&b)+(p&(1<<y)-1)]}}break}}while(s<n&&r<a);C=m>>3,s-=C,m-=C<<3,p&=(1<<m)-1,e.next_in=s,e.next_out=r,e.avail_in=s<n?n-s+5:5-(s-n),e.avail_out=r<a?a-r+257:257-(r-a),O.hold=p,O.bits=m}},447:(e,t,i)=>{"use strict";const s=i(269),n=i(823),r=i(293),o=i(998),{Z_FINISH:a,Z_BLOCK:l,Z_TREES:h,Z_OK:c,Z_STREAM_END:d,Z_NEED_DICT:u,Z_STREAM_ERROR:p,Z_DATA_ERROR:m,Z_MEM_ERROR:f,Z_BUF_ERROR:g,Z_DEFLATED:_}=i(681),v=16180,b=16190,y=16191,C=16192,w=16194,S=16199,E=16200,x=16206,T=16209,O=16210,k=e=>(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24);function I(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const A=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<v||t.mode>16211?1:0},D=e=>{if(A(e))return p;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=v,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(852),t.distcode=t.distdyn=new Int32Array(592),t.sane=1,t.back=-1,c},R=e=>{if(A(e))return p;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,D(e)},P=(e,t)=>{let i;if(A(e))return p;const s=e.state;return t<0?(i=0,t=-t):(i=5+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?p:(null!==s.window&&s.wbits!==t&&(s.window=null),s.wrap=i,s.wbits=t,R(e))},L=(e,t)=>{if(!e)return p;const i=new I;e.state=i,i.strm=e,i.window=null,i.mode=v;const s=P(e,t);return s!==c&&(e.state=null),s};let M,N,F=!0;const B=e=>{if(F){M=new Int32Array(512),N=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(o(1,e.lens,0,288,M,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;o(2,e.lens,0,32,N,0,e.work,{bits:5}),F=!1}e.lencode=M,e.lenbits=9,e.distcode=N,e.distbits=5},H=(e,t,i,s)=>{let n;const r=e.state;return null===r.window&&(r.wsize=1<<r.wbits,r.wnext=0,r.whave=0,r.window=new Uint8Array(r.wsize)),s>=r.wsize?(r.window.set(t.subarray(i-r.wsize,i),0),r.wnext=0,r.whave=r.wsize):(n=r.wsize-r.wnext,n>s&&(n=s),r.window.set(t.subarray(i-s,i-s+n),r.wnext),(s-=n)?(r.window.set(t.subarray(i-s,i),0),r.wnext=s,r.whave=r.wsize):(r.wnext+=n,r.wnext===r.wsize&&(r.wnext=0),r.whave<r.wsize&&(r.whave+=n))),0};e.exports.inflateReset=R,e.exports.inflateReset2=P,e.exports.inflateResetKeep=D,e.exports.inflateInit=e=>L(e,15),e.exports.inflateInit2=L,e.exports.inflate=(e,t)=>{let i,I,D,R,P,L,M,N,F,z,$,V,W,U,j,G,q,K,Y,X,Z,Q,J=0;const ee=new Uint8Array(4);let te,ie;const se=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(A(e)||!e.output||!e.input&&0!==e.avail_in)return p;i=e.state,i.mode===y&&(i.mode=C),P=e.next_out,D=e.output,M=e.avail_out,R=e.next_in,I=e.input,L=e.avail_in,N=i.hold,F=i.bits,z=L,$=M,Q=c;e:for(;;)switch(i.mode){case v:if(0===i.wrap){i.mode=C;break}for(;F<16;){if(0===L)break e;L--,N+=I[R++]<<F,F+=8}if(2&i.wrap&&35615===N){0===i.wbits&&(i.wbits=15),i.check=0,ee[0]=255&N,ee[1]=N>>>8&255,i.check=n(i.check,ee,2,0),N=0,F=0,i.mode=16181;break}if(i.head&&(i.head.done=!1),!(1&i.wrap)||(((255&N)<<8)+(N>>8))%31){e.msg="incorrect header check",i.mode=T;break}if((15&N)!==_){e.msg="unknown compression method",i.mode=T;break}if(N>>>=4,F-=4,Z=8+(15&N),0===i.wbits&&(i.wbits=Z),Z>15||Z>i.wbits){e.msg="invalid window size",i.mode=T;break}i.dmax=1<<i.wbits,i.flags=0,e.adler=i.check=1,i.mode=512&N?16189:y,N=0,F=0;break;case 16181:for(;F<16;){if(0===L)break e;L--,N+=I[R++]<<F,F+=8}if(i.flags=N,(255&i.flags)!==_){e.msg="unknown compression method",i.mode=T;break}if(57344&i.flags){e.msg="unknown header flags set",i.mode=T;break}i.head&&(i.head.text=N>>8&1),512&i.flags&&4&i.wrap&&(ee[0]=255&N,ee[1]=N>>>8&255,i.check=n(i.check,ee,2,0)),N=0,F=0,i.mode=16182;case 16182:for(;F<32;){if(0===L)break e;L--,N+=I[R++]<<F,F+=8}i.head&&(i.head.time=N),512&i.flags&&4&i.wrap&&(ee[0]=255&N,ee[1]=N>>>8&255,ee[2]=N>>>16&255,ee[3]=N>>>24&255,i.check=n(i.check,ee,4,0)),N=0,F=0,i.mode=16183;case 16183:for(;F<16;){if(0===L)break e;L--,N+=I[R++]<<F,F+=8}i.head&&(i.head.xflags=255&N,i.head.os=N>>8),512&i.flags&&4&i.wrap&&(ee[0]=255&N,ee[1]=N>>>8&255,i.check=n(i.check,ee,2,0)),N=0,F=0,i.mode=16184;case 16184:if(1024&i.flags){for(;F<16;){if(0===L)break e;L--,N+=I[R++]<<F,F+=8}i.length=N,i.head&&(i.head.extra_len=N),512&i.flags&&4&i.wrap&&(ee[0]=255&N,ee[1]=N>>>8&255,i.check=n(i.check,ee,2,0)),N=0,F=0}else i.head&&(i.head.extra=null);i.mode=16185;case 16185:if(1024&i.flags&&(V=i.length,V>L&&(V=L),V&&(i.head&&(Z=i.head.extra_len-i.length,i.head.extra||(i.head.extra=new Uint8Array(i.head.extra_len)),i.head.extra.set(I.subarray(R,R+V),Z)),512&i.flags&&4&i.wrap&&(i.check=n(i.check,I,V,R)),L-=V,R+=V,i.length-=V),i.length))break e;i.length=0,i.mode=16186;case 16186:if(2048&i.flags){if(0===L)break e;V=0;do{Z=I[R+V++],i.head&&Z&&i.length<65536&&(i.head.name+=String.fromCharCode(Z))}while(Z&&V<L);if(512&i.flags&&4&i.wrap&&(i.check=n(i.check,I,V,R)),L-=V,R+=V,Z)break e}else i.head&&(i.head.name=null);i.length=0,i.mode=16187;case 16187:if(4096&i.flags){if(0===L)break e;V=0;do{Z=I[R+V++],i.head&&Z&&i.length<65536&&(i.head.comment+=String.fromCharCode(Z))}while(Z&&V<L);if(512&i.flags&&4&i.wrap&&(i.check=n(i.check,I,V,R)),L-=V,R+=V,Z)break e}else i.head&&(i.head.comment=null);i.mode=16188;case 16188:if(512&i.flags){for(;F<16;){if(0===L)break e;L--,N+=I[R++]<<F,F+=8}if(4&i.wrap&&N!==(65535&i.check)){e.msg="header crc mismatch",i.mode=T;break}N=0,F=0}i.head&&(i.head.hcrc=i.flags>>9&1,i.head.done=!0),e.adler=i.check=0,i.mode=y;break;case 16189:for(;F<32;){if(0===L)break e;L--,N+=I[R++]<<F,F+=8}e.adler=i.check=k(N),N=0,F=0,i.mode=b;case b:if(0===i.havedict)return e.next_out=P,e.avail_out=M,e.next_in=R,e.avail_in=L,i.hold=N,i.bits=F,u;e.adler=i.check=1,i.mode=y;case y:if(t===l||t===h)break e;case C:if(i.last){N>>>=7&F,F-=7&F,i.mode=x;break}for(;F<3;){if(0===L)break e;L--,N+=I[R++]<<F,F+=8}switch(i.last=1&N,N>>>=1,F-=1,3&N){case 0:i.mode=16193;break;case 1:if(B(i),i.mode=S,t===h){N>>>=2,F-=2;break e}break;case 2:i.mode=16196;break;case 3:e.msg="invalid block type",i.mode=T}N>>>=2,F-=2;break;case 16193:for(N>>>=7&F,F-=7&F;F<32;){if(0===L)break e;L--,N+=I[R++]<<F,F+=8}if((65535&N)!=(N>>>16^65535)){e.msg="invalid stored block lengths",i.mode=T;break}if(i.length=65535&N,N=0,F=0,i.mode=w,t===h)break e;case w:i.mode=16195;case 16195:if(V=i.length,V){if(V>L&&(V=L),V>M&&(V=M),0===V)break e;D.set(I.subarray(R,R+V),P),L-=V,R+=V,M-=V,P+=V,i.length-=V;break}i.mode=y;break;case 16196:for(;F<14;){if(0===L)break e;L--,N+=I[R++]<<F,F+=8}if(i.nlen=257+(31&N),N>>>=5,F-=5,i.ndist=1+(31&N),N>>>=5,F-=5,i.ncode=4+(15&N),N>>>=4,F-=4,i.nlen>286||i.ndist>30){e.msg="too many length or distance symbols",i.mode=T;break}i.have=0,i.mode=16197;case 16197:for(;i.have<i.ncode;){for(;F<3;){if(0===L)break e;L--,N+=I[R++]<<F,F+=8}i.lens[se[i.have++]]=7&N,N>>>=3,F-=3}for(;i.have<19;)i.lens[se[i.have++]]=0;if(i.lencode=i.lendyn,i.lenbits=7,te={bits:i.lenbits},Q=o(0,i.lens,0,19,i.lencode,0,i.work,te),i.lenbits=te.bits,Q){e.msg="invalid code lengths set",i.mode=T;break}i.have=0,i.mode=16198;case 16198:for(;i.have<i.nlen+i.ndist;){for(;J=i.lencode[N&(1<<i.lenbits)-1],j=J>>>24,G=J>>>16&255,q=65535&J,!(j<=F);){if(0===L)break e;L--,N+=I[R++]<<F,F+=8}if(q<16)N>>>=j,F-=j,i.lens[i.have++]=q;else{if(16===q){for(ie=j+2;F<ie;){if(0===L)break e;L--,N+=I[R++]<<F,F+=8}if(N>>>=j,F-=j,0===i.have){e.msg="invalid bit length repeat",i.mode=T;break}Z=i.lens[i.have-1],V=3+(3&N),N>>>=2,F-=2}else if(17===q){for(ie=j+3;F<ie;){if(0===L)break e;L--,N+=I[R++]<<F,F+=8}N>>>=j,F-=j,Z=0,V=3+(7&N),N>>>=3,F-=3}else{for(ie=j+7;F<ie;){if(0===L)break e;L--,N+=I[R++]<<F,F+=8}N>>>=j,F-=j,Z=0,V=11+(127&N),N>>>=7,F-=7}if(i.have+V>i.nlen+i.ndist){e.msg="invalid bit length repeat",i.mode=T;break}for(;V--;)i.lens[i.have++]=Z}}if(i.mode===T)break;if(0===i.lens[256]){e.msg="invalid code -- missing end-of-block",i.mode=T;break}if(i.lenbits=9,te={bits:i.lenbits},Q=o(1,i.lens,0,i.nlen,i.lencode,0,i.work,te),i.lenbits=te.bits,Q){e.msg="invalid literal/lengths set",i.mode=T;break}if(i.distbits=6,i.distcode=i.distdyn,te={bits:i.distbits},Q=o(2,i.lens,i.nlen,i.ndist,i.distcode,0,i.work,te),i.distbits=te.bits,Q){e.msg="invalid distances set",i.mode=T;break}if(i.mode=S,t===h)break e;case S:i.mode=E;case E:if(L>=6&&M>=258){e.next_out=P,e.avail_out=M,e.next_in=R,e.avail_in=L,i.hold=N,i.bits=F,r(e,$),P=e.next_out,D=e.output,M=e.avail_out,R=e.next_in,I=e.input,L=e.avail_in,N=i.hold,F=i.bits,i.mode===y&&(i.back=-1);break}for(i.back=0;J=i.lencode[N&(1<<i.lenbits)-1],j=J>>>24,G=J>>>16&255,q=65535&J,!(j<=F);){if(0===L)break e;L--,N+=I[R++]<<F,F+=8}if(G&&!(240&G)){for(K=j,Y=G,X=q;J=i.lencode[X+((N&(1<<K+Y)-1)>>K)],j=J>>>24,G=J>>>16&255,q=65535&J,!(K+j<=F);){if(0===L)break e;L--,N+=I[R++]<<F,F+=8}N>>>=K,F-=K,i.back+=K}if(N>>>=j,F-=j,i.back+=j,i.length=q,0===G){i.mode=16205;break}if(32&G){i.back=-1,i.mode=y;break}if(64&G){e.msg="invalid literal/length code",i.mode=T;break}i.extra=15&G,i.mode=16201;case 16201:if(i.extra){for(ie=i.extra;F<ie;){if(0===L)break e;L--,N+=I[R++]<<F,F+=8}i.length+=N&(1<<i.extra)-1,N>>>=i.extra,F-=i.extra,i.back+=i.extra}i.was=i.length,i.mode=16202;case 16202:for(;J=i.distcode[N&(1<<i.distbits)-1],j=J>>>24,G=J>>>16&255,q=65535&J,!(j<=F);){if(0===L)break e;L--,N+=I[R++]<<F,F+=8}if(!(240&G)){for(K=j,Y=G,X=q;J=i.distcode[X+((N&(1<<K+Y)-1)>>K)],j=J>>>24,G=J>>>16&255,q=65535&J,!(K+j<=F);){if(0===L)break e;L--,N+=I[R++]<<F,F+=8}N>>>=K,F-=K,i.back+=K}if(N>>>=j,F-=j,i.back+=j,64&G){e.msg="invalid distance code",i.mode=T;break}i.offset=q,i.extra=15&G,i.mode=16203;case 16203:if(i.extra){for(ie=i.extra;F<ie;){if(0===L)break e;L--,N+=I[R++]<<F,F+=8}i.offset+=N&(1<<i.extra)-1,N>>>=i.extra,F-=i.extra,i.back+=i.extra}if(i.offset>i.dmax){e.msg="invalid distance too far back",i.mode=T;break}i.mode=16204;case 16204:if(0===M)break e;if(V=$-M,i.offset>V){if(V=i.offset-V,V>i.whave&&i.sane){e.msg="invalid distance too far back",i.mode=T;break}V>i.wnext?(V-=i.wnext,W=i.wsize-V):W=i.wnext-V,V>i.length&&(V=i.length),U=i.window}else U=D,W=P-i.offset,V=i.length;V>M&&(V=M),M-=V,i.length-=V;do{D[P++]=U[W++]}while(--V);0===i.length&&(i.mode=E);break;case 16205:if(0===M)break e;D[P++]=i.length,M--,i.mode=E;break;case x:if(i.wrap){for(;F<32;){if(0===L)break e;L--,N|=I[R++]<<F,F+=8}if($-=M,e.total_out+=$,i.total+=$,4&i.wrap&&$&&(e.adler=i.check=i.flags?n(i.check,D,$,P-$):s(i.check,D,$,P-$)),$=M,4&i.wrap&&(i.flags?N:k(N))!==i.check){e.msg="incorrect data check",i.mode=T;break}N=0,F=0}i.mode=16207;case 16207:if(i.wrap&&i.flags){for(;F<32;){if(0===L)break e;L--,N+=I[R++]<<F,F+=8}if(4&i.wrap&&N!==(4294967295&i.total)){e.msg="incorrect length check",i.mode=T;break}N=0,F=0}i.mode=16208;case 16208:Q=d;break e;case T:Q=m;break e;case O:return f;default:return p}return e.next_out=P,e.avail_out=M,e.next_in=R,e.avail_in=L,i.hold=N,i.bits=F,(i.wsize||$!==e.avail_out&&i.mode<T&&(i.mode<x||t!==a))&&H(e,e.output,e.next_out,$-e.avail_out)?(i.mode=O,f):(z-=e.avail_in,$-=e.avail_out,e.total_in+=z,e.total_out+=$,i.total+=$,4&i.wrap&&$&&(e.adler=i.check=i.flags?n(i.check,D,$,e.next_out-$):s(i.check,D,$,e.next_out-$)),e.data_type=i.bits+(i.last?64:0)+(i.mode===y?128:0)+(i.mode===S||i.mode===w?256:0),(0===z&&0===$||t===a)&&Q===c&&(Q=g),Q)},e.exports.inflateEnd=e=>{if(A(e))return p;let t=e.state;return t.window&&(t.window=null),e.state=null,c},e.exports.inflateGetHeader=(e,t)=>{if(A(e))return p;const i=e.state;return 2&i.wrap?(i.head=t,t.done=!1,c):p},e.exports.inflateSetDictionary=(e,t)=>{const i=t.length;let n,r,o;return A(e)?p:(n=e.state,0!==n.wrap&&n.mode!==b?p:n.mode===b&&(r=1,r=s(r,t,i,0),r!==n.check)?m:(o=H(e,t,i,i),o?(n.mode=O,f):(n.havedict=1,c)))},e.exports.inflateInfo="pako inflate (from Nodeca project)"},998:e=>{"use strict";const t=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),i=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),s=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),n=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);e.exports=(e,r,o,a,l,h,c,d)=>{const u=d.bits;let p,m,f,g,_,v,b=0,y=0,C=0,w=0,S=0,E=0,x=0,T=0,O=0,k=0,I=null;const A=new Uint16Array(16),D=new Uint16Array(16);let R,P,L,M=null;for(b=0;b<=15;b++)A[b]=0;for(y=0;y<a;y++)A[r[o+y]]++;for(S=u,w=15;w>=1&&0===A[w];w--);if(S>w&&(S=w),0===w)return l[h++]=20971520,l[h++]=20971520,d.bits=1,0;for(C=1;C<w&&0===A[C];C++);for(S<C&&(S=C),T=1,b=1;b<=15;b++)if(T<<=1,T-=A[b],T<0)return-1;if(T>0&&(0===e||1!==w))return-1;for(D[1]=0,b=1;b<15;b++)D[b+1]=D[b]+A[b];for(y=0;y<a;y++)0!==r[o+y]&&(c[D[r[o+y]]++]=y);if(0===e?(I=M=c,v=20):1===e?(I=t,M=i,v=257):(I=s,M=n,v=0),k=0,y=0,b=C,_=h,E=S,x=0,f=-1,O=1<<S,g=O-1,1===e&&O>852||2===e&&O>592)return 1;for(;;){R=b-x,c[y]+1<v?(P=0,L=c[y]):c[y]>=v?(P=M[c[y]-v],L=I[c[y]-v]):(P=96,L=0),p=1<<b-x,m=1<<E,C=m;do{m-=p,l[_+(k>>x)+m]=R<<24|P<<16|L}while(0!==m);for(p=1<<b-1;k&p;)p>>=1;if(0!==p?(k&=p-1,k+=p):k=0,y++,0==--A[b]){if(b===w)break;b=r[o+c[y]]}if(b>S&&(k&g)!==f){for(0===x&&(x=S),_+=C,E=b-x,T=1<<E;E+x<w&&(T-=A[E+x],!(T<=0));)E++,T<<=1;if(O+=1<<E,1===e&&O>852||2===e&&O>592)return 1;f=k&g,l[f]=S<<24|E<<16|_-h}}return 0!==k&&(l[_+k]=b-x<<24|64<<16),d.bits=S,0}},674:e=>{"use strict";e.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},665:e=>{"use strict";function t(e){let t=e.length;for(;--t>=0;)e[t]=0}const i=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),s=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),n=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),r=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),o=new Array(576);t(o);const a=new Array(60);t(a);const l=new Array(512);t(l);const h=new Array(256);t(h);const c=new Array(29);t(c);const d=new Array(30);function u(e,t,i,s,n){this.static_tree=e,this.extra_bits=t,this.extra_base=i,this.elems=s,this.max_length=n,this.has_stree=e&&e.length}let p,m,f;function g(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}t(d);const _=e=>e<256?l[e]:l[256+(e>>>7)],v=(e,t)=>{e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255},b=(e,t,i)=>{e.bi_valid>16-i?(e.bi_buf|=t<<e.bi_valid&65535,v(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=i-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=i)},y=(e,t,i)=>{b(e,i[2*t],i[2*t+1])},C=(e,t)=>{let i=0;do{i|=1&e,e>>>=1,i<<=1}while(--t>0);return i>>>1},w=(e,t,i)=>{const s=new Array(16);let n,r,o=0;for(n=1;n<=15;n++)o=o+i[n-1]<<1,s[n]=o;for(r=0;r<=t;r++){let t=e[2*r+1];0!==t&&(e[2*r]=C(s[t]++,t))}},S=e=>{let t;for(t=0;t<286;t++)e.dyn_ltree[2*t]=0;for(t=0;t<30;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},E=e=>{e.bi_valid>8?v(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},x=(e,t,i,s)=>{const n=2*t,r=2*i;return e[n]<e[r]||e[n]===e[r]&&s[t]<=s[i]},T=(e,t,i)=>{const s=e.heap[i];let n=i<<1;for(;n<=e.heap_len&&(n<e.heap_len&&x(t,e.heap[n+1],e.heap[n],e.depth)&&n++,!x(t,s,e.heap[n],e.depth));)e.heap[i]=e.heap[n],i=n,n<<=1;e.heap[i]=s},O=(e,t,n)=>{let r,o,a,l,u=0;if(0!==e.sym_next)do{r=255&e.pending_buf[e.sym_buf+u++],r+=(255&e.pending_buf[e.sym_buf+u++])<<8,o=e.pending_buf[e.sym_buf+u++],0===r?y(e,o,t):(a=h[o],y(e,a+256+1,t),l=i[a],0!==l&&(o-=c[a],b(e,o,l)),r--,a=_(r),y(e,a,n),l=s[a],0!==l&&(r-=d[a],b(e,r,l)))}while(u<e.sym_next);y(e,256,t)},k=(e,t)=>{const i=t.dyn_tree,s=t.stat_desc.static_tree,n=t.stat_desc.has_stree,r=t.stat_desc.elems;let o,a,l,h=-1;for(e.heap_len=0,e.heap_max=573,o=0;o<r;o++)0!==i[2*o]?(e.heap[++e.heap_len]=h=o,e.depth[o]=0):i[2*o+1]=0;for(;e.heap_len<2;)l=e.heap[++e.heap_len]=h<2?++h:0,i[2*l]=1,e.depth[l]=0,e.opt_len--,n&&(e.static_len-=s[2*l+1]);for(t.max_code=h,o=e.heap_len>>1;o>=1;o--)T(e,i,o);l=r;do{o=e.heap[1],e.heap[1]=e.heap[e.heap_len--],T(e,i,1),a=e.heap[1],e.heap[--e.heap_max]=o,e.heap[--e.heap_max]=a,i[2*l]=i[2*o]+i[2*a],e.depth[l]=(e.depth[o]>=e.depth[a]?e.depth[o]:e.depth[a])+1,i[2*o+1]=i[2*a+1]=l,e.heap[1]=l++,T(e,i,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],((e,t)=>{const i=t.dyn_tree,s=t.max_code,n=t.stat_desc.static_tree,r=t.stat_desc.has_stree,o=t.stat_desc.extra_bits,a=t.stat_desc.extra_base,l=t.stat_desc.max_length;let h,c,d,u,p,m,f=0;for(u=0;u<=15;u++)e.bl_count[u]=0;for(i[2*e.heap[e.heap_max]+1]=0,h=e.heap_max+1;h<573;h++)c=e.heap[h],u=i[2*i[2*c+1]+1]+1,u>l&&(u=l,f++),i[2*c+1]=u,c>s||(e.bl_count[u]++,p=0,c>=a&&(p=o[c-a]),m=i[2*c],e.opt_len+=m*(u+p),r&&(e.static_len+=m*(n[2*c+1]+p)));if(0!==f){do{for(u=l-1;0===e.bl_count[u];)u--;e.bl_count[u]--,e.bl_count[u+1]+=2,e.bl_count[l]--,f-=2}while(f>0);for(u=l;0!==u;u--)for(c=e.bl_count[u];0!==c;)d=e.heap[--h],d>s||(i[2*d+1]!==u&&(e.opt_len+=(u-i[2*d+1])*i[2*d],i[2*d+1]=u),c--)}})(e,t),w(i,h,e.bl_count)},I=(e,t,i)=>{let s,n,r=-1,o=t[1],a=0,l=7,h=4;for(0===o&&(l=138,h=3),t[2*(i+1)+1]=65535,s=0;s<=i;s++)n=o,o=t[2*(s+1)+1],++a<l&&n===o||(a<h?e.bl_tree[2*n]+=a:0!==n?(n!==r&&e.bl_tree[2*n]++,e.bl_tree[32]++):a<=10?e.bl_tree[34]++:e.bl_tree[36]++,a=0,r=n,0===o?(l=138,h=3):n===o?(l=6,h=3):(l=7,h=4))},A=(e,t,i)=>{let s,n,r=-1,o=t[1],a=0,l=7,h=4;for(0===o&&(l=138,h=3),s=0;s<=i;s++)if(n=o,o=t[2*(s+1)+1],!(++a<l&&n===o)){if(a<h)do{y(e,n,e.bl_tree)}while(0!=--a);else 0!==n?(n!==r&&(y(e,n,e.bl_tree),a--),y(e,16,e.bl_tree),b(e,a-3,2)):a<=10?(y(e,17,e.bl_tree),b(e,a-3,3)):(y(e,18,e.bl_tree),b(e,a-11,7));a=0,r=n,0===o?(l=138,h=3):n===o?(l=6,h=3):(l=7,h=4)}};let D=!1;const R=(e,t,i,s)=>{b(e,0+(s?1:0),3),E(e),v(e,i),v(e,~i),i&&e.pending_buf.set(e.window.subarray(t,t+i),e.pending),e.pending+=i};e.exports._tr_init=e=>{D||((()=>{let e,t,r,g,_;const v=new Array(16);for(r=0,g=0;g<28;g++)for(c[g]=r,e=0;e<1<<i[g];e++)h[r++]=g;for(h[r-1]=g,_=0,g=0;g<16;g++)for(d[g]=_,e=0;e<1<<s[g];e++)l[_++]=g;for(_>>=7;g<30;g++)for(d[g]=_<<7,e=0;e<1<<s[g]-7;e++)l[256+_++]=g;for(t=0;t<=15;t++)v[t]=0;for(e=0;e<=143;)o[2*e+1]=8,e++,v[8]++;for(;e<=255;)o[2*e+1]=9,e++,v[9]++;for(;e<=279;)o[2*e+1]=7,e++,v[7]++;for(;e<=287;)o[2*e+1]=8,e++,v[8]++;for(w(o,287,v),e=0;e<30;e++)a[2*e+1]=5,a[2*e]=C(e,5);p=new u(o,i,257,286,15),m=new u(a,s,0,30,15),f=new u(new Array(0),n,0,19,7)})(),D=!0),e.l_desc=new g(e.dyn_ltree,p),e.d_desc=new g(e.dyn_dtree,m),e.bl_desc=new g(e.bl_tree,f),e.bi_buf=0,e.bi_valid=0,S(e)},e.exports._tr_stored_block=R,e.exports._tr_flush_block=(e,t,i,s)=>{let n,l,h=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=(e=>{let t,i=4093624447;for(t=0;t<=31;t++,i>>>=1)if(1&i&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<256;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0})(e)),k(e,e.l_desc),k(e,e.d_desc),h=(e=>{let t;for(I(e,e.dyn_ltree,e.l_desc.max_code),I(e,e.dyn_dtree,e.d_desc.max_code),k(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*r[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t})(e),n=e.opt_len+3+7>>>3,l=e.static_len+3+7>>>3,l<=n&&(n=l)):n=l=i+5,i+4<=n&&-1!==t?R(e,t,i,s):4===e.strategy||l===n?(b(e,2+(s?1:0),3),O(e,o,a)):(b(e,4+(s?1:0),3),((e,t,i,s)=>{let n;for(b(e,t-257,5),b(e,i-1,5),b(e,s-4,4),n=0;n<s;n++)b(e,e.bl_tree[2*r[n]+1],3);A(e,e.dyn_ltree,t-1),A(e,e.dyn_dtree,i-1)})(e,e.l_desc.max_code+1,e.d_desc.max_code+1,h+1),O(e,e.dyn_ltree,e.dyn_dtree)),S(e),s&&E(e)},e.exports._tr_tally=(e,t,i)=>(e.pending_buf[e.sym_buf+e.sym_next++]=t,e.pending_buf[e.sym_buf+e.sym_next++]=t>>8,e.pending_buf[e.sym_buf+e.sym_next++]=i,0===t?e.dyn_ltree[2*i]++:(e.matches++,t--,e.dyn_ltree[2*(h[i]+256+1)]++,e.dyn_dtree[2*_(t)]++),e.sym_next===e.sym_end),e.exports._tr_align=e=>{b(e,2,3),y(e,256,o),(e=>{16===e.bi_valid?(v(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)})(e)}},442:e=>{"use strict";e.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}}},t={};function i(s){var n=t[s];if(void 0!==n)return n.exports;var r=t[s]={exports:{}};return e[s].call(r.exports,r,r.exports,i),r.exports}i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var s in t)i.o(t,s)&&!i.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{"use strict";var e={};i.r(e),i.d(e,{BackendUtilityService:()=>g});var t={};i.r(t),i.d(t,{collectionObserver:()=>_,propertyObserver:()=>v});var s={};i.r(s),i.d(s,{CaseType:()=>C,DelimiterType:()=>w,EmitterType:()=>h,ExtensionName:()=>S,FieldType:()=>E,FileType:()=>x,FilterMultiplePassType:()=>T,GridStateType:()=>O,OperatorType:()=>k,SortDirection:()=>I,SortDirectionNumber:()=>A,ToggleStateChangeType:()=>D});var n={};i.r(n),i.d(n,{CancelledException:()=>R,addTreeLevelAndAggregatorsByMutation:()=>N,addTreeLevelByMutation:()=>M,cancellablePromise:()=>P,castObservableToPromise:()=>L,decimalFormatted:()=>$,findItemInTreeStructure:()=>z,findOrDefault:()=>J,flattenToParentChildArray:()=>F,formatNumber:()=>V,getCellValueFromQueryFieldGetter:()=>W,getColumnFieldType:()=>G,getDescendantProperty:()=>U,getTranslationPrefix:()=>j,getTreeDataOptionPropName:()=>B,isColumnDateType:()=>q,mapOperatorByFieldType:()=>X,mapOperatorToShorthandDesignation:()=>Y,mapOperatorType:()=>K,objectWithoutKey:()=>Z,thousandSeparatorFormatted:()=>Q,unflattenParentChildArrayToTree:()=>H,unsubscribeAll:()=>ee});var r={};i.r(r),i.d(r,{addToArrayWhenNotExists:()=>Oe,addWhiteSpaces:()=>ke,arrayRemoveItemByIndex:()=>Ie,calculateAvailableSpace:()=>te,classNameToList:()=>se,createDomElement:()=>ie,deepCopy:()=>Ae,deepMerge:()=>De,destroyAllElementProps:()=>ne,emptyElement:()=>re,emptyObject:()=>Re,extend:()=>Te,findFirstAttribute:()=>de,findWidthOrDefault:()=>ue,getFunctionDetails:()=>Pe,getHtmlStringOutput:()=>oe,getInnerSize:()=>he,getOffset:()=>le,getOffsetRelativeToParent:()=>ae,getStyleProp:()=>ce,htmlEncode:()=>pe,htmlEncodeWithPadding:()=>fe,htmlEntityDecode:()=>me,insertAfterElement:()=>ge,isDefined:()=>Me,isDefinedNumber:()=>Ne,isEmptyObject:()=>Le,isNumber:()=>ze,isObject:()=>Fe,isObjectEmpty:()=>$e,isPrimitiveOrHTML:()=>He,isPrimitiveValue:()=>Be,parseBoolean:()=>Ve,removeAccentFromText:()=>We,setDeepValue:()=>Ue,stripTags:()=>st,titleCase:()=>je,toCamelCase:()=>Ge,toKebabCase:()=>qe,toSentenceCase:()=>Ke,toSnakeCase:()=>Ye,uniqueArray:()=>Xe,uniqueObjectArray:()=>Ze,windowScrollPosition:()=>_e});var o={};i.r(o),i.d(o,{sortByFieldType:()=>Ht});var a={};i.r(a),i.d(a,{afterMain:()=>Dl,afterRead:()=>kl,afterWrite:()=>Ll,applyStyles:()=>$l,arrow:()=>ah,auto:()=>gl,basePlacements:()=>_l,beforeMain:()=>Il,beforeRead:()=>Tl,beforeWrite:()=>Rl,bottom:()=>pl,clippingParents:()=>yl,computeStyles:()=>dh,createPopper:()=>zh,createPopperBase:()=>Hh,createPopperLite:()=>$h,detectOverflow:()=>Th,end:()=>bl,eventListeners:()=>ph,flip:()=>Oh,hide:()=>Ah,left:()=>fl,main:()=>Al,modifierPhases:()=>Ml,offset:()=>Dh,placements:()=>xl,popper:()=>wl,popperGenerator:()=>Bh,popperOffsets:()=>Rh,preventOverflow:()=>Ph,read:()=>Ol,reference:()=>Sl,right:()=>ml,start:()=>vl,top:()=>ul,variationPlacements:()=>El,viewport:()=>Cl,write:()=>Pl});var l={};i.r(l),i.d(l,{Alert:()=>Mc,Button:()=>Fc,Carousel:()=>vd,Collapse:()=>Rd,Dropdown:()=>su,Modal:()=>Bu,Offcanvas:()=>ip,Popover:()=>kp,ScrollSpy:()=>Hp,Tab:()=>rm,Toast:()=>ym,Tooltip:()=>Sp});var h,c=i(856),d=i(616),u=i(838),p=i.n(u),m=i(189),f=i.n(m);!function(e){e.local="local",e.remote="remote"}(h||(h={}));class g{constructor(e){this.rxjs=e,this._infiniteScrollBottomHit=!1}addRxJsResource(e){this.rxjs=e}executeBackendProcessesCallback(e,t,i,s){const n=new Date;t&&i.service.postProcess&&i.service.postProcess(t),t&&i?.internalPostProcess&&i.internalPostProcess(t),void 0!==i.postProcess&&(t instanceof Object&&(t.metrics={startTime:e,endTime:n,executionTime:n.valueOf()-e.valueOf(),itemCount:s,totalItemCount:s},i.service.options?.infiniteScroll&&(t.infiniteScrollBottomHit=this._infiniteScrollBottomHit,delete t.itemCount)),i.postProcess(t),this.setInfiniteScrollBottomHit(!1))}onBackendError(e,t){if("function"!=typeof t?.onError)throw e;t.onError(e)}executeBackendCallback(e,t,i,s,n,r){if(e){i&&!i.clearFilterTriggered&&!i.clearSortTriggered&&r?.emitActionChangedCallback&&r.emitActionChangedCallback.call(this,h.remote);const o=e.process(t);if(o instanceof Promise&&o.then)o.then((t=>{this.executeBackendProcessesCallback(s,t,e,n),r?.successCallback?.call(this,i)})).catch((t=>{r?.errorCallback?.call(this,i),this.onBackendError(t,e)}));else if(this.rxjs?.isObservable(o)){const t=this.rxjs;t.isObservable(r?.httpCancelRequestSubject)&&r?.httpCancelRequestSubject.next(),o.pipe(t.takeUntil(t.iif((()=>t.isObservable(r?.httpCancelRequestSubject)),r?.httpCancelRequestSubject,t.EMPTY))).subscribe((t=>{this.executeBackendProcessesCallback(s,t,e,n),r?.successCallback?.call(this,i)}),(t=>{r?.errorCallback?.call(this,i),this.onBackendError(t,e)}))}}}refreshBackendDataset(e){let t="";const i=e?.backendServiceApi;if(!i||!i.service||!i.process)throw new Error('BackendServiceApi requires at least a "process" function and a "service" defined');if(i.service&&(t=i.service.buildQuery()),t&&""!==t){const s=new Date;i.preProcess&&i.preProcess();const n=e?.pagination?.totalItems??0;this.executeBackendCallback(i,t,null,s,n)}}setInfiniteScrollBottomHit(e){this._infiniteScrollBottomHit=e}}function _(e,t){["pop","push","reverse","shift","unshift","splice","sort"].forEach((i=>{e[i]=(...s)=>{const n=Array.prototype[i].apply(e,s);return t.apply(e,[e,s]),n}}))}function v(e,t,i){let s=e[t];Object.defineProperty(e,t,{configurable:!0,get:()=>s,set(n){s=n,i.apply(e,[n,e[t]])}})}Array.prototype.map,Array.prototype.reduce;const b=e=>e;class y{}var C,w,S;y.locales={TEXT_ALL_SELECTED:"All Selected",TEXT_ALL_X_RECORDS_SELECTED:"All {{x}} records selected",TEXT_APPLY_MASS_UPDATE:"Apply Mass Update",TEXT_APPLY_TO_SELECTION:"Update Selection",TEXT_CANCEL:"Cancel",TEXT_CLEAR_ALL_FILTERS:"Clear all Filters",TEXT_CLEAR_ALL_GROUPING:"Clear all Grouping",TEXT_CLEAR_ALL_SORTING:"Clear all Sorting",TEXT_CLEAR_PINNING:"Unfreeze Columns/Rows",TEXT_CLONE:"Clone",TEXT_COLLAPSE_ALL_GROUPS:"Collapse all Groups",TEXT_CONTAINS:"Contains",TEXT_COLUMNS:"Columns",TEXT_COLUMN_RESIZE_BY_CONTENT:"Resize by Content",TEXT_COMMANDS:"Commands",TEXT_COPY:"Copy",TEXT_DROP_COLUMN_HEADER_TO_GROUP_BY:"Drop a column header here to group by the column",TEXT_EQUALS:"Equals",TEXT_EQUAL_TO:"Equal to",TEXT_ENDS_WITH:"Ends With",TEXT_ERROR_EDITABLE_GRID_REQUIRED:"Your grid must be editable in order to use the Composite Editor Modal.",TEXT_ERROR_ENABLE_CELL_NAVIGATION_REQUIRED:'Composite Editor requires the flag "enableCellNavigation" to be set to True in your Grid Options.',TEXT_ERROR_NO_CHANGES_DETECTED:"Sorry we could not detect any changes.",TEXT_ERROR_NO_EDITOR_FOUND:"We could not find any Editor in your Column Definition.",TEXT_ERROR_NO_RECORD_FOUND:"No records selected for edit or clone operation.",TEXT_ERROR_ROW_NOT_EDITABLE:"Current row is not editable.",TEXT_ERROR_ROW_SELECTION_REQUIRED:"You must select some rows before trying to apply new value(s).",TEXT_EXPAND_ALL_GROUPS:"Expand all Groups",TEXT_EXPORT_TO_CSV:"Export in CSV format",TEXT_EXPORT_TO_TEXT_FORMAT:"Export in Text format (Tab delimited)",TEXT_EXPORT_TO_EXCEL:"Export to Excel",TEXT_EXPORT_TO_TAB_DELIMITED:"Export in Text format (Tab delimited)",TEXT_FORCE_FIT_COLUMNS:"Force fit columns",TEXT_FILTER_SHORTCUTS:"Filter Shortcuts",TEXT_FREEZE_COLUMNS:"Freeze Columns",TEXT_GREATER_THAN:"Greater than",TEXT_GREATER_THAN_OR_EQUAL_TO:"Greater than or equal to",TEXT_GROUP_BY:"Group By",TEXT_HIDE_COLUMN:"Hide Column",TEXT_ITEMS:"items",TEXT_ITEMS_PER_PAGE:"items per page",TEXT_ITEMS_SELECTED:"items selected",TEXT_OF:"of",TEXT_OK:"OK",TEXT_LAST_UPDATE:"Last Update",TEXT_LESS_THAN:"Less than",TEXT_LESS_THAN_OR_EQUAL_TO:"Less than or equal to",TEXT_NOT_CONTAINS:"Not contains",TEXT_NOT_EQUAL_TO:"Not equal to",TEXT_PAGE:"Page",TEXT_RECORDS_SELECTED:"records selected",TEXT_REFRESH_DATASET:"Refresh Dataset",TEXT_REMOVE_FILTER:"Remove Filter",TEXT_REMOVE_SORT:"Remove Sort",TEXT_RESET_INPUT_VALUE:"Reset Input Value",TEXT_RESET_FORM:"Reset Form",TEXT_SAVE:"Save",TEXT_SELECT_ALL:"Select All",TEXT_SYNCHRONOUS_RESIZE:"Synchronous resize",TEXT_SORT_ASCENDING:"Sort Ascending",TEXT_SORT_DESCENDING:"Sort Descending",TEXT_STARTS_WITH:"Starts With",TEXT_TOGGLE_ALL_GROUPS:"Toggle all Groups",TEXT_TOGGLE_DARK_MODE:"Toggle Dark Mode",TEXT_TOGGLE_FILTER_ROW:"Toggle Filter Row",TEXT_TOGGLE_PRE_HEADER_ROW:"Toggle Pre-Header Row",TEXT_UNFREEZE_COLUMNS:"Unfreeze Columns",TEXT_X_OF_Y_SELECTED:"# of % selected",TEXT_X_OF_Y_MASS_SELECTED:"{{x}} of {{y}} selected"},y.treeDataProperties={CHILDREN_PROP:"children",COLLAPSED_PROP:"__collapsed",HAS_CHILDREN_PROP:"__hasChildren",TREE_LEVEL_PROP:"__treeLevel",PARENT_PROP:"__parentId"},y.DEFAULT_FORMATTER_NUMBER_MIN_DECIMAL=2,y.DEFAULT_FORMATTER_NUMBER_MAX_DECIMAL=2,y.DEFAULT_FORMATTER_CURRENCY_MIN_DECIMAL=2,y.DEFAULT_FORMATTER_CURRENCY_MAX_DECIMAL=4,y.DEFAULT_FORMATTER_PERCENT_MIN_DECIMAL=void 0,y.DEFAULT_FORMATTER_PERCENT_MAX_DECIMAL=void 0,y.DEFAULT_NUMBER_DECIMAL_SEPARATOR=".",y.DEFAULT_NUMBER_THOUSAND_SEPARATOR="",y.DEFAULT_NEGATIVE_NUMBER_WRAPPED_IN_BRAQUET=!1,y.SLIDER_DEFAULT_MIN_VALUE=0,y.SLIDER_DEFAULT_MAX_VALUE=100,y.SLIDER_DEFAULT_STEP=1,y.VALIDATION_REQUIRED_FIELD="Field is required",y.VALIDATION_EDITOR_VALID_NUMBER="Please enter a valid number",y.VALIDATION_EDITOR_VALID_INTEGER="Please enter a valid integer number",y.VALIDATION_EDITOR_INTEGER_BETWEEN="Please enter a valid integer number between {{minValue}} and {{maxValue}}",y.VALIDATION_EDITOR_INTEGER_MAX="Please enter a valid integer number that is lower than {{maxValue}}",y.VALIDATION_EDITOR_INTEGER_MAX_INCLUSIVE="Please enter a valid integer number that is lower than or equal to {{maxValue}}",y.VALIDATION_EDITOR_INTEGER_MIN="Please enter a valid integer number that is greater than {{minValue}}",y.VALIDATION_EDITOR_INTEGER_MIN_INCLUSIVE="Please enter a valid integer number that is greater than or equal to {{minValue}}",y.VALIDATION_EDITOR_NUMBER_BETWEEN="Please enter a valid number between {{minValue}} and {{maxValue}}",y.VALIDATION_EDITOR_NUMBER_MAX="Please enter a valid number that is lower than {{maxValue}}",y.VALIDATION_EDITOR_NUMBER_MAX_INCLUSIVE="Please enter a valid number that is lower than or equal to {{maxValue}}",y.VALIDATION_EDITOR_NUMBER_MIN="Please enter a valid number that is greater than {{minValue}}",y.VALIDATION_EDITOR_NUMBER_MIN_INCLUSIVE="Please enter a valid number that is greater than or equal to {{minValue}}",y.VALIDATION_EDITOR_DECIMAL_BETWEEN="Please enter a valid number with a maximum of {{maxDecimal}} decimals",y.VALIDATION_EDITOR_TEXT_LENGTH_BETWEEN="Please make sure your text length is between {{minLength}} and {{maxLength}} characters",y.VALIDATION_EDITOR_TEXT_MAX_LENGTH="Please make sure your text is less than {{maxLength}} characters",y.VALIDATION_EDITOR_TEXT_MAX_LENGTH_INCLUSIVE="Please make sure your text is less than or equal to {{maxLength}} characters",y.VALIDATION_EDITOR_TEXT_MIN_LENGTH="Please make sure your text is more than {{minLength}} character(s)",y.VALIDATION_EDITOR_TEXT_MIN_LENGTH_INCLUSIVE="Please make sure your text is at least {{minLength}} character(s)",function(e){e[e.camelCase=0]="camelCase",e[e.pascalCase=1]="pascalCase",e[e.snakeCase=2]="snakeCase",e[e.kebabCase=3]="kebabCase"}(C||(C={})),function(e){e.colon=":",e.comma=",",e.equalSign="=",e.pipe="|",e.semicolon=";",e.space=" ",e.tab="\t",e.doubleColon="::",e.doublePipe="||",e.doubleSemicolon=";;"}(w||(w={})),function(e){e.autoTooltip="autoTooltip",e.cellExternalCopyManager="cellExternalCopyManager",e.cellMenu="cellMenu",e.checkboxSelector="checkboxSelector",e.columnPicker="columnPicker",e.contextMenu="contextMenu",e.customTooltip="customTooltip",e.draggableGrouping="draggableGrouping",e.groupItemMetaProvider="groupItemMetaProvider",e.gridMenu="gridMenu",e.headerButton="headerButton",e.headerMenu="headerMenu",e.rowBasedEdit="rowBasedEdit",e.rowDetailView="rowDetailView",e.rowMoveManager="rowMoveManager",e.rowSelection="rowSelection"}(S||(S={}));const E={unknown:"unknown",string:"string",boolean:"boolean",integer:"integer",float:"float",number:"number",date:"date",dateIso:"dateIso",dateUtc:"dateUtc",dateTime:"dateTime",dateTimeIso:"dateTimeIso",dateTimeIsoAmPm:"dateTimeIsoAmPm",dateTimeIsoAM_PM:"dateTimeIsoAM_PM",dateTimeShortIso:"dateTimeShortIso",dateEuro:"dateEuro",dateEuroShort:"dateEuroShort",dateTimeShortEuro:"dateTimeShortEuro",dateTimeEuro:"dateTimeEuro",dateTimeEuroAmPm:"dateTimeEuroAmPm",dateTimeEuroAM_PM:"dateTimeEuroAM_PM",dateTimeEuroShort:"dateTimeEuroShort",dateTimeEuroShortAmPm:"dateTimeEuroShortAmPm",dateTimeEuroShortAM_PM:"dateTimeEuroShortAM_PM",dateUs:"dateUs",dateUsShort:"dateUsShort",dateTimeShortUs:"dateTimeShortUs",dateTimeUs:"dateTimeUs",dateTimeUsAmPm:"dateTimeUsAmPm",dateTimeUsAM_PM:"dateTimeUsAM_PM",dateTimeUsShort:"dateTimeUsShort",dateTimeUsShortAmPm:"dateTimeUsShortAmPm",dateTimeUsShortAM_PM:"dateTimeUsShortAM_PM",object:"object",password:"password",text:"text",readonly:"readonly"};var x,T,O,k,I,A,D;!function(e){e.csv="csv",e.txt="txt",e.xls="xls",e.xlsx="xlsx"}(x||(x={})),function(e){e.merge="merge",e.chain="chain"}(T||(T={})),function(e){e.columns="columns",e.filter="filter",e.pagination="pagination",e.pinning="pinning",e.rowSelection="rowSelection",e.sorter="sorter",e.treeData="treeData"}(O||(O={})),function(e){e.empty="",e.custom="Custom",e.contains="Contains",e.notContains="Not_Contains",e.lessThan="LT",e.lessThanOrEqual="LE",e.greaterThan="GT",e.greaterThanOrEqual="GE",e.notEqual="NE",e.equal="EQ",e.endsWith="EndsWith",e.rangeInclusive="RangeInclusive",e.rangeExclusive="RangeExclusive",e.startsWith="StartsWith",e.startsWithEndsWith="StartsWithEndsWith",e.in="IN",e.notIn="NOT_IN",e.inContains="IN_CONTAINS",e.notInContains="NOT_IN_CONTAINS",e.inCollection="IN_COLLECTION",e.notInCollection="NOT_IN_COLLECTION"}(k||(k={})),function(e){e.asc="asc",e.ASC="ASC",e.desc="desc",e.DESC="DESC"}(I||(I={})),function(e){e[e.asc=1]="asc",e[e.desc=-1]="desc",e[e.neutral=0]="neutral"}(A||(A={})),function(e){e.toggleCollapse="toggle-collapse",e.fullExpand="full-expand",e.fullCollapse="full-collapse",e.toggleExpand="toggle-expand"}(D||(D={}));class R extends Error{constructor(e){super(e),Object.setPrototypeOf(this,R.prototype)}}function P(e){let t=!1;return e instanceof Promise?{promise:e.then((e=>{if(t)throw new R("Cancelled Promise");return e})),cancel:()=>t=!0}:e}function L(e,t,i=""){let s=t;if(t instanceof Promise)return t;if(e.isObservable(t)&&(s=e.firstValueFrom(t)),!(s instanceof Promise))throw new Error(`Something went wrong, Slickgrid-Universal ${i} is not able to convert the Observable into a Promise.`);return s}function M(e,t,i=0){const s=B(t,"childrenPropName");Array.isArray(e)&&e.forEach((e=>{e&&(Array.isArray(e[s])&&e[s].length>0&&(i++,M(e[s],t,i),i--),e[t.levelPropName]=i)}))}function N(e,t,i=0,s=null){const n=B(t,"childrenPropName"),{aggregator:r}=t;Array.isArray(e)&&e.forEach((e=>{if(e){const o=Array.isArray(e[n]);Array.isArray(e[n])&&e[n].length>0&&(r.init(e,!0),i++,N(e[n],t,i,e),i--),s&&r.isInitialized&&"function"==typeof r.accumulate&&!e?.__filteredOut&&(r.accumulate(e,o),r.storeResult(s.__treeTotals)),e[t.levelPropName]=i}}))}function F(e,t){const i=B(t,"identifierPropName"),s=B(t,"childrenPropName"),n=B(t,"hasChildrenPropName"),r=B(t,"parentPropName"),o=B(t,"levelPropName");t?.shouldAddTreeLevelNumber&&(Array.isArray(t?.aggregators)?t.aggregators.forEach((t=>{N(e,{childrenPropName:s,levelPropName:o,aggregator:t})})):M(e,{childrenPropName:s,levelPropName:o}));const a=function(e,t,i=b,s=()=>{}){const n=e&&e.length?[{pointer:e,offset:0}]:[],r=[];let o;for(;n.length;)for(o=n.pop();o.offset<o.pointer.length;){const e=o.pointer[o.offset],a=s(e),l=t(e);r.push(i(e,o.node,a,o.nodeId)),o.offset+=1,l&&(n.push(o),o={pointer:l,offset:0,node:e,nodeId:a})}return r}(e,(e=>e[s]),((e,t)=>({[i]:e[i],[r]:void 0!==t?t[i]:null,[n]:!!e[s],...Z(e,s)})));return a}function B(e,t,i="id"){let s="";switch(t){case"childrenPropName":s=e?.childrenPropName??y.treeDataProperties.CHILDREN_PROP;break;case"collapsedPropName":s=e?.collapsedPropName??y.treeDataProperties.COLLAPSED_PROP;break;case"hasChildrenPropName":s=e?.hasChildrenPropName??y.treeDataProperties.HAS_CHILDREN_PROP;break;case"identifierPropName":s=e?.identifierPropName??i;break;case"levelPropName":s=e?.levelPropName??y.treeDataProperties.TREE_LEVEL_PROP;break;case"parentPropName":s=e?.parentPropName??y.treeDataProperties.PARENT_PROP}return s}function H(e,t){const i=B(t,"identifierPropName"),s=B(t,"childrenPropName"),n=B(t,"parentPropName"),r=B(t,"levelPropName"),o=B(t,"collapsedPropName"),a=[],l={};return(e||[]).forEach((e=>{l[e[i]]=e,delete e[s]})),Object.keys(l).forEach((e=>{const i=l[e];if(n in i&&null!==i[n]&&void 0!==i[n]&&""!==i[n]){if(i[n]in l){const e=l[i[n]];s in e||(e[s]=[]),e[s].push(i),void 0===e[o]&&(e[o]=t?.initiallyCollapsed??!1)}}else a.push(i)})),Array.isArray(t?.aggregators)?t.aggregators.forEach((e=>{N(a,{childrenPropName:s,levelPropName:r,aggregator:e},0)})):M(a,{childrenPropName:s,levelPropName:r},0),a}function z(e,t,i){if(!i)throw new Error('findRecursive requires parameter "childrenPropertyName"');const s=e.find(t),n=e.filter((e=>e?.hasOwnProperty(i)&&e[i]));if(s)return s;if(n.length){const e=[];return n.forEach((t=>{t?.hasOwnProperty(i)&&e.push(...t[i])})),z(e,t,i)}}function $(e,t,i,s=".",n=""){if(isNaN(+e))return e;const r=void 0===t?2:t,o=void 0===i?2:i;let a=String(Math.round(+e*Math.pow(10,o))/Math.pow(10,o));for(a.indexOf(".")<0&&r>0&&(a+=".");a.length-a.indexOf(".")<=r;)a+="0";const l=a.split(".");let h,c;h=n?l.length>=1?Q(l[0],n):void 0:l.length>=1?l[0]:a,l.length>1&&(c=l[1]);let d="";return void 0!==h&&void 0!==c?d=`${h}${s}${c}`:null!=h&&(d=h),d}function V(e,t,i,s,n="",r="",o=".",a=""){if(isNaN(+e))return e;const l=Math.round(1e6*parseFloat(e))/1e6;if(l<0){const e=Math.abs(l);return s?isNaN(t)&&isNaN(i)?`(${n}${Q(`${e}`,a)}${r})`:`(${n}${$(e,t,i,o,a)}${r})`:isNaN(t)&&isNaN(i)?`-${n}${Q(`${e}`,a)}${r}`:`-${n}${$(e,t,i,o,a)}${r}`}return isNaN(t)&&isNaN(i)?`${n}${Q(`${e}`,a)}${r}`:`${n}${$(e,t,i,o,a)}${r}`}function W(e,t,i){if("function"==typeof e.queryFieldNameGetterFn){const s=e.queryFieldNameGetterFn(t);i=s?.indexOf(".")>=0?U(t,s):t.hasOwnProperty(s)?t[s]:i}return i}function U(e,t){return e&&t?t.split(".").reduce(((e,t)=>e&&e[t]),e):e}function j(e){return e&&e.translationNamespace?e.translationNamespace+(e.translationNamespaceSeparator||""):""}function G(e){return e.outputType||e.type||E.string}function q(e){switch(e){case E.date:case E.dateTime:case E.dateIso:case E.dateTimeIso:case E.dateTimeShortIso:case E.dateTimeIsoAmPm:case E.dateTimeIsoAM_PM:case E.dateEuro:case E.dateEuroShort:case E.dateTimeEuro:case E.dateTimeShortEuro:case E.dateTimeEuroAmPm:case E.dateTimeEuroAM_PM:case E.dateTimeEuroShort:case E.dateTimeEuroShortAmPm:case E.dateTimeEuroShortAM_PM:case E.dateUs:case E.dateUsShort:case E.dateTimeUs:case E.dateTimeShortUs:case E.dateTimeUsAmPm:case E.dateTimeUsAM_PM:case E.dateTimeUsShort:case E.dateTimeUsShortAmPm:case E.dateTimeUsShortAM_PM:case E.dateUtc:return!0;default:return!1}}function K(e){let t;switch(e){case"<":case"LT":t=k.lessThan;break;case"<=":case"LE":t=k.lessThanOrEqual;break;case">":case"GT":t=k.greaterThan;break;case">=":case"GE":t=k.greaterThanOrEqual;break;case"!=":case"NE":t=k.notEqual;break;case"*":case"a*":case"StartsWith":t=k.startsWith;break;case"*z":case"EndsWith":t=k.endsWith;break;case"=":case"==":case"EQ":t=k.equal;break;case"IN":t=k.in;break;case"NIN":case"NOT_IN":t=k.notIn;break;case"<>":case"Not_Contains":case"NOT_CONTAINS":t=k.notContains;break;default:t=k.contains}return t}function Y(e){let t="";switch(e){case k.greaterThan:case">":t=">";break;case k.greaterThanOrEqual:case">=":t=">=";break;case k.lessThan:case"<":t="<";break;case k.lessThanOrEqual:case"<=":t="<=";break;case k.notEqual:case"<>":t="<>";break;case k.equal:case"=":case"==":case"EQ":t="=";break;case k.startsWith:case"a*":case"*":t="a*";break;case k.endsWith:case"*z":t="*z";break;default:t=e}return t}function X(e){let t;if(q(e))t=k.equal;else switch(e){case E.unknown:case E.string:case E.text:case E.password:case E.readonly:t=k.contains;break;case E.float:case E.number:default:t=k.equal}return t}function Z(e,t){return Object.keys(e).reduce(((i,s)=>(s!==t&&(i[s]=e[s]),i)),{})}function Q(e,t=","){if(null!=e){const i=`${e}`,s=i.split(".");return 2===s.length?`${s[0].replace(/\B(?=(\d{3})+(?!\d))/g,t)}.${s[1]}`:i.replace(/\B(?=(\d{3})+(?!\d))/g,t)}return e}function J(e,t,i={}){return Array.isArray(e)?e.find(t)||i:e}function ee(e){if(Array.isArray(e))for(;e.length>0;){const t=e.pop();t?.unsubscribe&&t.unsubscribe()}return e}function te(e){let t=0,i=0,s=0,n=0;const r=window.innerHeight||0,o=window.innerWidth||0,a=_e(),l=a.top,h=a.left,c=le(e);if(c){const a=c.top,d=c.left;i=a-l,s=d-h,t=r-(a-l+e.clientHeight),n=o-(d-h+e.clientWidth)}return{top:i,bottom:t,left:s,right:n}}function ie(e,t,i){const s=document.createElement(e);return t&&Object.keys(t).forEach((i=>{"innerHTML"===i&&console.warn(`[Slickgrid-Universal] For better CSP (Content Security Policy) support, do not use "innerHTML" directly in "createDomElement('${e}', { innerHTML: 'some html'})", it is better as separate assignment: "const elm = createDomElement('span'); elm.innerHTML = 'some html';"`);const n=t[i];"object"==typeof n?Object.assign(s[i],n):s[i]=t[i]})),i?.appendChild&&i.appendChild(s),s}function se(e=""){return e.split(" ").filter((e=>e))}function ne(e){"object"==typeof e&&Object.keys(e).forEach((t=>{Array.isArray(e[t])&&ne(e[t]),e[t]instanceof HTMLElement&&(e[t]=null)}))}function re(e){for(;e?.firstChild;)e.removeChild(e.firstChild);return e}function oe(e,t="innerHTML"){return e instanceof DocumentFragment?[].map.call(e.childNodes,(e=>e[t])).join("")||e.textContent||"":e instanceof HTMLElement?e[t]:String(e??"")}function ae(e,t){if(!e||!t)return;const i=e.getBoundingClientRect(),s=t.getBoundingClientRect();return{top:s.top-i.top,right:s.right-i.right,bottom:s.bottom-i.bottom,left:s.left-i.left}}function le(e){let t=0,i=0,s=0,n=0;if(!e||!e.getBoundingClientRect)return{top:t,bottom:s,left:i,right:n};const r=e.getBoundingClientRect(),o=document.documentElement;return void 0!==r?.top&&void 0!==r.left&&(t=r.top+window.pageYOffset-o.clientTop,i=r.left+window.pageXOffset-o.clientLeft,n=r.right,s=r.bottom),{top:t,left:i,bottom:s,right:n}}function he(e,t){let i=0;if(e){const s="height"===t?["top","bottom"]:["left","right"];i=e["height"===t?"clientHeight":"clientWidth"];for(const t of s)i-=parseFloat(ce(e,`padding-${t}`)||"")||0}return i}function ce(e,t){return e?window.getComputedStyle(e).getPropertyValue(t):null}function de(e,t){if(e)for(const i of t){const t=e.getAttribute(i);if(t)return t}return null}function ue(e,t="auto"){return(/^[0-9]+$/i.test(`${e}`)?+e+"px":e)||t}function pe(e){const t="string"==typeof e?e:String(e),i={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};return(t||"").toString().replace(/[&<>"']/g,(e=>i[e]))}function me(e){return e.replace(/&#(\d+);/g,((e,t)=>String.fromCharCode(t)))}function fe(e,t){const i=e.length;let s=pe(e);if(i<t)for(let e=i;e<t;e++)s+="&nbsp;";return s}function ge(e,t){e.parentNode?.insertBefore(t,e.nextSibling)}function _e(){return{left:window.pageXOffset||document.documentElement.scrollLeft||0,top:window.pageYOffset||document.documentElement.scrollTop||0}}const ve=Object.prototype.hasOwnProperty,be=Object.prototype.toString,ye=Object.defineProperty,Ce=Object.getOwnPropertyDescriptor,we=function(e){return"function"==typeof Array.isArray?Array.isArray(e):"[object Array]"===be.call(e)},Se=function(e){if(!e||"[object Object]"!==be.call(e))return!1;const t=ve.call(e,"constructor"),i=e.constructor&&e.constructor.prototype&&ve.call(e.constructor.prototype,"isPrototypeOf");if(e.constructor&&!t&&!i)return!1;let s;for(s in e);return void 0===s||ve.call(e,s)},Ee=function(e,t){ye&&"__proto__"===t.name?ye(e,t.name,{enumerable:!0,configurable:!0,value:t.newValue,writable:!0}):e[t.name]=t.newValue},xe=function(e,t){if("__proto__"===t){if(!ve.call(e,t))return;if(Ce)return Ce(e,t).value}return e[t]};function Te(...e){let t,i,s,n,r,o,a=e[0],l=1;const h=e.length;let c=!1;for("boolean"==typeof a&&(c=a,a=e[1]||{},l=2),(null==a||"object"!=typeof a&&"function"!=typeof a)&&(a={});l<h;++l)if(t=e[l],null!=t)for(i in t)s=xe(a,i),n=xe(t,i),a!==n&&(c&&n&&(Se(n)||(r=we(n)))?(r?(r=!1,o=s&&we(s)?s:[]):o=s&&Se(s)?s:{},Ee(a,{name:i,newValue:Te(c,o,n)})):void 0!==n&&Ee(a,{name:i,newValue:n}));return a}function Oe(e,t,i="id"){let s=-1;s=t&&"object"==typeof t&&i in t?e.findIndex((e=>e[i]===t[i])):e.findIndex((e=>e===t)),s<0&&e.push(t)}function ke(e,t=" "){let i="";for(let s=0;s<e;s++)i+=t;return i}function Ie(e,t){return e.filter(((e,i)=>t!==i))}function Ae(e){return Array.isArray(e)||Fe(e)?Te(!0,Array.isArray(e)?[]:{},e):e}function De(e,...t){if(!t.length)return e;const i=t.shift();return e=!Fe(e)&&Fe(i)?{}:e,Fe(e)&&Fe(i)&&Object.keys(i).forEach((t=>{i.hasOwnProperty(t)&&(t in e?"object"!=typeof e[t]||"object"!=typeof i[t]?e[t]=i[t]:e[t].concat&&i[t].concat?e[t]=e[t].concat(i[t]):e[t]=De(e[t],i[t]):e[t]=i[t])})),De(e,...t)}function Re(e){return Fe(e)&&Object.keys(e).forEach((t=>{e.hasOwnProperty(t)&&delete e[t]})),e=null,e={}}function Pe(e,t=!0){let i=!1;return{params:(e=>{const t=e.toString().replace(/(\/\/.*$)|(\/\*[\s\S]*?\*\/)|(\s*=[^,)]*(('(?:\\'|[^'\r\n])*')|("(?:\\"|[^"\r\n])*"))|(\s*=[^,)]*))/gm,"");return t.slice(t.indexOf("(")+1,t.indexOf(")")).match(/([^\s,]+)/g)??[]})(e),body:(e=>{const s=e.toString();if(i=s.includes("async "),s.replaceAll(" ","").includes("=>({")){const e=s.match(/(({.*}))/g)||[];return e.length>=1?`return ${e[0].trimStart()}`:s}const n=!s.includes("{")&&s.includes("=>"),r=s.substring(s.indexOf("{")+1||s.indexOf("=>")+2,s.includes("}")?s.lastIndexOf("}"):s.length);return t&&n&&!r.startsWith("return")?"return "+r.trimStart():r})(e),isAsync:i}}function Le(e){return null==e||0===Object.entries(e).length}function Me(e){return null!=e&&""!==e}function Ne(e){return null!==e&&!isNaN(e)&&""!==e}function Fe(e){return!(null===e||"object"!=typeof e||Array.isArray(e)||e instanceof Date)}function Be(e){return"boolean"==typeof e||"number"==typeof e||"string"==typeof e||null==e}function He(e){return e instanceof HTMLElement||e instanceof DocumentFragment||Be(e)}function ze(e,t=!1){return t?null!=e&&"string"!=typeof e&&!isNaN(e):null!=e&&""!==e&&!isNaN(+e)}function $e(e){return!e||e&&"object"==typeof e&&0===Object.keys(e).length}function Ve(e){return/(true|1)/i.test(e+"")}function We(e,t=!1){const i="function"==typeof e.normalize?e.normalize("NFD").replace(/[\u0300-\u036f]/g,""):e;return t?i.toLowerCase():i}function Ue(e,t,i){if("string"==typeof t&&(t=t.split(".")),t.length>1){const s=t.shift();e&&void 0!==s&&Ue(e[s]=Me(e[s])&&(Array.isArray(e[s])||"[object Object]"===Object.prototype.toString.call(e[s]))?e[s]:{},t,i)}else e&&t[0]&&(e[t[0]]=i)}function je(e,t=!1){return"string"==typeof e?t?e.replace(/\w\S*/g,(e=>e.charAt(0).toUpperCase()+e.substring(1).toLowerCase())):e.charAt(0).toUpperCase()+e.slice(1):e}function Ge(e){return"string"==typeof e?e.replace(/(?:^\w|[A-Z]|\b\w|[\s+\-_/])/g,((e,t)=>/[\s+\-_/]/.test(e)?"":0===t?e.toLowerCase():e.toUpperCase())):e}function qe(e){return"string"==typeof e?Ge(e).replace(/([A-Z])|([-_])/g,"-$1").toLowerCase():e}function Ke(e){if("string"==typeof e){const t=e.replace(/([A-Z])|([-_])/g," $1").replace(/\s+/g," ").trim();return t.charAt(0).toUpperCase()+t.slice(1)}return e}function Ye(e){return"string"==typeof e?Ge(e).replace(/([A-Z])/g,"_$1").toLowerCase():e}function Xe(e){return Array.isArray(e)&&e.length>0?e.filter(((t,i)=>e.indexOf(t)>=i)):e}function Ze(e,t="id"){if(Array.isArray(e)&&e.length>0){const i=[],s=new Map;for(const n of e)n&&!s.has(n[t])&&(s.set(n[t],!0),i.push({id:n[t],name:n.name}));return i}return e}const Qe=Symbol("plaintext"),Je=Symbol("html"),et=Symbol("comment"),tt=/<(\w*)>/g,it=/<\/?([^\s/>]+)/;function st(e,t,i){function s(e){let t=new Set;if("string"==typeof e){let i;for(;i=tt.exec(e);)t.add(i[1])}else"function"==typeof e[Symbol.iterator]&&(t=new Set(e));return t}function n(e){const t=it.exec(e);return t?t[1].toLowerCase():null}return function(e,t,i){if("string"!=typeof e&&(ze(e)||"boolean"==typeof e))return String(e);if(e instanceof HTMLElement&&(e=e.innerHTML),"string"!=typeof e&&null!=e)throw new TypeError("'html' parameter must be a string");return function(e,t){const i=t.allowable_tags,s=t.tag_replacement;let r=t.state,o=t.tag_buffer,a=t.depth,l=t.in_quote_char,h="";for(let t=0,c=e.length;t<c;t++){const c=e[t];if(r===Qe)"<"===c?(r=Je,o+=c):h+=c;else if(r===Je)switch(c){case"<":if(l)break;a++;break;case">":if(l)break;if(a){a--;break}l="",r=Qe,o+=">",i.has(n(o))?h+=o:h+=s,o="";break;case'"':case"'":l=c===l?"":l||c,o+=c;break;case"-":"<!-"===o&&(r=et),o+=c;break;case" ":case"\n":if("<"===o){r=Qe,h+="< ",o="";break}o+=c;break;default:o+=c}else r===et&&(">"===c?("--"===o.slice(-2)&&(r=Qe),o=""):o+=c)}return t.state=r,t.tag_buffer=o,t.depth=a,t.in_quote_char=l,h}(e||"",function(e,t){return{allowable_tags:s(e),tag_replacement:t,state:Qe,tag_buffer:"",depth:0,in_quote_char:""}}(t||"",i||""))}(e,t,i)}var nt=/^([0-9]{4})-([0-1][0-9])(?:-([0-3][0-9]))?(?:[T ]?([0-2][0-9])(?::([0-5][0-9]))?(?::([0-5][0-9]))?)?(?:\.[0-9]+)?(Z|(?:\+|\-)[0-9]{2}:?[0-9]{2})?$/;function rt(e){if(e||(e=new Date),e instanceof Date){const t=new Date(e);return t.setMilliseconds(0),t}if(function(e){const t=e.match(nt);if(t){const e=Number(t[2]);if(e<1||e>12)return!1;if(void 0!==typeof t[3]){const e=Number(t[3]);if(e<1||e>31)return!1}if(void 0!==typeof t[4]){const e=Number(t[4]);if(e<0||e>23)return!1}return!0}return!1}(e=e.trim()))return new Date(function(e){const t=e.match(nt);return t&&void 0===t[4]?e+"T00:00:00":e}(e));throw new Error(`Non ISO 8601 compliant date (${e}).`)}var ot="1999-03-04T02:05:01.000Z",at=new Map,lt=[["YYYY",{year:"numeric"}],["YY",{year:"2-digit"}],["MMMM",{month:"long"}],["MMM",{month:"short"}],["MM",{month:"2-digit"}],["M",{month:"numeric"}],["DD",{day:"2-digit"}],["D",{day:"numeric"}],["dddd",{weekday:"long"}],["ddd",{weekday:"short"}],["d",{weekday:"narrow"}],["mm",{minute:"2-digit"}],["m",{minute:"numeric"}],["ss",{second:"2-digit"}],["s",{second:"numeric"}],["ZZ",{timeZoneName:"long"}],["Z",{timeZoneName:"short"}]],ht=[["HH",{hour:"2-digit"}],["H",{hour:"numeric"}]],ct=[["hh",{hour:"2-digit"}],["h",{hour:"numeric"}],["a",{dayPeriod:"narrow"}],["A",{dayPeriod:"narrow"}]],dt={DD:2,HH:2,MM:2,YY:2,YYYY:4,hh:2,mm:2,ss:2};function ut(e){if(/^[+-]\d{2}:\d{2}/.test(e))return 6;if(/^[+-]\d{4}/.test(e))return 5;throw new Error("Invalid offset format")}var pt=["MMMM","MMM","dddd","ddd"],mt=new Map([...lt,...ht,...ct].map((e=>[e[0],e]))),ft=new Map,gt=["full","long","medium","short"],_t=e=>String(e).padStart(2,"0"),vt=e=>String(e).padStart(2,"0");function bt(e){return"literal"===e.type&&(e.value=e.value.normalize("NFKC")),e}function yt(e,t="Z"){const i=String(Math.floor(Math.abs(e/60))).padStart(2,"0"),s=String(Math.abs(e%60)).padStart(2,"0"),n=e<0?"-":"+";return"ZZ"===t?`${n}${i}${s}`:`${n}${i}:${s}`}function Ct(e,t="Z"){if(!(t=>{switch(t){case"Z":return/^([+-])[0-3][0-9]:[0-6][0-9]$/.test(e);case"ZZ":return/^([+-])[0-3][0-9][0-6][0-9]$/.test(e)}})(t))throw new Error(`Invalid offset: ${e}`);return e}function wt(e){return["numeric","2-digit"].includes(e.partValue)}function St(e,t){const i=ft.get(t);if(i&&i[e])return i[e];const s=new Date(ot);s.setUTCHours("am"===e?5:20);const n=new Intl.DateTimeFormat(t,{timeStyle:"full",timeZone:"UTC",hour12:!0}).formatToParts(s).map(bt).find((e=>"dayPeriod"===e.type));if(n){const s=i||{};return ft.set(t,Object.assign(s,{[e]:n.value})),n.value}return e}function Et(){return Intl.DateTimeFormat().resolvedOptions().timeZone}function xt(e,t){const i=new Intl.DateTimeFormat("en-US",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",timeZone:t,hourCycle:"h23"}).formatToParts(e).map(bt),s={};return i.forEach((e=>{s[e.type]=e.value})),new Date(`${s.year}-${s.month}-${s.day}T${s.hour}:${s.minute}:${s.second}Z`)}function Tt(e,t="UTC",i="device",s="Z"){var n;i="device"===i?null!=(n=Et())?n:"utc":i;const r=rt(e),o=xt(r,t),a=xt(r,i);return yt(Math.round((a.getTime()-o.getTime())/1e3/60),s)}function Ot(e){const t=rt(e);return t.setHours(0,0,0),t}function kt(e,t){if(gt.includes(e)||"object"==typeof e)return function(e,t){const i={timeZone:"UTC"};"string"==typeof e?i.dateStyle=e:("date"in e&&(i.dateStyle=e.date),"time"in e&&(i.timeStyle=e.time));const s=new Intl.DateTimeFormat(t,i),n=s.formatToParts(new Date(ot)).map(bt),r=s.formatToParts(new Date("1999-04-05T23:05:01.000Z")).map(bt).find((e=>"hour"===e.type)),o=r&&"23"===r.value?24:12;return n.map((e=>{const s=e.type,n=function(e,t,i,s,n){const r=t.length,o=!isNaN(Number(t));let a;switch(e){case"year":return 2===r?mt.get("YY"):mt.get("YYYY");case"month":return o?1===r?mt.get("M"):mt.get("MM"):(a=It(i,e,t),"long"===a?mt.get("MMMM"):mt.get("MMM"));case"day":return 1===r?mt.get("D"):mt.get("DD");case"weekday":switch(a=It(i,e,t),a){case"narrow":return mt.get("d");case"short":return mt.get("ddd");default:return mt.get("dddd")}case"hour":return 12===s?1===r?mt.get("h"):mt.get("hh"):1===r?mt.get("H"):mt.get("HH");case"minute":return 1===r?mt.get("m"):mt.get("mm");case"second":return 1===r?mt.get("s"):mt.get("ss");case"dayPeriod":return/^[A-Z]+$/u.test(t)?mt.get("A"):mt.get("a");case"literal":return[t,{literal:t},new RegExp("")];case"timeZoneName":return"full"===n.timeStyle?mt.get("Z"):mt.get("ZZ");default:return}}(e.type,e.value,t,"hour"===e.type?o:void 0,i);if(void 0===n)return;const r=n[1][s];return r?(n[2]||(n[2]=new RegExp(`${n[0]}`,"g")),{option:{[s]:r},partName:s,partValue:r,token:n[0],pattern:n[2],hour12:12===o}):void 0})).filter((e=>!!e))}(e,t);let i=e,s=0;const n=e=>{if(e[2]||(e[2]=new RegExp(`(.)?(${e[0]})`,"g")),e[2].test(i)){let t=0;return i=i.replace(e[2],((e,i,n)=>"\\"===i?n:`${"string"==typeof i?i:""}{!${t++?s:s++}!}`)),!!t}return!1};function r(e,[t,i,s]){const n=Object.keys(i)[0];return{option:i,partName:n,partValue:i[n],token:t,pattern:s,hour12:e}}const o=function(e){const t=e.map((e=>e.partName)),i=new Set(t);if(t.length>i.size)throw new Error("Cannot reuse format tokens.");return e}(lt.filter(n).concat(ht.filter(n)).map(r.bind(null,!1)).concat(ct.filter(n).map(r.bind(null,!0)))),a=/^\{!(\d+)!\}$/;return i.split(/(\{!\d+!\})/).map((e=>{const t=e.match(a);return t?o[Number(t[1])]:{option:{literal:e},partName:"literal",partValue:e,token:e,pattern:new RegExp(""),hour12:!1}})).filter((e=>!("literal"===e.partName&&""===e.partValue)))}function It(e,t,i){if(!at.has(e)){const t=new Date(ot),i=[3,8,9,7,6,4,3],s=["weekday","month","dayPeriod"],n=["long","short","narrow"],r={};for(let o=0;o<12;o++){t.setMonth(0+o),o in i&&t.setDate(i[o]),t.setUTCHours(8+o);for(const i of n){const n=new Intl.DateTimeFormat(e,s.reduce(((e,t)=>Object.assign(e,{[t]:i})),{hour12:!0,timeZone:"UTC"})).formatToParts(t).map(bt);if("long"===i||"short"===i){const s=new Intl.DateTimeFormat(e,{dateStyle:"short"===i?"medium":"long",timeZone:"UTC"}).formatToParts(t).map(bt).find((e=>"month"===e.type)),r=n.findIndex((e=>"month"===e.type));r>-1&&s&&(n[r]=s)}n.forEach((e=>{if("literal"===e.type)return;const t=e.type;r[t]=Object.assign(r[t]||{},{[e.value]:i})}))}}at.set(e,r)}const s=at.get(e);return s?s[t][i]:void 0}function At(e,t="+00:00"){const i="+"===t.slice(0,1);return function(e,t="+00:00"){const i=rt(e),s=(()=>{switch(ut(t)){case 5:return"ZZ";case 6:return"Z"}})(),n=function(e,t){Ct(e,t);const[i,s,n,r]=e.match(/([+-])([0-3][0-9]):?([0-6][0-9])/),o=60*Number(n)+Number(r);return"+"===s?o:-o}(t,s);return new Date(i.getTime()+1e3*n*60)}(e,t.replace(i?"+":"-",i?"-":"+"))}function Dt(e,t="long",i="device",s=!1,n){let r,o;return"object"!=typeof e||e instanceof Date||({date:e,format:t,locale:i,genitive:s,partFilter:n,tz:r}=e),"ISO8601"===t?rt(e).toISOString():(r&&(o=Tt(e,"utc",r,function(e){return"string"==typeof e?e.includes("ZZ")?"ZZ":"Z":"time"in e&&"full"===e.time?"Z":"ZZ"}(t))),null!=r||(r=Et()),"utc"!==(null==r?void 0:r.toLowerCase())&&(e=At(e,Tt(e,r,"utc"))),i&&"device"!==i||(i=Intl.DateTimeFormat().resolvedOptions().locale),function(e,t,i,s=!1,n=null){const r=function(e,t,i,s=!1){const n=rt(e),r=t.filter((e=>e.hour12)),o=t.filter((e=>!e.hour12)),a=[],l=[];function h(e,t=!1){const r=`${i}-u-hc-${t?"h12":"h23"}`;if(a.push(...new Intl.DateTimeFormat(r,e.reduce(((e,t)=>"literal"===t.partName?e:(s&&pt.includes(t.token)&&l.push(t),Object.assign(e,t.option))),{timeZone:"UTC"})).formatToParts(n).map(bt)),s&&l.length)for(const e of l){let t=[];switch(e.token){case"MMMM":t=new Intl.DateTimeFormat(r,{dateStyle:"long",timeZone:"UTC"}).formatToParts(n).map(bt);break;case"MMM":t=new Intl.DateTimeFormat(r,{dateStyle:"medium",timeZone:"UTC"}).formatToParts(n).map(bt)}const i=t.find((t=>t.type===e.partName)),s=a.findIndex((t=>t.type===e.partName));i&&s>-1&&(a[s]=i)}}return r.length&&h(r,!0),o.length&&h(o),a.reduce(((e,t)=>(e[t.type]=t.value,e)),{})}(e,t,i,s),o=rt(e);function a({partName:e,partValue:t,token:s}){if("literal"===e)return t;const a=r[e];if("hour"===e&&"H"===s)return a.replace(/^0/,"")||"0";if(["mm","ss","MM"].includes(s)&&1===a.length)return`0${a}`;if("dayPeriod"===e){const e=St(o.getUTCHours()<12?"am":"pm",i);return"A"===s?e.toUpperCase():e.toLowerCase()}return"timeZoneName"===e?null!=n?n:yt(-1*o.getTimezoneOffset(),s):a}return t.map((e=>({...e,value:a(e)})))}(e,kt(t,i).filter(null!=n?n:()=>!0),i,s,o).map((e=>e.value)).join(""))}function Rt(e,t="en",i=!1){const s=(e,t)=>Array(e).fill("").map(((e,i)=>`${t(i)}`));if("M"===e)return s(12,(e=>e+1));if("MM"===e)return s(12,(e=>{const t=e+1;return t<10?`0${t}`:t}));if(e.startsWith("M"))return Rt("MM").map((s=>Dt(`2000-${s}-05`,e,t,i)));if(e.startsWith("d"))return s(7,(e=>`0${e+2}`)).map((i=>Dt(`2022-10-${i}`,e,t)));if("a"===e)return[St("am",t).toLowerCase(),St("pm",t).toLowerCase()];if("A"===e)return[St("am",t).toUpperCase(),St("pm",t).toUpperCase()];if(e.startsWith("Y")){const i=(new Date).getFullYear();return s(120,(e=>e+1)).reduce(((s,n)=>("120"!==n&&s.push(Dt(`${i+Number(n)}-06-06`,e,t)),s.unshift(Dt(i-Number(n)+"-06-06",e,t)),s)),[Dt(`${i}-06-06`,e,t)])}return e.startsWith("D")?s(31,(t=>`${"DD"===e&&t<9?"0":""}${t+1}`)):e.startsWith("H")?s(24,(t=>`${"HH"===e&&t<10?"0":""}${t}`)):e.startsWith("h")?s(12,(t=>`${"hh"===e&&t<9?"0":""}${t+1}`)):e.startsWith("m")||e.startsWith("s")?s(60,(t=>`${e.length>1&&t<10?"0":""}${t}`)):[]}function Pt(e,t="ISO8601",i="device"){let s,n=()=>!0,r="backward";if("object"==typeof e?({date:s,format:t="ISO8601",locale:i="device",dateOverflow:r="backward",partFilter:n=()=>!0}=e):s=e,!s)throw new Error("parse() requires a date string.");const o=()=>{throw new Error(`Date (${s}) does not match format (${function(e,t="en",i=!1,s=()=>!0){return kt(e,t).filter(s).reduce(((e,t)=>{return e+(i&&"literal"===t.partName?(s=t.token,lt.concat(ht).concat(ct).sort(((e,t)=>e[0].length>t[0].length?1:-1)).reduce(((e,t)=>e.replace(t[0],`\\${t[0]}`)),s)):t.token);var s}),"").normalize("NFKC")}(t,i)})`)};if("ISO8601"===t)return rt(s);const a=gt.includes(t)||"object"==typeof t,l=function(e){let t;for(const i of e){if("literal"===i.partName&&!isNaN(parseFloat(i.partValue)))throw new Error(`Numbers in format (${i.partValue}).`);if(t&&"literal"!==t.partName&&"literal"!==i.partName&&!(t.token in dt||i.token in dt||wt(t)&&"a"===i.token.toLowerCase()))throw new Error(`Illegal adjacent tokens (${t.token}, ${i.token})`);t=i}return e}(kt(t,i).filter(n));if(!l.length)throw new Error("parse() requires a pattern.");let h;try{h=function(e,t){let i=0;let s=0;const n=[];let r;do{const[a,l]=[(o=t)[i++],o[i]];r=l;let h=1;if("literal"===a.partName)h=a.partValue.length;else if("timeZoneName"===a.partName)h=ut(e.substring(s));else if(a.token in dt)h=dt[a.token];else if(l)if("literal"===l.partName){if(h=e.indexOf(l.partValue,s)-s,h<0)throw new Error}else if("dayPeriod"===l.partName){for(let t=1;t<=4;t++)if(isNaN(Number(e.charAt(s+t)))){h=t;break}}else{const t=e.substring(s).search(/\d/);-1!==t&&(h=s+t)}else h=e.length;n.push({...a,value:e.substring(s,s+h)}),s+=h}while(r);var o;return n}(s,l)}catch{return o()}const c=new Date,d=new Map([["YYYY",c.getFullYear()],["MM",c.getMonth()+1],["DD",c.getDate()],["HH",0],["mm",0],["ss",0]]);let u=null,p="";h.forEach((e=>{if("literal"===e.partName)return;if(e.token===e.value)return o();const t=Number(e.value);if(d.has(e.token))d.set(e.token,t);else if("YY"===e.token)d.set("YYYY",function(e){const t=(new Date).getFullYear(),i=t%100,s=Math.floor(t/100),n=Number(e);return 100*(s+(n>i+20?-1:0))+n}(e.value));else{const s=e.token;if(s.startsWith("d"))return;if("D"===s)d.set("DD",t);else if("H"===s||s.startsWith("h"))d.set("HH",t);else if("M"===s)d.set("MM",t);else if("a"===s||"A"===s)u=e.value.toLowerCase()===St("am",i).toLowerCase();else if("Z"===s||"ZZ"===s)p=Ct(e.value,s);else{const t=Rt(s,i,a).indexOf(e.value);if(-1!==t)switch(s){case"MMM":case"MMMM":d.set("MM",t+1)}}}}));let m=d.get("HH")||0;!1===u?(m+=12===m?0:12,d.set("HH",24===m?0:m)):!0===u&&12===m&&d.set("HH",0),d.set("MM",(d.get("MM")||1)-1);let[f,g,_,v,b,y]=Array.from(d.values());const C=function(e){const t=function(e){const t=rt(e);return t.setDate(1),t.setMonth(t.getMonth()+1),t.setDate(0),t}(e);return t.getDate()}(new Date(`${vt(f)}-${_t(g+1)}-10`));if(C<_&&"throw"===r)throw new Error(`Invalid date ${vt(f)}-${_t(g+1)}-${_t(_)}`);_="backward"===r?Math.min(_,C):_;const w=`${vt(f)}-${_t(g+1)}-${_t(_)}T${_t(v)}:${_t(b)}:${_t(y)}${p}`,S=new Date(w);return isFinite(+S)?S:o()}function Lt(e,t){let i;const s=t?.withZeroPadding??!1;switch(e){case E.dateTime:case E.dateTimeIso:i="YYYY-MM-DD HH:mm:ss";break;case E.dateTimeIsoAmPm:i="YYYY-MM-DD hh:mm:ss a";break;case E.dateTimeIsoAM_PM:i="YYYY-MM-DD hh:mm:ss A";break;case E.dateTimeShortIso:i="YYYY-MM-DD HH:mm";break;case E.dateEuro:i="DD/MM/YYYY";break;case E.dateEuroShort:i=s?"DD/MM/YY":"D/M/YY";break;case E.dateTimeEuro:i="DD/MM/YYYY HH:mm:ss";break;case E.dateTimeShortEuro:i=s?"DD/MM/YYYY HH:mm":"D/M/YYYY H:m";break;case E.dateTimeEuroAmPm:i="DD/MM/YYYY hh:mm:ss a";break;case E.dateTimeEuroAM_PM:i="DD/MM/YYYY hh:mm:ss A";break;case E.dateTimeEuroShort:i=s?"DD/MM/YY HH:mm:ss":"D/M/YY H:m:s";break;case E.dateTimeEuroShortAmPm:i=s?"DD/MM/YY hh:mm:ss a":"D/M/YY h:m:s a";break;case E.dateTimeEuroShortAM_PM:i=s?"DD/MM/YY hh:mm:ss A":"D/M/YY h:m:s A";break;case E.dateUs:i="MM/DD/YYYY";break;case E.dateUsShort:i=s?"MM/DD/YY":"M/D/YY";break;case E.dateTimeUs:i="MM/DD/YYYY HH:mm:ss";break;case E.dateTimeUsAmPm:i="MM/DD/YYYY hh:mm:ss a";break;case E.dateTimeUsAM_PM:i="MM/DD/YYYY hh:mm:ss A";break;case E.dateTimeUsShort:i=s?"MM/DD/YY HH:mm:ss":"M/D/YY H:m:s";break;case E.dateTimeUsShortAmPm:i=s?"MM/DD/YY hh:mm:ss a":"M/D/YY h:m:s a";break;case E.dateTimeUsShortAM_PM:i=s?"MM/DD/YY hh:mm:ss A":"M/D/YY h:m:s A";break;case E.dateTimeShortUs:i=s?"MM/DD/YYYY HH:mm":"M/D/YYYY H:m";break;case E.dateUtc:i="ISO8601";break;case E.date:case E.dateIso:default:i=t?.withDefaultIso8601?"ISO8601":"YYYY-MM-DD"}return i}function Mt(e,t,i){const s=t?Lt(t):void 0,n=Lt(i),r=e instanceof Date?e:Nt(e,s);return r&&void 0!==e?i===E.dateUtc?r.toISOString():Dt(r,n,"en-US"):""}function Nt(e,t,i=!1){try{return!!e&&(e instanceof Date?e:Pt({date:e,format:t,dateOverflow:i?"throw":"backward",locale:"en-US"}))}catch(e){return!1}}function Ft(e){const t=e===E.date?void 0:Lt(e);return(e,i,s)=>function(e,t,i,s,n){let r=0;if(e===t)r=0;else{let i=Nt(e,s,n),o=Nt(t,s,n);i||(i=new Date(1001,1,1)),o||(o=new Date(1001,1,1)),r=i.valueOf()-o.valueOf()}return i*r}(e,i,s,t,void 0!==t)}const Bt={boolean:(e,t,i=A.neutral)=>{let s=0;return s=e===t?0:null===e?-1:null===t?1:i?e<t?-1:1:e<t?1:-1,i*s},date:Ft(E.date),dateIso:Ft(E.dateIso),dateUtc:Ft(E.dateUtc),dateTime:Ft(E.dateTime),dateTimeIso:Ft(E.dateTimeIso),dateTimeIsoAmPm:Ft(E.dateTimeIsoAmPm),dateTimeIsoAM_PM:Ft(E.dateTimeIsoAM_PM),dateTimeShortIso:Ft(E.dateTimeShortIso),dateEuro:Ft(E.dateEuro),dateEuroShort:Ft(E.dateEuroShort),dateTimeShortEuro:Ft(E.dateTimeShortEuro),dateTimeEuro:Ft(E.dateTimeEuro),dateTimeEuroAmPm:Ft(E.dateTimeEuroAmPm),dateTimeEuroAM_PM:Ft(E.dateTimeEuroAM_PM),dateTimeEuroShort:Ft(E.dateTimeEuroShort),dateTimeEuroShortAmPm:Ft(E.dateTimeEuroShortAmPm),dateTimeEuroShortAM_PM:Ft(E.dateTimeEuroShortAM_PM),dateUs:Ft(E.dateUs),dateUsShort:Ft(E.dateUsShort),dateTimeShortUs:Ft(E.dateTimeShortUs),dateTimeUs:Ft(E.dateTimeUs),dateTimeUsAmPm:Ft(E.dateTimeUsAmPm),dateTimeUsAM_PM:Ft(E.dateTimeUsAM_PM),dateTimeUsShort:Ft(E.dateTimeUsShort),dateTimeUsShortAmPm:Ft(E.dateTimeUsShortAmPm),dateTimeUsShortAM_PM:Ft(E.dateTimeUsShortAM_PM),numeric:(e,t,i=A.neutral,s,n)=>{const r=s?.valueCouldBeUndefined??n?.cellValueCouldBeUndefined??!1,o=isNaN(e)||""===e||null===e||r&&void 0===e?-1/0:parseFloat(e),a=isNaN(t)||""===t||null===t||r&&void 0===t?-1/0:parseFloat(t);return i*(o===a?0:o>a?1:-1)},objectString:(e,t,i=A.neutral,s,n)=>{if(!s||!s.dataKey)throw new Error('Sorting a "FieldType.object" requires you to provide the "dataKey" (object property name) of the object so that we can use it to sort correctly');const r=e?.hasOwnProperty(s.dataKey)?e[s.dataKey]:e,o=t?.hasOwnProperty(s.dataKey)?t[s.dataKey]:t,a=s?.valueCouldBeUndefined??n?.cellValueCouldBeUndefined??!1;let l=0;return l="object"!=typeof e?-1/0:"object"!=typeof t?1/0:null===r||a&&void 0===r?-1:null===o||a&&void 0===o?1:r===o?0:i?r<o?-1:1:r<o?1:-1,i*l},string:(e,t,i=A.neutral,s,n)=>{let r=0;const o=s?.valueCouldBeUndefined??n?.cellValueCouldBeUndefined??!1;return e===t?r=0:null===e||o&&void 0===e?r=-1:null===t||o&&void 0===t?r=1:(n?.ignoreAccentOnStringFilterAndSort&&(e=We(e,!1),t=We(t,!1)),r=i?e<t?-1:1:e<t?1:-1),i*r}};function Ht(e,t,i,s,n,r){let o=0;if(q(e))o=Ft(e).call(this,t,i,s,n,r);else switch(e){case E.boolean:o=Bt.boolean(t,i,s,n,r);break;case E.float:case E.integer:case E.number:o=Bt.numeric(t,i,s,n,r);break;case E.object:o=Bt.objectString(t,i,s,n,r);break;case E.string:case E.text:case E.password:case E.readonly:default:o=Bt.string(t,i,s,n,r)}return o}var zt;!function(e){e.camelCase="camelCase",e.kebabCase="kebabCase",e.lowerCase="lowerCase",e.lowerCaseWithoutOnPrefix="lowerCaseWithoutOnPrefix"}(zt||(zt={}));class $t{get elementSource(){return this._elementSource}set elementSource(e){this._elementSource=e}get subscribedEvents(){return this._subscribedEvents}get subscribedEventNames(){return this._subscribedEvents.map((e=>e.name))}constructor(e){this._subscribedEvents=[],this.eventNamingStyle=zt.camelCase,this._elementSource=e||document.createElement("div")}dispose(){this.unsubscribeAll(),this._subscribedEvents=[],window.clearTimeout(this._timer),this._elementSource?.remove(),this._elementSource=null}dispatchCustomEvent(e,t,i=!0,s=!0,n){const r={bubbles:i,cancelable:s};t&&(r.detail=t);const o=new CustomEvent(e,r);return"function"==typeof n&&n(o),this._elementSource?.dispatchEvent(o)}getEventNameByNamingConvention(e,t){let i="";switch(this.eventNamingStyle){case zt.camelCase:i=""!==t?`${t}${je(e)}`:e;break;case zt.kebabCase:i=""!==t?`${t}-${qe(e)}`:qe(e);break;case zt.lowerCase:i=`${t}${e}`.toLowerCase();break;case zt.lowerCaseWithoutOnPrefix:i=`${t}${e.replace(/^on/,"")}`.toLowerCase()}return i}publish(e,t,i,s){const n=this.getEventNameByNamingConvention(e,"");return i?new Promise((e=>{window.clearTimeout(this._timer),this._timer=window.setTimeout((()=>e(this.dispatchCustomEvent(n,t,!0,!0,s))),i)})):this.dispatchCustomEvent(n,t,!0,!0,s)}subscribe(e,t){e=Array.isArray(e)?e:[e];const i=[];return e.forEach((e=>{const s=this.getEventNameByNamingConvention(e,"");this._elementSource.addEventListener(s,(e=>t.call(null,e.detail))),this._subscribedEvents.push({name:s,listener:t}),i.push((()=>this.unsubscribe(s,t)))})),{unsubscribe:()=>i.forEach((e=>e()))}}subscribeEvent(e,t){const i=this.getEventNameByNamingConvention(e,"");return this._elementSource.addEventListener(i,t),this._subscribedEvents.push({name:i,listener:t}),{unsubscribe:()=>this.unsubscribe(i,t)}}unsubscribe(e,t,i=!0){const s=this.getEventNameByNamingConvention(e,"");this._elementSource.removeEventListener(s,t),i&&this.removeSubscribedEventWhenFound(e,t)}unsubscribeAll(e){if(Array.isArray(e)){let t;do{t=e.pop(),t?.dispose?t.dispose():t?.unsubscribe&&t.unsubscribe()}while(t)}else{let e=this._subscribedEvents.pop();for(;e;)this.unsubscribe(e.name,e.listener,!1),e=this._subscribedEvents.pop()}}removeSubscribedEventWhenFound(e,t){const i=this._subscribedEvents.findIndex((i=>i.name===e&&i.listener===t));i>=0&&this._subscribedEvents.splice(i,1)}}const Vt=function(e){var t=document,i=e.container||t.createElement("div"),s=e.preventSubmit||0;i.id=i.id||"autocomplete-"+v();var n,r,o=i.style,a=e.debounceWaitMs||0,l=e.disableAutoSelect||!1,h=i.parentElement,c=[],d="",u=2,p=e.showOnFocus,m=0,f=!1,g=!1;if(void 0!==e.minLength&&(u=e.minLength),!e.input)throw new Error("input undefined");var _=e.input;function v(){return Date.now().toString(36)+Math.random().toString(36).substring(2)}function b(){var e=i.parentNode;e&&e.removeChild(i)}function y(){r&&window.clearTimeout(r)}function C(){return!!i.parentNode}function w(){m++,c=[],d="",n=void 0,_.setAttribute("aria-activedescendant",""),_.setAttribute("aria-expanded","false"),b()}function S(){i.textContent="",_.setAttribute("aria-activedescendant","");var s=function(e,i,s){var n=t.createElement("div");return n.textContent=e.label||"",n};e.render&&(s=e.render);var r=function(e,i){var s=t.createElement("div");return s.textContent=e,s};e.renderGroup&&(r=e.renderGroup);var a=t.createDocumentFragment(),l=v();if(c.forEach((function(t,o){if(t.group&&t.group!==l){l=t.group;var h=r(t.group,d);h&&(h.className+=" group",a.appendChild(h))}var c=s(t,d,o);c&&(c.id=i.id+"_"+o,c.setAttribute("role","option"),c.addEventListener("click",(function(i){g=!0;try{e.onSelect(t,_)}finally{g=!1}w(),i.preventDefault(),i.stopPropagation()})),t===n&&(c.className+=" selected",c.setAttribute("aria-selected","true"),_.setAttribute("aria-activedescendant",c.id)),a.appendChild(c))})),i.appendChild(a),c.length<1){if(!e.emptyMsg)return void w();var u=t.createElement("div");u.id=i.id+"_"+v(),u.className="empty",u.textContent=e.emptyMsg,i.appendChild(u),_.setAttribute("aria-activedescendant",u.id)}i.parentNode||(h||t.body).appendChild(i),function(){if(C()){_.setAttribute("aria-expanded","true"),o.height="auto",o.width=_.offsetWidth+"px";var s,n=0;r(),r(),e.customize&&s&&e.customize(_,s,i,n)}function r(){var e=t.documentElement,i=e.clientTop||t.body.clientTop||0,r=e.clientLeft||t.body.clientLeft||0,a=window.pageYOffset||e.scrollTop,l=window.pageXOffset||e.scrollLeft,h=(s=_.getBoundingClientRect()).top+_.offsetHeight+a-i,c=s.left+l-r;o.top=h+"px",o.left=c+"px",(n=window.innerHeight-(s.top+_.offsetHeight))<0&&(n=0),o.top=h+"px",o.bottom="",o.left=c+"px",o.maxHeight=n+"px"}}(),k()}function E(){C()&&S()}function x(){E()}function T(e){e.target!==i?E():e.preventDefault()}function O(){g||R(0)}function k(){var e=i.getElementsByClassName("selected");if(e.length>0){var t=e[0],s=t.previousElementSibling;if(s&&-1!==s.className.indexOf("group")&&!s.previousElementSibling&&(t=s),t.offsetTop<i.scrollTop)i.scrollTop=t.offsetTop;else{var n=t.offsetTop+t.offsetHeight,r=i.scrollTop+i.offsetHeight;n>r&&(i.scrollTop+=n-r)}}}function I(e){c.length>0&&(function(e){var s=t.getElementById(i.id+"_"+e);s&&(s.classList.remove("selected"),s.removeAttribute("aria-selected"),_.removeAttribute("aria-activedescendant"))}(e),function(e){var s=t.getElementById(i.id+"_"+e);s&&(s.classList.add("selected"),s.setAttribute("aria-selected","true"),_.setAttribute("aria-activedescendant",s.id))}(c.indexOf(n)),k())}function A(t){var i=t.key;switch(i){case"ArrowUp":case"ArrowDown":case"Escape":!function(e,t){var i=C();if("Escape"===t)w();else{if(!i||c.length<1)return;"ArrowUp"===t?function(){var e=c.indexOf(n);n=-1===e?void 0:c[(e+c.length-1)%c.length],I(e)}():function(){var e=c.indexOf(n);n=c.length<1?void 0:-1===e?c[0]:c[(e+1)%c.length],I(e)}()}e.preventDefault(),i&&e.stopPropagation()}(t,i);break;case"Enter":!function(t){if(n){2===s&&t.preventDefault(),g=!0;try{e.onSelect(n,_)}finally{g=!1}w()}1===s&&t.preventDefault()}(t)}}function D(){p&&R(1)}function R(e){_.value.length>=u||1===e?(y(),r=window.setTimeout((function(){return P(_.value,e,_.selectionStart||0)}),0===e||2===e?a:0)):w()}function P(t,i,s){if(!f){var r=++m;e.fetch(t,(function(e){m===r&&e&&(d=t,n=(c=e).length<1||l?void 0:c[0],S())}),i,s)}}function L(t){e.keyup?e.keyup({event:t,fetch:function(){return R(0)}}):C()||"ArrowDown"!==t.key||R(0)}function M(t){e.click&&e.click({event:t,fetch:function(){return R(2)}})}function N(){setTimeout((function(){t.activeElement!==_&&w()}),200)}return i.className=[i.className,"autocomplete",e.className||""].join(" ").trim(),i.setAttribute("role","listbox"),_.setAttribute("role","combobox"),_.setAttribute("aria-expanded","false"),_.setAttribute("aria-autocomplete","list"),_.setAttribute("aria-controls",i.id),_.setAttribute("aria-owns",i.id),_.setAttribute("aria-activedescendant",""),_.setAttribute("aria-haspopup","listbox"),o.position="absolute",i.addEventListener("mousedown",(function(e){e.stopPropagation(),e.preventDefault()})),i.addEventListener("focus",(function(){return _.focus()})),b(),_.addEventListener("keyup",L),_.addEventListener("click",M),_.addEventListener("keydown",A),_.addEventListener("input",O),_.addEventListener("blur",N),_.addEventListener("focus",D),window.addEventListener("resize",x),t.addEventListener("scroll",T,!0),{destroy:function(){_.removeEventListener("focus",D),_.removeEventListener("keyup",L),_.removeEventListener("click",M),_.removeEventListener("keydown",A),_.removeEventListener("input",O),_.removeEventListener("blur",N),window.removeEventListener("resize",x),t.removeEventListener("scroll",T,!0),_.removeAttribute("role"),_.removeAttribute("aria-expanded"),_.removeAttribute("aria-autocomplete"),_.removeAttribute("aria-controls"),_.removeAttribute("aria-activedescendant"),_.removeAttribute("aria-owns"),_.removeAttribute("aria-haspopup"),y(),w(),f=!0},fetch:function(){P(_.value,3,_.selectionStart||0)}}};class Wt{constructor(){this._boundedEvents=[]}get boundedEvents(){return this._boundedEvents}dispose(){this.unbindAll(),this._boundedEvents=[]}bind(e,t,i,s,n=""){const r=Array.isArray(t)?t:[t];if(e?.forEach)e.forEach((e=>{for(const t of r)e.addEventListener(t,i,s),this._boundedEvents.push({element:e,eventName:t,listener:i,groupName:n})}));else if(e)for(const t of r)e.addEventListener(t,i,s),this._boundedEvents.push({element:e,eventName:t,listener:i,groupName:n})}unbind(e,t,i){const s=Array.isArray(e)?e:[e],n=Array.isArray(t)?t:[t];for(const e of n)for(const t of s)"function"==typeof t?.removeEventListener&&t.removeEventListener(e,i)}unbindByEventName(e,t){const i=this._boundedEvents.find((i=>i.element===e&&i.eventName===t));i&&this.unbind(i.element,i.eventName,i.listener)}unbindAll(e){if(e){const t=Array.isArray(e)?e:[e];for(let e=this._boundedEvents.length-1;e>=0;--e){const i=this._boundedEvents[e];if(t.some((e=>e===i.groupName))){const{element:t,eventName:s,listener:n}=i;this.unbind(t,s,n),this._boundedEvents.splice(e,1)}}}else for(;this._boundedEvents.length>0;){const e=this._boundedEvents.pop(),{element:t,eventName:i,listener:s}=e;this.unbind(t,i,s)}}}var Ut=Object.prototype.hasOwnProperty;function jt(e,t){var i,s;if(e===t)return!0;if(e&&t&&(i=e.constructor)===t.constructor){if(i===Date)return e.getTime()===t.getTime();if(i===RegExp)return e.toString()===t.toString();if(i===Array){if((s=e.length)===t.length)for(;s--&&jt(e[s],t[s]););return-1===s}if(!i||"object"==typeof e){for(i in s=0,e){if(Ut.call(e,i)&&++s&&!Ut.call(t,i))return!1;if(!(i in t)||!jt(e[i],t[i]))return!1}return Object.keys(t).length===s}}return e!=e&&t!=t}function Gt(e,t){const i=t.fetch;i&&(t.fetch=(t,s,n,r)=>{e.classList.add("slick-autocomplete-loading");const o=s;i(t,(t=>{o(t),e.classList.remove("slick-autocomplete-loading")}),n,r)})}function qt(e,t,i,s){const{oldVal:n,newVal:r,columnDef:o,selectedSettings:a,updatePickerUI:l}=s;if(n!==r){const s=e.type||o.type,n=o.outputType||e.type||o.type||E.dateUtc,h=Array.isArray(r)?r:[r||""],c=[],d=Lt(E.dateIso),u=s?Lt(s):void 0;for(const e of h){const t=e instanceof Date?e:Nt(e,u);t&&c.push(t)}const p=a??{dates:[c.map((e=>Dt(e,d))).join(":")],month:c[0]?.getMonth(),year:c[0]?.getFullYear(),time:"ISO8601"===u||(u||"").toLowerCase().includes("h")?Dt(c[0],"HH:mm"):void 0};jt(i.settings.selected,p)||(i.settings.selected=p,l&&i?.update&&i.update({dates:!0,month:!0,year:!0,time:!0})),t.value=h.length?c.map((e=>Mt(e,void 0,n))).join(" â "):""}}function Kt(e,t){const i=ie("select",{className:"form-control"});for(const s of e){const e=document.createElement("option");e.value=s.operator,t.applyHtmlCode(e,`${fe(s.operatorAlt||s.operator,3)}${s.descAlt||s.desc}`),i.appendChild(e)}return i}async function Yt(e,t,i,s,n){const r=t?.filter??{},o=r?.collectionOptions??{};let a=null;if(e){const l=s?.isObservable(e)??!1;l&&s&&(a=await L(s,e));const h=await e;if(Array.isArray(h)?a=h:h?.status>=200&&h.status<300&&"function"==typeof h.json?a=await h.json():h&&h.content&&(a=h.content),!Array.isArray(a)&&o?.collectionInsideObjectProperty&&(a=U(a||h,o.collectionInsideObjectProperty||"")),!Array.isArray(a))throw new Error('Something went wrong while trying to pull the collection from the "collectionAsync" call in the Filter, the collection is not a valid array.');r.collection=a,i(a),l&&function(e,t,i,s){const n=e?.filter??{},r=i?.createSubject();n.collectionAsync=r,s&&r&&s.push(r.subscribe((i=>function(e,t,i){const s=t?.filter??{},n=s?.collectionOptions??{};if(n&&n.collectionInsideObjectProperty&&(e=U(e,n.collectionInsideObjectProperty)),!Array.isArray(e))throw new Error('Something went wrong while trying to pull the collection from the "collectionAsync" call in the Filter, the collection is not a valid array.');s.collection=e,i(e)}(i,e,t))))}(t,i,s,n)}return a}function Xt(e,t,i,s,n){if(s?.enableTranslate&&n?.translate){const t=j(s);return n.translate(`${t}${e}`)}const r=s.locales||y.locales;return r?.[t]??i}function Zt(e,t){return[{operator:"",desc:""},{operator:"=",desc:Xt("EQUAL_TO","TEXT_EQUAL_TO","Equal to",e,t)},{operator:"<",desc:Xt("LESS_THAN","TEXT_LESS_THAN","Less than",e,t)},{operator:"<=",desc:Xt("LESS_THAN_OR_EQUAL_TO","TEXT_LESS_THAN_OR_EQUAL_TO","Less than or equal to",e,t)},{operator:">",desc:Xt("GREATER_THAN","TEXT_GREATER_THAN","Greater than",e,t)},{operator:">=",desc:Xt("GREATER_THAN_OR_EQUAL_TO","TEXT_GREATER_THAN_OR_EQUAL_TO","Greater than or equal to",e,t)},{operator:"<>",desc:Xt("NOT_EQUAL_TO","TEXT_NOT_EQUAL_TO","Not equal to",e,t)}]}function Qt(e,t,i){if(e.compoundOperatorAltTexts)for(const s of t)if(e.compoundOperatorAltTexts.hasOwnProperty(i)){const t=e.compoundOperatorAltTexts[i][s.operator];s.operatorAlt=t?.operatorAlt||"",s.descAlt=t?.descAlt||""}}var Jt=Object.defineProperty,ei=Object.getOwnPropertySymbols,ti=Object.prototype.hasOwnProperty,ii=Object.prototype.propertyIsEnumerable,si=(e,t,i)=>t in e?Jt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,ni=(e,t)=>{for(var i in t||(t={}))ti.call(t,i)&&si(e,i,t[i]);if(ei)for(var i of ei(t))ii.call(t,i)&&si(e,i,t[i]);return e},ri=(e,t,i)=>(si(e,"symbol"!=typeof t?t+"":t,i),i);const oi={calendar:"vanilla-calendar",calendarDefault:"vanilla-calendar_default",calendarMultiple:"vanilla-calendar_multiple",calendarMonth:"vanilla-calendar_month",calendarYear:"vanilla-calendar_year",calendarHidden:"vanilla-calendar_hidden",calendarToInput:"vanilla-calendar_to-input",calendarToInputTop:"vanilla-calendar_to-input_top",calendarToInputBottom:"vanilla-calendar_to-input_bottom",controls:"vanilla-calendar-controls",grid:"vanilla-calendar-grid",gridDisabled:"vanilla-calendar-grid_disabled",column:"vanilla-calendar-column",columnMonth:"vanilla-calendar-column_month",columnYear:"vanilla-calendar-column_year",header:"vanilla-calendar-header",headerContent:"vanilla-calendar-header__content",month:"vanilla-calendar-month",monthDisabled:"vanilla-calendar-month_disabled",year:"vanilla-calendar-year",yearDisabled:"vanilla-calendar-year_disabled",arrow:"vanilla-calendar-arrow",arrowPrev:"vanilla-calendar-arrow_prev",arrowNext:"vanilla-calendar-arrow_next",wrapper:"vanilla-calendar-wrapper",content:"vanilla-calendar-content",week:"vanilla-calendar-week",weekDay:"vanilla-calendar-week__day",weekDayWeekend:"vanilla-calendar-week__day_weekend",days:"vanilla-calendar-days",daysSelecting:"vanilla-calendar-days_selecting",months:"vanilla-calendar-months",monthsSelecting:"vanilla-calendar-months_selecting",monthsMonth:"vanilla-calendar-months__month",monthsMonthSelected:"vanilla-calendar-months__month_selected",monthsMonthDisabled:"vanilla-calendar-months__month_disabled",years:"vanilla-calendar-years",yearsSelecting:"vanilla-calendar-years_selecting",yearsYear:"vanilla-calendar-years__year",yearsYearSelected:"vanilla-calendar-years__year_selected",yearsYearDisabled:"vanilla-calendar-years__year_disabled",time:"vanilla-calendar-time",timeContent:"vanilla-calendar-time__content",timeHours:"vanilla-calendar-time__hours",timeMinutes:"vanilla-calendar-time__minutes",timeKeeping:"vanilla-calendar-time__keeping",timeRanges:"vanilla-calendar-time__ranges",timeRange:"vanilla-calendar-time__range",day:"vanilla-calendar-day",dayHoverFirst:"vanilla-calendar-day_hover-first",dayHoverLast:"vanilla-calendar-day_hover-last",dayHoverIntermediate:"vanilla-calendar-day_hover-intermediate",daySelectedFirst:"vanilla-calendar-day_selected-first",daySelectedLast:"vanilla-calendar-day_selected-last",daySelectedIntermediate:"vanilla-calendar-day_selected-intermediate",dayPopup:"vanilla-calendar-day__popup",dayBtn:"vanilla-calendar-day__btn",dayBtnPrev:"vanilla-calendar-day__btn_prev",dayBtnNext:"vanilla-calendar-day__btn_next",dayBtnToday:"vanilla-calendar-day__btn_today",dayBtnSelected:"vanilla-calendar-day__btn_selected",dayBtnHover:"vanilla-calendar-day__btn_hover",dayBtnDisabled:"vanilla-calendar-day__btn_disabled",dayBtnWeekend:"vanilla-calendar-day__btn_weekend",dayBtnHoliday:"vanilla-calendar-day__btn_holiday",weekNumbers:"vanilla-calendar-week-numbers",weekNumbersTitle:"vanilla-calendar-week-numbers__title",weekNumbersContent:"vanilla-calendar-week-numbers__content",weekNumber:"vanilla-calendar-week-number",isFocus:"vanilla-calendar-is-focus"},ai=e=>`<div class="${e.controls}"><#ArrowPrev /><#ArrowNext /></div><div class="${e.grid}"><#Multiple><div class="${e.column}"><div class="${e.header}"><div class="${e.headerContent}"><#Month /><#Year /></div></div><div class="${e.wrapper}"><#WeekNumbers /><div class="${e.content}"><#Week /><#Days /></div></div></div><#/Multiple></div><#ControlTime />`,li=e=>`<div class="${e.header}"><div class="${e.headerContent}"><#Month /><#Year /></div></div><div class="${e.wrapper}"><div class="${e.content}"><#Months /></div></div>`,hi=e=>`<div class="${e.header}"><#ArrowPrev /><div class="${e.headerContent}"><#Month /><#Year /></div><#ArrowNext /></div><div class="${e.wrapper}"><div class="${e.content}"><#Years /></div></div>`;class ci{constructor(){var e;ri(this,"isInit",!1),ri(this,"isInputInit",!1),ri(this,"input",!1),ri(this,"type","default"),ri(this,"months",2),ri(this,"jumpMonths",1),ri(this,"jumpToSelectedDate",!1),ri(this,"toggleSelected",!0),ri(this,"date",{min:"1970-01-01",max:"2470-12-31",today:new Date}),ri(this,"settings",{lang:"en",iso8601:!0,range:{min:void 0,max:void 0,disablePast:!1,disableGaps:!1,edgesOnly:!1,disableAllDays:!1,disableWeekday:void 0,disabled:void 0,enabled:void 0},selection:{day:"single",month:!0,year:!0,time:!1,controlTime:"all",stepHours:1,stepMinutes:1,cancelableDay:!0},selected:{dates:void 0,month:void 0,year:void 0,holidays:void 0,time:void 0},visibility:{theme:"system",themeDetect:"html[data-theme]",monthShort:!0,weekNumbers:!1,weekend:!0,today:!0,disabled:!1,daysOutside:!0,positionToInput:"left"}}),ri(this,"locale",{months:[],weekday:[]}),ri(this,"sanitizer",(e=>e)),ri(this,"actions",{clickDay:null,clickWeekNumber:null,clickMonth:null,clickYear:null,clickArrow:null,changeTime:null,changeToInput:null,getDays:null,getMonths:null,getYears:null,initCalendar:null,updateCalendar:null,destroyCalendar:null,showCalendar:null,hideCalendar:null}),ri(this,"popups",{}),ri(this,"CSSClasses",ni({},oi)),ri(this,"DOMTemplates",{default:(e=this.CSSClasses,`<div class="${e.header}"><#ArrowPrev /><div class="${e.headerContent}"><#Month /><#Year /></div><#ArrowNext /></div><div class="${e.wrapper}"><#WeekNumbers /><div class="${e.content}"><#Week /><#Days /></div></div><#ControlTime />`),multiple:ai(this.CSSClasses),month:li(this.CSSClasses),year:hi(this.CSSClasses)}),ri(this,"HTMLElement"),ri(this,"HTMLOriginalElement"),ri(this,"HTMLInputElement"),ri(this,"rangeMin"),ri(this,"rangeMax"),ri(this,"rangeDisabled"),ri(this,"rangeEnabled"),ri(this,"selectedDates"),ri(this,"selectedHolidays"),ri(this,"selectedMonth"),ri(this,"selectedYear"),ri(this,"selectedHours"),ri(this,"selectedMinutes"),ri(this,"selectedKeeping"),ri(this,"selectedTime"),ri(this,"currentType"),ri(this,"correctMonths"),ri(this,"viewYear"),ri(this,"dateMin"),ri(this,"dateMax")}}const di=e=>`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`,ui=e=>new Date(`${e}T00:00:00`),pi=e=>e.reduce(((e,t)=>{if(t instanceof Date||"number"==typeof t){const i=t instanceof Date?t:new Date(t);e.push(i.toISOString().substring(0,10))}else t.match(/^(\d{4}-\d{2}-\d{2})$/g)?e.push(t):t.replace(/(\d{4}-\d{2}-\d{2}).*?(\d{4}-\d{2}-\d{2})/g,((t,i,s)=>{const n=ui(i),r=ui(s),o=new Date(n.getTime());for(;o<=r;o.setDate(o.getDate()+1))e.push(di(o));return t}));return e}),[]),mi=()=>{const e=new Date;return new Date(e.getTime()-6e4*e.getTimezoneOffset()).toISOString().substring(0,10)},fi=e=>e?{0:"12",13:"01",14:"02",15:"03",16:"04",17:"05",18:"06",19:"07",20:"08",21:"09",22:"10",23:"11"}[Number(e)]||String(e):"",gi='The calendar has not been initialized, please initialize it using the "init()" method first.',_i=e=>{e.currentType=e.type,(e=>{var t;if(e.jumpToSelectedDate&&(null==(t=e.settings.selected.dates)?void 0:t.length)&&void 0===e.settings.selected.month&&void 0===e.settings.selected.year){const t=ui(pi(e.settings.selected.dates)[0]);e.settings.selected.month=t.getMonth(),e.settings.selected.year=t.getFullYear()}const i=void 0!==e.settings.selected.month&&Number(e.settings.selected.month)>=0&&Number(e.settings.selected.month)<12,s=void 0!==e.settings.selected.year&&Number(e.settings.selected.year)>=0&&Number(e.settings.selected.year)<=9999;e.selectedMonth=i?Number(e.settings.selected.month):e.date.today.getMonth(),e.selectedYear=s?Number(e.settings.selected.year):e.date.today.getFullYear(),e.viewYear=e.selectedYear})(e),(e=>{var t,i,s;"today"===e.date.min&&(e.date.min=mi()),"today"===e.date.max&&(e.date.max=mi()),"today"===e.settings.range.min&&(e.settings.range.min=mi()),"today"===e.settings.range.max&&(e.settings.range.max=mi()),e.settings.range.min=e.settings.range.min?ui(e.date.min)>=ui(e.settings.range.min)?e.date.min:e.settings.range.min:e.date.min,e.settings.range.max=e.settings.range.max?ui(e.date.max)<=ui(e.settings.range.max)?e.date.max:e.settings.range.max:e.date.max;const n=e.settings.range.disablePast&&!e.settings.range.disableAllDays&&ui(e.settings.range.min)<e.date.today;e.rangeMin=n||e.settings.range.disableAllDays?di(e.date.today):e.settings.range.min,e.rangeMax=e.settings.range.disableAllDays?di(e.date.today):e.settings.range.max,e.rangeDisabled=e.settings.range.disabled&&!e.settings.range.disableAllDays?pi(e.settings.range.disabled):e.settings.range.disableAllDays?[e.rangeMin]:[],e.rangeDisabled.length>1&&e.rangeDisabled.sort(((e,t)=>+new Date(e)-+new Date(t))),e.rangeEnabled=e.settings.range.enabled?pi(e.settings.range.enabled):[],(null==(t=e.rangeEnabled)?void 0:t[0])&&(null==(i=e.rangeDisabled)?void 0:i[0])&&(e.rangeDisabled=e.rangeDisabled.filter((t=>!e.rangeEnabled.includes(t)))),e.rangeEnabled.length>1&&e.rangeEnabled.sort(((e,t)=>+new Date(e)-+new Date(t))),(null==(s=e.rangeEnabled)?void 0:s[0])&&e.settings.range.disableAllDays&&(e.rangeMin=e.rangeEnabled[0],e.rangeMax=e.rangeEnabled[e.rangeEnabled.length-1])})(e),(e=>{var t,i;e.selectedDates=(null==(t=e.settings.selected.dates)?void 0:t[0])?pi(e.settings.selected.dates):[],e.selectedHolidays=(null==(i=e.settings.selected.holidays)?void 0:i[0])?pi(e.settings.selected.holidays):[]})(e),(e=>{e.dateMin=e.settings.visibility.disabled?ui(e.date.min):ui(e.rangeMin),e.dateMax=e.settings.visibility.disabled?ui(e.date.max):ui(e.rangeMax)})(e),(e=>{const t=!0===e.settings.selection.time||12===e.settings.selection.time;if(t||24===e.settings.selection.time){let i=!1;if("string"==typeof e.settings.selected.time){const s=t?/^([0-9]|0[1-9]|1[0-2]):([0-5][0-9])|(AM|PM)/g:/^([0-1]?[0-9]|2[0-3]):([0-5][0-9])/g;e.settings.selected.time.replace(s,((s,n,r,o)=>(n&&r&&(i=!0,e.selectedHours=n,e.selectedMinutes=r),o&&t?e.selectedKeeping=o:t&&(e.selectedKeeping="AM"),"")))}!i&&t?(e.selectedHours=fi(String(e.date.today.getHours())),e.selectedMinutes=String(e.date.today.getMinutes()),e.selectedKeeping=Number(e.date.today.getHours())>=12?"PM":"AM"):i||(e.selectedHours=String(e.date.today.getHours()),e.selectedMinutes=String(e.date.today.getMinutes())),e.selectedHours=Number(e.selectedHours)<10?`0${Number(e.selectedHours)}`:`${e.selectedHours}`,e.selectedMinutes=Number(e.selectedMinutes)<10?`0${Number(e.selectedMinutes)}`:`${e.selectedMinutes}`,e.selectedTime=`${e.selectedHours}:${e.selectedMinutes}${e.selectedKeeping?` ${e.selectedKeeping}`:""}`}else if(e.settings.selection.time)throw new Error("The value of the time property can be: false, true, 12 or 24.")})(e),(e=>{e.correctMonths="multiple"===e.type?1===e.months?2:e.months>12?12:e.months:1})(e)},vi=({arrowPrev:e,arrowNext:t,isPrevHidden:i,isNextHidden:s})=>{e.style.visibility=i?"hidden":"",t.style.visibility=s?"hidden":""},bi=e=>{var t,i;if("month"===e.currentType)return;const s=null==(t=e.HTMLElement)?void 0:t.querySelector(`.${e.CSSClasses.arrowPrev}`),n=null==(i=e.HTMLElement)?void 0:i.querySelector(`.${e.CSSClasses.arrowNext}`);s&&n&&{default:()=>{const t=ui(di(new Date(e.selectedYear,e.selectedMonth,1))),i=new Date(t.getTime()),r=new Date(t.getTime());i.setMonth(i.getMonth()-e.jumpMonths),r.setMonth(r.getMonth()+e.jumpMonths),e.settings.selection.year||(e.dateMin.setFullYear(t.getFullYear()),e.dateMax.setFullYear(t.getFullYear()));const o=!e.settings.selection.month||i.getFullYear()<e.dateMin.getFullYear()||i.getFullYear()===e.dateMin.getFullYear()&&i.getMonth()<e.dateMin.getMonth(),a=!e.settings.selection.month||r.getFullYear()>e.dateMax.getFullYear()||r.getFullYear()===e.dateMax.getFullYear()&&r.getMonth()>e.dateMax.getMonth();vi({arrowPrev:s,arrowNext:n,isPrevHidden:o,isNextHidden:a})},year:()=>{vi({arrowPrev:s,arrowNext:n,isPrevHidden:e.dateMin.getFullYear()&&e.viewYear-7<=e.dateMin.getFullYear(),isNextHidden:e.dateMax.getFullYear()&&e.viewYear+7>=e.dateMax.getFullYear()})}}["multiple"===e.currentType?"default":e.currentType]()},yi=(e,t)=>{if(!e)return null;const i=ui(e),s=t?i.getDay()||7:i.getDay();i.setDate(i.getDate()+4-s);const n=new Date(i.getFullYear(),0,1),r=Math.ceil(((+i-+n)/864e5+1)/7);return{year:i.getFullYear(),week:r}};function Ci(e){if(!e||!e.getBoundingClientRect)return{top:0,bottom:0,left:0,right:0};const t=e.getBoundingClientRect(),i=document.documentElement;return{bottom:t.bottom,right:t.right,top:t.top+window.scrollY-i.clientTop,left:t.left+window.scrollX-i.clientLeft}}function wi(){return{vw:Math.max(document.documentElement.clientWidth||0,window.innerWidth||0),vh:Math.max(document.documentElement.clientHeight||0,window.innerHeight||0)}}function Si(e,t,i=5){const s={top:!0,bottom:!0,left:!0,right:!0},n=[];if(!t||!e)return{canShow:s,parentPositions:n};const{bottom:r,top:o}=function(e){const{top:t,left:i}={left:window.scrollX||document.documentElement.scrollLeft||0,top:window.scrollY||document.documentElement.scrollTop||0},{top:s,left:n}=Ci(e),{vh:r,vw:o}=wi(),a=s-t,l=n-i;return{top:a,bottom:r-(a+e.clientHeight),left:l,right:o-(l+e.clientWidth)}}(e),{top:a,left:l}=Ci(e),{height:h,width:c}=t.getBoundingClientRect(),{vh:d,vw:u}=wi(),p=u/2,m=d/2;return[{condition:a<m,position:"top"},{condition:a>m,position:"bottom"},{condition:l<p,position:"left"},{condition:l>p,position:"right"}].forEach((({condition:e,position:t})=>{e&&n.push(t)})),Object.assign(s,{top:h<=o-i,bottom:h<=r-i,left:c<=l,right:c<=u-l}),{canShow:s,parentPositions:n}}const Ei=(e,t,i,s)=>{if(e){const n="auto"===i?function(e,t){const i="left";if(!t||!e)return i;const{canShow:s,parentPositions:n}=Si(e,t),r=s.left&&s.right;return(r&&s.bottom?"center":r&&s.top?["top","center"]:Array.isArray(n)?["bottom"===n[0]?"top":"bottom",...n.slice(1)]:n)||i}(e,t):i,r={top:-t.offsetHeight,bottom:e.offsetHeight,left:0,center:e.offsetWidth/2-t.offsetWidth/2,right:e.offsetWidth-t.offsetWidth},o=Array.isArray(n)?n[0]:"bottom",a=Array.isArray(n)?n[1]:n;"bottom"===o?(t.classList.remove(s.calendarToInputTop),t.classList.add(s.calendarToInputBottom)):(t.classList.remove(s.calendarToInputBottom),t.classList.add(s.calendarToInputTop));const{top:l,left:h}=Ci(e),c=l+r[o];let d=h+r[a];const{vw:u}=wi();if(d+t.clientWidth>u){const e=window.innerWidth-document.body.clientWidth;d=u-t.clientWidth-e}else d<0&&(d=0);Object.assign(t.style,{left:`${d}px`,top:`${c}px`})}},xi=(e,t,i,s,n)=>{const r=t[i].querySelector(`.${e.CSSClasses.dayBtn}`),o=yi(null==r?void 0:r.dataset.calendarDay,e.settings.iso8601);if(!o)return;const a=s.cloneNode(!0);a.innerText=String(o.week),a.dataset.calendarYearWeek=String(o.year),n.appendChild(a)},Ti=(e,t,i,s,n,r,o,a)=>{const l=document.createElement("div");l.className=e.CSSClasses.day;const h=document.createElement("button");h.className=`${e.CSSClasses.dayBtn}${a?` ${a}`:""}`,h.type="button",h.innerText=String(s),h.dataset.calendarDay=r,e.settings.visibility.weekNumbers&&(()=>{const t=yi(r,e.settings.iso8601);t&&(h.dataset.calendarWeekNumber=String(t.week))})(),o?e.settings.visibility.daysOutside&&l.appendChild(h):l.appendChild(h),((e,t,i)=>{var s,n,r,o,a;const l=null==(s=e.settings.range.disableWeekday)?void 0:s.includes(i),h=e.settings.range.disableAllDays&&!!(null==(n=e.rangeEnabled)?void 0:n[0]);!l&&!h||(null==(r=e.rangeEnabled)?void 0:r.includes(t))||(null==(o=e.rangeDisabled)?void 0:o.includes(t))||(e.rangeDisabled.push(t),null==(a=e.rangeDisabled)||a.sort(((e,t)=>+new Date(e)-+new Date(t))))})(e,r,n),((e,t,i,s,n,r,o)=>{var a,l,h;if((ui(e.rangeMin)>ui(r)||ui(e.rangeMax)<ui(r)||(null==(a=e.rangeDisabled)?void 0:a.includes(r))||!e.settings.selection.month&&o||!e.settings.selection.year&&ui(r).getFullYear()!==t)&&(s.classList.add(e.CSSClasses.dayBtnDisabled),s.tabIndex=-1),e.settings.visibility.today&&di(e.date.today)===r&&s.classList.add(e.CSSClasses.dayBtnToday),!e.settings.visibility.weekend||0!==n&&6!==n||s.classList.add(e.CSSClasses.dayBtnWeekend),(null==(l=e.selectedHolidays)?void 0:l.includes(r))&&s.classList.add(e.CSSClasses.dayBtnHoliday),(null==(h=e.selectedDates)?void 0:h.includes(r))&&(s.classList.add(e.CSSClasses.dayBtnSelected),e.selectedDates.length>1&&"multiple-ranged"===e.settings.selection.day&&(e.selectedDates[0]===r&&i.classList.add(e.CSSClasses.daySelectedFirst),e.selectedDates[e.selectedDates.length-1]===r&&i.classList.add(e.CSSClasses.daySelectedLast),e.selectedDates[0]!==r&&e.selectedDates[e.selectedDates.length-1]!==r&&i.classList.add(e.CSSClasses.daySelectedIntermediate))),e.settings.range.edgesOnly&&e.selectedDates.length>1&&"multiple-ranged"===e.settings.selection.day){const t=+new Date(e.selectedDates[0]),n=+new Date(e.selectedDates[e.selectedDates.length-1]),o=+new Date(r);o>t&&o<n&&(s.classList.add(e.CSSClasses.dayBtnSelected),i.classList.add(e.CSSClasses.daySelectedIntermediate))}})(e,t,l,h,n,r,o),i.appendChild(l),e.actions.getDays&&e.actions.getDays(s,r,l,h,e)},Oi=e=>{const t=e.HTMLElement.querySelectorAll(`.${e.CSSClasses.days}`),i=e.HTMLElement.querySelectorAll(`.${e.CSSClasses.weekNumbers}`),s=new Date(e.selectedYear,e.selectedMonth,1);t.forEach(((t,n)=>{const r=new Date(s);r.setMonth(r.getMonth()+n);const o=r.getMonth(),a=r.getFullYear(),l=new Date(a,o,1),h=new Date(a,o+1,0).getDate(),c=e.settings.iso8601?(0!==l.getDay()?l.getDay():7)-1:l.getDay();e.settings.selection.day&&t.classList.add(e.CSSClasses.daysSelecting),t.textContent="",((e,t,i,s,n)=>{let r=new Date(i,s,0).getDate()-(n-1);const o=0===s?i-1:i,a=0===s?12:s<10?`0${s}`:s;for(let s=n;s>0;s--,r++){const s=`${o}-${a}-${r}`,n=ui(s).getDay();Ti(e,i,t,r,n,s,!0,e.CSSClasses.dayBtnPrev)}})(e,t,a,o,c),((e,t,i,s,n)=>{for(let r=1;r<=i;r++){const i=new Date(s,n,r),o=di(i),a=i.getDay();Ti(e,s,t,r,a,o,!1,null)}})(e,t,h,a,o),((e,t,i,s,n,r)=>{const o=r+i,a=7*Math.ceil(o/7)-o,l=n+1===12?s+1:s,h=n+1===12?"01":n+2<10?`0${n+2}`:n+2;for(let i=1;i<=a;i++){const n=`${l}-${h}-${i<10?`0${i}`:String(i)}`,r=ui(n).getDay();Ti(e,s,t,i,r,n,!0,e.CSSClasses.dayBtnNext)}})(e,t,h,a,o,c),((e,t,i,s,n)=>{if(!e.settings.visibility.weekNumbers)return;s.textContent="";const r=document.createElement("b");r.className=e.CSSClasses.weekNumbersTitle,r.innerText="#",s.appendChild(r);const o=document.createElement("div");o.className=e.CSSClasses.weekNumbersContent,s.appendChild(o);const a=document.createElement("button");a.type="button",a.className=e.CSSClasses.weekNumber;const l=n.querySelectorAll(`.${e.CSSClasses.day}`),h=Math.ceil((t+i)/7);for(let t=0;t<h;t++)xi(e,l,0===t?6:7*t,a,o)})(e,c,h,i[n],t),((e,t)=>{var i;e.popups&&(null==(i=Object.entries(e.popups))||i.forEach((([i,s])=>((e,t,i,s)=>{const n=e.CSSClasses.dayPopup,r=s.querySelector(`[data-calendar-day="${t}"]`);if(r&&((null==i?void 0:i.modifier)&&r.classList.add(...i.modifier.trim().split(" ")),null==i?void 0:i.html)){const t=r.parentElement,s=document.createElement("div");s.className=n,s.innerHTML=e.sanitizer(i.html),t.appendChild(s),setTimeout((()=>{if(s){const{canShow:e}=Si(t,s),i=5;let n=t.offsetHeight,r=0;e.bottom||(n=-s.offsetHeight-i),e.left&&!e.right&&(r=t.offsetWidth-s.offsetWidth/2),!e.left&&e.right&&(r=s.offsetWidth/2),Object.assign(s.style,{left:`${r}px`,top:`${n}px`})}}))}})(e,i,s,t))))})(e,t)}))},ki=e=>{var t,i;const s=null==(t=e.HTMLElement)?void 0:t.querySelectorAll("[data-calendar-selected-month]"),n=null==(i=e.HTMLElement)?void 0:i.querySelectorAll("[data-calendar-selected-year]");if(!(null==s?void 0:s[0])&&(null==n?void 0:n[0]))return;const r=new Date(e.selectedYear,e.selectedMonth,1);null==s||s.forEach(((t,i)=>((e,t,i,s)=>{const n=new Date(s.setMonth(e.selectedMonth+i)).getMonth(),r=!1===e.settings.selection.month||"only-arrows"===e.settings.selection.month;t.tabIndex=r?-1:0,t.classList.toggle(e.CSSClasses.monthDisabled,r),t.setAttribute("data-calendar-selected-month",String(n)),t.innerText=e.locale.months[n]})(e,t,i,r))),null==n||n.forEach(((t,i)=>((e,t,i,s)=>{const n=new Date(s.setFullYear(e.selectedYear,e.selectedMonth+i)).getFullYear(),r=!1===e.settings.selection.year||"only-arrows"===e.settings.selection.year;t.tabIndex=r?-1:0,t.classList.toggle(e.CSSClasses.yearDisabled,r),t.setAttribute("data-calendar-selected-year",String(n)),t.innerText=String(n)})(e,t,i,r)))},Ii=(e,t)=>{const i=ui(di(new Date(e.selectedYear,e.selectedMonth,1)));({prev:()=>i.setMonth(i.getMonth()-e.jumpMonths),next:()=>i.setMonth(i.getMonth()+e.jumpMonths)})[t](),[e.selectedMonth,e.selectedYear]=[i.getMonth(),i.getFullYear()],ki(e),bi(e),Oi(e)},Ai=Object.freeze(Object.defineProperty({__proto__:null,ArrowNext:e=>`<button type="button"class="${e.CSSClasses.arrow} ${e.CSSClasses.arrowNext}"data-calendar-arrow="next"></button>`,ArrowPrev:e=>`<button type="button"class="${e.CSSClasses.arrow} ${e.CSSClasses.arrowPrev}"data-calendar-arrow="prev"></button>`,ControlTime:e=>e.settings.selection.time?`<div class="${e.CSSClasses.time}"></div>`:"",Days:e=>`<div class="${e.CSSClasses.days}"></div>`,Month:e=>`<button type="button"class="${e.CSSClasses.month}"data-calendar-selected-month></button>`,Months:e=>`<div class="${e.CSSClasses.months}"></div>`,Week:e=>`<div class="${e.CSSClasses.week}"></div>`,WeekNumbers:e=>e.settings.visibility.weekNumbers?`<div class="${e.CSSClasses.weekNumbers}"></div>`:"",Year:e=>`<button type="button"class="${e.CSSClasses.year}"data-calendar-selected-year></button>`,Years:e=>`<div class="${e.CSSClasses.years}"></div>`},Symbol.toStringTag,{value:"Module"})),Di=(e,t)=>t.replace(/[\n\t]/g,"").replace(/<#(?!\/?Multiple)(.*?)>/g,((t,i)=>{const s=(n=i.replace(/[/\s\n\t]/g,""),Ai[n]);var n;const r=s?s(e):"";return e.sanitizer(r)})).replace(/[\n\t]/g,""),Ri=(e,t)=>{const{HTMLElement:i,CSSClasses:s,DOMTemplates:n,type:r,currentType:o,correctMonths:a}=e,l=(n,r)=>{if(!t)return;const o=i.querySelector(`.${s.controls}`);o&&i.removeChild(o),i.querySelector(`.${s.grid}`).classList.add(s.gridDisabled);const a=t.closest(`.${s.column}`);a.classList.add(n),a.innerHTML=Di(e,r)},h={default:()=>{i.classList.add(s.calendarDefault),i.classList.remove(s.calendarMonth,s.calendarYear),i.innerHTML=Di(e,n.default)},multiple:()=>{a&&(i.classList.add(s.calendarMultiple),i.classList.remove(s.calendarMonth,s.calendarYear),i.innerHTML=((e,t)=>t.replace(/<#Multiple>(.*?)<#\/Multiple>/g,((t,i)=>{let s="";for(let t=0;t<e.correctMonths;t++)s+=i;return e.sanitizer(s)})).replace(/[\n\t]/g,""))(e,Di(e,n.multiple)))},month:()=>{"multiple"!==r?(i.classList.add(s.calendarMonth),i.classList.remove(s.calendarDefault,s.calendarYear),i.innerHTML=Di(e,n.month)):l(s.columnMonth,n.month)},year:()=>{"multiple"!==r?(i.classList.add(s.calendarYear),i.classList.remove(s.calendarDefault,s.calendarMonth),i.innerHTML=Di(e,n.year)):l(s.columnYear,n.year)}};i.classList.add(s.calendar),h[o]()},Pi=(e,t,i,s,n)=>{const r=t.cloneNode(!1);return r.className=`${e.CSSClasses.yearsYear}${i===n?` ${e.CSSClasses.yearsYearSelected}`:s?` ${e.CSSClasses.yearsYearDisabled}`:""}`,r.dataset.calendarYear=String(n),r.title=String(n),r.innerText=String(n),s&&(r.tabIndex=-1),r},Li=(e,t)=>{const i=(null==t?void 0:t.dataset.calendarSelectedYear)?Number(null==t?void 0:t.dataset.calendarSelectedYear):e.selectedYear;e.currentType="year",Ri(e,t),ki(e),bi(e);const s=e.HTMLElement.querySelector(`.${e.CSSClasses.years}`);if(!e.settings.selection.year||!s)return;s.classList.add(e.CSSClasses.yearsSelecting);const n="multiple"!==e.type||e.selectedYear===i?0:1,r=document.createElement("button");r.type="button";for(let t=e.viewYear-7;t<e.viewYear+8;t++){const o=t<e.dateMin.getFullYear()+n||t>e.dateMax.getFullYear(),a=Pi(e,r,i,o,t);s.appendChild(a),e.actions.getYears&&e.actions.getYears(t,a,e)}},Mi=e=>`${e.charAt(0).toUpperCase()}${e.substring(1,e.length)}`.replace(/\./,""),Ni=(e,t)=>{const i=new Date(`1978-01-0${t+1}T00:00:00.000Z`).toLocaleString(e.settings.lang,{weekday:"short",timeZone:"UTC"});e.locale.weekday.push(Mi(i))},Fi=(e,t)=>{const i=new Date(`1978-${t+1<=9?`0${t+1}`:t+1}-01T00:00:00.000Z`).toLocaleString(e.settings.lang,{month:"long",timeZone:"UTC"});e.locale.months.push(Mi(i))},Bi=e=>{if("multiple"!==e.type)return 0;const t=e.HTMLElement.querySelectorAll(`.${e.CSSClasses.column}`),i=Array.from(t).findIndex((t=>t.classList.contains(`${e.CSSClasses.columnMonth}`)));return i>0?i:0},Hi=(e,t,i,s,n,r)=>{const o=t.cloneNode(!1);return o.className=`${e.CSSClasses.monthsMonth}${i===r?` ${e.CSSClasses.monthsMonthSelected}`:n?` ${e.CSSClasses.monthsMonthDisabled}`:""}`,o.title=s,o.innerText=`${e.settings.visibility.monthShort?s.substring(0,3):s}`,o.dataset.calendarMonth=String(r),n&&(o.tabIndex=-1),o},zi=(e,t)=>{var i,s;const n=(null==t?void 0:t.dataset.calendarSelectedMonth)?Number(t.dataset.calendarSelectedMonth):e.selectedMonth,r=null==(i=null==t?void 0:t.closest(`.${e.CSSClasses.column}`))?void 0:i.querySelector(`.${e.CSSClasses.year}`),o=r?Number(r.dataset.calendarSelectedYear):e.selectedYear;e.currentType="month",Ri(e,t),ki(e);const a=null==(s=e.HTMLElement)?void 0:s.querySelector(`.${e.CSSClasses.months}`);if(!e.settings.selection.month||!a)return;a.classList.add(e.CSSClasses.monthsSelecting);const l=e.jumpMonths>1?e.locale.months.map(((t,i)=>n-e.jumpMonths*i)).concat(e.locale.months.map(((t,i)=>n+e.jumpMonths*i))).filter((e=>e>=0&&e<=12)):Array.from(Array(12).keys()),h=document.createElement("button");h.type="button";for(let t=0;t<12;t++){const i=e.locale.months[t],s=t<e.dateMin.getMonth()+Bi(e)&&o<=e.dateMin.getFullYear()||t>e.dateMax.getMonth()+Bi(e)&&o>=e.dateMax.getFullYear()||t!==n&&!l.includes(t),r=Hi(e,h,n,i,s,t);a.appendChild(r),e.actions.getMonths&&e.actions.getMonths(t,r,e)}},$i=(e,t)=>e&&t?{0:{AM:"00",PM:"12"},1:{AM:"01",PM:"13"},2:{AM:"02",PM:"14"},3:{AM:"03",PM:"15"},4:{AM:"04",PM:"16"},5:{AM:"05",PM:"17"},6:{AM:"06",PM:"18"},7:{AM:"07",PM:"19"},8:{AM:"08",PM:"20"},9:{AM:"09",PM:"21"},10:{AM:"10",PM:"22"},11:{AM:"11",PM:"23"},12:{AM:"12",PM:"12"}}[Number(e)][t]:"",Vi=(e,t,i)=>e.querySelector(`.${t}${i?` input[name="${i}"]`:""}`),Wi=(e,t,i)=>{e.addEventListener("mouseover",(()=>t.classList.add(i))),e.addEventListener("mouseout",(()=>t.classList.remove(i)))},Ui=(e,t,i,s)=>{({hours:()=>{e.selectedHours=i},minutes:()=>{e.selectedMinutes=i}})[s](),e.selectedTime=`${e.selectedHours}:${e.selectedMinutes}${e.selectedKeeping?` ${e.selectedKeeping}`:""}`,e.actions.changeTime&&e.actions.changeTime(t,e),e.input&&e.HTMLInputElement&&e.actions.changeToInput&&e.actions.changeToInput(t,e)},ji=(e,t,i,s,n,r)=>{t.addEventListener("input",(t=>{const o=t.target,a=Number(o.value),l=a<10?`0${a}`:`${a}`;if("hours"!==n||12!==r)return i.value=l,void Ui(e,t,l,n);a<r&&a>0?(i.value=l,e.selectedKeeping="AM",s.innerText=e.selectedKeeping,Ui(e,t,l,n)):(0===a?(e.selectedKeeping="AM",s.innerText="AM"):(e.selectedKeeping="PM",s.innerText="PM"),i.value=fi(o.value),Ui(e,t,fi(o.value),n))}))},Gi=(e,t,i,s,n,r)=>{i.addEventListener("change",(i=>{const o=i.target,a=Number(o.value),l=a<10?`0${a}`:`${a}`;"hours"===n&&12===r?o.value&&a<=r&&a>0?(o.value=l,t.value=$i(l,e.selectedKeeping),Ui(e,i,l,n)):o.value&&a<24&&(a>r||0===a)?(0===a?(e.selectedKeeping="AM",s.innerText="AM"):(e.selectedKeeping="PM",s.innerText="PM"),o.value=fi(o.value),t.value=l,Ui(e,i,fi(o.value),n)):o.value=e.selectedHours:o.value&&a<=r&&a>=0?(o.value=l,t.value=l,Ui(e,i,l,n)):"hours"===n?o.value=e.selectedHours:"minutes"===n&&(o.value=e.selectedMinutes)}))},qi=(e,t,i,s)=>`<label class="${t}"><input type="text"name="${e}"maxlength="2"value="${i}"${s?"disabled":""}></label>`,Ki=(e,t,i,s,n,r)=>`<label class="${t}"><input type="range"name="${e}"min="${i}"max="${s}"step="${n}"value="${r}"></label>`,Yi=e=>{const t=[...e.locale.weekday];t[0]&&(e.settings.iso8601&&t.push(t.shift()),e.HTMLElement.querySelectorAll(`.${e.CSSClasses.week}`).forEach((i=>((e,t,i)=>{const s=document.createElement("b");t.textContent="";for(let n=0;n<i.length;n++){const r=i[n],o=s.cloneNode(!0);o.className=`${e.CSSClasses.weekDay}`,o.className=`${e.CSSClasses.weekDay}${e.settings.visibility.weekend&&e.settings.iso8601?5===n||6===n?` ${e.CSSClasses.weekDayWeekend}`:"":!e.settings.visibility.weekend||e.settings.iso8601||0!==n&&6!==n?"":` ${e.CSSClasses.weekDayWeekend}`}`,o.innerText=`${r}`,t.appendChild(o)}})(e,i,t))))},Xi=["light","dark","system"],Zi={value:!1,set:()=>{Zi.value=!0},check:()=>Zi.value},Qi=(e,t)=>Xi.find((i=>{var s;return"system"!==i&&(null==(s=e.getAttribute(t))?void 0:s.includes(i))})),Ji=(e,t)=>{e.dataset.calendarTheme=t},es=(e,t)=>{var i;if(i=t,Ji(e.HTMLElement,i.matches?"dark":"light"),"system"!==e.settings.visibility.theme||Zi.check())return;const s=t=>{const i=document.querySelectorAll(`.${e.CSSClasses.calendar}`);null==i||i.forEach((e=>Ji(e,t.matches?"dark":"light")))};t.addEventListener?t.addEventListener("change",s):t.addListener(s),Zi.set()},ts=e=>{const t={default:()=>{Yi(e),Oi(e)},multiple:()=>{Yi(e),Oi(e)},month:()=>zi(e),year:()=>Li(e)};(e=>{if(!Xi.includes(e.settings.visibility.theme))throw new Error('Incorrect name of theme in "settings.visibility.theme".');"not all"!==window.matchMedia("(prefers-color-scheme)").media?{light:()=>Ji(e.HTMLElement,"light"),dark:()=>Ji(e.HTMLElement,"dark"),system:()=>((e,t)=>{const i=e.settings.visibility.themeDetect?document.querySelector(e.settings.visibility.themeDetect):null;if(!i)return void es(e,t);const s=e.settings.visibility.themeDetect.replace(/^.*\[(.+)\]/g,((e,t)=>t)),n=Qi(i,s);n?(Ji(e.HTMLElement,n),((e,t,i)=>{new MutationObserver((s=>{for(let n=0;n<s.length;n++)if(s[n].attributeName===i){const s=Qi(t,i);s&&Ji(e.HTMLElement,s);break}})).observe(t,{attributes:!0})})(e,i,s)):es(e,t)})(e,window.matchMedia("(prefers-color-scheme: dark)"))}[e.settings.visibility.theme]():Ji(e.HTMLElement,"light")})(e),(e=>{if("define"!==e.settings.lang||!e.locale.weekday[6]||!e.locale.months[11]){if("define"===e.settings.lang)throw new Error('You specified "define" for "settings.lang" but did not provide the required values for "locale.weekday" or "locale.months".');e.locale.weekday=[],e.locale.months=[];for(let t=0;t<7;t++)Ni(e,t);for(let t=0;t<12;t++)Fi(e,t)}})(e),Ri(e),ki(e),bi(e),(e=>{const t=e.HTMLElement.querySelector(`.${e.CSSClasses.time}`);if(!t)return;const i=!0===e.settings.selection.time?12:e.settings.selection.time,s="range"===e.settings.selection.controlTime,[n,r]=[0,23],[o,a]=[0,59];t.innerHTML=e.sanitizer(`<div class="${e.CSSClasses.timeContent}">${qi("hours",e.CSSClasses.timeHours,e.selectedHours,s)}${qi("minutes",e.CSSClasses.timeMinutes,e.selectedMinutes,s)}${12===i?`<button type="button" class="${e.CSSClasses.timeKeeping}"${s?"disabled":""}>${e.selectedKeeping}</button>`:""}</div><div class="${e.CSSClasses.timeRanges}">${Ki("hours",e.CSSClasses.timeRange,n,r,e.settings.selection.stepHours,e.selectedKeeping?$i(e.selectedHours,e.selectedKeeping):e.selectedHours)}${Ki("minutes",e.CSSClasses.timeRange,o,a,e.settings.selection.stepMinutes,e.selectedMinutes)}</div>`),((e,t,i)=>{const s=24===i?23:i||12,n=Vi(t,e.CSSClasses.timeRange,"hours"),r=Vi(t,e.CSSClasses.timeRange,"minutes"),o=Vi(t,e.CSSClasses.timeHours,"hours"),a=Vi(t,e.CSSClasses.timeMinutes,"minutes"),l=t.querySelector(`.${e.CSSClasses.timeKeeping}`);Wi(n,o,e.CSSClasses.isFocus),Wi(r,a,e.CSSClasses.isFocus),ji(e,n,o,l,"hours",s),ji(e,r,a,l,"minutes",0),Gi(e,n,o,l,"hours",s),Gi(e,r,a,l,"minutes",59),l&&((e,t,i)=>{t.addEventListener("click",(s=>{e.selectedKeeping=t.innerText.includes("AM")?"PM":"AM",t.innerText=e.selectedKeeping,i.value=$i(e.selectedHours,e.selectedKeeping),Ui(e,s,e.selectedHours,"hours")}))})(e,l,n)})(e,t,i)})(e),t[e.currentType]()},is={self:null,rangeMin:void 0,rangeMax:void 0},ss=()=>{var e;if(!(null==(e=is.self)?void 0:e.HTMLElement))return;const{CSSClasses:t}=is.self;is.self.HTMLElement.querySelectorAll(`.${is.self.CSSClasses.dayBtnHover}`).forEach((e=>{var i;e.classList.remove(is.self.CSSClasses.dayBtnHover),null==(i=e.parentElement)||i.classList.remove(t.dayHoverIntermediate,t.dayHoverFirst,t.dayHoverLast)}))},ns=(e,t,i)=>{var s,n,r;if(!(null==(s=is.self)?void 0:s.selectedDates))return;const o=di(e),{CSSClasses:a}=is.self;if(null==(n=is.self.rangeDisabled)?void 0:n.includes(o))return;const l=null==(r=is.self.HTMLElement)?void 0:r.querySelectorAll(`[data-calendar-day="${o}"]`);null==l||l.forEach((e=>{var t;e.classList.add(a.dayBtnHover),null==(t=e.parentElement)||t.classList.add(a.dayHoverIntermediate)})),null==t||t.forEach((e=>{var t;return null==(t=e.parentElement)?void 0:t.classList.add(a.dayHoverFirst)})),null==i||i.forEach((e=>{var t;return null==(t=e.parentElement)?void 0:t.classList.add(a.dayHoverLast)}))},rs=e=>{var t;if(!e.target||!(null==(t=is.self)?void 0:t.selectedDates))return;if(!e.target.closest(`.${is.self.CSSClasses.days}`))return void ss();const i=e.target.closest("[data-calendar-day]");if(!i)return;const s=i.dataset.calendarDay,n=ui(is.self.selectedDates[0]),r=ui(s),o=is.self.HTMLElement.querySelectorAll(`[data-calendar-day="${is.self.selectedDates[0]}"]`),a=is.self.HTMLElement.querySelectorAll(`[data-calendar-day="${s}"]`),[l,h]=n<r?[o,a]:[a,o],[c,d]=n<r?[n,r]:[r,n];ss();for(let e=new Date(c);e<=d;e.setDate(e.getDate()+1))ns(e,l,h)},os=e=>{is.self&&"Escape"===e.key&&(is.self.selectedDates=[],is.self.HTMLElement.removeEventListener("mousemove",rs),document.removeEventListener("keydown",os),ts(is.self))},as=(e,t)=>{var i;if(t){const s=1===e.selectedDates.length&&e.selectedDates[0].includes(t);e.selectedDates=s&&!e.settings.selection.cancelableDay?[t,t]:s&&e.settings.selection.cancelableDay?[]:e.selectedDates.length>1?[t]:[...e.selectedDates,t],null==(i=e.selectedDates)||i.sort(((e,t)=>+new Date(e)-+new Date(t)))}e.settings.range.disableGaps&&(is.rangeMin=is.rangeMin?is.rangeMin:e.rangeMin,is.rangeMax=is.rangeMax?is.rangeMax:e.rangeMax),is.self=e,{set:()=>{e.HTMLElement.addEventListener("mousemove",rs),document.addEventListener("keydown",os),e.settings.range.disableGaps&&(()=>{var e,t,i;if(!(null==(t=null==(e=is.self)?void 0:e.selectedDates)?void 0:t[0])||!(null==(i=is.self.rangeDisabled)?void 0:i[0]))return;const s=ui(is.self.selectedDates[0]),[n,r]=is.self.rangeDisabled.map((e=>ui(e))).reduce((([e,t],i)=>[s>=i?i:e,s<i&&null===t?i:t]),[null,null]);n&&(is.self.rangeMin=di(new Date(n.setDate(n.getDate()+1)))),r&&(is.self.rangeMax=di(new Date(r.setDate(r.getDate()-1))))})()},reset:()=>{const[t,i]=[e.selectedDates[0],e.selectedDates[e.selectedDates.length-1]];e.selectedDates=e.selectedDates[0]!==e.selectedDates[e.selectedDates.length-1]?e.settings.range.edgesOnly?[t,i]:pi([`${t}:${i}`]):[e.selectedDates[0],e.selectedDates[0]],e.HTMLElement.removeEventListener("mousemove",rs),document.removeEventListener("keydown",os),e.settings.range.disableGaps&&is.self&&(is.self.rangeMin=is.rangeMin,is.self.rangeMax=is.rangeMax)}}[1===e.selectedDates.length?"set":"reset"]()},ls=(e,t,i)=>{if(!t.dataset.calendarDay)return;const s=t.dataset.calendarDay,n=t.classList.contains(e.CSSClasses.dayBtnSelected);if(n&&!e.settings.selection.cancelableDay)return;let r=!0;void 0!==e.toggleSelected&&(r="function"==typeof e.toggleSelected?e.toggleSelected(e):e.toggleSelected),n&&!r||(e.selectedDates=n?e.selectedDates.filter((e=>e!==s)):i?[...e.selectedDates,s]:[s])},hs=(e,t,i,s,n)=>{const r=e.HTMLElement.querySelectorAll(`.${e.CSSClasses.column}`),o=Array.from(r).findIndex((e=>e.classList.contains(t))),a=Number(r[o].querySelector(`.${i}`).getAttribute(n));return"month"===e.currentType&&o>=0?s-o:"year"===e.currentType&&e.selectedYear!==a?s-1:s},cs=(e,t,i,s)=>{if(!e.settings.selection[i])return;const n=t.target,r=e=>n.closest(`.${e}`),o=r(s.header),a=r(s.item),l=r(e.CSSClasses.grid),h=r(e.CSSClasses.column);e.currentType!==i&&o?{year:()=>Li(e,n),month:()=>zi(e,n)}[i]():a?((e,t,i,s,n)=>{const r={year:()=>{var i,s;return null==(s=(i=e.actions).clickYear)?void 0:s.call(i,t,e)},month:()=>{var i,s;return null==(s=(i=e.actions).clickMonth)?void 0:s.call(i,t,e)}};({year:()=>{if("multiple"===e.type){const t=hs(e,e.CSSClasses.columnYear,e.CSSClasses.year,Number(n.dataset.calendarYear),"data-calendar-selected-year"),i=e.selectedMonth<e.dateMin.getMonth()&&t<=e.dateMin.getFullYear(),s=e.selectedMonth>e.dateMax.getMonth()&&t>=e.dateMax.getFullYear(),r=t<e.dateMin.getFullYear(),o=t>e.dateMax.getFullYear();i||r?(e.selectedYear=e.dateMin.getFullYear(),e.selectedMonth=e.dateMin.getMonth()):s||o?(e.selectedYear=e.dateMax.getFullYear(),e.selectedMonth=e.dateMax.getMonth()):e.selectedYear=t}else e.selectedYear=Number(n.dataset.calendarYear)},month:()=>{if("multiple"===e.type){const t=hs(e,e.CSSClasses.columnMonth,e.CSSClasses.month,Number(n.dataset.calendarMonth),"data-calendar-selected-month"),i=n.closest(`.${s.column}`).querySelector(`.${e.CSSClasses.year}`);e.selectedYear=Number(i.dataset.calendarSelectedYear);const r=t<e.dateMin.getMonth()&&e.selectedYear<=e.dateMin.getFullYear(),o=t>e.dateMax.getMonth()&&e.selectedYear>=e.dateMax.getFullYear();e.selectedMonth=r?e.dateMin.getMonth():o?e.dateMax.getMonth():t}else e.selectedMonth=Number(n.dataset.calendarMonth)}})[i](),r[i](),e.currentType=e.type,ts(e)})(e,t,i,s,a):(e.currentType===i&&o||"multiple"===e.type&&e.currentType===i&&l&&!h)&&(e.currentType=e.type,ts(e))},ds=e=>{const t=t=>{((e,t)=>{const i=t.target.closest(`.${e.CSSClasses.arrow}`);i&&(["default","multiple"].includes(e.currentType)?Ii(e,i.dataset.calendarArrow):"year"===e.currentType&&void 0!==e.viewYear&&(e.viewYear+={prev:-15,next:15}[i.dataset.calendarArrow],Li(e,t.target)),e.actions.clickArrow&&e.actions.clickArrow(t,e))})(e,t),((e,t)=>{var i;if(!e.settings.visibility.weekNumbers||!e.actions.clickWeekNumber)return;const s=t.target.closest(`.${e.CSSClasses.weekNumber}`),n=null==(i=e.HTMLElement)?void 0:i.querySelectorAll("[data-calendar-week-number]");if(!s||!n)return;const r=Number(s.innerText),o=Number(s.dataset.calendarYearWeek),a=Array.from(n).filter((e=>Number(e.dataset.calendarWeekNumber)===r));e.actions.clickWeekNumber(t,r,a,o,e)})(e,t),((e,t)=>{var i;const s=t.target,n=e=>s.closest(`.${e}`),r=n(e.CSSClasses.dayBtn);if(!e.settings.selection.day||!["single","multiple","multiple-ranged"].includes(e.settings.selection.day)||!r)return;({single:()=>ls(e,r,!1),multiple:()=>ls(e,r,!0),"multiple-ranged":()=>as(e,r.dataset.calendarDay)})[e.settings.selection.day](),null==(i=e.selectedDates)||i.sort(((e,t)=>+new Date(e)-+new Date(t))),e.actions.clickDay&&e.actions.clickDay(t,e),e.input&&e.HTMLInputElement&&e.HTMLElement&&e.actions.changeToInput&&e.actions.changeToInput(t,e);const o=n(e.CSSClasses.dayBtnPrev),a=n(e.CSSClasses.dayBtnNext);({prev:()=>Ii(e,"prev"),next:()=>Ii(e,"next"),default:()=>Oi(e)})[o?"prev":a?"next":"default"]()})(e,t),cs(e,t,"month",{header:e.CSSClasses.month,item:e.CSSClasses.monthsMonth,column:e.CSSClasses.columnMonth}),cs(e,t,"year",{header:e.CSSClasses.year,item:e.CSSClasses.yearsYear,column:e.CSSClasses.columnYear})};return e.HTMLElement.addEventListener("click",t),()=>e.HTMLElement.removeEventListener("click",t)},us=(e,{year:t,month:i,dates:s,holidays:n,time:r}={})=>{var o;const a=ni({},e.settings.selected);e.settings.selected.year=t?a.year:e.selectedYear,e.settings.selected.month=i?a.month:e.selectedMonth,e.settings.selected.holidays=n?a.holidays:e.selectedHolidays,e.settings.selected.time=r?a.time:e.selectedTime,e.settings.selected.dates="only-first"===s&&(null==(o=e.selectedDates)?void 0:o[0])?[e.selectedDates[0]]:!0===s?a.dates:e.selectedDates,_i(e),ts(e),e.settings.selected=a,"multiple-ranged"===e.settings.selection.day&&s&&as(e)},ps=(e,t=!0)=>{e.isInputInit=!0;const i=document.createElement("div");return i.className=`${e.CSSClasses.calendar} ${e.CSSClasses.calendarToInput} ${e.CSSClasses.calendarHidden}`,e.HTMLElement=i,document.body.appendChild(e.HTMLElement),e.HTMLElement.style.visibility="hidden",t&&queueMicrotask((()=>{Ei(e.HTMLInputElement,i,e.settings.visibility.positionToInput,e.CSSClasses),e.HTMLElement.style.visibility="visible",e.show()})),us(e,{year:!0,month:!0,dates:!0,holidays:!0,time:!0}),e.actions.initCalendar&&e.actions.initCalendar(e),ds(e)};class ms extends ci{constructor(e,t){if(super(),ri(this,"init",(()=>{return(e=this).HTMLOriginalElement=e.HTMLElement.cloneNode(!0),e.isInit=!0,e.input?(e=>{const t=[];e.HTMLInputElement=e.HTMLElement;const i=()=>Ei(e.HTMLInputElement,e.HTMLElement,e.settings.visibility.positionToInput,e.CSSClasses),s=t=>{"Escape"===t.key&&((null==e?void 0:e.HTMLInputElement)&&(null==e?void 0:e.HTMLElement)&&e.hide(),document.removeEventListener("keydown",s))},n=t=>{var s;e&&t.target!==e.HTMLInputElement&&!(null==(s=e.HTMLElement)?void 0:s.contains(t.target))&&(e.HTMLInputElement&&e.HTMLElement&&e.hide(),window.removeEventListener("resize",i),document.removeEventListener("click",n,{capture:!0}))},r=()=>{e.isInputInit?(Ei(e.HTMLInputElement,e.HTMLElement,e.settings.visibility.positionToInput,e.CSSClasses),e.HTMLElement.style.visibility="visible",e.show()):t.push(ps(e)),window.addEventListener("resize",i),document.addEventListener("click",n,{capture:!0}),document.addEventListener("keydown",s)};return e.HTMLInputElement.addEventListener("click",r),e.HTMLInputElement.addEventListener("focus",r),()=>{t.forEach((e=>e()))}})(e):(_i(e),ts(e),e.actions.initCalendar&&e.actions.initCalendar(e),ds(e));var e})),ri(this,"update",(e=>((e,{year:t,month:i,dates:s,holidays:n,time:r}={})=>{if(!e.isInit)throw new Error(gi);e.input&&!e.isInputInit&&ps(e,!1),us(e,{year:t,month:i,dates:s,holidays:n,time:r}),e.actions.updateCalendar&&e.actions.updateCalendar(e)})(this,e))),ri(this,"destroy",(()=>(e=>{var t,i,s,n,r,o;if(!e.isInit)throw new Error(gi);e.input?(null==(i=null==(t=e.HTMLElement)?void 0:t.parentElement)||i.removeChild(e.HTMLElement),null==(n=null==(s=e.HTMLInputElement)?void 0:s.replaceWith)||n.call(s,e.HTMLOriginalElement),e.HTMLInputElement=void 0):null==(o=null==(r=e.HTMLElement)?void 0:r.replaceWith)||o.call(r,e.HTMLOriginalElement),e.HTMLElement=e.HTMLOriginalElement,e.actions.destroyCalendar&&e.actions.destroyCalendar(e)})(this))),ri(this,"show",(()=>{var e;(e=this).currentType?(e.HTMLElement.classList.remove(e.CSSClasses.calendarHidden),e.actions.showCalendar&&e.actions.showCalendar(e)):e.HTMLElement.click()})),ri(this,"hide",(()=>{var e;(e=this).currentType&&(e.HTMLElement.classList.add(e.CSSClasses.calendarHidden),e.actions.hideCalendar&&e.actions.hideCalendar(e))})),this.HTMLElement="string"==typeof e?document.querySelector(e):e,!this.HTMLElement)throw new Error((e=>`${e} is not found, check the first argument passed to new VanillaCalendar.`)(e));if(!t)return;const i=(e,t)=>{Object.keys(t).forEach((s=>{"object"!=typeof e[s]||"object"!=typeof t[s]||t[s]instanceof Date?e[s]=t[s]:i(e[s],t[s])}))};i(this,t)}}class fs{constructor(e){this.translaterService=e,this._clearFilterTriggered=!1,this._lastClickIsDate=!1,this._shouldTriggerQuery=!0,this.hasTimePicker=!1,this.inputFilterType="range",this.searchTerms=[],this._bindEventService=new Wt}get gridOptions(){return this.grid?.getOptions()??{}}get columnFilter(){return this.columnDef?.filter||{}}get currentDateOrDates(){return this._currentDateOrDates}get defaultOperator(){return"compound"===this.inputFilterType?k.empty:this.gridOptions.defaultFilterRangeOperator||k.rangeInclusive}get pickerOptions(){return this._pickerOptions||{}}get filterOptions(){return{...this.gridOptions.defaultFilterOptions?.date,...this.columnFilter?.filterOptions}}get operator(){return"compound"===this.inputFilterType?this._operator||this.columnFilter.operator||this.defaultOperator:this.columnFilter?.operator??this.defaultOperator}set operator(e){"compound"===this.inputFilterType?this._operator=e:this.columnFilter&&(this.columnFilter.operator=e)}init(e){if(!e)throw new Error('[Slickgrid-Universal] A filter must always have an "init()" with valid arguments.');this.grid=e.grid,this.callback=e.callback,this.columnDef=e.columnDef,"compound"===this.inputFilterType&&(this.operator=e.operator||""),this.searchTerms=e?.searchTerms??[],this.filterContainerElm=e.filterContainerElm;const t="compound"===this.inputFilterType?Array.isArray(this.searchTerms)&&this.searchTerms.length>=0?this.searchTerms[0]:"":this.searchTerms;this._filterElm=this.createDomFilterElement(t),this.updateFilterStyle(this.searchTerms.length>0),this._selectOperatorElm&&this._bindEventService.bind(this._selectOperatorElm,"change",this.onTriggerEvent.bind(this)),this._bindEventService.bind(document.body,"keydown",(e=>{"Escape"!==e.key&&"Tab"!==e.key||this.hide()})),this._bindEventService.bind(this._dateInputElm,"keydown",(e=>{"Backspace"===e.key&&this.clear(!0,!1)}))}clear(e=!0,t=!0){if(this.calendarInstance&&(this._clearFilterTriggered=t,this._shouldTriggerQuery=e,this._currentValue="",this.searchTerms=[],this._currentDateStrings=[],this._selectOperatorElm&&(this._selectOperatorElm.selectedIndex=0),this.calendarInstance)){const e=new Date;qt(this.columnFilter,this._dateInputElm,this.calendarInstance,{columnDef:this.columnDef,oldVal:this._currentDateOrDates,newVal:"",updatePickerUI:!0,selectedSettings:{dates:[],month:e.getMonth(),year:e.getFullYear()}})}this.onTriggerEvent(new Event("keyup")),this.updateFilterStyle(!1)}destroy(){this._bindEventService.unbindAll(),this.calendarInstance?.destroy(),re(this.filterContainerElm),this.filterContainerElm?.remove(),this._selectOperatorElm?.remove(),this._filterElm?.remove()}hide(){"function"==typeof this.calendarInstance?.hide&&this.calendarInstance.hide()}show(){"function"==typeof this.calendarInstance?.show&&this.calendarInstance.show()}getValues(){return this._currentDateOrDates}setValues(e,t,i=!1){let s;"compound"===this.inputFilterType?s=Array.isArray(e)?e[0]:e:"string"==typeof e||Array.isArray(e)&&"string"==typeof e[0]&&e[0].indexOf("..")>0?s="string"==typeof e?[e]:e[0].split(".."):Array.isArray(e)&&(s=e),this.calendarInstance&&void 0!==s&&(qt(this.columnFilter,this._dateInputElm,this.calendarInstance,{columnDef:this.columnDef,newVal:s,updatePickerUI:!0}),this._currentDateOrDates=e&&s?s:void 0);const n=this.getValues()||[],r=Array.isArray(n)?n:[n];if(this.updateFilterStyle(r.length>0),this.operator=t||this.defaultOperator,t&&this._selectOperatorElm){const e=Y(this.operator);this._selectOperatorElm.value=e}i&&this.callback(void 0,{columnDef:this.columnDef,searchTerms:r,operator:this.operator,shouldTriggerQuery:!0})}buildDatePickerInput(e){const t=this.columnDef?.id??"",i=this.columnFilter.type||this.columnDef.type||E.dateIso,s=this.columnDef.outputType||this.columnFilter.type||this.columnDef.type||E.dateUtc,n=Lt(s),r=this.columnFilter.type||this.columnDef.type||E.dateIso;n&&"range"!==this.inputFilterType&&("ISO8601"===n||n.toLowerCase().includes("h"))&&(this.hasTimePicker=!0);const o=Lt(this.hasTimePicker?E.dateTimeIsoAM_PM:E.dateIso),a=(this.filterOptions?.locale??this.translaterService?.getCurrentLanguage?.())||this.gridOptions.locale||"en";let l;"compound"===this.inputFilterType?e&&(l=e,this._currentDateOrDates=e):("string"==typeof e||Array.isArray(e)&&"string"==typeof e[0]&&e[0].indexOf("..")>0?l="string"==typeof e?[e]:e[0].split(".."):Array.isArray(e)&&(l=e),Array.isArray(l)&&(this._currentDateOrDates=l,this._currentDateStrings=l.map((e=>Mt(e,void 0,r)))));const h={input:!0,jumpToSelectedDate:!0,type:"range"===this.inputFilterType?"multiple":"default",sanitizer:e=>this.grid.sanitizeHtmlString(e),toggleSelected:!1,actions:{clickDay:e=>{this._lastClickIsDate=!0},changeToInput:(e,t)=>{if(t.HTMLInputElement){let e=[],r="",a="";if(t.selectedDates[1]){t.selectedDates.sort(((e,t)=>+new Date(e)-+new Date(t))),r=t.selectedDates[0],a=t.selectedDates[t.selectedDates.length-1];const i=Dt(t.selectedDates[0],n,"en-US"),s=Dt(a,n,"en-US");t.HTMLInputElement.value=`${i} â ${s}`,e=[r,a]}else t.selectedDates[0]?(r=t.selectedDates[0],t.HTMLInputElement.value=Mt(r,E.dateIso,s),e=t.selectedDates):t.HTMLInputElement.value="";if(this.hasTimePicker&&r){const i=Pt(r,o);i.setHours(+(t.selectedHours||0)),i.setMinutes(+(t.selectedMinutes||0)),t.HTMLInputElement.value=Mt(i,void 0,s),e=[i]}if("compound"===this.inputFilterType?this._currentValue=Mt(e[0],void 0,i):Array.isArray(e)&&(this._currentDateStrings=e.map((e=>Mt(e,void 0,i))),this._currentValue=this._currentDateStrings.join("..")),this._currentDateOrDates=e.map((e=>e instanceof Date?e:Pt(e,o))),this._currentValue){const e=this.hasTimePicker?new Event("keyup"):void 0;this.onTriggerEvent(e)}"range"===this.inputFilterType&&t.selectedDates.length<2&&(this._lastClickIsDate=!1),this._lastClickIsDate&&(t.hide(),this._lastClickIsDate=!1)}}},settings:{lang:a,iso8601:!1,visibility:{theme:this.gridOptions?.darkMode?"dark":"light",positionToInput:"auto",weekend:!1}}};"range"===this.inputFilterType&&(h.type="multiple",h.months=2,h.jumpMonths=2,h.settings={...h.settings,range:{edgesOnly:!0},selection:{day:"multiple-ranged"},visibility:{...h.settings?.visibility,daysOutside:!1}}),this.hasTimePicker&&(h.settings.selection??={},h.settings.selection.time=24),this._pickerOptions=Te(!0,{},h,{settings:this.filterOptions});let c=this.gridOptions?.defaultFilterPlaceholder??"";this.columnFilter?.placeholder&&(c=this.columnFilter.placeholder),this._dateInputElm=ie("input",{type:"text",className:"form-control date-picker",placeholder:c,readOnly:!0,dataset:{input:"",columnid:`${t}`}}),this.calendarInstance=new ms(this._dateInputElm,this._pickerOptions),this.calendarInstance.init(),this._pickerOptions.settings?.selected?.dates&&(l=this._pickerOptions.settings.selected.dates),l&&qt(this.columnFilter,this._dateInputElm,this.calendarInstance,{columnDef:this.columnDef,oldVal:void 0,newVal:l,updatePickerUI:!1})}getOperatorOptionValues(){let e;return e=this.columnFilter?.compoundOperatorList?this.columnFilter.compoundOperatorList:Zt(this.gridOptions,this.translaterService),Qt(this.gridOptions,e,"numeric"),e}createDomFilterElement(e){const t=this.columnDef?.id??"";if(re(this.filterContainerElm),this.buildDatePickerInput(e),"range"===this.inputFilterType){const i=ie("div",{className:`date-picker form-group search-filter filter-${t}`});return Array.isArray(e)&&e.length>0&&""!==e[0]&&(this._currentDateOrDates=e,this._currentValue=e[0]),i.appendChild(this._dateInputElm),i&&this.filterContainerElm.appendChild(i),i}{this._selectOperatorElm=Kt(this.getOperatorOptionValues(),this.grid);const i=ie("div",{className:`date-picker form-group search-filter filter-${t}`}),s=ie("div",{className:"input-group date-picker"},i);if(ie("div",{className:"input-group-addon input-group-prepend operator"},s).appendChild(this._selectOperatorElm),s.appendChild(this._dateInputElm),this.operator){const e=Y(this.operator);this._selectOperatorElm.value=e}return this._currentDateOrDates=e,this._currentValue=e,i&&this.filterContainerElm.appendChild(i),i}}onTriggerEvent(e){if(this._clearFilterTriggered)this.callback(e,{columnDef:this.columnDef,clearFilterTriggered:this._clearFilterTriggered,shouldTriggerQuery:this._shouldTriggerQuery}),this.updateFilterStyle(!1);else if("range"===this.inputFilterType){const t=this._currentDateStrings?this._currentDateStrings:[this._currentValue];this.updateFilterStyle(t.length>0),this.callback(e,{columnDef:this.columnDef,searchTerms:t,operator:this.operator||"",shouldTriggerQuery:this._shouldTriggerQuery})}else if("compound"===this.inputFilterType&&this._selectOperatorElm){const t=this._selectOperatorElm.value;this.updateFilterStyle(!!this._currentValue);const i=this.columnFilter.skipCompoundOperatorFilterWithNullInput??this.gridOptions.skipCompoundOperatorFilterWithNullInput??void 0===this.gridOptions.skipCompoundOperatorFilterWithNullInput,s=i&&Me(this._currentDateOrDates)||""===this._currentDateOrDates&&Me(this._lastSearchValue);i&&i&&!s||this.callback(e,{columnDef:this.columnDef,searchTerms:this._currentValue?[this._currentValue]:null,operator:t||"",shouldTriggerQuery:this._shouldTriggerQuery})}this._clearFilterTriggered=!1,this._shouldTriggerQuery=!0,this._lastSearchValue=this._currentValue}updateFilterStyle(e){e?this._filterElm.classList.add("filled"):this._filterElm.classList.remove("filled")}}class gs{constructor(e){this.translaterService=e}filterCollection(e,t,i=T.chain){let s=[];return Array.isArray(t)?(s=i===T.merge?[]:[...e],t.forEach((t=>{if(i===T.merge){const i=this.singleFilterCollection(e,t);s=Xe([...s,...i])}else s=this.singleFilterCollection(s,t)}))):s=this.singleFilterCollection(e,t),s}preParseByMutationDateItems(e,t,i){const s=[];t.getColumns().forEach((e=>{const t=this.getParseDateInfo(e,i);t&&s.push(t)})),e.forEach((e=>{s.forEach((({columnId:t,dateFormat:i,queryFieldName:s})=>{this.reassignDateWhenValid(e,t,i,s)}))}))}parseSingleDateItem(e,t,i){i&&t.getColumns().forEach((t=>{const s=this.getParseDateInfo(t,i);s&&this.reassignDateWhenValid(e,t.id,s.dateFormat,s.queryFieldName)}))}singleFilterCollection(e,t){let i=[];if(t){const s=t.property,n=t.operator||k.equal,r=void 0===t.value?"":t.value;switch(n){case k.equal:i=s?e.filter((e=>e[s]===r)):e.filter((e=>e===r));break;case k.contains:i=s?e.filter((e=>-1!==e[s]?.toString().indexOf(r.toString()))):e.filter((e=>null!=e&&-1!==e.toString().indexOf(r.toString())));break;case k.notContains:i=s?e.filter((e=>-1===e[s]?.toString().indexOf(r.toString()))):e.filter((e=>null!=e&&-1===e.toString().indexOf(r.toString())));break;case k.notEqual:default:i=s?e.filter((e=>e[s]!==r)):e.filter((e=>e!==r))}}return i}sortCollection(e,t,i,s){if(s&&(!this.translaterService||!this.translaterService.translate))throw new Error('[Slickgrid-Universal] requires a Translate Service to be installed and configured when the grid option "enableTranslate" is enabled.');let n=[];if(i)if(Array.isArray(i))n=t.sort(((t,n)=>{for(let r=0,o=i.length;r<o;r++){const o=i[r];if(o?.property){const i=o.sortDesc?A.desc:A.asc,r=o.property,a=Ht(o?.fieldType??e?.type??E.string,s?this.translaterService?.translate?.(t[r]||" "):t[r],s?this.translaterService?.translate?.(n[r]||" "):n[r],i,e);if(a!==A.neutral)return a}}return A.neutral}));else if(i?.property){const r=i.property,o=i.sortDesc?A.desc:A.asc,a=i?.fieldType??e?.type??E.string;n=t.sort(((t,i)=>{const n=s?this.translaterService?.translate&&this.translaterService.translate(t[r]||" "):t[r],l=s?this.translaterService?.translate&&this.translaterService.translate(i[r]||" "):i[r],h=Ht(a,n,l,o,e);return h!==A.neutral?h:A.neutral}))}else if(i&&!i.property){const r=i.sortDesc?A.desc:A.asc,o=i?.fieldType??e?.type??E.string;n=t.sort(((t,i)=>{const n=s?this.translaterService?.translate&&this.translaterService.translate(t||" "):t,a=s?this.translaterService?.translate&&this.translaterService.translate(i||" "):i,l=Ht(o,n,a,r,e);return l!==A.neutral?l:A.neutral}))}return n}getParseDateInfo(e,t){const i=e.type||E.string,s=Lt(i);if(q(i)&&t){const i="string"==typeof t?`${t}${e.id}`:`${e.id}`;return{columnId:e.id,dateFormat:s,queryFieldName:i}}}reassignDateWhenValid(e,t,i,s){const n=Nt(e[t],i,!1);n&&(e[s]=n)}}function _s(e,t,i,s,n=!1,r,o){const a=i?.id??"",l=s.getOptions(),h=("editor"===e?i?.editor:i?.filter)??{},c=h?.collectionOptions??{},d=c?.separatorBetweenTextLabels??"",u=h?.enableTranslateLabel??!1,p=l?.enableTranslate??!1,m=h?.enableRenderHtml??!1,f=h?.customStructure?.label??"label",g=h?.customStructure?.labelPrefix??"labelPrefix",_=h?.customStructure?.labelSuffix??"labelSuffix",v=h?.customStructure?.optionLabel??"value",b=h?.customStructure?.value??"value",y=ie("select",{className:"ms-filter search-filter"}),C="filter"===e?["search-filter",`filter-${a}`]:["select-editor",`editor-${a}`];y.classList.add(...C),y.multiple=n;const w=[];let S=!1;return Array.isArray(t)&&(t.every((e=>"number"==typeof e||"string"==typeof e))?t.forEach((t=>{const i={text:String(t),value:t};"filter"===e&&Array.isArray(o)&&(i.selected=o.findIndex((e=>e===t))>=0),w.push(i),(i.selected&&n||i.selected&&!n&&""!==t)&&(S=!0)})):t.forEach((t=>{if(void 0===t||"object"==typeof t&&void 0===t[f]&&void 0===t.labelKey)throw new Error("[Slickgrid-Universal] Select Filter/Editor collection with value/label (or value/labelKey when using Locale) is required to populate the Select list, for example:: { filter: model: Filters.multipleSelect, collection: [ { value: '1', label: 'One' } ]')");const i=t.labelKey||t[f],a=(t.labelKey||u&&r)&&i&&p?r?.translate(i||" "):i;let l=t[g]||"",h=t[_]||"",c=t.hasOwnProperty(v)?t[v]:"";c?.toString&&(c=c.toString().replace(/"/g,"'")),l=u&&r&&l&&"string"==typeof l?r.translate(l||" "):l,h=u&&r&&h&&"string"==typeof h?r.translate(h||" "):h,c=u&&r&&c&&"string"==typeof c?r.translate(c||" "):c;let y=[l,"string"==typeof a||"number"==typeof a?a.toString():a,h].filter((e=>e)).join(d);const C={text:"",value:""};m&&(y=s.sanitizeHtmlString(y)),C.text=y;let E=t[b];null==E&&(E=""),"filter"===e&&Array.isArray(o)&&(C.selected=o.findIndex((e=>`${e}`==`${t[b]}`))>=0),C.value=`${E??""}`,w.push(C),(C.selected&&n||C.selected&&!n&&""!==t[b])&&(S=!0)}))),{selectElement:y,dataCollection:w,hasFoundSearchTerm:S}}class vs{constructor(e,t,i){this.sharedService=e,this.backendUtilities=t,this.translaterService=i}getPickerTitleOutputString(e,t){if(this.sharedService.gridOptions?.enableTranslate&&!this.translaterService?.translate)throw new Error('[Slickgrid-Universal] requires a Translate Service to be installed and configured when the grid option "enableTranslate" is enabled.');let i="";const s=this.sharedService.gridOptions?.[t]??{},n=this.sharedService.gridOptions?.enableTranslate??!1,r=this.sharedService.gridOptions?.locales??y.locales,o=s?.[e],a=s?.[`${e}Key`],l=j(this.sharedService.gridOptions);if(a&&this.translaterService?.translate)i=this.translaterService.translate(a||" ");else switch(e){case"commandTitle":i=o||n&&this.translaterService?.getCurrentLanguage&&this.translaterService?.translate(`${l}COMMANDS`)||r?.TEXT_COMMANDS;break;case"columnTitle":i=o||n&&this.translaterService?.getCurrentLanguage&&this.translaterService?.translate(`${l}COLUMNS`)||r?.TEXT_COLUMNS;break;case"forceFitTitle":i=o||n&&this.translaterService?.getCurrentLanguage&&this.translaterService?.translate(`${l}FORCE_FIT_COLUMNS`)||r?.TEXT_FORCE_FIT_COLUMNS;break;case"syncResizeTitle":i=o||n&&this.translaterService?.getCurrentLanguage&&this.translaterService?.translate(`${l}SYNCHRONOUS_RESIZE`)||r?.TEXT_SYNCHRONOUS_RESIZE;break;default:i=o}return i}readjustFrozenColumnIndexWhenNeeded(e,t,i){if(e>=0){const s=i.findIndex((e=>e.id===this.sharedService.frozenVisibleColumnId));s>=0&&s!==e&&(this.sharedService.gridOptions.frozenColumn=s,this.sharedService.slickGrid.setOptions({frozenColumn:s})),Array.isArray(i)&&Array.isArray(t)&&i.length!==t.length&&this.sharedService.slickGrid.setColumns(i)}}refreshBackendDataset(e){let t=this.sharedService.gridOptions;e&&(t={...this.sharedService.gridOptions,...e},this.sharedService.gridOptions=t),this.backendUtilities?.refreshBackendDataset(t)}runOverrideFunctionWhenExists(e,t){return"function"!=typeof e||!!e.call(this,t)}sortItems(e,t){Array.isArray(e)&&e.sort(((e,i)=>e&&i&&e.hasOwnProperty(t)&&i.hasOwnProperty(t)?e[t]-i[t]:0))}translateItems(e,t,i){if(Array.isArray(e))for(const s of e)s.hasOwnProperty(t)&&(s[i]=this.translaterService?.translate?.(s[t]))}translateMenuItemsFromTitleKey(e,t="commandItems"){for(const i of e)"object"==typeof i&&(i.titleKey&&(i.title=this.translateWhenEnabledAndServiceExist(`${i.titleKey}`,`TEXT_${i.titleKey}`)),i.subMenuTitleKey&&(i.subMenuTitle=this.translateWhenEnabledAndServiceExist(`${i.subMenuTitleKey}`,`TEXT_${i.subMenuTitleKey}`))),Array.isArray(i?.[t])&&this.translateMenuItemsFromTitleKey(i?.[t])}translateWhenEnabledAndServiceExist(e,t,i){let s="";const n=this.sharedService?.gridOptions,r=n?.locales??y.locales;return s=i||(n.enableTranslate&&this.translaterService?.translate?this.translaterService.translate(e||" "):t in r?r[t]:t),s}}class bs{get defaultPrevented(){return this._isDefaultPrevented}constructor(e,t){this.event=e,this.args=t,this._isPropagationStopped=!1,this._isImmediatePropagationStopped=!1,this._isDefaultPrevented=!1,this.returnValue=void 0,this.nativeEvent=e,this._arguments=t,e&&["altKey","ctrlKey","metaKey","shiftKey","key","keyCode","clientX","clientY","offsetX","offsetY","pageX","pageY","bubbles","target","type","which","x","y"].forEach((t=>this[t]=e[t])),this._eventTarget=this.nativeEvent?this.nativeEvent.target:void 0}stopPropagation(){this._isPropagationStopped=!0,this.nativeEvent?.stopPropagation()}isPropagationStopped(){return this._isPropagationStopped}stopImmediatePropagation(){this._isImmediatePropagationStopped=!0,this.nativeEvent&&this.nativeEvent.stopImmediatePropagation()}isImmediatePropagationStopped(){return this._isImmediatePropagationStopped}getNativeEvent(){return this.nativeEvent}preventDefault(){this.nativeEvent&&this.nativeEvent.preventDefault(),this._isDefaultPrevented=!0}isDefaultPrevented(){return this.nativeEvent?this.nativeEvent.defaultPrevented:this._isDefaultPrevented}addReturnValue(e){void 0===this.returnValue&&void 0!==e&&(this.returnValue=e)}getReturnValue(){return this.returnValue}getArguments(){return this._arguments}resetReturnValue(){this.returnValue=void 0}}class ys{get subscriberCount(){return this._handlers.length}constructor(e,t){this.eventName=e,this.pubSub=t,this._handlers=[],this._pubSubService=t}subscribe(e){this._handlers.push(e)}unsubscribe(e){for(let t=this._handlers.length-1;t>=0;t--)this._handlers[t]===e&&this._handlers.splice(t,1)}notify(e,t,i,s=!1){const n=t instanceof bs?t:new bs(t,e);s&&n.resetReturnValue(),i=i||this;for(let t=0;t<this._handlers.length&&!n.isPropagationStopped()&&!n.isImmediatePropagationStopped();t++){const s=this._handlers[t].call(i,n,e);n.addReturnValue(s)}if("function"==typeof this._pubSubService?.publish&&this.eventName){const t=this._pubSubService.publish(this.eventName,{args:e,eventData:n},void 0,(e=>n.nativeEvent??=e));n.addReturnValue(t)}return n}setPubSubService(e){this._pubSubService=e}}class Cs{constructor(){this.handlers=[]}get subscriberCount(){return this.handlers.length}subscribe(e,t){return this.handlers.push({event:e,handler:t}),e.subscribe(t),this}unsubscribe(e,t){let i=this.handlers.length;for(;i--;)if(this.handlers[i].event===e&&this.handlers[i].handler===t)return this.handlers.splice(i,1),void e.unsubscribe(t);return this}unsubscribeAll(){let e=this.handlers.length;for(;e--;)this.handlers[e].event.unsubscribe(this.handlers[e].handler);return this.handlers=[],this}}class ws{constructor(e,t,i,s){void 0===i&&void 0===s&&(i=e,s=t),this.fromRow=Math.min(e,i),this.fromCell=Math.min(t,s),this.toRow=Math.max(e,i),this.toCell=Math.max(t,s)}isSingleCell(){return this.fromRow===this.toRow&&this.fromCell===this.toCell}isSingleRow(){return this.fromRow===this.toRow}contains(e,t){return e>=this.fromRow&&e<=this.toRow&&t>=this.fromCell&&t<=this.toCell}toString(){return this.isSingleCell()?`(${this.fromRow}:${this.fromCell})`:`(${this.fromRow}:${this.fromCell} - ${this.toRow}:${this.toCell})`}}class Ss{constructor(){this.__nonDataRow=!0}}class Es extends Ss{constructor(){super(),this.__group=!0,this.level=0,this.count=0,this.value=null,this.title=null,this.collapsed=!1,this.selectChecked=!1,this.totals=null,this.rows=[],this.groups=null,this.groupingKey=""}equals(e){return this.value===e.value&&this.count===e.count&&this.collapsed===e.collapsed&&this.title===e.title}}class xs extends Ss{constructor(){super(),this.__groupTotals=!0,this.group=null,this.initialized=!1}}class Ts{static height(e,t){if(e)return void 0===t?e.getBoundingClientRect().height:void Ts.setStyleSize(e,"height",t)}static width(e,t){if(e&&e.getBoundingClientRect)return void 0===t?e.getBoundingClientRect().width:void Ts.setStyleSize(e,"width",t)}static setStyleSize(e,t,i){"function"==typeof i&&(i=i()),e.style[t]="string"==typeof i?i:`${i}px`}static isHidden(e){return 0===e.offsetWidth&&0===e.offsetHeight}static parents(e,t){const i=[],s=":visible"===t,n=":hidden"===t;for(;(e=e.parentNode)&&e!==document&&e&&e.parentNode;)n?Ts.isHidden(e)&&i.push(e):s?Ts.isHidden(e)||i.push(e):t&&!e.matches(t)||i.push(e);return i}static toFloat(e){const t=parseFloat(e);return isNaN(t)?0:t}static show(e,t=""){Array.isArray(e)?e.forEach((e=>e.style.display=t)):e.style.display=t}static hide(e){Array.isArray(e)?e.forEach((e=>e.style.display="none")):e.style.display="none"}static applyDefaults(e,t){"object"==typeof t&&Object.keys(t).forEach((i=>{t.hasOwnProperty(i)&&!e.hasOwnProperty(i)&&(e[i]=t[i])}))}static addSlickEventPubSubWhenDefined(e,t){if(e)for(const i in t)t[i]instanceof ys&&"function"==typeof t[i].setPubSubService&&t[i].setPubSubService(e)}}Ts.storage={_storage:new WeakMap,put:function(e,t,i){this._storage.has(e)||this._storage.set(e,new Map),this._storage.get(e).set(t,i)},get:function(e,t){const i=this._storage.get(e);return i?i.get(t):null},remove:function(e,t){const i=this._storage.get(e).delete(t);return 0!==this._storage.get(e).size&&this._storage.delete(e),i}};const Os=new class{constructor(){this.activeEditController=null}isActive(e){return e?this.activeEditController===e:null!==this.activeEditController}activate(e){if(e!==this.activeEditController){if(null!==this.activeEditController)throw new Error("SlickEditorLock.activate: an editController is still active, can't activate another editController");if(!e.commitCurrentEdit)throw new Error("SlickEditorLock.activate: editController must implement .commitCurrentEdit()");if(!e.cancelCurrentEdit)throw new Error("SlickEditorLock.activate: editController must implement .cancelCurrentEdit()");this.activeEditController=e}}deactivate(e){if(this.activeEditController){if(this.activeEditController!==e)throw new Error("SlickEditorLock.deactivate: specified editController is not the currently active one");this.activeEditController=null}}commitCurrentEdit(){return!this.activeEditController||this.activeEditController.commitCurrentEdit()}cancelCurrentEdit(){return!this.activeEditController||this.activeEditController.cancelCurrentEdit()}};class ks{constructor(e){this.pluginName="GroupItemMetadataProvider",this._defaults={groupCssClass:"slick-group",groupTitleCssClass:"slick-group-title",totalsCssClass:"slick-group-totals",groupFocusable:!0,indentation:15,totalsFocusable:!1,toggleCssClass:"slick-group-toggle",toggleExpandedCssClass:"expanded",toggleCollapsedCssClass:"collapsed",enableExpandCollapse:!0,groupFormatter:this.defaultGroupCellFormatter.bind(this),totalsFormatter:this.defaultTotalsCellFormatter.bind(this),includeHeaderTotals:!1},this._eventHandler=new Cs,this._options=Te(!0,{},this._defaults,e)}get eventHandler(){return this._eventHandler}get dataView(){return this._grid?.getData()??{}}get gridOptions(){return this._grid?.getOptions()||{}}init(e,t){this._grid=e,this._options={...this._defaults,...t},this._eventHandler.subscribe(e.onClick,this.handleGridClick.bind(this)),this._eventHandler.subscribe(e.onKeyDown,this.handleGridKeyDown.bind(this))}destroy(){this.dispose()}dispose(){this._eventHandler?.unsubscribeAll()}getOptions(){return this._options}setOptions(e){this._options={...this._options,...e}}getGroupRowMetadata(e){return{selectable:!1,focusable:this._options.groupFocusable,cssClasses:`${this._options.groupCssClass} slick-group-level-${e?.level||0}`,formatter:this._options.includeHeaderTotals&&this._options.totalsFormatter||void 0,columns:{0:{colspan:this._options.includeHeaderTotals?"1":"*",formatter:this._options.groupFormatter,editorClass:null}}}}getTotalsRowMetadata(e){return{selectable:!1,focusable:this._options.totalsFocusable,cssClasses:`${this._options.totalsCssClass} slick-group-level-${e?.group?.level||0}`,formatter:this._options.totalsFormatter,editorClass:null}}defaultGroupCellFormatter(e,t,i,s,n){if(!this._options.enableExpandCollapse)return n.title;const r=n.level||0,o=r*(this._options?.indentation??15)+"px",a=n.collapsed?this._options.toggleCollapsedCssClass:this._options.toggleExpandedCssClass,l=this.gridOptions?.preventDocumentFragmentUsage?document.createElement("span"):new DocumentFragment;l.appendChild(ie("span",{className:`${this._options.toggleCssClass} ${a}`,ariaExpanded:String(!n.collapsed),style:{marginLeft:o}}));const h=ie("span",{className:this._options.groupTitleCssClass||""});return h.setAttribute("level",r),n.title instanceof HTMLElement||n.title instanceof DocumentFragment?h.appendChild(n.title):this._grid.applyHtmlCode(h,n.title??""),l.appendChild(h),l}defaultTotalsCellFormatter(e,t,i,s,n,r){return s?.groupTotalsFormatter?.(n,s,r)??""}handleGridClick(e,t){const i=e.target,s=this._grid?.getDataItem(t.row);s instanceof Es&&i.classList.contains(this._options.toggleCssClass||"")&&(this.handleDataViewExpandOrCollapse(s),e.stopImmediatePropagation(),e.preventDefault())}handleGridKeyDown(e){if(this._options.enableExpandCollapse&&" "===e.key){const t=this._grid?.getActiveCell();if(t){const i=this._grid.getDataItem(t.row);i instanceof Es&&(this.handleDataViewExpandOrCollapse(i),e.stopImmediatePropagation(),e.preventDefault())}}}handleDataViewExpandOrCollapse(e){const t=this._grid?.getRenderedRange();this.dataView.setRefreshHints({ignoreDiffsBefore:t.top,ignoreDiffsAfter:t.bottom+1}),e.collapsed?this.dataView.expandGroup(e.groupingKey):this.dataView.collapseGroup(e.groupingKey)}}class Is{constructor(e,t){this.externalPubSub=t,this.defaults={groupItemMetadataProvider:null,inlineFilters:!1,useCSPSafeFilter:!1},this.idProperty="id",this.items=[],this.rows=[],this.idxById=new Map,this.rowsById=void 0,this.filter=null,this.filterCSPSafe=null,this.updated=null,this.suspend=!1,this.isBulkSuspend=!1,this.bulkDeleteIds=new Map,this.sortAsc=!0,this.refreshHints={},this.prevRefreshHints={},this.filteredItems=[],this.filterCache=[],this.groupingInfoDefaults={getter:void 0,formatter:void 0,comparer:(e,t)=>e.value===t.value?0:e.value>t.value?1:-1,predefinedValues:[],aggregators:[],aggregateEmpty:!1,aggregateCollapsed:!1,aggregateChildGroups:!1,collapsed:!1,displayTotalsRow:!0,lazyTotalsCalculation:!1},this.groupingInfos=[],this.groups=[],this.toggledGroupsByLevel=[],this.groupingDelimiter=":|:",this.selectedRowIds=[],this.pagesize=0,this.pagenum=0,this.totalRows=0,this.onBeforePagingInfoChanged=new ys("onBeforePagingInfoChanged",t),this.onGroupExpanded=new ys("onGroupExpanded",t),this.onGroupCollapsed=new ys("onGroupCollapsed",t),this.onPagingInfoChanged=new ys("onPagingInfoChanged",t),this.onRowCountChanged=new ys("onRowCountChanged",t),this.onRowsChanged=new ys("onRowsChanged",t),this.onRowsOrCountChanged=new ys("onRowsOrCountChanged",t),this.onSelectedRowIdsChanged=new ys("onSelectedRowIdsChanged",t),this.onSetItemsCalled=new ys("onSetItemsCalled",t),this._options=Te(!0,{},this.defaults,e)}beginUpdate(e){this.suspend=!0,this.isBulkSuspend=!0===e}endUpdate(){const e=this.isBulkSuspend;this.isBulkSuspend=!1,this.suspend=!1,e&&(this.processBulkDelete(),this.ensureIdUniqueness()),this.refresh()}destroy(){this.items=[],this.idProperty="id",this.idxById=null,this.rowsById=null,this.filter=null,this.filterCSPSafe=null,this.updated=null,this.sortComparer=null,this.filterCache=[],this.filteredItems=[],this.compiledFilter=null,this.compiledFilterCSPSafe=null,this.compiledFilterWithCaching=null,this.compiledFilterWithCachingCSPSafe=null,this._grid&&(this._grid.onSelectedRowsChanged?.unsubscribe(),this._grid.onCellCssStylesChanged?.unsubscribe()),this.onRowsOrCountChanged?.unsubscribe()}setRefreshHints(e){this.refreshHints=e}getFilterArgs(){return this.filterArgs}setFilterArgs(e){this.filterArgs=e}processBulkDelete(){if(!this.idxById)return;let e,t,i=0;for(let s=0,n=this.items.length;s<n;s++){if(t=this.items[s],e=t[this.idProperty],void 0===e)throw new Error("[SlickGrid DataView] Each data element must implement a unique 'id' property");this.bulkDeleteIds.has(e)?this.idxById.delete(e):(this.items[i]=t,this.idxById.set(e,i),++i)}this.items.length=i,this.bulkDeleteIds=new Map}updateIdxById(e){if(this.isBulkSuspend||!this.idxById)return;let t;for(let i=e=e||0,s=this.items.length;i<s;i++){if(t=this.items[i][this.idProperty],void 0===t)throw new Error("[SlickGrid DataView] Each data element must implement a unique 'id' property");this.idxById.set(t,i)}}ensureIdUniqueness(){if(this.isBulkSuspend||!this.idxById)return;let e;for(let t=0,i=this.items.length;t<i;t++)if(e=this.items[t][this.idProperty],void 0===e||this.idxById.get(e)!==t)throw new Error("[SlickGrid DataView] Each data element must implement a unique 'id' property")}getItems(){return this.items}getIdPropertyName(){return this.idProperty}setItems(e,t){void 0!==t&&(this.idProperty=t),this.items=this.filteredItems=e,this.onSetItemsCalled.notify({idProperty:this.idProperty,itemCount:this.items.length},null,this),this.idxById=new Map,this.updateIdxById(),this.ensureIdUniqueness(),this.refresh()}setPagingOptions(e){!1!==this.onBeforePagingInfoChanged.notify(this.getPagingInfo(),null,this).getReturnValue()&&(Me(e.pageSize)&&(this.pagesize=e.pageSize,this.pagenum=this.pagesize?Math.min(this.pagenum,Math.max(0,Math.ceil(this.totalRows/this.pagesize)-1)):0),Me(e.pageNum)&&(this.pagenum=Math.min(e.pageNum,Math.max(0,Math.ceil(this.totalRows/this.pagesize)-1))),this.onPagingInfoChanged.notify(this.getPagingInfo(),null,this),this.refresh())}getPagingInfo(){const e=this.pagesize?Math.max(1,Math.ceil(this.totalRows/this.pagesize)):1;return{pageSize:this.pagesize,pageNum:this.pagenum,totalRows:this.totalRows,totalPages:e,dataView:this}}sort(e,t){this.sortAsc=t,this.sortComparer=e,!1===t&&this.items.reverse(),this.items.sort(e),!1===t&&this.items.reverse(),this.idxById=new Map,this.updateIdxById(),this.refresh()}reSort(){this.sortComparer&&this.sort(this.sortComparer,this.sortAsc)}getFilteredItems(){return this.filteredItems}getFilteredItemCount(){return this.filteredItems.length}getFilter(){return this._options.useCSPSafeFilter?this.filterCSPSafe:this.filter}setFilter(e){this.filterCSPSafe=e,this.filter=e,this._options.inlineFilters&&(this.compiledFilterCSPSafe=this.compileFilterCSPSafe,this.compiledFilterWithCachingCSPSafe=this.compileFilterWithCachingCSPSafe,this.compiledFilter=this.compileFilter(this._options.useCSPSafeFilter),this.compiledFilterWithCaching=this.compileFilterWithCaching(this._options.useCSPSafeFilter)),this.refresh()}getGrouping(){return this.groupingInfos}setGrouping(e){this._options.groupItemMetadataProvider||(this._options.groupItemMetadataProvider=new ks),this.groups=[],this.toggledGroupsByLevel=[],e=e||[],this.groupingInfos=e instanceof Array?e:[e];for(let e=0;e<this.groupingInfos.length;e++){const t=this.groupingInfos[e]=Te(!0,{},this.groupingInfoDefaults,this.groupingInfos[e]);t.getterIsAFn="function"==typeof t.getter,t.compiledAccumulators=[];let i=t.aggregators.length;for(;i--;)t.compiledAccumulators[i]=this.compileAccumulatorLoopCSPSafe(t.aggregators[i]);this.toggledGroupsByLevel[e]={}}this.refresh()}getItemByIdx(e){return this.items[e]}getIdxById(e){return this.idxById?.get(e)}ensureRowsByIdCache(){if(!this.rowsById){this.rowsById={};for(let e=0,t=this.rows.length;e<t;e++)this.rowsById[this.rows[e][this.idProperty]]=e}}getRowByItem(e){return this.ensureRowsByIdCache(),this.rowsById?.[e[this.idProperty]]}getRowById(e){return this.ensureRowsByIdCache(),this.rowsById?.[e]}getItemById(e){return this.items[this.idxById.get(e)]}mapItemsToRows(e){const t=[];this.ensureRowsByIdCache();for(let i=0,s=e.length;i<s;i++){const s=this.rowsById?.[e[i][this.idProperty]];Me(s)&&(t[t.length]=s)}return t}mapIdsToRows(e){const t=[];this.ensureRowsByIdCache();for(let i=0,s=e.length;i<s;i++){const s=this.rowsById?.[e[i]];Me(s)&&(t[t.length]=s)}return t}mapRowsToIds(e){const t=[];for(let i=0,s=e.length;i<s;i++)if(e[i]<this.rows.length){const s=this.rows[e[i]];t[t.length]=s[this.idProperty]}return t}updateSingleItem(e,t){if(this.idxById){if(!this.idxById.has(e))throw new Error("[SlickGrid DataView] Invalid id");if(e!==t[this.idProperty]){const i=t[this.idProperty];if(!Me(i))throw new Error("[SlickGrid DataView] Cannot update item to associate with a null id");if(this.idxById.has(i))throw new Error("[SlickGrid DataView] Cannot update item to associate with a non-unique id");this.idxById.set(i,this.idxById.get(e)),this.idxById.delete(e),this.updated?.[e]&&delete this.updated[e],e=i}this.items[this.idxById.get(e)]=t,this.updated||(this.updated={}),this.updated[e]=!0}}updateItem(e,t){this.updateSingleItem(e,t),this.refresh()}updateItems(e,t){if(e.length!==t.length)throw new Error("[SlickGrid DataView] Mismatch on the length of ids and items provided to update");for(let i=0,s=t.length;i<s;i++)this.updateSingleItem(e[i],t[i]);this.refresh()}insertItem(e,t){this.items.splice(e,0,t),this.updateIdxById(e),this.refresh()}insertItems(e,t){Array.prototype.splice.apply(this.items,[e,0].concat(t)),this.updateIdxById(e),this.refresh()}addItem(e){this.items.push(e),this.updateIdxById(this.items.length-1),this.refresh()}addItems(e){this.items=this.items.concat(e),this.updateIdxById(this.items.length-e.length),this.refresh()}deleteItem(e){if(this.idxById)if(this.isBulkSuspend)this.bulkDeleteIds.set(e,!0);else{const t=this.idxById.get(e);if(void 0===t)throw new Error("[SlickGrid DataView] Invalid id");this.idxById.delete(e),this.items.splice(t,1),this.updateIdxById(t),this.refresh()}}deleteItems(e){if(0!==e.length&&this.idxById)if(this.isBulkSuspend)for(let t=0,i=e.length;t<i;t++){const i=e[t];if(void 0===this.idxById.get(i))throw new Error("[SlickGrid DataView] Invalid id");this.bulkDeleteIds.set(i,!0)}else{const t=[];for(let i=0,s=e.length;i<s;i++){const s=e[i],n=this.idxById.get(s);if(void 0===n)throw new Error("[SlickGrid DataView] Invalid id");this.idxById.delete(s),t.push(n)}t.sort();for(let e=t.length-1;e>=0;--e)this.items.splice(t[e],1);this.updateIdxById(t[0]),this.refresh()}}sortedAddItem(e){if(!this.sortComparer)throw new Error("[SlickGrid DataView] sortedAddItem() requires a sort comparer, use sort()");this.insertItem(this.sortedIndex(e),e)}sortedUpdateItem(e,t){if(!this.idxById)return;if(!this.idxById.has(e)||e!==t[this.idProperty])throw new Error(`[SlickGrid DataView] Invalid or non-matching id ${e}`);if(!this.sortComparer)throw new Error("[SlickGrid DataView] sortedUpdateItem() requires a sort comparer, use sort()");const i=this.getItemById(e);0!==this.sortComparer(i,t)?(this.deleteItem(e),this.sortedAddItem(t)):this.updateItem(e,t)}sortedIndex(e){let t=0,i=this.items.length;for(;t<i;){const s=t+i>>>1;-1===this.sortComparer(this.items[s],e)?t=s+1:i=s}return t}getItemCount(){return this.items.length}getLength(){return this.rows.length}getItem(e){const t=this.rows[e];if(t?.__group&&t.totals&&!t.totals?.initialized){const e=this.groupingInfos[t.level];e.displayTotalsRow||(this.calculateTotals(t.totals),t.title=e.formatter?e.formatter(t):t.value)}else t?.__groupTotals&&!t.initialized&&this.calculateTotals(t);return t}getItemMetadata(e){const t=this.rows[e];return void 0===t?null:t.__group?this._options.groupItemMetadataProvider.getGroupRowMetadata(t):t.__groupTotals?this._options.groupItemMetadataProvider.getTotalsRowMetadata(t):null}expandCollapseAllGroups(e,t){if(Me(e))this.toggledGroupsByLevel[e]={},this.groupingInfos[e].collapsed=t,!0===t?this.onGroupCollapsed.notify({level:e,groupingKey:null}):this.onGroupExpanded.notify({level:e,groupingKey:null});else for(let e=0;e<this.groupingInfos.length;e++)this.toggledGroupsByLevel[e]={},this.groupingInfos[e].collapsed=t,!0===t?this.onGroupCollapsed.notify({level:e,groupingKey:null}):this.onGroupExpanded.notify({level:e,groupingKey:null});this.refresh()}collapseAllGroups(e){this.expandCollapseAllGroups(e,!0)}expandAllGroups(e){this.expandCollapseAllGroups(e,!1)}expandCollapseGroup(e,t,i){this.toggledGroupsByLevel[e]&&(this.toggledGroupsByLevel[e][t]=this.groupingInfos[e].collapsed^i),this.refresh()}collapseGroup(...e){const t=Array.prototype.slice.call(e)[0];let i,s;1===e.length&&-1!==t.indexOf(this.groupingDelimiter)?(i=t,s=t.split(this.groupingDelimiter).length-1):(i=e.join(this.groupingDelimiter),s=e.length-1),this.expandCollapseGroup(s,i,!0),this.onGroupCollapsed.notify({level:s,groupingKey:i})}expandGroup(...e){const t=Array.prototype.slice.call(e)[0];let i,s;1===e.length&&-1!==t.indexOf(this.groupingDelimiter)?(s=t.split(this.groupingDelimiter).length-1,i=t):(s=e.length-1,i=e.join(this.groupingDelimiter)),this.expandCollapseGroup(s,i,!1),this.onGroupExpanded.notify({level:s,groupingKey:i})}getGroups(){return this.groups}extractGroups(e,t){let i,s;const n=[],r={};let o;const a=t?t.level+1:0,l=this.groupingInfos[a];for(let e=0,o=l.predefinedValues?.length??0;e<o;e++)s=l.predefinedValues?.[e],i=r[s],i||(i=new Es,i.value=s,i.level=a,i.groupingKey=(t?t.groupingKey+this.groupingDelimiter:"")+s,n[n.length]=i,r[s]=i);for(let h=0,c=e.length;h<c;h++)o=e[h],s=l.getterIsAFn?l.getter(o):o[l.getter],i=r[s],i||(i=new Es,i.value=s,i.level=a,i.groupingKey=(t?t.groupingKey+this.groupingDelimiter:"")+s,n[n.length]=i,r[s]=i),i.rows[i.count++]=o;if(a<this.groupingInfos.length-1)for(let e=0;e<n.length;e++)i=n[e],i.groups=this.extractGroups(i.rows,i);return n.length&&this.addTotals(n,a),n.sort(this.groupingInfos[a].comparer),n}calculateTotals(e){const t=e.group,i=this.groupingInfos[t?.level??0],s=t.level===this.groupingInfos.length;let n,r=i.aggregators.length;if(!s&&i.aggregateChildGroups){let e=t.groups?.length??0;for(;e--;)t.groups[e].totals.initialized||this.calculateTotals(t.groups[e].totals)}for(;r--;)n=i.aggregators[r],n.init(),!s&&i.aggregateChildGroups?i.compiledAccumulators[r].call(n,t.groups):i.compiledAccumulators[r].call(n,t.rows),n.storeResult(e);e.initialized=!0}addGroupTotals(e){const t=this.groupingInfos[e.level],i=new xs;i.group=e,e.totals=i,t.lazyTotalsCalculation||this.calculateTotals(i)}addTotals(e,t){t=t||0;const i=this.groupingInfos[t],s=i.collapsed,n=this.toggledGroupsByLevel[t];let r,o=e.length;for(;o--;)r=e[o],r.collapsed&&!i.aggregateCollapsed||(r.groups&&this.addTotals(r.groups,t+1),i.aggregators?.length&&(i.aggregateEmpty||r.rows.length||r.groups?.length)&&this.addGroupTotals(r),r.collapsed=s^n[r.groupingKey],r.title=i.formatter?i.formatter(r):r.value)}flattenGroupedRows(e,t){t=t||0;const i=this.groupingInfos[t],s=[];let n,r,o=0;for(let a=0,l=e.length;a<l;a++){if(r=e[a],s[o++]=r,!r.collapsed){n=r.groups?this.flattenGroupedRows(r.groups,t+1):r.rows;for(let e=0,t=n.length;e<t;e++)s[o++]=n[e]}r.totals&&i.displayTotalsRow&&(!r.collapsed||i.aggregateCollapsed)&&(s[o++]=r.totals)}return s}compileAccumulatorLoopCSPSafe(e){return e.accumulate?function(t){let i;if(Array.isArray(t))for(let s=0;s<t.length;s++){const n=t[s];i=e.accumulate.call(e,n)}return i}:function(){}}compileFilterCSPSafe(e,t){if("function"!=typeof this.filterCSPSafe)return[];const i=[],s=e.length;for(let n=0;n<s;n++)this.filterCSPSafe(e[n],t)&&i.push(e[n]);return i}compileFilter(e=!1){if(e)return null;const t=Pe(this.filter),i="{ continue _coreloop; }$1",s="{ _retval[_idx++] = $item$; continue _coreloop; }$1",n=t.body.replace(/return false\s*([;}]|\}|$)/gi,i).replace(/return!1([;}]|\}|$)/gi,i).replace(/return true\s*([;}]|\}|$)/gi,s).replace(/return!0([;}]|\}|$)/gi,s).replace(/return ([^;}]+?)\s*([;}]|$)/gi,"{ if ($1) { _retval[_idx++] = $item$; }; continue _coreloop; }$2");let r=["var _retval = [], _idx = 0; ","var $item$, $args$ = _args; ","_coreloop: ","for (var _i = 0, _il = _items.length; _i < _il; _i++) { ","$item$ = _items[_i]; ","$filter$; ","} ","return _retval; "].join("");r=r.replace(/\$filter\$/gi,n),r=r.replace(/\$item\$/gi,t.params[0]),r=r.replace(/\$args\$/gi,t.params[1]);const o=new Function("_items,_args",r),a="compiledFilter";return o.displayName=a,o.name=this.setFunctionName(o,a),o}compileFilterWithCaching(e=!1){if(e)return null;const t=Pe(this.filter),i="{ continue _coreloop; }$1",s="{ _cache[_i] = true;_retval[_idx++] = $item$; continue _coreloop; }$1",n=t.body.replace(/return false\s*([;}]|\}|$)/gi,i).replace(/return!1([;}]|\}|$)/gi,i).replace(/return true\s*([;}]|\}|$)/gi,s).replace(/return!0([;}]|\}|$)/gi,s).replace(/return ([^;}]+?)\s*([;}]|$)/gi,"{ if ((_cache[_i] = $1)) { _retval[_idx++] = $item$; }; continue _coreloop; }$2");let r=["var _retval = [], _idx = 0; ","var $item$, $args$ = _args; ","_coreloop: ","for (var _i = 0, _il = _items.length; _i < _il; _i++) { ","$item$ = _items[_i]; ","if (_cache[_i]) { ","_retval[_idx++] = $item$; ","continue _coreloop; ","} ","$filter$; ","} ","return _retval; "].join("");r=r.replace(/\$filter\$/gi,n),r=r.replace(/\$item\$/gi,t.params[0]),r=r.replace(/\$args\$/gi,t.params[1]);const o=new Function("_items,_args,_cache",r),a="compiledFilterWithCaching";return o.displayName=a,o.name=this.setFunctionName(o,a),o}compileFilterWithCachingCSPSafe(e,t,i){if("function"!=typeof this.filterCSPSafe)return[];const s=[],n=e.length;for(let r=0;r<n;r++)(i[r]||this.filterCSPSafe(e[r],t))&&s.push(e[r]);return s}setFunctionName(e,t){try{Object.defineProperty(e,"name",{writable:!0,value:t})}catch(i){e.name=t}}uncompiledFilter(e,t){const i=[];let s=0;for(let n=0,r=e.length;n<r;n++)this.filter?.(e[n],t)&&(i[s++]=e[n]);return i}uncompiledFilterWithCaching(e,t,i){const s=[];let n,r=0;for(let o=0,a=e.length;o<a;o++)n=e[o],i[o]?s[r++]=n:this.filter?.(n,t)&&(s[r++]=n,i[o]=!0);return s}getFilteredAndPagedItems(e){if(this._options.useCSPSafeFilter?this.filterCSPSafe:this.filter){let t,i;this._options.useCSPSafeFilter?(t=this._options.inlineFilters?this.compiledFilterCSPSafe:this.uncompiledFilter,i=this._options.inlineFilters?this.compiledFilterWithCachingCSPSafe:this.uncompiledFilterWithCaching):(t=this._options.inlineFilters?this.compiledFilter:this.uncompiledFilter,i=this._options.inlineFilters?this.compiledFilterWithCaching:this.uncompiledFilterWithCaching),this.refreshHints.isFilterNarrowing?this.filteredItems=t.call(this,this.filteredItems,this.filterArgs):this.refreshHints.isFilterExpanding?this.filteredItems=i.call(this,e,this.filterArgs,this.filterCache):this.refreshHints.isFilterUnchanged||(this.filteredItems=t.call(this,e,this.filterArgs))}else this.filteredItems=this.pagesize?e:e.concat();let t;return this.pagesize?(this.filteredItems.length<=this.pagenum*this.pagesize&&(0===this.filteredItems.length?this.pagenum=0:this.pagenum=Math.floor((this.filteredItems.length-1)/this.pagesize)),t=this.filteredItems.slice(this.pagesize*this.pagenum,this.pagesize*this.pagenum+this.pagesize)):t=this.filteredItems,{totalRows:this.filteredItems.length,rows:t}}getRowDiffs(e,t){let i,s,n;const r=[];let o=0,a=Math.max(t.length,e.length);this.refreshHints?.ignoreDiffsBefore&&(o=Math.max(0,Math.min(t.length,this.refreshHints.ignoreDiffsBefore))),this.refreshHints?.ignoreDiffsAfter&&(a=Math.min(t.length,Math.max(0,this.refreshHints.ignoreDiffsAfter)));for(let l=o,h=e.length;l<a;l++)l>=h?r[r.length]=l:(i=t[l],s=e[l],(!i||this.groupingInfos.length&&(n=i.__nonDataRow||s.__nonDataRow)&&i.__group!==s.__group||i.__group&&!i.equals(s)||n&&(i.__groupTotals||s.__groupTotals)||i[this.idProperty]!==s[this.idProperty]||this.updated?.[i[this.idProperty]])&&(r[r.length]=l));return r}recalc(e){this.rowsById=void 0,this.refreshHints.isFilterNarrowing===this.prevRefreshHints.isFilterNarrowing&&this.refreshHints.isFilterExpanding===this.prevRefreshHints.isFilterExpanding||(this.filterCache=[]);const t=this.getFilteredAndPagedItems(e);this.totalRows=t.totalRows;let i=t.rows;this.groups=[],this.groupingInfos.length&&(this.groups=this.extractGroups(i),this.groups.length&&(i=this.flattenGroupedRows(this.groups)));const s=this.getRowDiffs(this.rows,i);return this.rows=i,s}refresh(){if(this.suspend)return;const e=Te(!0,{},this.getPagingInfo()),t=this.rows.length,i=this.totalRows;let s=this.recalc(this.items);this.pagesize&&this.totalRows<this.pagenum*this.pagesize&&(this.pagenum=Math.max(0,Math.ceil(this.totalRows/this.pagesize)-1),s=this.recalc(this.items)),this.updated=null,this.prevRefreshHints=this.refreshHints,this.refreshHints={},i!==this.totalRows&&!1!==this.onBeforePagingInfoChanged.notify(e,null,this).getReturnValue()&&this.onPagingInfoChanged.notify(this.getPagingInfo(),null,this),t!==this.rows.length&&this.onRowCountChanged.notify({previous:t,current:this.rows.length,itemCount:this.items.length,dataView:this,callingOnRowsChanged:s.length>0},null,this),s.length>0&&this.onRowsChanged.notify({rows:s,itemCount:this.items.length,dataView:this,calledOnRowCountChanged:t!==this.rows.length},null,this),(t!==this.rows.length||s.length>0)&&this.onRowsOrCountChanged.notify({rowsDiff:s,previousRowCount:t,currentRowCount:this.rows.length,itemCount:this.items.length,rowCountChanged:t!==this.rows.length,rowsChanged:s.length>0,dataView:this},null,this)}syncGridSelection(e,t,i){let s;this._grid=e,this.selectedRowIds=this.mapRowsToIds(e.getSelectedRows());const n=e.getOptions(),r=e=>{!1===e?this.selectedRowIds=[]:this.selectedRowIds.sort().join(",")!==e.sort().join(",")&&(this.selectedRowIds=e)};return e.onSelectedRowsChanged.subscribe(((e,t)=>{if(!s){const e=this.mapRowsToIds(t.rows),i={grid:this._grid,ids:e,rows:t.rows,added:!0,dataView:this};this.preSelectedRowIdsChangeFn(i),this.onSelectedRowIdsChanged.notify(Object.assign(i,{selectedRowIds:this.selectedRowIds,filteredIds:this.getAllSelectedFilteredIds()}),new bs,this)}})),this.preSelectedRowIdsChangeFn=e=>{if(!s){if(s=!0,void 0===e.added)r(e.ids);else{let t;if(e.added)if(i&&n.multiSelect){const i=this.selectedRowIds?.filter((e=>void 0===this.getRowById(e)));t=i.concat(e.ids)}else t=e.ids;else if(i&&n.multiSelect){const i=new Set(e.ids);t=this.selectedRowIds?.filter((e=>!i.has(e)))}else t=[];r(t)}s=!1}},this.onRowsOrCountChanged.subscribe((()=>{if((this.selectedRowIds||[]).length>0&&!s){s=!0;const i=this.mapIdsToRows(this.selectedRowIds||[]);if(!t){const e={grid:this._grid,ids:this.mapRowsToIds(i),rows:i,dataView:this};this.preSelectedRowIdsChangeFn(e),this.onSelectedRowIdsChanged.notify(Object.assign(e,{selectedRowIds:this.selectedRowIds,filteredIds:this.getAllSelectedFilteredIds()}),new bs,this)}e.setSelectedRows(i),s=!1}}).bind(this)),this.onSelectedRowIdsChanged}getAllSelectedIds(){return this.selectedRowIds}getAllSelectedFilteredIds(){return this.getAllSelectedFilteredItems().map((e=>e[this.idProperty]))}setSelectedIds(e,t){let i=t?.isRowBeingAdded;const s=t?.shouldTriggerEvent,n=t?.applyRowSelectionToGrid;!1!==i&&(i=!0);const r=this.mapIdsToRows(e),o={grid:this._grid,ids:e,rows:r,added:i,dataView:this};this.preSelectedRowIdsChangeFn?.(o),!1!==s&&this.onSelectedRowIdsChanged.notify(Object.assign(o,{selectedRowIds:this.selectedRowIds,filteredIds:this.getAllSelectedFilteredIds()}),new bs,this),!1!==n&&this._grid&&this._grid.setSelectedRows(r)}getAllSelectedItems(){const e=[];return this.getAllSelectedIds().forEach((t=>{e.push(this.getItemById(t))})),e}getAllSelectedFilteredItems(){if(!Array.isArray(this.selectedRowIds))return[];const e=new Set(this.selectedRowIds);return this.filteredItems.filter((t=>e.has(t[this.idProperty])))||[]}syncGridCellCssStyles(e,t){let i,s;const n=e=>{i={},"object"==typeof e&&Object.keys(e).forEach((t=>{if(e&&this.rows[t]){const s=this.rows[t][this.idProperty];i[s]=e[t]}}))};n(e.getCellCssStyles(t));const r=()=>{if("object"==typeof i){s=!0,this.ensureRowsByIdCache();const n={};Object.keys(i).forEach((e=>{const t=this.rowsById?.[e];Me(t)&&(n[t]=i[e])})),e.setCellCssStyles(t,n),s=!1}};e.onCellCssStylesChanged.subscribe(((i,o)=>{s||t!==o.key||(o.hash?n(o.hash):(e.onCellCssStylesChanged.unsubscribe(),this.onRowsOrCountChanged.unsubscribe(r)))})),this.onRowsOrCountChanged.subscribe(r.bind(this))}}function As(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,s)}return i}function Ds(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?As(Object(i),!0).forEach((function(t){Ps(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):As(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function Rs(e){return Rs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Rs(e)}function Ps(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Ls(){return Ls=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e},Ls.apply(this,arguments)}function Ms(e){if("undefined"!=typeof window&&window.navigator)return!!navigator.userAgent.match(e)}var Ns=Ms(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),Fs=Ms(/Edge/i),Bs=Ms(/firefox/i),Hs=Ms(/safari/i)&&!Ms(/chrome/i)&&!Ms(/android/i),zs=Ms(/iP(ad|od|hone)/i),$s=Ms(/chrome/i)&&Ms(/android/i),Vs={capture:!1,passive:!1};function Ws(e,t,i){e.addEventListener(t,i,!Ns&&Vs)}function Us(e,t,i){e.removeEventListener(t,i,!Ns&&Vs)}function js(e,t){if(t){if(">"===t[0]&&(t=t.substring(1)),e)try{if(e.matches)return e.matches(t);if(e.msMatchesSelector)return e.msMatchesSelector(t);if(e.webkitMatchesSelector)return e.webkitMatchesSelector(t)}catch(e){return!1}return!1}}function Gs(e){return e.host&&e!==document&&e.host.nodeType?e.host:e.parentNode}function qs(e,t,i,s){if(e){i=i||document;do{if(null!=t&&(">"===t[0]?e.parentNode===i&&js(e,t):js(e,t))||s&&e===i)return e;if(e===i)break}while(e=Gs(e))}return null}var Ks,Ys=/\s+/g;function Xs(e,t,i){if(e&&t)if(e.classList)e.classList[i?"add":"remove"](t);else{var s=(" "+e.className+" ").replace(Ys," ").replace(" "+t+" "," ");e.className=(s+(i?" "+t:"")).replace(Ys," ")}}function Zs(e,t,i){var s=e&&e.style;if(s){if(void 0===i)return document.defaultView&&document.defaultView.getComputedStyle?i=document.defaultView.getComputedStyle(e,""):e.currentStyle&&(i=e.currentStyle),void 0===t?i:i[t];t in s||-1!==t.indexOf("webkit")||(t="-webkit-"+t),s[t]=i+("string"==typeof i?"":"px")}}function Qs(e,t){var i="";if("string"==typeof e)i=e;else do{var s=Zs(e,"transform");s&&"none"!==s&&(i=s+" "+i)}while(!t&&(e=e.parentNode));var n=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return n&&new n(i)}function Js(e,t,i){if(e){var s=e.getElementsByTagName(t),n=0,r=s.length;if(i)for(;n<r;n++)i(s[n],n);return s}return[]}function en(){return document.scrollingElement||document.documentElement}function tn(e,t,i,s,n){if(e.getBoundingClientRect||e===window){var r,o,a,l,h,c,d;if(e!==window&&e.parentNode&&e!==en()?(o=(r=e.getBoundingClientRect()).top,a=r.left,l=r.bottom,h=r.right,c=r.height,d=r.width):(o=0,a=0,l=window.innerHeight,h=window.innerWidth,c=window.innerHeight,d=window.innerWidth),(t||i)&&e!==window&&(n=n||e.parentNode,!Ns))do{if(n&&n.getBoundingClientRect&&("none"!==Zs(n,"transform")||i&&"static"!==Zs(n,"position"))){var u=n.getBoundingClientRect();o-=u.top+parseInt(Zs(n,"border-top-width")),a-=u.left+parseInt(Zs(n,"border-left-width")),l=o+r.height,h=a+r.width;break}}while(n=n.parentNode);if(s&&e!==window){var p=Qs(n||e),m=p&&p.a,f=p&&p.d;p&&(l=(o/=f)+(c/=f),h=(a/=m)+(d/=m))}return{top:o,left:a,bottom:l,right:h,width:d,height:c}}}function sn(e,t,i){for(var s=ln(e,!0),n=tn(e)[t];s;){var r=tn(s)[i];if(!("top"===i||"left"===i?n>=r:n<=r))return s;if(s===en())break;s=ln(s,!1)}return!1}function nn(e,t,i,s){for(var n=0,r=0,o=e.children;r<o.length;){if("none"!==o[r].style.display&&o[r]!==dr.ghost&&(s||o[r]!==dr.dragged)&&qs(o[r],i.draggable,e,!1)){if(n===t)return o[r];n++}r++}return null}function rn(e,t){for(var i=e.lastElementChild;i&&(i===dr.ghost||"none"===Zs(i,"display")||t&&!js(i,t));)i=i.previousElementSibling;return i||null}function on(e,t){var i=0;if(!e||!e.parentNode)return-1;for(;e=e.previousElementSibling;)"TEMPLATE"===e.nodeName.toUpperCase()||e===dr.clone||t&&!js(e,t)||i++;return i}function an(e){var t=0,i=0,s=en();if(e)do{var n=Qs(e),r=n.a,o=n.d;t+=e.scrollLeft*r,i+=e.scrollTop*o}while(e!==s&&(e=e.parentNode));return[t,i]}function ln(e,t){if(!e||!e.getBoundingClientRect)return en();var i=e,s=!1;do{if(i.clientWidth<i.scrollWidth||i.clientHeight<i.scrollHeight){var n=Zs(i);if(i.clientWidth<i.scrollWidth&&("auto"==n.overflowX||"scroll"==n.overflowX)||i.clientHeight<i.scrollHeight&&("auto"==n.overflowY||"scroll"==n.overflowY)){if(!i.getBoundingClientRect||i===document.body)return en();if(s||t)return i;s=!0}}}while(i=i.parentNode);return en()}function hn(e,t){return Math.round(e.top)===Math.round(t.top)&&Math.round(e.left)===Math.round(t.left)&&Math.round(e.height)===Math.round(t.height)&&Math.round(e.width)===Math.round(t.width)}function cn(e,t){return function(){if(!Ks){var i=arguments;1===i.length?e.call(this,i[0]):e.apply(this,i),Ks=setTimeout((function(){Ks=void 0}),t)}}}function dn(e,t,i){e.scrollLeft+=t,e.scrollTop+=i}function un(e){var t=window.Polymer,i=window.jQuery||window.Zepto;return t&&t.dom?t.dom(e).cloneNode(!0):i?i(e).clone(!0)[0]:e.cloneNode(!0)}function pn(e,t,i){var s={};return Array.from(e.children).forEach((function(n){var r,o,a,l;if(qs(n,t.draggable,e,!1)&&!n.animated&&n!==i){var h=tn(n);s.left=Math.min(null!==(r=s.left)&&void 0!==r?r:1/0,h.left),s.top=Math.min(null!==(o=s.top)&&void 0!==o?o:1/0,h.top),s.right=Math.max(null!==(a=s.right)&&void 0!==a?a:-1/0,h.right),s.bottom=Math.max(null!==(l=s.bottom)&&void 0!==l?l:-1/0,h.bottom)}})),s.width=s.right-s.left,s.height=s.bottom-s.top,s.x=s.left,s.y=s.top,s}var mn="Sortable"+(new Date).getTime();var fn=[],gn={initializeByDefault:!0},_n={mount:function(e){for(var t in gn)gn.hasOwnProperty(t)&&!(t in e)&&(e[t]=gn[t]);fn.forEach((function(t){if(t.pluginName===e.pluginName)throw"Sortable: Cannot mount plugin ".concat(e.pluginName," more than once")})),fn.push(e)},pluginEvent:function(e,t,i){var s=this;this.eventCanceled=!1,i.cancel=function(){s.eventCanceled=!0};var n=e+"Global";fn.forEach((function(s){t[s.pluginName]&&(t[s.pluginName][n]&&t[s.pluginName][n](Ds({sortable:t},i)),t.options[s.pluginName]&&t[s.pluginName][e]&&t[s.pluginName][e](Ds({sortable:t},i)))}))},initializePlugins:function(e,t,i,s){for(var n in fn.forEach((function(s){var n=s.pluginName;if(e.options[n]||s.initializeByDefault){var r=new s(e,t,e.options);r.sortable=e,r.options=e.options,e[n]=r,Ls(i,r.defaults)}})),e.options)if(e.options.hasOwnProperty(n)){var r=this.modifyOption(e,n,e.options[n]);void 0!==r&&(e.options[n]=r)}},getEventProperties:function(e,t){var i={};return fn.forEach((function(s){"function"==typeof s.eventProperties&&Ls(i,s.eventProperties.call(t[s.pluginName],e))})),i},modifyOption:function(e,t,i){var s;return fn.forEach((function(n){e[n.pluginName]&&n.optionListeners&&"function"==typeof n.optionListeners[t]&&(s=n.optionListeners[t].call(e[n.pluginName],i))})),s}};var vn=["evt"],bn=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=i.evt,n=function(e,t){if(null==e)return{};var i,s,n=function(e,t){if(null==e)return{};var i,s,n={},r=Object.keys(e);for(s=0;s<r.length;s++)i=r[s],t.indexOf(i)>=0||(n[i]=e[i]);return n}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(s=0;s<r.length;s++)i=r[s],t.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}(i,vn);_n.pluginEvent.bind(dr)(e,t,Ds({dragEl:Cn,parentEl:wn,ghostEl:Sn,rootEl:En,nextEl:xn,lastDownEl:Tn,cloneEl:On,cloneHidden:kn,dragStarted:$n,putSortable:Ln,activeSortable:dr.active,originalEvent:s,oldIndex:In,oldDraggableIndex:Dn,newIndex:An,newDraggableIndex:Rn,hideGhostForTarget:ar,unhideGhostForTarget:lr,cloneNowHidden:function(){kn=!0},cloneNowShown:function(){kn=!1},dispatchSortableEvent:function(e){yn({sortable:t,name:e,originalEvent:s})}},n))};function yn(e){!function(e){var t=e.sortable,i=e.rootEl,s=e.name,n=e.targetEl,r=e.cloneEl,o=e.toEl,a=e.fromEl,l=e.oldIndex,h=e.newIndex,c=e.oldDraggableIndex,d=e.newDraggableIndex,u=e.originalEvent,p=e.putSortable,m=e.extraEventProperties;if(t=t||i&&i[mn]){var f,g=t.options,_="on"+s.charAt(0).toUpperCase()+s.substr(1);!window.CustomEvent||Ns||Fs?(f=document.createEvent("Event")).initEvent(s,!0,!0):f=new CustomEvent(s,{bubbles:!0,cancelable:!0}),f.to=o||i,f.from=a||i,f.item=n||i,f.clone=r,f.oldIndex=l,f.newIndex=h,f.oldDraggableIndex=c,f.newDraggableIndex=d,f.originalEvent=u,f.pullMode=p?p.lastPutMode:void 0;var v=Ds(Ds({},m),_n.getEventProperties(s,t));for(var b in v)f[b]=v[b];i&&i.dispatchEvent(f),g[_]&&g[_].call(t,f)}}(Ds({putSortable:Ln,cloneEl:On,targetEl:Cn,rootEl:En,oldIndex:In,oldDraggableIndex:Dn,newIndex:An,newDraggableIndex:Rn},e))}var Cn,wn,Sn,En,xn,Tn,On,kn,In,An,Dn,Rn,Pn,Ln,Mn,Nn,Fn,Bn,Hn,zn,$n,Vn,Wn,Un,jn,Gn=!1,qn=!1,Kn=[],Yn=!1,Xn=!1,Zn=[],Qn=!1,Jn=[],er="undefined"!=typeof document,tr=zs,ir=Fs||Ns?"cssFloat":"float",sr=er&&!$s&&!zs&&"draggable"in document.createElement("div"),nr=function(){if(er){if(Ns)return!1;var e=document.createElement("x");return e.style.cssText="pointer-events:auto","auto"===e.style.pointerEvents}}(),rr=function(e,t){var i=Zs(e),s=parseInt(i.width)-parseInt(i.paddingLeft)-parseInt(i.paddingRight)-parseInt(i.borderLeftWidth)-parseInt(i.borderRightWidth),n=nn(e,0,t),r=nn(e,1,t),o=n&&Zs(n),a=r&&Zs(r),l=o&&parseInt(o.marginLeft)+parseInt(o.marginRight)+tn(n).width,h=a&&parseInt(a.marginLeft)+parseInt(a.marginRight)+tn(r).width;if("flex"===i.display)return"column"===i.flexDirection||"column-reverse"===i.flexDirection?"vertical":"horizontal";if("grid"===i.display)return i.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(n&&o.float&&"none"!==o.float){var c="left"===o.float?"left":"right";return!r||"both"!==a.clear&&a.clear!==c?"horizontal":"vertical"}return n&&("block"===o.display||"flex"===o.display||"table"===o.display||"grid"===o.display||l>=s&&"none"===i[ir]||r&&"none"===i[ir]&&l+h>s)?"vertical":"horizontal"},or=function(e){function t(e,i){return function(s,n,r,o){var a=s.options.group.name&&n.options.group.name&&s.options.group.name===n.options.group.name;if(null==e&&(i||a))return!0;if(null==e||!1===e)return!1;if(i&&"clone"===e)return e;if("function"==typeof e)return t(e(s,n,r,o),i)(s,n,r,o);var l=(i?s:n).options.group.name;return!0===e||"string"==typeof e&&e===l||e.join&&e.indexOf(l)>-1}}var i={},s=e.group;s&&"object"==Rs(s)||(s={name:s}),i.name=s.name,i.checkPull=t(s.pull,!0),i.checkPut=t(s.put),i.revertClone=s.revertClone,e.group=i},ar=function(){!nr&&Sn&&Zs(Sn,"display","none")},lr=function(){!nr&&Sn&&Zs(Sn,"display","")};er&&!$s&&document.addEventListener("click",(function(e){if(qn)return e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.stopImmediatePropagation&&e.stopImmediatePropagation(),qn=!1,!1}),!0);var hr=function(e){if(Cn){var t=function(e,t){var i;return Kn.some((function(s){var n=s[mn].options.emptyInsertThreshold;if(n&&!rn(s)){var r=tn(s),o=e>=r.left-n&&e<=r.right+n,a=t>=r.top-n&&t<=r.bottom+n;return o&&a?i=s:void 0}})),i}((e=e.touches?e.touches[0]:e).clientX,e.clientY);if(t){var i={};for(var s in e)e.hasOwnProperty(s)&&(i[s]=e[s]);i.target=i.rootEl=t,i.preventDefault=void 0,i.stopPropagation=void 0,t[mn]._onDragOver(i)}}},cr=function(e){Cn&&Cn.parentNode[mn]._isOutsideThisEl(e.target)};function dr(e,t){if(!e||!e.nodeType||1!==e.nodeType)throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(e));this.el=e,this.options=t=Ls({},t),e[mn]=this;var i,s,n={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(e.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return rr(e,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(e,t){e.setData("Text",t.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:!1!==dr.supportPointer&&"PointerEvent"in window&&!Hs,emptyInsertThreshold:5};for(var r in _n.initializePlugins(this,e,n),n)!(r in t)&&(t[r]=n[r]);for(var o in or(t),this)"_"===o.charAt(0)&&"function"==typeof this[o]&&(this[o]=this[o].bind(this));this.nativeDraggable=!t.forceFallback&&sr,this.nativeDraggable&&(this.options.touchStartThreshold=1),t.supportPointer?Ws(e,"pointerdown",this._onTapStart):(Ws(e,"mousedown",this._onTapStart),Ws(e,"touchstart",this._onTapStart)),this.nativeDraggable&&(Ws(e,"dragover",this),Ws(e,"dragenter",this)),Kn.push(this.el),t.store&&t.store.get&&this.sort(t.store.get(this)||[]),Ls(this,(s=[],{captureAnimationState:function(){s=[],this.options.animation&&[].slice.call(this.el.children).forEach((function(e){if("none"!==Zs(e,"display")&&e!==dr.ghost){s.push({target:e,rect:tn(e)});var t=Ds({},s[s.length-1].rect);if(e.thisAnimationDuration){var i=Qs(e,!0);i&&(t.top-=i.f,t.left-=i.e)}e.fromRect=t}}))},addAnimationState:function(e){s.push(e)},removeAnimationState:function(e){s.splice(function(e,t){for(var i in e)if(e.hasOwnProperty(i))for(var s in t)if(t.hasOwnProperty(s)&&t[s]===e[i][s])return Number(i);return-1}(s,{target:e}),1)},animateAll:function(e){var t=this;if(!this.options.animation)return clearTimeout(i),void("function"==typeof e&&e());var n=!1,r=0;s.forEach((function(e){var i=0,s=e.target,o=s.fromRect,a=tn(s),l=s.prevFromRect,h=s.prevToRect,c=e.rect,d=Qs(s,!0);d&&(a.top-=d.f,a.left-=d.e),s.toRect=a,s.thisAnimationDuration&&hn(l,a)&&!hn(o,a)&&(c.top-a.top)/(c.left-a.left)==(o.top-a.top)/(o.left-a.left)&&(i=function(e,t,i,s){return Math.sqrt(Math.pow(t.top-e.top,2)+Math.pow(t.left-e.left,2))/Math.sqrt(Math.pow(t.top-i.top,2)+Math.pow(t.left-i.left,2))*s.animation}(c,l,h,t.options)),hn(a,o)||(s.prevFromRect=o,s.prevToRect=a,i||(i=t.options.animation),t.animate(s,c,a,i)),i&&(n=!0,r=Math.max(r,i),clearTimeout(s.animationResetTimer),s.animationResetTimer=setTimeout((function(){s.animationTime=0,s.prevFromRect=null,s.fromRect=null,s.prevToRect=null,s.thisAnimationDuration=null}),i),s.thisAnimationDuration=i)})),clearTimeout(i),n?i=setTimeout((function(){"function"==typeof e&&e()}),r):"function"==typeof e&&e(),s=[]},animate:function(e,t,i,s){if(s){Zs(e,"transition",""),Zs(e,"transform","");var n=Qs(this.el),r=n&&n.a,o=n&&n.d,a=(t.left-i.left)/(r||1),l=(t.top-i.top)/(o||1);e.animatingX=!!a,e.animatingY=!!l,Zs(e,"transform","translate3d("+a+"px,"+l+"px,0)"),this.forRepaintDummy=function(e){return e.offsetWidth}(e),Zs(e,"transition","transform "+s+"ms"+(this.options.easing?" "+this.options.easing:"")),Zs(e,"transform","translate3d(0,0,0)"),"number"==typeof e.animated&&clearTimeout(e.animated),e.animated=setTimeout((function(){Zs(e,"transition",""),Zs(e,"transform",""),e.animated=!1,e.animatingX=!1,e.animatingY=!1}),s)}}}))}function ur(e,t,i,s,n,r,o,a){var l,h,c=e[mn],d=c.options.onMove;return!window.CustomEvent||Ns||Fs?(l=document.createEvent("Event")).initEvent("move",!0,!0):l=new CustomEvent("move",{bubbles:!0,cancelable:!0}),l.to=t,l.from=e,l.dragged=i,l.draggedRect=s,l.related=n||t,l.relatedRect=r||tn(t),l.willInsertAfter=a,l.originalEvent=o,e.dispatchEvent(l),d&&(h=d.call(c,l,o)),h}function pr(e){e.draggable=!1}function mr(){Qn=!1}function fr(e){for(var t=e.tagName+e.className+e.src+e.href+e.textContent,i=t.length,s=0;i--;)s+=t.charCodeAt(i);return s.toString(36)}function gr(e){return setTimeout(e,0)}function _r(e){return clearTimeout(e)}dr.prototype={constructor:dr,_isOutsideThisEl:function(e){this.el.contains(e)||e===this.el||(Vn=null)},_getDirection:function(e,t){return"function"==typeof this.options.direction?this.options.direction.call(this,e,t,Cn):this.options.direction},_onTapStart:function(e){if(e.cancelable){var t=this,i=this.el,s=this.options,n=s.preventOnFilter,r=e.type,o=e.touches&&e.touches[0]||e.pointerType&&"touch"===e.pointerType&&e,a=(o||e).target,l=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||a,h=s.filter;if(function(e){Jn.length=0;for(var t=e.getElementsByTagName("input"),i=t.length;i--;){var s=t[i];s.checked&&Jn.push(s)}}(i),!Cn&&!(/mousedown|pointerdown/.test(r)&&0!==e.button||s.disabled)&&!l.isContentEditable&&(this.nativeDraggable||!Hs||!a||"SELECT"!==a.tagName.toUpperCase())&&!((a=qs(a,s.draggable,i,!1))&&a.animated||Tn===a)){if(In=on(a),Dn=on(a,s.draggable),"function"==typeof h){if(h.call(this,e,a,this))return yn({sortable:t,rootEl:l,name:"filter",targetEl:a,toEl:i,fromEl:i}),bn("filter",t,{evt:e}),void(n&&e.cancelable&&e.preventDefault())}else if(h&&(h=h.split(",").some((function(s){if(s=qs(l,s.trim(),i,!1))return yn({sortable:t,rootEl:s,name:"filter",targetEl:a,fromEl:i,toEl:i}),bn("filter",t,{evt:e}),!0}))))return void(n&&e.cancelable&&e.preventDefault());s.handle&&!qs(l,s.handle,i,!1)||this._prepareDragStart(e,o,a)}}},_prepareDragStart:function(e,t,i){var s,n=this,r=n.el,o=n.options,a=r.ownerDocument;if(i&&!Cn&&i.parentNode===r){var l=tn(i);if(En=r,wn=(Cn=i).parentNode,xn=Cn.nextSibling,Tn=i,Pn=o.group,dr.dragged=Cn,Mn={target:Cn,clientX:(t||e).clientX,clientY:(t||e).clientY},Hn=Mn.clientX-l.left,zn=Mn.clientY-l.top,this._lastX=(t||e).clientX,this._lastY=(t||e).clientY,Cn.style["will-change"]="all",s=function(){bn("delayEnded",n,{evt:e}),dr.eventCanceled?n._onDrop():(n._disableDelayedDragEvents(),!Bs&&n.nativeDraggable&&(Cn.draggable=!0),n._triggerDragStart(e,t),yn({sortable:n,name:"choose",originalEvent:e}),Xs(Cn,o.chosenClass,!0))},o.ignore.split(",").forEach((function(e){Js(Cn,e.trim(),pr)})),Ws(a,"dragover",hr),Ws(a,"mousemove",hr),Ws(a,"touchmove",hr),Ws(a,"mouseup",n._onDrop),Ws(a,"touchend",n._onDrop),Ws(a,"touchcancel",n._onDrop),Bs&&this.nativeDraggable&&(this.options.touchStartThreshold=4,Cn.draggable=!0),bn("delayStart",this,{evt:e}),!o.delay||o.delayOnTouchOnly&&!t||this.nativeDraggable&&(Fs||Ns))s();else{if(dr.eventCanceled)return void this._onDrop();Ws(a,"mouseup",n._disableDelayedDrag),Ws(a,"touchend",n._disableDelayedDrag),Ws(a,"touchcancel",n._disableDelayedDrag),Ws(a,"mousemove",n._delayedDragTouchMoveHandler),Ws(a,"touchmove",n._delayedDragTouchMoveHandler),o.supportPointer&&Ws(a,"pointermove",n._delayedDragTouchMoveHandler),n._dragStartTimer=setTimeout(s,o.delay)}}},_delayedDragTouchMoveHandler:function(e){var t=e.touches?e.touches[0]:e;Math.max(Math.abs(t.clientX-this._lastX),Math.abs(t.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){Cn&&pr(Cn),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;Us(e,"mouseup",this._disableDelayedDrag),Us(e,"touchend",this._disableDelayedDrag),Us(e,"touchcancel",this._disableDelayedDrag),Us(e,"mousemove",this._delayedDragTouchMoveHandler),Us(e,"touchmove",this._delayedDragTouchMoveHandler),Us(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,t){t=t||"touch"==e.pointerType&&e,!this.nativeDraggable||t?this.options.supportPointer?Ws(document,"pointermove",this._onTouchMove):Ws(document,t?"touchmove":"mousemove",this._onTouchMove):(Ws(Cn,"dragend",this),Ws(En,"dragstart",this._onDragStart));try{document.selection?gr((function(){document.selection.empty()})):window.getSelection().removeAllRanges()}catch(e){}},_dragStarted:function(e,t){if(Gn=!1,En&&Cn){bn("dragStarted",this,{evt:t}),this.nativeDraggable&&Ws(document,"dragover",cr);var i=this.options;!e&&Xs(Cn,i.dragClass,!1),Xs(Cn,i.ghostClass,!0),dr.active=this,e&&this._appendGhost(),yn({sortable:this,name:"start",originalEvent:t})}else this._nulling()},_emulateDragOver:function(){if(Nn){this._lastX=Nn.clientX,this._lastY=Nn.clientY,ar();for(var e=document.elementFromPoint(Nn.clientX,Nn.clientY),t=e;e&&e.shadowRoot&&(e=e.shadowRoot.elementFromPoint(Nn.clientX,Nn.clientY))!==t;)t=e;if(Cn.parentNode[mn]._isOutsideThisEl(e),t)do{if(t[mn]&&t[mn]._onDragOver({clientX:Nn.clientX,clientY:Nn.clientY,target:e,rootEl:t})&&!this.options.dragoverBubble)break;e=t}while(t=Gs(t));lr()}},_onTouchMove:function(e){if(Mn){var t=this.options,i=t.fallbackTolerance,s=t.fallbackOffset,n=e.touches?e.touches[0]:e,r=Sn&&Qs(Sn,!0),o=Sn&&r&&r.a,a=Sn&&r&&r.d,l=tr&&jn&&an(jn),h=(n.clientX-Mn.clientX+s.x)/(o||1)+(l?l[0]-Zn[0]:0)/(o||1),c=(n.clientY-Mn.clientY+s.y)/(a||1)+(l?l[1]-Zn[1]:0)/(a||1);if(!dr.active&&!Gn){if(i&&Math.max(Math.abs(n.clientX-this._lastX),Math.abs(n.clientY-this._lastY))<i)return;this._onDragStart(e,!0)}if(Sn){r?(r.e+=h-(Fn||0),r.f+=c-(Bn||0)):r={a:1,b:0,c:0,d:1,e:h,f:c};var d="matrix(".concat(r.a,",").concat(r.b,",").concat(r.c,",").concat(r.d,",").concat(r.e,",").concat(r.f,")");Zs(Sn,"webkitTransform",d),Zs(Sn,"mozTransform",d),Zs(Sn,"msTransform",d),Zs(Sn,"transform",d),Fn=h,Bn=c,Nn=n}e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!Sn){var e=this.options.fallbackOnBody?document.body:En,t=tn(Cn,!0,tr,!0,e),i=this.options;if(tr){for(jn=e;"static"===Zs(jn,"position")&&"none"===Zs(jn,"transform")&&jn!==document;)jn=jn.parentNode;jn!==document.body&&jn!==document.documentElement?(jn===document&&(jn=en()),t.top+=jn.scrollTop,t.left+=jn.scrollLeft):jn=en(),Zn=an(jn)}Xs(Sn=Cn.cloneNode(!0),i.ghostClass,!1),Xs(Sn,i.fallbackClass,!0),Xs(Sn,i.dragClass,!0),Zs(Sn,"transition",""),Zs(Sn,"transform",""),Zs(Sn,"box-sizing","border-box"),Zs(Sn,"margin",0),Zs(Sn,"top",t.top),Zs(Sn,"left",t.left),Zs(Sn,"width",t.width),Zs(Sn,"height",t.height),Zs(Sn,"opacity","0.8"),Zs(Sn,"position",tr?"absolute":"fixed"),Zs(Sn,"zIndex","100000"),Zs(Sn,"pointerEvents","none"),dr.ghost=Sn,e.appendChild(Sn),Zs(Sn,"transform-origin",Hn/parseInt(Sn.style.width)*100+"% "+zn/parseInt(Sn.style.height)*100+"%")}},_onDragStart:function(e,t){var i=this,s=e.dataTransfer,n=i.options;bn("dragStart",this,{evt:e}),dr.eventCanceled?this._onDrop():(bn("setupClone",this),dr.eventCanceled||((On=un(Cn)).removeAttribute("id"),On.draggable=!1,On.style["will-change"]="",this._hideClone(),Xs(On,this.options.chosenClass,!1),dr.clone=On),i.cloneId=gr((function(){bn("clone",i),dr.eventCanceled||(i.options.removeCloneOnHide||En.insertBefore(On,Cn),i._hideClone(),yn({sortable:i,name:"clone"}))})),!t&&Xs(Cn,n.dragClass,!0),t?(qn=!0,i._loopId=setInterval(i._emulateDragOver,50)):(Us(document,"mouseup",i._onDrop),Us(document,"touchend",i._onDrop),Us(document,"touchcancel",i._onDrop),s&&(s.effectAllowed="move",n.setData&&n.setData.call(i,s,Cn)),Ws(document,"drop",i),Zs(Cn,"transform","translateZ(0)")),Gn=!0,i._dragStartId=gr(i._dragStarted.bind(i,t,e)),Ws(document,"selectstart",i),$n=!0,Hs&&Zs(document.body,"user-select","none"))},_onDragOver:function(e){var t,i,s,n,r=this.el,o=e.target,a=this.options,l=a.group,h=dr.active,c=Pn===l,d=a.sort,u=Ln||h,p=this,m=!1;if(!Qn){if(void 0!==e.preventDefault&&e.cancelable&&e.preventDefault(),o=qs(o,a.draggable,r,!0),I("dragOver"),dr.eventCanceled)return m;if(Cn.contains(e.target)||o.animated&&o.animatingX&&o.animatingY||p._ignoreWhileAnimating===o)return D(!1);if(qn=!1,h&&!a.disabled&&(c?d||(s=wn!==En):Ln===this||(this.lastPutMode=Pn.checkPull(this,h,Cn,e))&&l.checkPut(this,h,Cn,e))){if(n="vertical"===this._getDirection(e,o),t=tn(Cn),I("dragOverValid"),dr.eventCanceled)return m;if(s)return wn=En,A(),this._hideClone(),I("revert"),dr.eventCanceled||(xn?En.insertBefore(Cn,xn):En.appendChild(Cn)),D(!0);var f=rn(r,a.draggable);if(!f||function(e,t,i){var s=tn(rn(i.el,i.options.draggable)),n=pn(i.el,i.options,Sn);return t?e.clientX>n.right+10||e.clientY>s.bottom&&e.clientX>s.left:e.clientY>n.bottom+10||e.clientX>s.right&&e.clientY>s.top}(e,n,this)&&!f.animated){if(f===Cn)return D(!1);if(f&&r===e.target&&(o=f),o&&(i=tn(o)),!1!==ur(En,r,Cn,t,o,i,e,!!o))return A(),f&&f.nextSibling?r.insertBefore(Cn,f.nextSibling):r.appendChild(Cn),wn=r,R(),D(!0)}else if(f&&function(e,t,i){var s=tn(nn(i.el,0,i.options,!0)),n=pn(i.el,i.options,Sn);return t?e.clientX<n.left-10||e.clientY<s.top&&e.clientX<s.right:e.clientY<n.top-10||e.clientY<s.bottom&&e.clientX<s.left}(e,n,this)){var g=nn(r,0,a,!0);if(g===Cn)return D(!1);if(i=tn(o=g),!1!==ur(En,r,Cn,t,o,i,e,!1))return A(),r.insertBefore(Cn,g),wn=r,R(),D(!0)}else if(o.parentNode===r){i=tn(o);var _,v,b,y=Cn.parentNode!==r,C=!function(e,t,i){var s=i?e.left:e.top,n=i?e.right:e.bottom,r=i?e.width:e.height,o=i?t.left:t.top,a=i?t.right:t.bottom,l=i?t.width:t.height;return s===o||n===a||s+r/2===o+l/2}(Cn.animated&&Cn.toRect||t,o.animated&&o.toRect||i,n),w=n?"top":"left",S=sn(o,"top","top")||sn(Cn,"top","top"),E=S?S.scrollTop:void 0;if(Vn!==o&&(v=i[w],Yn=!1,Xn=!C&&a.invertSwap||y),_=function(e,t,i,s,n,r,o,a){var l=s?e.clientY:e.clientX,h=s?i.height:i.width,c=s?i.top:i.left,d=s?i.bottom:i.right,u=!1;if(!o)if(a&&Un<h*n){if(!Yn&&(1===Wn?l>c+h*r/2:l<d-h*r/2)&&(Yn=!0),Yn)u=!0;else if(1===Wn?l<c+Un:l>d-Un)return-Wn}else if(l>c+h*(1-n)/2&&l<d-h*(1-n)/2)return function(e){return on(Cn)<on(e)?1:-1}(t);return(u=u||o)&&(l<c+h*r/2||l>d-h*r/2)?l>c+h/2?1:-1:0}(e,o,i,n,C?1:a.swapThreshold,null==a.invertedSwapThreshold?a.swapThreshold:a.invertedSwapThreshold,Xn,Vn===o),0!==_){var x=on(Cn);do{x-=_,b=wn.children[x]}while(b&&("none"===Zs(b,"display")||b===Sn))}if(0===_||b===o)return D(!1);Vn=o,Wn=_;var T=o.nextElementSibling,O=!1,k=ur(En,r,Cn,t,o,i,e,O=1===_);if(!1!==k)return 1!==k&&-1!==k||(O=1===k),Qn=!0,setTimeout(mr,30),A(),O&&!T?r.appendChild(Cn):o.parentNode.insertBefore(Cn,O?T:o),S&&dn(S,0,E-S.scrollTop),wn=Cn.parentNode,void 0===v||Xn||(Un=Math.abs(v-tn(o)[w])),R(),D(!0)}if(r.contains(Cn))return D(!1)}return!1}function I(a,l){bn(a,p,Ds({evt:e,isOwner:c,axis:n?"vertical":"horizontal",revert:s,dragRect:t,targetRect:i,canSort:d,fromSortable:u,target:o,completed:D,onMove:function(i,s){return ur(En,r,Cn,t,i,tn(i),e,s)},changed:R},l))}function A(){I("dragOverAnimationCapture"),p.captureAnimationState(),p!==u&&u.captureAnimationState()}function D(t){return I("dragOverCompleted",{insertion:t}),t&&(c?h._hideClone():h._showClone(p),p!==u&&(Xs(Cn,Ln?Ln.options.ghostClass:h.options.ghostClass,!1),Xs(Cn,a.ghostClass,!0)),Ln!==p&&p!==dr.active?Ln=p:p===dr.active&&Ln&&(Ln=null),u===p&&(p._ignoreWhileAnimating=o),p.animateAll((function(){I("dragOverAnimationComplete"),p._ignoreWhileAnimating=null})),p!==u&&(u.animateAll(),u._ignoreWhileAnimating=null)),(o===Cn&&!Cn.animated||o===r&&!o.animated)&&(Vn=null),a.dragoverBubble||e.rootEl||o===document||(Cn.parentNode[mn]._isOutsideThisEl(e.target),!t&&hr(e)),!a.dragoverBubble&&e.stopPropagation&&e.stopPropagation(),m=!0}function R(){An=on(Cn),Rn=on(Cn,a.draggable),yn({sortable:p,name:"change",toEl:r,newIndex:An,newDraggableIndex:Rn,originalEvent:e})}},_ignoreWhileAnimating:null,_offMoveEvents:function(){Us(document,"mousemove",this._onTouchMove),Us(document,"touchmove",this._onTouchMove),Us(document,"pointermove",this._onTouchMove),Us(document,"dragover",hr),Us(document,"mousemove",hr),Us(document,"touchmove",hr)},_offUpEvents:function(){var e=this.el.ownerDocument;Us(e,"mouseup",this._onDrop),Us(e,"touchend",this._onDrop),Us(e,"pointerup",this._onDrop),Us(e,"touchcancel",this._onDrop),Us(document,"selectstart",this)},_onDrop:function(e){var t=this.el,i=this.options;An=on(Cn),Rn=on(Cn,i.draggable),bn("drop",this,{evt:e}),wn=Cn&&Cn.parentNode,An=on(Cn),Rn=on(Cn,i.draggable),dr.eventCanceled||(Gn=!1,Xn=!1,Yn=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),_r(this.cloneId),_r(this._dragStartId),this.nativeDraggable&&(Us(document,"drop",this),Us(t,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),Hs&&Zs(document.body,"user-select",""),Zs(Cn,"transform",""),e&&($n&&(e.cancelable&&e.preventDefault(),!i.dropBubble&&e.stopPropagation()),Sn&&Sn.parentNode&&Sn.parentNode.removeChild(Sn),(En===wn||Ln&&"clone"!==Ln.lastPutMode)&&On&&On.parentNode&&On.parentNode.removeChild(On),Cn&&(this.nativeDraggable&&Us(Cn,"dragend",this),pr(Cn),Cn.style["will-change"]="",$n&&!Gn&&Xs(Cn,Ln?Ln.options.ghostClass:this.options.ghostClass,!1),Xs(Cn,this.options.chosenClass,!1),yn({sortable:this,name:"unchoose",toEl:wn,newIndex:null,newDraggableIndex:null,originalEvent:e}),En!==wn?(An>=0&&(yn({rootEl:wn,name:"add",toEl:wn,fromEl:En,originalEvent:e}),yn({sortable:this,name:"remove",toEl:wn,originalEvent:e}),yn({rootEl:wn,name:"sort",toEl:wn,fromEl:En,originalEvent:e}),yn({sortable:this,name:"sort",toEl:wn,originalEvent:e})),Ln&&Ln.save()):An!==In&&An>=0&&(yn({sortable:this,name:"update",toEl:wn,originalEvent:e}),yn({sortable:this,name:"sort",toEl:wn,originalEvent:e})),dr.active&&(null!=An&&-1!==An||(An=In,Rn=Dn),yn({sortable:this,name:"end",toEl:wn,originalEvent:e}),this.save())))),this._nulling()},_nulling:function(){bn("nulling",this),En=Cn=wn=Sn=xn=On=Tn=kn=Mn=Nn=$n=An=Rn=In=Dn=Vn=Wn=Ln=Pn=dr.dragged=dr.ghost=dr.clone=dr.active=null,Jn.forEach((function(e){e.checked=!0})),Jn.length=Fn=Bn=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":Cn&&(this._onDragOver(e),function(e){e.dataTransfer&&(e.dataTransfer.dropEffect="move"),e.cancelable&&e.preventDefault()}(e));break;case"selectstart":e.preventDefault()}},toArray:function(){for(var e,t=[],i=this.el.children,s=0,n=i.length,r=this.options;s<n;s++)qs(e=i[s],r.draggable,this.el,!1)&&t.push(e.getAttribute(r.dataIdAttr)||fr(e));return t},sort:function(e,t){var i={},s=this.el;this.toArray().forEach((function(e,t){var n=s.children[t];qs(n,this.options.draggable,s,!1)&&(i[e]=n)}),this),t&&this.captureAnimationState(),e.forEach((function(e){i[e]&&(s.removeChild(i[e]),s.appendChild(i[e]))})),t&&this.animateAll()},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,t){return qs(e,t||this.options.draggable,this.el,!1)},option:function(e,t){var i=this.options;if(void 0===t)return i[e];var s=_n.modifyOption(this,e,t);i[e]=void 0!==s?s:t,"group"===e&&or(i)},destroy:function(){bn("destroy",this);var e=this.el;e[mn]=null,Us(e,"mousedown",this._onTapStart),Us(e,"touchstart",this._onTapStart),Us(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(Us(e,"dragover",this),Us(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),(function(e){e.removeAttribute("draggable")})),this._onDrop(),this._disableDelayedDragEvents(),Kn.splice(Kn.indexOf(this.el),1),this.el=e=null},_hideClone:function(){if(!kn){if(bn("hideClone",this),dr.eventCanceled)return;Zs(On,"display","none"),this.options.removeCloneOnHide&&On.parentNode&&On.parentNode.removeChild(On),kn=!0}},_showClone:function(e){if("clone"===e.lastPutMode){if(kn){if(bn("showClone",this),dr.eventCanceled)return;Cn.parentNode!=En||this.options.group.revertClone?xn?En.insertBefore(On,xn):En.appendChild(On):En.insertBefore(On,Cn),this.options.group.revertClone&&this.animate(Cn,On),Zs(On,"display",""),kn=!1}}else this._hideClone()}},er&&Ws(document,"touchmove",(function(e){(dr.active||Gn)&&e.cancelable&&e.preventDefault()})),dr.utils={on:Ws,off:Us,css:Zs,find:Js,is:function(e,t){return!!qs(e,t,e,!1)},extend:function(e,t){if(e&&t)for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e},throttle:cn,closest:qs,toggleClass:Xs,clone:un,index:on,nextTick:gr,cancelNextTick:_r,detectDirection:rr,getChild:nn,expando:mn},dr.get=function(e){return e[mn]},dr.mount=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];t[0].constructor===Array&&(t=t[0]),t.forEach((function(e){if(!e.prototype||!e.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(e));e.utils&&(dr.utils=Ds(Ds({},dr.utils),e.utils)),_n.mount(e)}))},dr.create=function(e,t){return new dr(e,t)},dr.version="1.15.3";var vr,br,yr,Cr,wr,Sr,Er=[],xr=!1;function Tr(){Er.forEach((function(e){clearInterval(e.pid)})),Er=[]}function Or(){clearInterval(Sr)}var kr=cn((function(e,t,i,s){if(t.scroll){var n,r=(e.touches?e.touches[0]:e).clientX,o=(e.touches?e.touches[0]:e).clientY,a=t.scrollSensitivity,l=t.scrollSpeed,h=en(),c=!1;br!==i&&(br=i,Tr(),vr=t.scroll,n=t.scrollFn,!0===vr&&(vr=ln(i,!0)));var d=0,u=vr;do{var p=u,m=tn(p),f=m.top,g=m.bottom,_=m.left,v=m.right,b=m.width,y=m.height,C=void 0,w=void 0,S=p.scrollWidth,E=p.scrollHeight,x=Zs(p),T=p.scrollLeft,O=p.scrollTop;p===h?(C=b<S&&("auto"===x.overflowX||"scroll"===x.overflowX||"visible"===x.overflowX),w=y<E&&("auto"===x.overflowY||"scroll"===x.overflowY||"visible"===x.overflowY)):(C=b<S&&("auto"===x.overflowX||"scroll"===x.overflowX),w=y<E&&("auto"===x.overflowY||"scroll"===x.overflowY));var k=C&&(Math.abs(v-r)<=a&&T+b<S)-(Math.abs(_-r)<=a&&!!T),I=w&&(Math.abs(g-o)<=a&&O+y<E)-(Math.abs(f-o)<=a&&!!O);if(!Er[d])for(var A=0;A<=d;A++)Er[A]||(Er[A]={});Er[d].vx==k&&Er[d].vy==I&&Er[d].el===p||(Er[d].el=p,Er[d].vx=k,Er[d].vy=I,clearInterval(Er[d].pid),0==k&&0==I||(c=!0,Er[d].pid=setInterval(function(){s&&0===this.layer&&dr.active._onTouchMove(wr);var t=Er[this.layer].vy?Er[this.layer].vy*l:0,i=Er[this.layer].vx?Er[this.layer].vx*l:0;"function"==typeof n&&"continue"!==n.call(dr.dragged.parentNode[mn],i,t,e,wr,Er[this.layer].el)||dn(Er[this.layer].el,i,t)}.bind({layer:d}),24))),d++}while(t.bubbleScroll&&u!==h&&(u=ln(u,!1)));xr=c}}),30),Ir=function(e){var t=e.originalEvent,i=e.putSortable,s=e.dragEl,n=e.activeSortable,r=e.dispatchSortableEvent,o=e.hideGhostForTarget,a=e.unhideGhostForTarget;if(t){var l=i||n;o();var h=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:t,c=document.elementFromPoint(h.clientX,h.clientY);a(),l&&!l.el.contains(c)&&(r("spill"),this.onSpill({dragEl:s,putSortable:i}))}};function Ar(){}function Dr(){}Ar.prototype={startIndex:null,dragStart:function(e){var t=e.oldDraggableIndex;this.startIndex=t},onSpill:function(e){var t=e.dragEl,i=e.putSortable;this.sortable.captureAnimationState(),i&&i.captureAnimationState();var s=nn(this.sortable.el,this.startIndex,this.options);s?this.sortable.el.insertBefore(t,s):this.sortable.el.appendChild(t),this.sortable.animateAll(),i&&i.animateAll()},drop:Ir},Ls(Ar,{pluginName:"revertOnSpill"}),Dr.prototype={onSpill:function(e){var t=e.dragEl,i=e.putSortable||this.sortable;i.captureAnimationState(),t.parentNode&&t.parentNode.removeChild(t),i.animateAll()},drop:Ir},Ls(Dr,{pluginName:"removeOnSpill"}),dr.mount(new function(){function e(){for(var e in this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0},this)"_"===e.charAt(0)&&"function"==typeof this[e]&&(this[e]=this[e].bind(this))}return e.prototype={dragStarted:function(e){var t=e.originalEvent;this.sortable.nativeDraggable?Ws(document,"dragover",this._handleAutoScroll):this.options.supportPointer?Ws(document,"pointermove",this._handleFallbackAutoScroll):t.touches?Ws(document,"touchmove",this._handleFallbackAutoScroll):Ws(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(e){var t=e.originalEvent;this.options.dragOverBubble||t.rootEl||this._handleAutoScroll(t)},drop:function(){this.sortable.nativeDraggable?Us(document,"dragover",this._handleAutoScroll):(Us(document,"pointermove",this._handleFallbackAutoScroll),Us(document,"touchmove",this._handleFallbackAutoScroll),Us(document,"mousemove",this._handleFallbackAutoScroll)),Or(),Tr(),clearTimeout(Ks),Ks=void 0},nulling:function(){wr=br=vr=xr=Sr=yr=Cr=null,Er.length=0},_handleFallbackAutoScroll:function(e){this._handleAutoScroll(e,!0)},_handleAutoScroll:function(e,t){var i=this,s=(e.touches?e.touches[0]:e).clientX,n=(e.touches?e.touches[0]:e).clientY,r=document.elementFromPoint(s,n);if(wr=e,t||this.options.forceAutoScrollFallback||Fs||Ns||Hs){kr(e,this.options,r,t);var o=ln(r,!0);!xr||Sr&&s===yr&&n===Cr||(Sr&&Or(),Sr=setInterval((function(){var r=ln(document.elementFromPoint(s,n),!0);r!==o&&(o=r,Tr()),kr(e,i.options,r,t)}),10),yr=s,Cr=n)}else{if(!this.options.bubbleScroll||ln(r,!0)===en())return void Tr();kr(e,this.options,ln(r,!1),!1)}}},Ls(e,{pluginName:"scroll",initializeByDefault:!0})}),dr.mount(Dr,Ar);const Rr=dr;function Pr(e){let{containerElement:t}=e;const{onDragInit:i,onDragStart:s,onDrag:n,onDragEnd:r,preventDragFromKeys:o}=e;let a,l,h,c,d,u;t||(t=document.body);let p={dragSource:t,dragHandle:null};function m(e,t,i){if("function"==typeof e)return e(t,i)}function f(e){let t=!1;return o&&o.forEach((i=>{e[i]&&(t=!0)})),t}function g(t){if(a=t.target,!f(t)){const s=t?.touches?.[0]??t,{target:n}=s;if(!e.allowDragFrom||e.allowDragFrom&&a.matches(e.allowDragFrom)||e.allowDragFromClosest&&a.closest(e.allowDragFromClosest)){p.dragHandle=a;const e=_e();l=e.left+s.clientX,h=e.top+s.clientY,c=s.clientX-s.clientX,d=s.clientY-s.clientY,p=Object.assign(p,{deltaX:c,deltaY:d,startX:l,startY:h,target:n}),!1!==m(i,t,p)&&(document.body.addEventListener("mousemove",_),document.body.addEventListener("touchmove",_),document.body.addEventListener("mouseup",v),document.body.addEventListener("touchend",v),document.body.addEventListener("touchcancel",v))}}}function _(e){const t=e?.touches?.[0]??e;if(!f(e)){c=t.clientX-l,d=t.clientY-h;const{target:i}=t;u||(p=Object.assign(p,{deltaX:c,deltaY:d,startX:l,startY:h,target:i}),m(s,e,p),u=!0),p=Object.assign(p,{deltaX:c,deltaY:d,startX:l,startY:h,target:i}),m(n,e,p)}}function v(e){if(document.body.removeEventListener("mousemove",_),document.body.removeEventListener("touchmove",_),document.body.removeEventListener("mouseup",v),document.body.removeEventListener("touchend",v),document.body.removeEventListener("touchcancel",v),u){const{target:t}=e;p=Object.assign(p,{target:t}),m(r,e,p),u=!1}}return t&&(t.addEventListener("mousedown",g),t.addEventListener("touchstart",g)),{destroy:function(){t&&(t.removeEventListener("mousedown",g),t.removeEventListener("touchstart",g))}}}function Lr(e){const{element:t,onMouseWheel:i}=e;function s(e){const t=e||window.event;let s=0,n=0,r=0;t.wheelDelta&&(s=t.wheelDelta/120),t.detail&&(s=-t.detail/3),r=s,void 0!==t.axis&&t.axis===t.HORIZONTAL_AXIS&&(r=0,n=-1*s),void 0!==t.wheelDeltaY&&(r=t.wheelDeltaY/120),void 0!==t.wheelDeltaX&&(n=-1*t.wheelDeltaX/120),"function"==typeof i&&i(e,s,n,r)}return t.addEventListener("wheel",s),t.addEventListener("mousewheel",s),{destroy:function(){t.removeEventListener("wheel",s),t.removeEventListener("mousewheel",s)}}}function Mr(e){const{resizeableElement:t,resizeableHandleElement:i,onResizeStart:s,onResize:n,onResizeEnd:r}=e;if(!i||"function"!=typeof i.addEventListener)throw new Error("[SlickResizable] You did not provide a valid html element that will be used for the handle to resize.");function o(e,s){if("function"==typeof e)return e(s,{resizeableElement:t,resizeableHandleElement:i})}function a(e){e.preventDefault();const t=e.touches?e.changedTouches[0]:e;!1!==o(s,t)&&(document.body.addEventListener("mousemove",l),document.body.addEventListener("mouseup",h),document.body.addEventListener("touchmove",l),document.body.addEventListener("touchend",h))}function l(e){e.preventDefault&&"touchmove"!==e.type&&e.preventDefault();const s=e.touches?e.changedTouches[0]:e;"function"==typeof n&&n(s,{resizeableElement:t,resizeableHandleElement:i})}function h(e){const t=e.touches?e.changedTouches[0]:e;o(r,t),document.body.removeEventListener("mousemove",l),document.body.removeEventListener("mouseup",h),document.body.removeEventListener("touchmove",l),document.body.removeEventListener("touchend",h)}return i.addEventListener("mousedown",a),i.addEventListener("touchstart",a),{destroy:function(){"function"==typeof i?.removeEventListener&&(i.removeEventListener("mousedown",a),i.removeEventListener("touchstart",a))}}}class Nr{constructor(e,t,i,s,n){if(this.container=e,this.data=t,this.columns=i,this.externalPubSub=n,this.cid="",this.canvas=null,this.canvas_context=null,this._defaults={alwaysShowVerticalScroll:!1,alwaysAllowHorizontalScroll:!1,explicitInitialization:!1,rowHeight:25,defaultColumnWidth:80,enableHtmlRendering:!0,enableAddRow:!1,leaveSpaceForNewRows:!1,editable:!1,autoEdit:!0,autoEditNewRow:!0,autoCommitEdit:!1,suppressActiveCellChangeOnEdit:!1,enableCellNavigation:!0,enableColumnReorder:!0,unorderableColumnCssClass:"unorderable",asyncEditorLoading:!1,asyncEditorLoadDelay:100,forceFitColumns:!1,enableAsyncPostRender:!1,asyncPostRenderDelay:50,enableAsyncPostRenderCleanup:!1,asyncPostRenderCleanupDelay:40,columnResizingDelay:300,nonce:"",editorLock:Os,showColumnHeader:!0,showHeaderRow:!1,headerRowHeight:25,createFooterRow:!1,showFooterRow:!1,footerRowHeight:25,createPreHeaderPanel:!1,createTopHeaderPanel:!1,showPreHeaderPanel:!1,showTopHeaderPanel:!1,preHeaderPanelHeight:25,preHeaderPanelWidth:"auto",topHeaderPanelHeight:25,topHeaderPanelWidth:"auto",showTopPanel:!1,topPanelHeight:25,formatterFactory:null,editorFactory:null,cellFlashingCssClass:"flashing",rowHighlightCssClass:"highlight-animate",rowHighlightDuration:400,selectedCellCssClass:"selected",multiSelect:!0,enableTextSelectionOnCells:!1,dataItemColumnValueExtractor:null,frozenBottom:!1,frozenColumn:-1,frozenRow:-1,frozenRightViewportMinWidth:100,throwWhenFrozenNotAllViewable:!1,fullWidthRows:!1,multiColumnSort:!1,numberedMultiColumnSort:!1,tristateMultiColumnSort:!1,sortColNumberInSeparateSpan:!1,defaultFormatter:this.defaultFormatter,forceSyncScrolling:!1,addNewRowCssClass:"new-row",preserveCopiedSelectionOnPaste:!1,preventDragFromKeys:["ctrlKey","metaKey"],showCellSelection:!0,viewportClass:void 0,minRowBuffer:3,emulatePagingWhenScrolling:!0,editorCellNavOnLRKeys:!1,enableMouseWheelScrollHandler:!0,doPaging:!0,rowTopOffsetRenderType:"top",scrollRenderThrottling:10,suppressCssChangesOnHiddenInit:!1,ffMaxSupportedCssHeight:6e6,maxSupportedCssHeight:1e9,sanitizer:void 0,mixinDefaults:!1,shadowRoot:void 0},this._columnDefaults={name:"",headerCssClass:null,defaultSortAsc:!0,focusable:!0,hidden:!1,minWidth:30,maxWidth:void 0,rerenderOnResize:!1,reorderable:!0,resizable:!0,sortable:!1,selectable:!0},this.page=0,this.offset=0,this.vScrollDir=1,this._bindingEventService=new Wt,this.initialized=!1,this.uid=`slickgrid_${Math.round(1e6*Math.random())}`,this._groupHeaders=[],this._headerScroller=[],this._headers=[],this._boundAncestors=[],this.viewportH=0,this.viewportW=0,this.canvasWidth=0,this.canvasWidthL=0,this.canvasWidthR=0,this.headersWidth=0,this.headersWidthL=0,this.headersWidthR=0,this.viewportHasHScroll=!1,this.viewportHasVScroll=!1,this.headerColumnWidthDiff=0,this.headerColumnHeightDiff=0,this.cellWidthDiff=0,this.cellHeightDiff=0,this.hasFrozenRows=!1,this.frozenRowsHeight=0,this.actualFrozenRow=-1,this.paneTopH=0,this.paneBottomH=0,this.viewportTopH=0,this.viewportBottomH=0,this.topPanelH=0,this.headerRowH=0,this.footerRowH=0,this.tabbingDirection=1,this.activeCellNode=null,this.currentEditor=null,this.rowsCache={},this.renderedRows=0,this.numVisibleRows=0,this.prevScrollTop=0,this.scrollHeight=0,this.scrollTop=0,this.lastRenderedScrollTop=0,this.lastRenderedScrollLeft=0,this.prevScrollLeft=0,this.scrollLeft=0,this.selectedRows=[],this.plugins=[],this.cellCssClasses={},this.columnsById={},this.sortColumns=[],this.columnPosLeft=[],this.columnPosRight=[],this.pagingActive=!1,this.pagingIsLastPage=!1,this.h_render=null,this.postProcessedRows={},this.postProcessToRow=null,this.postProcessFromRow=null,this.postProcessedCleanupQueue=[],this.postProcessgroupId=0,this.counter_rows_rendered=0,this.counter_rows_removed=0,this.cssShow={position:"absolute",visibility:"hidden",display:"block"},this._hiddenParents=[],this.oldProps=[],this.enforceFrozenRowHeightRecalc=!1,this.columnResizeDragging=!1,this.slickDraggableInstance=null,this.slickMouseWheelInstances=[],this.slickResizableInstances=[],this.logMessageMaxCount=30,this._container="string"==typeof this.container?document.querySelector(this.container):this.container,!this._container)throw new Error(`SlickGrid requires a valid container, ${this.container} does not exist in the DOM.`);this._pubSubService=n,this.onActiveCellChanged=new ys("onActiveCellChanged",n),this.onActiveCellPositionChanged=new ys("onActiveCellPositionChanged",n),this.onAddNewRow=new ys("onAddNewRow",n),this.onAfterSetColumns=new ys("onAfterSetColumns",n),this.onAutosizeColumns=new ys("onAutosizeColumns",n),this.onBeforeAppendCell=new ys("onBeforeAppendCell",n),this.onBeforeCellEditorDestroy=new ys("onBeforeCellEditorDestroy",n),this.onBeforeColumnsResize=new ys("onBeforeColumnsResize",n),this.onBeforeDestroy=new ys("onBeforeDestroy",n),this.onBeforeEditCell=new ys("onBeforeEditCell",n),this.onBeforeFooterRowCellDestroy=new ys("onBeforeFooterRowCellDestroy",n),this.onBeforeHeaderCellDestroy=new ys("onBeforeHeaderCellDestroy",n),this.onBeforeHeaderRowCellDestroy=new ys("onBeforeHeaderRowCellDestroy",n),this.onBeforeSetColumns=new ys("onBeforeSetColumns",n),this.onBeforeSort=new ys("onBeforeSort",n),this.onBeforeUpdateColumns=new ys("onBeforeUpdateColumns",n),this.onCellChange=new ys("onCellChange",n),this.onCellCssStylesChanged=new ys("onCellCssStylesChanged",n),this.onClick=new ys("onClick",n),this.onColumnsReordered=new ys("onColumnsReordered",n),this.onColumnsDrag=new ys("onColumnsDrag",n),this.onColumnsResized=new ys("onColumnsResized",n),this.onColumnsResizeDblClick=new ys("onColumnsResizeDblClick",n),this.onCompositeEditorChange=new ys("onCompositeEditorChange",n),this.onContextMenu=new ys("onContextMenu",n),this.onDblClick=new ys("onDblClick",n),this.onDrag=new ys("onDrag",n),this.onDragInit=new ys("onDragInit",n),this.onDragStart=new ys("onDragStart",n),this.onDragEnd=new ys("onDragEnd",n),this.onFooterClick=new ys("onFooterClick",n),this.onFooterContextMenu=new ys("onFooterContextMenu",n),this.onFooterRowCellRendered=new ys("onFooterRowCellRendered",n),this.onHeaderCellRendered=new ys("onHeaderCellRendered",n),this.onHeaderClick=new ys("onHeaderClick",n),this.onHeaderContextMenu=new ys("onHeaderContextMenu",n),this.onHeaderMouseEnter=new ys("onHeaderMouseEnter",n),this.onHeaderMouseLeave=new ys("onHeaderMouseLeave",n),this.onHeaderMouseOver=new ys("onHeaderMouseOver",n),this.onHeaderMouseOut=new ys("onHeaderMouseOut",n),this.onHeaderRowMouseOver=new ys("onHeaderRowMouseOver",n),this.onHeaderRowMouseOut=new ys("onHeaderRowMouseOut",n),this.onHeaderRowCellRendered=new ys("onHeaderRowCellRendered",n),this.onHeaderRowMouseEnter=new ys("onHeaderRowMouseEnter",n),this.onHeaderRowMouseLeave=new ys("onHeaderRowMouseLeave",n),this.onKeyDown=new ys("onKeyDown",n),this.onMouseEnter=new ys("onMouseEnter",n),this.onMouseLeave=new ys("onMouseLeave",n),this.onPreHeaderClick=new ys("onPreHeaderClick",n),this.onPreHeaderContextMenu=new ys("onPreHeaderContextMenu",n),this.onRendered=new ys("onRendered",n),this.onScroll=new ys("onScroll",n),this.onSelectedRowsChanged=new ys("onSelectedRowsChanged",n),this.onSetOptions=new ys("onSetOptions",n),this.onActivateChangedOptions=new ys("onActivateChangedOptions",n),this.onSort=new ys("onSort",n),this.onValidationError=new ys("onValidationError",n),this.onViewportChanged=new ys("onViewportChanged",n),this.initialize(s)}init(){!this._options.silenceWarnings&&document.body.style.zoom&&"100%"!==document.body.style.zoom&&console.warn("[Slickgrid-Universal] Zoom level other than 100% is not supported by the library and will give subpar experience. SlickGrid relies on the `rowHeight` grid option to do row positioning & calculation and when zoom is not 100% then calculation becomes all offset."),this.finishInitialization()}applyHtmlCode(e,t="",i){if(e)if(t instanceof HTMLElement||t instanceof DocumentFragment)!1!==i?.emptyTarget&&re(e),e.appendChild(t);else{if(!1!==i?.skipEmptyReassignment&&!Me(t)&&!e.innerHTML)return;if("number"==typeof t||"boolean"==typeof t)e.textContent=String(t);else{const i=this.sanitizeHtmlString(t);this._options.enableHtmlRendering&&i?e.innerHTML=i:e.textContent=i}}}initialize(e){if(e?.mixinDefaults?(this._options||(this._options=e),Ts.applyDefaults(this._options,this._defaults)):this._options=Te(!0,{},this._defaults,e),this.scrollThrottle=this.actionThrottle(this.render.bind(this),this._options.scrollRenderThrottling),this.maxSupportedCssHeight=this.maxSupportedCssHeight||this.getMaxSupportedCssHeight(),this.validateAndEnforceOptions(),this._columnDefaults.width=this._options.defaultColumnWidth,this._options.suppressCssChangesOnHiddenInit||this.cacheCssForHiddenInit(),this.updateColumnProps(),this._options.enableColumnReorder&&(!Rr||!Rr.create))throw new Error("SlickGrid requires Sortable.js module to be loaded");this.editController={commitCurrentEdit:this.commitCurrentEdit.bind(this),cancelCurrentEdit:this.cancelCurrentEdit.bind(this)},re(this._container),this._container.style.outline=String(0),this._container.classList.add(this.uid),this._container.classList.add("slick-widget"),this._container.setAttribute("role","grid");const t=window.getComputedStyle(this._container);/relative|absolute|fixed/.test(t.position)||(this._container.style.position="relative"),this._focusSink=ie("div",{tabIndex:0,style:{position:"fixed",width:"0px",height:"0px",top:"0px",left:"0px",outline:"0px"}},this._container),this._options.createTopHeaderPanel&&(this._topHeaderPanelScroller=ie("div",{className:"slick-topheader-panel slick-state-default",style:{overflow:"hidden",position:"relative"}},this._container),this._topHeaderPanelScroller.appendChild(document.createElement("div")),this._topHeaderPanel=ie("div",null,this._topHeaderPanelScroller),this._topHeaderPanelSpacer=ie("div",{style:{display:"block",height:"1px",position:"absolute",top:"0px",left:"0px"}},this._topHeaderPanelScroller),this._options.showTopHeaderPanel||Ts.hide(this._topHeaderPanelScroller)),this._paneHeaderL=ie("div",{className:"slick-pane slick-pane-header slick-pane-left",tabIndex:0},this._container),this._paneHeaderR=ie("div",{className:"slick-pane slick-pane-header slick-pane-right",tabIndex:0},this._container),this._paneTopL=ie("div",{className:"slick-pane slick-pane-top slick-pane-left",tabIndex:0},this._container),this._paneTopR=ie("div",{className:"slick-pane slick-pane-top slick-pane-right",tabIndex:0},this._container),this._paneBottomL=ie("div",{className:"slick-pane slick-pane-bottom slick-pane-left",tabIndex:0},this._container),this._paneBottomR=ie("div",{className:"slick-pane slick-pane-bottom slick-pane-right",tabIndex:0},this._container),this._options.createPreHeaderPanel&&(this._preHeaderPanelScroller=ie("div",{className:"slick-preheader-panel slick-state-default",style:{overflow:"hidden",position:"relative"}},this._paneHeaderL),this._preHeaderPanelScroller.appendChild(document.createElement("div")),this._preHeaderPanel=ie("div",null,this._preHeaderPanelScroller),this._preHeaderPanelSpacer=ie("div",{style:{display:"block",height:"1px",position:"absolute",top:"0px",left:"0px"}},this._preHeaderPanelScroller),this._preHeaderPanelScrollerR=ie("div",{className:"slick-preheader-panel slick-state-default",style:{overflow:"hidden",position:"relative"}},this._paneHeaderR),this._preHeaderPanelR=ie("div",null,this._preHeaderPanelScrollerR),this._preHeaderPanelSpacerR=ie("div",{style:{display:"block",height:"1px",position:"absolute",top:"0px",left:"0px"}},this._preHeaderPanelScrollerR),this._options.showPreHeaderPanel||(Ts.hide(this._preHeaderPanelScroller),Ts.hide(this._preHeaderPanelScrollerR))),this._headerScrollerL=ie("div",{className:"slick-header slick-state-default slick-header-left"},this._paneHeaderL),this._headerScrollerR=ie("div",{className:"slick-header slick-state-default slick-header-right"},this._paneHeaderR),this._headerScroller.push(this._headerScrollerL),this._headerScroller.push(this._headerScrollerR),this._headerL=ie("div",{className:"slick-header-columns slick-header-columns-left",style:{left:"-1000px"}},this._headerScrollerL),this._headerR=ie("div",{className:"slick-header-columns slick-header-columns-right",style:{left:"-1000px"}},this._headerScrollerR),this._headers=[this._headerL,this._headerR],this._headerRowScrollerL=ie("div",{className:"slick-headerrow slick-state-default"},this._paneTopL),this._headerRowScrollerR=ie("div",{className:"slick-headerrow slick-state-default"},this._paneTopR),this._headerRowScroller=[this._headerRowScrollerL,this._headerRowScrollerR],this._headerRowSpacerL=ie("div",{style:{display:"block",height:"1px",position:"absolute",top:"0px",left:"0px"}},this._headerRowScrollerL),this._headerRowSpacerR=ie("div",{style:{display:"block",height:"1px",position:"absolute",top:"0px",left:"0px"}},this._headerRowScrollerR),this._headerRowL=ie("div",{className:"slick-headerrow-columns slick-headerrow-columns-left"},this._headerRowScrollerL),this._headerRowR=ie("div",{className:"slick-headerrow-columns slick-headerrow-columns-right"},this._headerRowScrollerR),this._headerRows=[this._headerRowL,this._headerRowR],this._topPanelScrollerL=ie("div",{className:"slick-top-panel-scroller slick-state-default"},this._paneTopL),this._topPanelScrollerR=ie("div",{className:"slick-top-panel-scroller slick-state-default"},this._paneTopR),this._topPanelScrollers=[this._topPanelScrollerL,this._topPanelScrollerR],this._topPanelL=ie("div",{className:"slick-top-panel",style:{width:"10000px"}},this._topPanelScrollerL),this._topPanelR=ie("div",{className:"slick-top-panel",style:{width:"10000px"}},this._topPanelScrollerR),this._topPanels=[this._topPanelL,this._topPanelR],this._options.showColumnHeader||this._headerScroller.forEach((e=>{Ts.hide(e)})),this._options.showTopPanel||this._topPanelScrollers.forEach((e=>{Ts.hide(e)})),this._options.showHeaderRow||this._headerRowScroller.forEach((e=>{Ts.hide(e)})),this._viewportTopL=ie("div",{className:"slick-viewport slick-viewport-top slick-viewport-left",tabIndex:0},this._paneTopL),this._viewportTopR=ie("div",{className:"slick-viewport slick-viewport-top slick-viewport-right",tabIndex:0},this._paneTopR),this._viewportBottomL=ie("div",{className:"slick-viewport slick-viewport-bottom slick-viewport-left",tabIndex:0},this._paneBottomL),this._viewportBottomR=ie("div",{className:"slick-viewport slick-viewport-bottom slick-viewport-right",tabIndex:0},this._paneBottomR),this._viewport=[this._viewportTopL,this._viewportTopR,this._viewportBottomL,this._viewportBottomR],this._options.viewportClass&&this._viewport.forEach((e=>{e.classList.add(...se(this._options.viewportClass))})),this._activeViewportNode=this._viewportTopL,this._canvasTopL=ie("div",{className:"grid-canvas grid-canvas-top grid-canvas-left",tabIndex:0},this._viewportTopL),this._canvasTopR=ie("div",{className:"grid-canvas grid-canvas-top grid-canvas-right",tabIndex:0},this._viewportTopR),this._canvasBottomL=ie("div",{className:"grid-canvas grid-canvas-bottom grid-canvas-left",tabIndex:0},this._viewportBottomL),this._canvasBottomR=ie("div",{className:"grid-canvas grid-canvas-bottom grid-canvas-right",tabIndex:0},this._viewportBottomR),this._canvas=[this._canvasTopL,this._canvasTopR,this._canvasBottomL,this._canvasBottomR],this.scrollbarDimensions=this.scrollbarDimensions||this.measureScrollbar(),this._activeCanvasNode=this._canvasTopL,this._topHeaderPanelSpacer&&Ts.width(this._topHeaderPanelSpacer,this.getCanvasWidth()+this.scrollbarDimensions.width),this._preHeaderPanelSpacer&&Ts.width(this._preHeaderPanelSpacer,this.getCanvasWidth()+this.scrollbarDimensions.width),this._headers.forEach((e=>{Ts.width(e,this.getHeadersWidth())})),Ts.width(this._headerRowSpacerL,this.getCanvasWidth()+this.scrollbarDimensions.width),Ts.width(this._headerRowSpacerR,this.getCanvasWidth()+this.scrollbarDimensions.width),this._options.createFooterRow&&(this._footerRowScrollerR=ie("div",{className:"slick-footerrow slick-state-default"},this._paneTopR),this._footerRowScrollerL=ie("div",{className:"slick-footerrow slick-state-default"},this._paneTopL),this._footerRowScroller=[this._footerRowScrollerL,this._footerRowScrollerR],this._footerRowSpacerL=ie("div",{style:{display:"block",height:"1px",position:"absolute",top:"0px",left:"0px"}},this._footerRowScrollerL),Ts.width(this._footerRowSpacerL,this.getCanvasWidth()+this.scrollbarDimensions.width),this._footerRowSpacerR=ie("div",{style:{display:"block",height:"1px",position:"absolute",top:"0px",left:"0px"}},this._footerRowScrollerR),Ts.width(this._footerRowSpacerR,this.getCanvasWidth()+this.scrollbarDimensions.width),this._footerRowL=ie("div",{className:"slick-footerrow-columns slick-footerrow-columns-left"},this._footerRowScrollerL),this._footerRowR=ie("div",{className:"slick-footerrow-columns slick-footerrow-columns-right"},this._footerRowScrollerR),this._footerRow=[this._footerRowL,this._footerRowR],this._options.showFooterRow||this._footerRowScroller.forEach((e=>{Ts.hide(e)}))),this._focusSink2=this._focusSink.cloneNode(!0),this._container.appendChild(this._focusSink2),this._options.explicitInitialization||this.finishInitialization()}finishInitialization(){this.initialized||(this.initialized=!0,this.getViewportWidth(),this.getViewportHeight(),this.measureCellPaddingAndBorder(),this.disableSelection(this._headers),this._options.enableTextSelectionOnCells||this._viewport.forEach((e=>{this._bindingEventService.bind(e,"selectstart",(e=>{e.target instanceof HTMLInputElement||(e.target,HTMLTextAreaElement)}))})),this.setFrozenOptions(),this.setPaneVisibility(),this.setScroller(),this.setOverflow(),this.updateColumnCaches(),this.createColumnHeaders(),this.createColumnFooter(),this.setupColumnSort(),this.createCssRules(),this.resizeCanvas(),this.bindAncestorScrollEvents(),this._bindingEventService.bind(this._container,"resize",this.resizeCanvas.bind(this)),this._viewport.forEach((e=>{this._bindingEventService.bind(e,"scroll",this.handleScroll.bind(this))})),this._options.enableMouseWheelScrollHandler&&this._viewport.forEach((e=>{this.slickMouseWheelInstances.push(Lr({element:e,onMouseWheel:this.handleMouseWheel.bind(this)}))})),this._headerScroller.forEach((e=>{this._bindingEventService.bind(e,"contextmenu",this.handleHeaderContextMenu.bind(this)),this._bindingEventService.bind(e,"click",this.handleHeaderClick.bind(this))})),this._headerRowScroller.forEach((e=>{this._bindingEventService.bind(e,"scroll",this.handleHeaderRowScroll.bind(this))})),this._options.createFooterRow&&(this._footerRow.forEach((e=>{this._bindingEventService.bind(e,"contextmenu",this.handleFooterContextMenu.bind(this)),this._bindingEventService.bind(e,"click",this.handleFooterClick.bind(this))})),this._footerRowScroller.forEach((e=>{this._bindingEventService.bind(e,"scroll",this.handleFooterRowScroll.bind(this))}))),this._options.createTopHeaderPanel&&this._bindingEventService.bind(this._topHeaderPanelScroller,"scroll",this.handleTopHeaderPanelScroll.bind(this)),this._options.createPreHeaderPanel&&(this._bindingEventService.bind(this._preHeaderPanelScroller,"scroll",this.handlePreHeaderPanelScroll.bind(this)),this._bindingEventService.bind([this._preHeaderPanelScroller,this._preHeaderPanelScrollerR],"contextmenu",this.handlePreHeaderContextMenu.bind(this)),this._bindingEventService.bind([this._preHeaderPanelScroller,this._preHeaderPanelScrollerR],"click",this.handlePreHeaderClick.bind(this))),this._bindingEventService.bind(this._focusSink,"keydown",this.handleKeyDown.bind(this)),this._bindingEventService.bind(this._focusSink2,"keydown",this.handleKeyDown.bind(this)),this._canvas.forEach((e=>{this._bindingEventService.bind(e,"keydown",this.handleKeyDown.bind(this)),this._bindingEventService.bind(e,"click",this.handleClick.bind(this)),this._bindingEventService.bind(e,"dblclick",this.handleDblClick.bind(this)),this._bindingEventService.bind(e,"contextmenu",this.handleContextMenu.bind(this)),this._bindingEventService.bind(e,"mouseover",this.handleCellMouseOver.bind(this)),this._bindingEventService.bind(e,"mouseout",this.handleCellMouseOut.bind(this))})),Pr&&(this.slickDraggableInstance=Pr({containerElement:this._container,allowDragFrom:"div.slick-cell",allowDragFromClosest:"div.slick-cell.dnd, div.slick-cell.cell-reorder",preventDragFromKeys:this._options.preventDragFromKeys,onDragInit:this.handleDragInit.bind(this),onDragStart:this.handleDragStart.bind(this),onDrag:this.handleDrag.bind(this),onDragEnd:this.handleDragEnd.bind(this)})),this._options.suppressCssChangesOnHiddenInit||this.restoreCssFromHiddenInit())}cacheCssForHiddenInit(){this._hiddenParents=Ts.parents(this._container,":hidden"),this._hiddenParents.forEach((e=>{const t={};Object.keys(this.cssShow).forEach((i=>{this.cssShow&&(t[i]=e.style[i],e.style[i]=this.cssShow[i])})),this.oldProps.push(t)}))}restoreCssFromHiddenInit(){let e=0;this._hiddenParents&&this._hiddenParents.forEach((t=>{const i=this.oldProps[e++];Object.keys(this.cssShow).forEach((e=>{this.cssShow&&(t.style[e]=i[e])}))}))}hasFrozenColumns(){return this._options.frozenColumn>-1}registerPlugin(e){this.plugins.unshift(e),e.init(this)}unregisterPlugin(e){for(let t=this.plugins.length;t>=0;t--)if(this.plugins[t]===e){this.plugins[t]?.destroy(),this.plugins.splice(t,1);break}}getPluginByName(e){for(let t=this.plugins.length-1;t>=0;t--)if(this.plugins[t]?.pluginName===e)return this.plugins[t]}getPubSubService(){return this._pubSubService}setSelectionModel(e){this.selectionModel&&(this.selectionModel.onSelectedRangesChanged.unsubscribe(this.handleSelectedRangesChanged.bind(this)),this.selectionModel.destroy&&this.selectionModel.destroy()),this.selectionModel=e,this.selectionModel&&(this.selectionModel.init(this),this.selectionModel.onSelectedRangesChanged.subscribe(this.handleSelectedRangesChanged.bind(this)))}getSelectionModel(){return this.selectionModel}getCanvasNode(e,t){return this._getContainerElement(this.getCanvases(),e,t)}getActiveCanvasNode(e){return void 0===e||(e instanceof bs&&(e=e.getNativeEvent()),this._activeCanvasNode=e?.target?.closest(".grid-canvas")),this._activeCanvasNode}getCanvases(){return this._canvas}getViewportNode(e,t){return this._getContainerElement(this.getViewports(),e,t)}getViewports(){return this._viewport}getActiveViewportNode(e){return this.setActiveViewportNode(e),this._activeViewportNode}setActiveViewportNode(e){return e instanceof bs&&(e=e.getNativeEvent()),this._activeViewportNode=e?.target?.closest(".slick-viewport"),this._activeViewportNode}_getContainerElement(e,t,i){if(!e)return;t||(t=0),i||(i=0);const s="number"==typeof t?t:this.getColumnIndex(t);return e[(this.hasFrozenRows&&i>=this.actualFrozenRow+(this._options.frozenBottom?0:1)?2:0)+(this.hasFrozenColumns()&&s>this._options.frozenColumn?1:0)]}measureScrollbar(){let e="";this._viewport.forEach((t=>e+=t.className));const t=ie("div",{className:e,style:{position:"absolute",top:"-10000px",left:"-10000px",overflow:"auto",width:"100px",height:"100px"}},document.body),i=ie("div",{style:{width:"200px",height:"200px",overflow:"auto"}},t),s={width:t.offsetWidth-t.clientWidth,height:t.offsetHeight-t.clientHeight};return i.remove(),t.remove(),s}getHeadersWidth(){this.headersWidth=this.headersWidthL=this.headersWidthR=0;const e=!this._options.autoHeight;let t=0;const i=this.columns.length;for(t=0;t<i;t++){if(!this.columns[t]||this.columns[t].hidden)continue;const e=this.columns[t].width;this._options.frozenColumn>-1&&t>this._options.frozenColumn?this.headersWidthR+=e||0:this.headersWidthL+=e||0}return e&&(this._options.frozenColumn>-1&&t>this._options.frozenColumn?this.headersWidthR+=this.scrollbarDimensions?.width||0:this.headersWidthL+=this.scrollbarDimensions?.width||0),this.hasFrozenColumns()?(this.headersWidthL=this.headersWidthL+1e3,this.headersWidthR=Math.max(this.headersWidthR,this.viewportW)+this.headersWidthL,this.headersWidthR+=this.scrollbarDimensions?.width||0):(this.headersWidthL+=this.scrollbarDimensions?.width||0,this.headersWidthL=Math.max(this.headersWidthL,this.viewportW)+1e3),this.headersWidth=this.headersWidthL+this.headersWidthR,Math.max(this.headersWidth,this.viewportW)+1e3}getCanvasWidth(){const e=this.viewportHasVScroll?this.viewportW-(this.scrollbarDimensions?.width||0):this.viewportW;let t=this.columns.length;for(this.canvasWidthL=this.canvasWidthR=0;t--;)this.columns[t]&&!this.columns[t].hidden&&(this.hasFrozenColumns()&&t>this._options.frozenColumn?this.canvasWidthR+=this.columns[t].width||0:this.canvasWidthL+=this.columns[t].width||0);let i=this.canvasWidthL+this.canvasWidthR;if(this._options.fullWidthRows){const t=Math.max(i,e)-i;t>0&&(i+=t,this.hasFrozenColumns()?this.canvasWidthR+=t:this.canvasWidthL+=t)}return i}updateCanvasWidth(e){const t=this.canvasWidth,i=this.canvasWidthL,s=this.canvasWidthR;this.canvasWidth=this.getCanvasWidth(),this._options.createTopHeaderPanel&&Ts.width(this._topHeaderPanel,this._options.topHeaderPanelWidth??this.canvasWidth);const n=this.canvasWidth!==t||this.canvasWidthL!==i||this.canvasWidthR!==s;if(n||this.hasFrozenColumns()||this.hasFrozenRows)if(Ts.width(this._canvasTopL,this.canvasWidthL),this.getHeadersWidth(),Ts.width(this._headerL,this.headersWidthL),Ts.width(this._headerR,this.headersWidthR),this.hasFrozenColumns()){const e=Ts.width(this._container)||0;if(e>0&&this.canvasWidthL>e&&this._options.throwWhenFrozenNotAllViewable)throw new Error("[SlickGrid] Frozen columns cannot be wider than the actual grid container width. Make sure to have less columns freezed or make your grid container wider");Ts.width(this._canvasTopR,this.canvasWidthR),Ts.width(this._paneHeaderL,this.canvasWidthL),Ts.setStyleSize(this._paneHeaderR,"left",this.canvasWidthL),Ts.setStyleSize(this._paneHeaderR,"width",this.viewportW-this.canvasWidthL),Ts.width(this._paneTopL,this.canvasWidthL),Ts.setStyleSize(this._paneTopR,"left",this.canvasWidthL),Ts.width(this._paneTopR,this.viewportW-this.canvasWidthL),Ts.width(this._headerRowScrollerL,this.canvasWidthL),Ts.width(this._headerRowScrollerR,this.viewportW-this.canvasWidthL),Ts.width(this._headerRowL,this.canvasWidthL),Ts.width(this._headerRowR,this.canvasWidthR),this._options.createFooterRow&&(Ts.width(this._footerRowScrollerL,this.canvasWidthL),Ts.width(this._footerRowScrollerR,this.viewportW-this.canvasWidthL),Ts.width(this._footerRowL,this.canvasWidthL),Ts.width(this._footerRowR,this.canvasWidthR)),this._options.createPreHeaderPanel&&Ts.width(this._preHeaderPanel,this._options.preHeaderPanelWidth??this.canvasWidth),Ts.width(this._viewportTopL,this.canvasWidthL),Ts.width(this._viewportTopR,this.viewportW-this.canvasWidthL),this.hasFrozenRows&&(Ts.width(this._paneBottomL,this.canvasWidthL),Ts.setStyleSize(this._paneBottomR,"left",this.canvasWidthL),Ts.width(this._viewportBottomL,this.canvasWidthL),Ts.width(this._viewportBottomR,this.viewportW-this.canvasWidthL),Ts.width(this._canvasBottomL,this.canvasWidthL),Ts.width(this._canvasBottomR,this.canvasWidthR))}else Ts.width(this._paneHeaderL,"100%"),Ts.width(this._paneTopL,"100%"),Ts.width(this._headerRowScrollerL,"100%"),Ts.width(this._headerRowL,this.canvasWidth),this._options.createFooterRow&&(Ts.width(this._footerRowScrollerL,"100%"),Ts.width(this._footerRowL,this.canvasWidth)),this._options.createPreHeaderPanel&&Ts.width(this._preHeaderPanel,this._options.preHeaderPanelWidth??this.canvasWidth),Ts.width(this._viewportTopL,"100%"),this.hasFrozenRows&&(Ts.width(this._viewportBottomL,"100%"),Ts.width(this._canvasBottomL,this.canvasWidthL));this.viewportHasHScroll=this.canvasWidth>=this.viewportW-(this.scrollbarDimensions?.width||0),Ts.width(this._headerRowSpacerL,this.canvasWidth+(this.viewportHasVScroll&&this.scrollbarDimensions?.width||0)),Ts.width(this._headerRowSpacerR,this.canvasWidth+(this.viewportHasVScroll&&this.scrollbarDimensions?.width||0)),this._options.createFooterRow&&(Ts.width(this._footerRowSpacerL,this.canvasWidth+(this.viewportHasVScroll&&this.scrollbarDimensions?.width||0)),Ts.width(this._footerRowSpacerR,this.canvasWidth+(this.viewportHasVScroll&&this.scrollbarDimensions?.width||0))),(n||e)&&this.applyColumnWidths()}disableSelection(e){e.forEach((e=>{e.setAttribute("unselectable","on"),e.style.mozUserSelect="none",this._bindingEventService.bind(e,"selectstart",(()=>!1))}))}getMaxSupportedCssHeight(){let e=1e6;const t=navigator.userAgent.toLowerCase().match(/firefox/)?this._options.ffMaxSupportedCssHeight:this._options.maxSupportedCssHeight,i=ie("div",{style:{display:"hidden"}},document.body);let s=!0;for(;s;){const n=2*e;Ts.height(i,n);const r=Ts.height(i);if(n>t||r!==n){s=!1;break}e=n}return i.remove(),e}getUID(){return this.uid}getHeaderColumnWidthDiff(){return this.headerColumnWidthDiff}getScrollbarDimensions(){return this.scrollbarDimensions}getDisplayedScrollbarDimensions(){return{width:this.viewportHasVScroll&&this.scrollbarDimensions?.width||0,height:this.viewportHasHScroll&&this.scrollbarDimensions?.height||0}}getAbsoluteColumnMinWidth(){return this.absoluteColumnMinWidth}bindAncestorScrollEvents(){let e=this.hasFrozenRows&&!this._options.frozenBottom?this._canvasBottomL:this._canvasTopL;for(;(e=e.parentNode)!==document.body&&e;)e!==this._viewportTopL&&e.scrollWidth===e.clientWidth&&e.scrollHeight===e.clientHeight||(this._boundAncestors.push(e),this._bindingEventService.bind(e,"scroll",this.handleActiveCellPositionChange.bind(this)))}unbindAncestorScrollEvents(){this._boundAncestors.forEach((e=>{this._bindingEventService.unbindByEventName(e,"scroll")})),this._boundAncestors=[]}updateColumnHeader(e,t,i){if(this.initialized){const s=this.getColumnIndex(e);if(!Me(s))return;const n=this.columns[s],r=this.getColumnByIndex(s);return r&&(void 0!==t&&(this.columns[s].name=t),void 0!==i&&(this.columns[s].toolTip=i),this.triggerEvent(this.onBeforeHeaderCellDestroy,{node:r,column:n,grid:this}),r.setAttribute("title",i||""),void 0!==t&&this.applyHtmlCode(r.children[0],t),this.triggerEvent(this.onHeaderCellRendered,{node:r,column:n,grid:this})),r}}getHeader(e){if(!e)return this.hasFrozenColumns()?this._headers:this._headerL;const t=this.getColumnIndex(e.id);return this.hasFrozenColumns()?t<=this._options.frozenColumn?this._headerL:this._headerR:this._headerL}getHeaderColumn(e){const t="number"==typeof e?e:this.getColumnIndex(e),i=this.hasFrozenColumns()?t<=this._options.frozenColumn?this._headerL:this._headerR:this._headerL,s=this.hasFrozenColumns()?t<=this._options.frozenColumn?t:t-this._options.frozenColumn-1:t;return i.children[s]}getHeaderRow(){return this.hasFrozenColumns()?this._headerRows:this._headerRows?.[0]}getFooterRow(){return this.hasFrozenColumns()?this._footerRow:this._footerRow?.[0]}getPreHeaderPanel(){return this._preHeaderPanel}getPreHeaderPanelLeft(){return this._preHeaderPanel}getPreHeaderPanelRight(){return this._preHeaderPanelR}getTopHeaderPanel(){return this._topHeaderPanel}getHeaderRowColumn(e){let t,i="number"==typeof e?e:this.getColumnIndex(e);return this.hasFrozenColumns()?i<=this._options.frozenColumn?t=this._headerRowL:(t=this._headerRowR,i-=this._options.frozenColumn+1):t=this._headerRowL,t.children[i]}getFooterRowColumn(e){let t,i="number"==typeof e?e:this.getColumnIndex(e);return this.hasFrozenColumns()?i<=this._options.frozenColumn?t=this._footerRowL:(t=this._footerRowR,i-=this._options.frozenColumn+1):t=this._footerRowL,t?.children[i]}createColumnFooter(){if(this._options.createFooterRow){this._footerRow.forEach((e=>{e.querySelectorAll(".slick-footerrow-column").forEach((e=>{const t=Ts.storage.get(e,"column");this.triggerEvent(this.onBeforeFooterRowCellDestroy,{node:e,column:t,grid:this})}))})),re(this._footerRowL),re(this._footerRowR);for(let e=0;e<this.columns.length;e++){const t=this.columns[e];if(!t||t.hidden)continue;const i=ie("div",{className:`slick-state-default slick-footerrow-column l${e} r${e}`},this.hasFrozenColumns()&&e>this._options.frozenColumn?this._footerRowR:this._footerRowL),s=this.hasFrozenColumns()&&e<=this._options.frozenColumn?"frozen":null;s&&i.classList.add(s),Ts.storage.put(i,"column",t),this.triggerEvent(this.onFooterRowCellRendered,{node:i,column:t,grid:this})}}}handleHeaderMouseHoverOn(e){e?.target.classList.add("slick-state-hover")}handleHeaderMouseHoverOff(e){e?.target.classList.remove("slick-state-hover")}createColumnHeaders(){this._headers.forEach((e=>{e.querySelectorAll(".slick-header-column").forEach((e=>{const t=Ts.storage.get(e,"column");t&&this.triggerEvent(this.onBeforeHeaderCellDestroy,{node:e,column:t,grid:this})}))})),re(this._headerL),re(this._headerR),this.getHeadersWidth(),Ts.width(this._headerL,this.headersWidthL),Ts.width(this._headerR,this.headersWidthR),this._headerRows.forEach((e=>{e.querySelectorAll(".slick-headerrow-column").forEach((e=>{const t=Ts.storage.get(e,"column");t&&this.triggerEvent(this.onBeforeHeaderRowCellDestroy,{node:this,column:t,grid:this})}))})),re(this._headerRowL),re(this._headerRowR),this._options.createFooterRow&&(this._footerRowL.querySelectorAll(".slick-footerrow-column").forEach((e=>{const t=Ts.storage.get(e,"column");t&&this.triggerEvent(this.onBeforeFooterRowCellDestroy,{node:this,column:t,grid:this})})),re(this._footerRowL),this.hasFrozenColumns()&&(this._footerRowR.querySelectorAll(".slick-footerrow-column").forEach((e=>{const t=Ts.storage.get(e,"column");t&&this.triggerEvent(this.onBeforeFooterRowCellDestroy,{node:this,column:t,grid:this})})),re(this._footerRowR)));for(let e=0;e<this.columns.length;e++){const t=this.columns[e];if(!t||t.hidden)continue;const i=this.hasFrozenColumns()?e<=this._options.frozenColumn?this._headerL:this._headerR:this._headerL,s=this.hasFrozenColumns()?e<=this._options.frozenColumn?this._headerRowL:this._headerRowR:this._headerRowL,n=ie("div",{id:`${this.uid+t.id}`,dataset:{id:String(t.id)},role:"columnheader",className:"slick-state-default slick-header-column"},i);t.toolTip&&(n.title=t.toolTip),t.reorderable||n.classList.add(this._options.unorderableColumnCssClass);const r=ie("span",{className:"slick-column-name"},n);this.applyHtmlCode(r,t.name),Ts.width(n,t.width-this.headerColumnWidthDiff);let o=t.headerCssClass||null;if(o&&n.classList.add(...se(o)),o=this.hasFrozenColumns()&&e<=this._options.frozenColumn?"frozen":null,o&&n.classList.add(o),this._bindingEventService.bind(n,"mouseenter",this.handleHeaderMouseEnter.bind(this)),this._bindingEventService.bind(n,"mouseleave",this.handleHeaderMouseLeave.bind(this)),this._bindingEventService.bind(n,"mouseover",this.handleHeaderMouseOver.bind(this)),this._bindingEventService.bind(n,"mouseout",this.handleHeaderMouseOut.bind(this)),Ts.storage.put(n,"column",t),(this._options.enableColumnReorder||t.sortable)&&(this._bindingEventService.bind(n,"mouseenter",this.handleHeaderMouseHoverOn.bind(this)),this._bindingEventService.bind(n,"mouseleave",this.handleHeaderMouseHoverOff.bind(this))),t.hasOwnProperty("headerCellAttrs")&&t.headerCellAttrs instanceof Object&&Object.keys(t.headerCellAttrs).forEach((e=>{t.headerCellAttrs.hasOwnProperty(e)&&n.setAttribute(e,t.headerCellAttrs[e])})),t.sortable&&(n.classList.add("slick-header-sortable"),ie("div",{className:"slick-sort-indicator "+(this._options.numberedMultiColumnSort&&!this._options.sortColNumberInSeparateSpan?" slick-sort-indicator-numbered":"")},n),this._options.numberedMultiColumnSort&&this._options.sortColNumberInSeparateSpan&&ie("div",{className:"slick-sort-indicator-numbered"},n)),this.triggerEvent(this.onHeaderCellRendered,{node:n,column:t,grid:this}),this._options.showHeaderRow){const i=ie("div",{className:`slick-state-default slick-headerrow-column l${e} r${e}`},s),n=this.hasFrozenColumns()&&e<=this._options.frozenColumn?"frozen":null;n&&i.classList.add(n),this._bindingEventService.bind(i,"mouseenter",this.handleHeaderRowMouseEnter.bind(this)),this._bindingEventService.bind(i,"mouseleave",this.handleHeaderRowMouseLeave.bind(this)),this._bindingEventService.bind(i,"mouseover",this.handleHeaderRowMouseOver.bind(this)),this._bindingEventService.bind(i,"mouseout",this.handleHeaderRowMouseOut.bind(this)),Ts.storage.put(i,"column",t),this.triggerEvent(this.onHeaderRowCellRendered,{node:i,column:t,grid:this})}if(this._options.createFooterRow&&this._options.showFooterRow){const i=ie("div",{className:`slick-state-default slick-footerrow-column l${e} r${e}`},this.hasFrozenColumns()?e<=this._options.frozenColumn?this._footerRow[0]:this._footerRow[1]:this._footerRow[0]);Ts.storage.put(i,"column",t),this.triggerEvent(this.onFooterRowCellRendered,{node:i,column:t,grid:this})}}this.setSortColumns(this.sortColumns),this.setupColumnResize(),this._options.enableColumnReorder&&("function"==typeof this._options.enableColumnReorder?this._options.enableColumnReorder(this,this._headers,this.headerColumnWidthDiff,this.setColumns,this.setupColumnResize,this.columns,this.getColumnIndex,this.uid,this.triggerEvent):this.setupColumnReorder())}setupColumnSort(){this._headers.forEach((e=>{this._bindingEventService.bind(e,"click",(e=>{if(this.columnResizeDragging||e.target.classList.contains("slick-resizable-handle"))return;const t=e.target.closest(".slick-header-column");if(!t)return;const i=Ts.storage.get(t,"column");if(i?.sortable){if(!this.getEditorLock()?.commitCurrentEdit())return;const t=this.sortColumns.slice();let s=null,n=0;for(;n<this.sortColumns.length;n++)if(this.sortColumns[n].columnId===i.id){s=this.sortColumns[n],s.sortAsc=!s.sortAsc;break}const r=!!s;let o;this._options.tristateMultiColumnSort?(s||(s={columnId:i.id,sortAsc:i.defaultSortAsc,sortCol:i}),r&&s.sortAsc&&(this.sortColumns.splice(n,1),s=null),this._options.multiColumnSort||(this.sortColumns=[]),!s||r&&this._options.multiColumnSort||this.sortColumns.push(s)):e.metaKey&&this._options.multiColumnSort?s&&this.sortColumns.splice(n,1):((e.shiftKey||e.metaKey)&&this._options.multiColumnSort||(this.sortColumns=[]),s?0===this.sortColumns.length&&this.sortColumns.push(s):(s={columnId:i.id,sortAsc:i.defaultSortAsc,sortCol:i},this.sortColumns.push(s))),o=this._options.multiColumnSort?{multiColumnSort:!0,previousSortColumns:t,sortCols:this.sortColumns.map((e=>{const t=this.columns[this.getColumnIndex(e.columnId)];return!t||t.hidden?null:{columnId:t.id,sortCol:t,sortAsc:e.sortAsc}})).filter((e=>e))}:{multiColumnSort:!1,previousSortColumns:t,columnId:this.sortColumns.length>0?i.id:null,sortCol:this.sortColumns.length>0?i:null,sortAsc:!(this.sortColumns.length>0)||this.sortColumns[0].sortAsc},!1!==this.triggerEvent(this.onBeforeSort,o,e).getReturnValue()&&(this.setSortColumns(this.sortColumns),this.triggerEvent(this.onSort,o,e))}}))}))}setupColumnReorder(){let e;this.sortableSideLeftInstance?.destroy(),this.sortableSideRightInstance?.destroy();const t=()=>this._viewportScrollContainerX.scrollLeft+=10,i=()=>this._viewportScrollContainerX.scrollLeft-=10;let s=!1;const n={animation:50,direction:"horizontal",chosenClass:"slick-header-column-active",ghostClass:"slick-sortable-placeholder",draggable:".slick-header-column",dragoverBubble:!1,revertClone:!0,scroll:!this.hasFrozenColumns(),filter:`.${this._options.unorderableColumnCssClass}`,onMove:e=>!e.related.classList.contains(this._options.unorderableColumnCssClass),onStart:n=>{s=!this.hasFrozenColumns()||le(n.item).left>le(this._viewportScrollContainerX).left,s&&n.originalEvent.pageX>this._container.clientWidth?e||(e=window.setInterval(t,100)):s&&n.originalEvent.pageX<le(this._viewportScrollContainerX).left?e||(e=window.setInterval(i,100)):window.clearInterval(e)},onEnd:t=>{if(window.clearInterval(e),!this.getEditorLock()?.commitCurrentEdit())return;let i=this.sortableSideLeftInstance?.toArray()??[];i=i.concat(this.sortableSideRightInstance?.toArray()??[]);const s=[];for(let e=0;e<i.length;e++)s.push(this.columns[this.getColumnIndex(i[e])]);this.setColumns(s),this.triggerEvent(this.onColumnsReordered,{impactedColumns:this.columns}),t.stopPropagation(),this.setupColumnResize(),this.activeCellNode&&this.setFocus()}};this.sortableSideLeftInstance=Rr.create(this._headerL,n),this.sortableSideRightInstance=Rr.create(this._headerR,n)}getHeaderChildren(){const e=Array.from(this._headers[0].children),t=Array.from(this._headers[1].children);return e.concat(t)}handleResizeableDoubleClick(e){const t=e.target.parentElement.id.replace(this.uid,"");this.triggerEvent(this.onColumnsResizeDblClick,{triggeredByColumn:t})}setupColumnResize(){if(void 0===Mr)throw new Error('SlickResizable is undefined, make sure to import "slick.interactions.js"');let e,t,i,s,n,r,o,a=-1,l=0;const h=this.getHeaderChildren(),c=this.getVisibleColumns();for(let e=0;e<h.length;e++)h[e].querySelectorAll(".slick-resizable-handle").forEach((e=>e.remove())),e<c.length&&c[e]?.resizable&&(void 0===o&&(o=e),a=e);if(void 0!==o)for(let d=0;d<h.length;d++){const u=h[d];if(d>=c.length||!c[d])continue;if(d<o||this._options.forceFitColumns&&d>=a)continue;const p=ie("div",{className:"slick-resizable-handle",role:"separator",ariaOrientation:"horizontal"},u);this._bindingEventService.bind(p,"dblclick",this.handleResizeableDoubleClick.bind(this)),this.slickResizableInstances.push(Mr({resizeableElement:u,resizeableHandleElement:p,onResizeStart:(t,o)=>{const a=t.touches?t.changedTouches[0]:t;if(!this.getEditorLock()?.commitCurrentEdit())return!1;s=a.pageX,l=0,o.resizeableElement.classList.add("slick-header-column-active");let u=null,p=null;for(let e=0;e<h.length;e++)e<c.length&&c[e]&&(c[e].previousWidth=h[e].offsetWidth);if(this._options.forceFitColumns)for(u=0,p=0,e=d+1;e<c.length;e++)i=c[e],i?.resizable&&(null!==p&&(i.maxWidth?p+=i.maxWidth-(i.previousWidth||0):p=null),u+=(i.previousWidth||0)-Math.max(i.minWidth||0,this.absoluteColumnMinWidth));let m=0,f=0;for(e=0;e<=d;e++)i=c[e],i?.resizable&&(null!==f&&(i.maxWidth?f+=i.maxWidth-(i.previousWidth||0):f=null),m+=(i.previousWidth||0)-Math.max(i.minWidth||0,this.absoluteColumnMinWidth));null===u&&(u=1e5),null===m&&(m=1e5),null===p&&(p=1e5),null===f&&(f=1e5),r=s+Math.min(u,f),n=s-Math.min(m,p)},onResize:(o,a)=>{const h=o.touches?o.changedTouches[0]:o;let u;this.columnResizeDragging=!0;const p=Math.min(r,Math.max(n,h.pageX))-s;let m,f=0,g=0;const _=this.viewportHasVScroll?this.viewportW-(this.scrollbarDimensions?.width||0):this.viewportW;if(p<0){for(m=p,e=d;e>=0;e--)i=c[e],i&&i.resizable&&!i.hidden&&(u=Math.max(i.minWidth||0,this.absoluteColumnMinWidth),m&&(i.previousWidth||0)+m<u?(m+=(i.previousWidth||0)-u,i.width=u):(i.width=(i.previousWidth||0)+m,m=0));for(t=0;t<=d;t++)i=c[t],i&&!i.hidden&&(this.hasFrozenColumns()&&t>this._options.frozenColumn?g+=i.width||0:f+=i.width||0);if(this._options.forceFitColumns)for(m=-p,e=d+1;e<c.length;e++)i=c[e],i&&!i.hidden&&i.resizable&&(m&&i.maxWidth&&i.maxWidth-(i.previousWidth||0)<m?(m-=i.maxWidth-(i.previousWidth||0),i.width=i.maxWidth):(i.width=(i.previousWidth||0)+m,m=0),this.hasFrozenColumns()&&e>this._options.frozenColumn?g+=i.width||0:f+=i.width||0);else for(e=d+1;e<c.length;e++)i=c[e],i&&!i.hidden&&(this.hasFrozenColumns()&&e>this._options.frozenColumn?g+=i.width||0:f+=i.width||0);if(this._options.forceFitColumns)for(m=-p,e=d+1;e<c.length;e++)i=c[e],i&&!i.hidden&&i.resizable&&(m&&i.maxWidth&&i.maxWidth-(i.previousWidth||0)<m?(m-=i.maxWidth-(i.previousWidth||0),i.width=i.maxWidth):(i.width=(i.previousWidth||0)+m,m=0))}else{for(m=p,f=0,g=0,e=d;e>=0;e--)if(i=c[e],i&&!i.hidden&&i.resizable)if(m&&i.maxWidth&&i.maxWidth-(i.previousWidth||0)<m)m-=i.maxWidth-(i.previousWidth||0),i.width=i.maxWidth;else{const t=(i.previousWidth||0)+m,s=this.canvasWidthL+m;this.hasFrozenColumns()&&e<=this._options.frozenColumn?(t>l&&s<_-this._options.frozenRightViewportMinWidth&&(l=t),i.width=s+this._options.frozenRightViewportMinWidth>_?l:t):i.width=t,m=0}for(t=0;t<=d;t++)i=c[t],i&&!i.hidden&&(this.hasFrozenColumns()&&t>this._options.frozenColumn?g+=i.width||0:f+=i.width||0);if(this._options.forceFitColumns)for(m=-p,e=d+1;e<c.length;e++)i=c[e],i&&!i.hidden&&i.resizable&&(u=Math.max(i.minWidth||0,this.absoluteColumnMinWidth),m&&(i.previousWidth||0)+m<u?(m+=(i.previousWidth||0)-u,i.width=u):(i.width=(i.previousWidth||0)+m,m=0),this.hasFrozenColumns()&&e>this._options.frozenColumn?g+=i.width||0:f+=i.width||0);else for(e=d+1;e<c.length;e++)i=c[e],i&&!i.hidden&&(this.hasFrozenColumns()&&e>this._options.frozenColumn?g+=i.width||0:f+=i.width||0)}this.hasFrozenColumns()&&f!==this.canvasWidthL&&(Ts.width(this._headerL,f+1e3),Ts.setStyleSize(this._paneHeaderR,"left",f)),this.applyColumnHeaderWidths(),this._options.syncColumnCellResize&&this.applyColumnWidths(),this.triggerEvent(this.onColumnsDrag,{triggeredByColumn:a.resizeableElement,resizeHandle:a.resizeableHandleElement})},onResizeEnd:(t,s)=>{s.resizeableElement.classList.remove("slick-header-column-active");const n=s.resizeableElement.id.replace(this.uid,"");let r;for(!0===this.triggerEvent(this.onBeforeColumnsResize,{triggeredByColumn:n}).getReturnValue()&&this.applyColumnHeaderWidths(),e=0;e<c.length;e++)i=c[e],i&&!i.hidden&&h[e]&&(r=h[e].offsetWidth,i.previousWidth!==r&&i.rerenderOnResize&&this.invalidateAllRows());this.updateCanvasWidth(!0),this.render(),this.triggerEvent(this.onColumnsResized,{triggeredByColumn:n}),window.clearTimeout(this._columnResizeTimer),this._columnResizeTimer=window.setTimeout((()=>this.columnResizeDragging=!1),this._options.columnResizingDelay)}}))}}getVBoxDelta(e){const t=getComputedStyle(e);let i=0;return["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"].forEach((e=>i+=Ts.toFloat(t[e]))),i}setFrozenOptions(){if(this._options.frozenColumn=this._options.frozenColumn>=0&&this._options.frozenColumn<this.columns.length?parseInt(this._options.frozenColumn,10):-1,this._options.frozenRow>-1){this.hasFrozenRows=!0,this.frozenRowsHeight=this._options.frozenRow*this._options.rowHeight;const e=this.getDataLength();this.actualFrozenRow=this._options.frozenBottom?e-this._options.frozenRow:this._options.frozenRow}else this.hasFrozenRows=!1}setPaneVisibility(){this.hasFrozenColumns()?(Ts.show(this._paneHeaderR),Ts.show(this._paneTopR),this.hasFrozenRows?(Ts.show(this._paneBottomL),Ts.show(this._paneBottomR)):(Ts.hide(this._paneBottomR),Ts.hide(this._paneBottomL))):(Ts.hide(this._paneHeaderR),Ts.hide(this._paneTopR),Ts.hide(this._paneBottomR),this.hasFrozenRows?Ts.show(this._paneBottomL):(Ts.hide(this._paneBottomR),Ts.hide(this._paneBottomL)))}setOverflow(){if(this._viewportTopL.style.overflowX=this.hasFrozenColumns()?this.hasFrozenRows&&!this._options.alwaysAllowHorizontalScroll?"hidden":"scroll":this.hasFrozenRows&&!this._options.alwaysAllowHorizontalScroll?"hidden":"auto",this._viewportTopL.style.overflowY=!this.hasFrozenColumns()&&this._options.alwaysShowVerticalScroll?"scroll":this.hasFrozenColumns()?(this.hasFrozenRows,"hidden"):this.hasFrozenRows?"scroll":"auto",this._viewportTopR.style.overflowX=this.hasFrozenColumns()?this.hasFrozenRows&&!this._options.alwaysAllowHorizontalScroll?"hidden":"scroll":this.hasFrozenRows&&!this._options.alwaysAllowHorizontalScroll?"hidden":"auto",this._viewportTopR.style.overflowY=this._options.alwaysShowVerticalScroll?"scroll":(this.hasFrozenColumns(),this.hasFrozenRows?"scroll":"auto"),this._viewportBottomL.style.overflowX=this.hasFrozenColumns()?this.hasFrozenRows&&!this._options.alwaysAllowHorizontalScroll?"scroll":"auto":(this.hasFrozenRows&&this._options.alwaysAllowHorizontalScroll,"auto"),this._viewportBottomL.style.overflowY=!this.hasFrozenColumns()&&this._options.alwaysShowVerticalScroll?"scroll":this.hasFrozenColumns()?(this.hasFrozenRows,"hidden"):this.hasFrozenRows?"scroll":"auto",this._viewportBottomR.style.overflowX=this.hasFrozenColumns()?this.hasFrozenRows&&!this._options.alwaysAllowHorizontalScroll?"scroll":"auto":(this.hasFrozenRows&&this._options.alwaysAllowHorizontalScroll,"auto"),this._viewportBottomR.style.overflowY=this._options.alwaysShowVerticalScroll?"scroll":(this.hasFrozenColumns(),this.hasFrozenRows,"auto"),this._options.viewportClass){const e=se(this._options.viewportClass);this._viewportTopL.classList.add(...e),this._viewportTopR.classList.add(...e),this._viewportBottomL.classList.add(...e),this._viewportBottomR.classList.add(...e)}}setScroller(){this.hasFrozenColumns()?(this._headerScrollContainer=this._headerScrollerR,this._headerRowScrollContainer=this._headerRowScrollerR,this._footerRowScrollContainer=this._footerRowScrollerR,this.hasFrozenRows?this._options.frozenBottom?(this._viewportScrollContainerX=this._viewportBottomR,this._viewportScrollContainerY=this._viewportTopR):this._viewportScrollContainerX=this._viewportScrollContainerY=this._viewportBottomR:this._viewportScrollContainerX=this._viewportScrollContainerY=this._viewportTopR):(this._headerScrollContainer=this._headerScrollerL,this._headerRowScrollContainer=this._headerRowScrollerL,this._footerRowScrollContainer=this._footerRowScrollerL,this.hasFrozenRows?this._options.frozenBottom?(this._viewportScrollContainerX=this._viewportBottomL,this._viewportScrollContainerY=this._viewportTopL):this._viewportScrollContainerX=this._viewportScrollContainerY=this._viewportBottomL:this._viewportScrollContainerX=this._viewportScrollContainerY=this._viewportTopL)}measureCellPaddingAndBorder(){const e=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],t=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],i=this._headers[0];this.headerColumnWidthDiff=this.headerColumnHeightDiff=0,this.cellWidthDiff=this.cellHeightDiff=0;let s=ie("div",{className:"slick-state-default slick-header-column",style:{visibility:"hidden"},textContent:"-"},i),n=getComputedStyle(s);"border-box"!==n.boxSizing&&(e.forEach((e=>this.headerColumnWidthDiff+=Ts.toFloat(n[e]))),t.forEach((e=>this.headerColumnHeightDiff+=Ts.toFloat(n[e])))),s.remove();const r=ie("div",{className:"slick-row"},this._canvas[0]);s=ie("div",{className:"slick-cell",id:"",style:{visibility:"hidden"},textContent:"-"},r),n=getComputedStyle(s),"border-box"!==n.boxSizing&&(e.forEach((e=>this.cellWidthDiff+=Ts.toFloat(n[e]))),t.forEach((e=>this.cellHeightDiff+=Ts.toFloat(n[e])))),r.remove(),this.absoluteColumnMinWidth=Math.max(this.headerColumnWidthDiff,this.cellWidthDiff)}createCssRules(){this._style=document.createElement("style"),this._style.nonce=this._options.nonce||"",(this._options.shadowRoot||document.head).appendChild(this._style);const e=this._options.rowHeight-this.cellHeightDiff,t=[`.${this.uid} .slick-group-header-column { left: 1000px; }`,`.${this.uid} .slick-header-column { left: 1000px; }`,`.${this.uid} .slick-top-panel { height: ${this._options.topPanelHeight}px; }`,`.${this.uid} .slick-preheader-panel { height: ${this._options.preHeaderPanelHeight}px; }`,`.${this.uid} .slick-topheader-panel { height: ${this._options.topHeaderPanelHeight}px; }`,`.${this.uid} .slick-headerrow-columns { height: ${this._options.headerRowHeight}px; }`,`.${this.uid} .slick-footerrow-columns { height: ${this._options.footerRowHeight}px; }`,`.${this.uid} .slick-cell { height: ${e}px; }`,`.${this.uid} .slick-row { height: ${this._options.rowHeight}px; }`],i=this._style.sheet;if(i){t.forEach((e=>{i.insertRule(e)}));for(let e=0;e<this.columns.length;e++)this.columns[e]&&!this.columns[e].hidden&&(i.insertRule(`.${this.uid} .l${e} { }`),i.insertRule(`.${this.uid} .r${e} { }`))}else this.createCssRulesAlternative(t)}createCssRulesAlternative(e){const t=document.createElement("template");t.innerHTML='<style type="text/css" rel="stylesheet" />',this._style=t.content.firstChild,(this._options.shadowRoot||document.head).appendChild(this._style);for(let t=0;t<this.columns.length;t++)this.columns[t]&&!this.columns[t].hidden&&(e.push(`.${this.uid} .l${t} { }`),e.push(`.${this.uid} .r${t} { }`));this._style.styleSheet?this._style.styleSheet.cssText=e.join(" "):this._style.appendChild(document.createTextNode(e.join(" ")))}getColumnCssRules(e){let t;if(!this.stylesheet){const e=(this._options.shadowRoot||document).styleSheets;for(this._options.devMode&&"number"==typeof this._options.devMode.ownerNodeIndex&&this._options.devMode.ownerNodeIndex>=0&&(e[this._options.devMode.ownerNodeIndex].ownerNode=this._style),t=0;t<e.length;t++){const i=e[t];if((i.ownerNode||i.owningElement)===this._style){this.stylesheet=i;break}}if(!this.stylesheet)throw new Error("SlickGrid Cannot find stylesheet.");this.columnCssRulesL=[],this.columnCssRulesR=[];const i=this.stylesheet.cssRules||this.stylesheet.rules;let s,n;for(t=0;t<i.length;t++){const e=i[t].selectorText;(s=/\.l\d+/.exec(e))?(n=parseInt(s[0].substr(2,s[0].length-2),10),this.columnCssRulesL[n]=i[t]):(s=/\.r\d+/.exec(e))&&(n=parseInt(s[0].substr(2,s[0].length-2),10),this.columnCssRulesR[n]=i[t])}}return{left:this.columnCssRulesL[e],right:this.columnCssRulesR[e]}}removeCssRules(){this._style?.remove(),this.stylesheet=null}clearAllTimers(){window.clearTimeout(this._columnResizeTimer),window.clearTimeout(this._executionBlockTimer),window.clearTimeout(this._flashCellTimer),window.clearTimeout(this._highlightRowTimer),window.clearTimeout(this.h_editorLoader)}destroy(e){this._bindingEventService.unbindAll(),this.slickDraggableInstance=this.destroyAllInstances(this.slickDraggableInstance),this.slickMouseWheelInstances=this.destroyAllInstances(this.slickMouseWheelInstances),this.slickResizableInstances=this.destroyAllInstances(this.slickResizableInstances),this.getEditorLock()?.cancelCurrentEdit(),this.triggerEvent(this.onBeforeDestroy,{});let t=this.plugins.length;for(;t--;)this.unregisterPlugin(this.plugins[t]);this._options.enableColumnReorder&&"function"==typeof this.sortableSideLeftInstance?.destroy&&"function"==typeof this.sortableSideRightInstance?.destroy&&(this.sortableSideLeftInstance.destroy(),this.sortableSideRightInstance.destroy()),this.unbindAncestorScrollEvents(),this._bindingEventService.unbindByEventName(this._container,"resize"),this.removeCssRules(),this._canvas.forEach((e=>{this._bindingEventService.unbindByEventName(e,"keydown"),this._bindingEventService.unbindByEventName(e,"click"),this._bindingEventService.unbindByEventName(e,"dblclick"),this._bindingEventService.unbindByEventName(e,"contextmenu"),this._bindingEventService.unbindByEventName(e,"mouseover"),this._bindingEventService.unbindByEventName(e,"mouseout")})),this._viewport.forEach((e=>{this._bindingEventService.unbindByEventName(e,"scroll")})),this._headerScroller.forEach((e=>{this._bindingEventService.unbindByEventName(e,"contextmenu"),this._bindingEventService.unbindByEventName(e,"click")})),this._headerRowScroller.forEach((e=>{this._bindingEventService.unbindByEventName(e,"scroll")})),this._footerRow&&this._footerRow.forEach((e=>{this._bindingEventService.unbindByEventName(e,"contextmenu"),this._bindingEventService.unbindByEventName(e,"click")})),this._footerRowScroller&&this._footerRowScroller.forEach((e=>{this._bindingEventService.unbindByEventName(e,"scroll")})),this._preHeaderPanelScroller&&this._bindingEventService.unbindByEventName(this._preHeaderPanelScroller,"scroll"),this._topHeaderPanelScroller&&this._bindingEventService.unbindByEventName(this._topHeaderPanelScroller,"scroll"),this._bindingEventService.unbindByEventName(this._focusSink,"keydown"),this._bindingEventService.unbindByEventName(this._focusSink2,"keydown");const i=this._container.querySelectorAll(".slick-resizable-handle");[].forEach.call(i,(e=>{this._bindingEventService.unbindByEventName(e,"dblclick")}));const s=this._container.querySelectorAll(".slick-header-column");[].forEach.call(s,(e=>{this._bindingEventService.unbindByEventName(e,"mouseenter"),this._bindingEventService.unbindByEventName(e,"mouseleave"),this._bindingEventService.unbindByEventName(e,"mouseover"),this._bindingEventService.unbindByEventName(e,"mouseout")})),re(this._container),this._container.classList.remove(this.uid),this.clearAllTimers(),e&&ne(this)}destroyAllInstances(e){if(e){const t=Array.isArray(e)?e:[e];let i;for(;Me(i=t.pop());)i&&"function"==typeof i.destroy&&i.destroy()}return Array.isArray(e)?[]:null}autosizeColumns(){this.legacyAutosizeColumns()}legacyAutosizeColumns(){let e,t,i=0,s=0,n=0;const r=[],o=this.viewportHasVScroll?this.viewportW-(this.scrollbarDimensions?.width||0):this.viewportW;for(e=0;e<this.columns.length;e++)t=this.columns[e],t&&!t.hidden?(r.push(t.width||0),s+=t.width||0,t.resizable&&(i+=(t.width||0)-Math.max(t.minWidth||0,this.absoluteColumnMinWidth))):r.push(0);for(n=s;s>o&&i;){const a=(s-o)/i;for(e=0;e<this.columns.length&&s>o;e++){if(t=this.columns[e],!t||t.hidden)continue;const n=r[e];if(!t.resizable||n<=t.minWidth||n<=this.absoluteColumnMinWidth)continue;const o=Math.max(t.minWidth,this.absoluteColumnMinWidth);let l=Math.floor(a*(n-o))||1;l=Math.min(l,n-o),s-=l,i-=l,r[e]-=l}if(n<=s)break;n=s}for(n=s;s<o;){const i=o/s;for(e=0;e<this.columns.length&&s<o;e++){if(t=this.columns[e],!t||t.hidden)continue;const n=r[e];let a;a=!t.resizable||t.maxWidth<=n?0:Math.min(Math.floor(i*n)-n,t.maxWidth-n||1e6)||1,s+=a,r[e]+=s<=o?a:0}if(n>=s)break;n=s}let a=!1;for(e=0;e<this.columns.length;e++)t&&!t.hidden&&(this.columns[e].rerenderOnResize&&this.columns[e].width!==r[e]&&(a=!0),this.columns[e].width=r[e]);this.reRenderColumns(a)}reRenderColumns(e){this.applyColumnHeaderWidths(),this.updateCanvasWidth(!0),this.triggerEvent(this.onAutosizeColumns,{columns:this.columns}),e&&(this.invalidateAllRows(),this.render())}getVisibleColumns(){return this.columns.filter((e=>!e.hidden))}triggerEvent(e,t,i){const s=i||new bs(i,t),n=t||{};return n.grid=this,e.notify(n,s,this)}getEditorLock(){return this._options.editorLock}getEditController(){return this.editController}getColumnIndex(e){return this.columnsById[e]}applyColumnHeaderWidths(){if(this.initialized){let e=0;const t=this.getVisibleColumns();this._headers.forEach((i=>{for(let s=0;s<i.children.length;s++,e++){const n=i.children[s],r=((t[e]||{}).width||0)-this.headerColumnWidthDiff;Ts.width(n)!==r&&Ts.width(n,r)}})),this.updateColumnCaches()}}applyColumnWidths(){let e,t=0,i=0;for(let s=0;s<this.columns.length;s++)this.columns[s]?.hidden||(i=this.columns[s].width||0,e=this.getColumnCssRules(s),e.left&&(e.left.style.left=`${t}px`),e.right&&(e.right.style.right=(-1!==this._options.frozenColumn&&s>this._options.frozenColumn?this.canvasWidthR:this.canvasWidthL)-t-i+"px"),this._options.frozenColumn!==s&&(t+=this.columns[s].width)),this._options.frozenColumn===s&&(t=0)}setSortColumn(e,t){this.setSortColumns([{columnId:e,sortAsc:t}])}getColumnByIndex(e){let t;return this._headers.every((i=>{const s=i.children.length;return e<s?(t=i.children[e],!1):(e-=s,!0)})),t}setSortColumns(e){this.sortColumns=e;const t=this._options.numberedMultiColumnSort&&this.sortColumns.length>1;this._headers.forEach((e=>{let t=e.querySelectorAll(".slick-header-column-sorted");t.forEach((e=>e.classList.remove("slick-header-column-sorted"))),t=e.querySelectorAll(".slick-sort-indicator"),t.forEach((e=>e.classList.remove("slick-sort-indicator-asc","slick-sort-indicator-desc"))),t=e.querySelectorAll(".slick-sort-indicator-numbered"),t.forEach((e=>e.textContent=""))}));let i=1;this.sortColumns.forEach((e=>{Me(e.sortAsc)||(e.sortAsc=!0);const s=this.getColumnIndex(e.columnId);if(Me(s)){const n=this.getColumnByIndex(s);if(n){n.classList.add("slick-header-column-sorted");let s=n.querySelector(".slick-sort-indicator");s?.classList.add(e.sortAsc?"slick-sort-indicator-asc":"slick-sort-indicator-desc"),t&&(s=n.querySelector(".slick-sort-indicator-numbered"),s&&(s.textContent=String(i)))}}i++}))}getSortColumns(){return this.sortColumns}handleSelectedRangesChanged(e,t){const i=e.getNativeEvent(),s=this.selectedRows.slice(0);this.selectedRows=[];const n={};for(let e=0;e<t.length;e++)for(let i=t[e].fromRow;i<=t[e].toRow;i++){n[i]||(this.selectedRows.push(i),n[i]={});for(let s=t[e].fromCell;s<=t[e].toCell;s++)this.canCellBeSelected(i,s)&&(n[i][this.columns[s].id]=this._options.selectedCellCssClass)}if(this.setCellCssStyles(this._options.selectedCellCssClass||"",n),this.simpleArrayEquals(s,this.selectedRows)){const t=i?.detail?.caller??"click",n=new Set(this.getSelectedRows()),r=new Set(s),o=Array.from(n).filter((e=>!r.has(e))),a=Array.from(r).filter((e=>!n.has(e)));this.triggerEvent(this.onSelectedRowsChanged,{rows:this.getSelectedRows(),previousSelectedRows:s,caller:t,changedSelectedRows:o,changedUnselectedRows:a},e)}}simpleArrayEquals(e,t){return Array.isArray(e)&&Array.isArray(t)&&t.sort().toString()!==e.sort().toString()}getColumns(){return this.columns}updateColumnCaches(){this.columnPosLeft=[],this.columnPosRight=[];let e=0;for(let t=0,i=this.columns.length;t<i;t++)this.columns[t]&&!this.columns[t].hidden&&(this.columnPosLeft[t]=e,this.columnPosRight[t]=e+(this.columns[t].width||0),this._options.frozenColumn===t?e=0:e+=this.columns[t].width||0)}updateColumnProps(){this.columnsById={};for(let e=0;e<this.columns.length;e++){let t=this.columns[e]||{};t.width&&(t.widthRequest=t.width),this._options.mixinDefaults?Ts.applyDefaults(t,this._columnDefaults):t=this.columns[e]=Te({},this._columnDefaults,t),this.columnsById[t.id]=e,t.minWidth&&(t.width||0)<t.minWidth&&(t.width=t.minWidth),t.maxWidth&&(t.width||0)>t.maxWidth&&(t.width=t.maxWidth)}}setColumns(e){this.triggerEvent(this.onBeforeSetColumns,{previousColumns:this.columns,newColumns:e,grid:this}),this.columns=e,this.updateColumnsInternal(),this.triggerEvent(this.onAfterSetColumns,{newColumns:e,grid:this})}updateColumns(){this.triggerEvent(this.onBeforeUpdateColumns,{columns:this.columns,grid:this}),this.updateColumnsInternal()}updateColumnsInternal(){this.updateColumnProps(),this.updateColumnCaches(),this.initialized&&(this.setPaneVisibility(),this.setOverflow(),this.invalidateAllRows(),this.createColumnHeaders(),this.createColumnFooter(),this.removeCssRules(),this.createCssRules(),this.resizeCanvas(),this.updateCanvasWidth(),this.applyColumnWidths(),this.handleScroll(),this.getSelectionModel()?.refreshSelections())}getOptions(){return this._options}setOptions(e,t,i,s){this.prepareForOptionsChange(),this._options.enableAddRow!==e.enableAddRow&&this.invalidateRow(this.getDataLength()),void 0!==e.frozenColumn&&e.frozenColumn>=0&&(this.getViewports().forEach((e=>e.scrollLeft=0)),this.handleScroll());const n=Te(!0,{},this._options);this._options=Te(this._options,e),this.triggerEvent(this.onSetOptions,{optionsBefore:n,optionsAfter:this._options}),this.internal_setOptions(t,i,s)}activateChangedOptions(e,t,i){this.prepareForOptionsChange(),this.invalidateRow(this.getDataLength()),this.triggerEvent(this.onActivateChangedOptions,{options:this._options}),this.internal_setOptions(e,t,i)}prepareForOptionsChange(){this.getEditorLock()?.commitCurrentEdit()&&this.makeActiveCellNormal()}internal_setOptions(e,t,i){void 0!==this._options.showColumnHeader&&this.setColumnHeaderVisibility(this._options.showColumnHeader),this.validateAndEnforceOptions(),this.setFrozenOptions(),void 0!==this._options.frozenBottom&&(this.enforceFrozenRowHeightRecalc=!0),this._viewport.forEach((e=>{e.style.overflowY=this._options.autoHeight?"hidden":"auto"})),e||this.render(),this.setScroller(),i||this.setOverflow(),t||this.setColumns(this.columns),!this._options.enableMouseWheelScrollHandler||!this._viewport||this.slickMouseWheelInstances&&0!==this.slickMouseWheelInstances.length?!1===this._options.enableMouseWheelScrollHandler&&this.destroyAllInstances(this.slickMouseWheelInstances):this._viewport.forEach((e=>{this.slickMouseWheelInstances.push(Lr({element:e,onMouseWheel:this.handleMouseWheel.bind(this)}))}))}validateAndEnforceOptions(){this._options.autoHeight&&(this._options.leaveSpaceForNewRows=!1)}setData(e,t){this.data=e,this.invalidateAllRows(),this.updateRowCount(),t&&this.scrollTo(0)}getData(){return this.data}getDataLength(){return this.data.getLength?this.data.getLength():this.data?.length||0}getDataLengthIncludingAddNew(){return this.getDataLength()+(!this._options.enableAddRow||this.pagingActive&&!this.pagingIsLastPage?0:1)}getDataItem(e){return this.data.getItem?this.data.getItem(e):this.data[e]}getTopPanel(){return this._topPanels[0]}getTopPanels(){return this._topPanels}hasDataView(){return!Array.isArray(this.data)}togglePanelVisibility(e,t,i){this._options[e]!==i&&(this._options[e]=i,i?Ts.show(t):Ts.hide(t),this.resizeCanvas())}setTopPanelVisibility(e){this.togglePanelVisibility("showTopPanel",this._topPanelScrollers,e)}setHeaderRowVisibility(e){this.togglePanelVisibility("showHeaderRow",this._headerRowScroller,e)}setColumnHeaderVisibility(e){this.togglePanelVisibility("showColumnHeader",this._headerScroller,e)}setFooterRowVisibility(e){this.togglePanelVisibility("showFooterRow",this._footerRowScroller,e)}setPreHeaderPanelVisibility(e){this.togglePanelVisibility("showPreHeaderPanel",[this._preHeaderPanelScroller,this._preHeaderPanelScrollerR],e)}setTopHeaderPanelVisibility(e){this.togglePanelVisibility("showTopHeaderPanel",this._topHeaderPanelScroller,e)}getContainerNode(){return this._container}getRowTop(e){return Math.round(this._options.rowHeight*e-this.offset)}getRowFromPosition(e){return Math.floor((e+this.offset)/this._options.rowHeight)}scrollTo(e){e=Math.max(e,0),e=Math.min(e,(this.th||0)-Ts.height(this._viewportScrollContainerY)+((this.viewportHasHScroll||this.hasFrozenColumns())&&this.scrollbarDimensions?.height||0));const t=this.offset;this.offset=Math.round(this.page*(this.cj||0)),this.page=Math.min((this.n||0)-1,Math.floor(e/(this.ph||0)));const i=e-this.offset;if(this.offset!==t){const e=this.getVisibleRange(i);this.cleanupRows(e),this.updateRowPositions()}this.prevScrollTop!==i&&(this.vScrollDir=this.prevScrollTop+t<i+this.offset?1:-1,this.lastRenderedScrollTop=this.scrollTop=this.prevScrollTop=i,this.hasFrozenColumns()&&(this._viewportTopL.scrollTop=i),this.hasFrozenRows&&(this._viewportBottomL.scrollTop=this._viewportBottomR.scrollTop=i),this._viewportScrollContainerY&&(this._viewportScrollContainerY.scrollTop=i),this.triggerEvent(this.onViewportChanged,{}))}defaultFormatter(e,t,i){return Me(i)?(i+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"):""}getFormatter(e,t){const i=this.data?.getItemMetadata?.(e),s=i?.columns&&(i.columns[t.id]||i.columns[this.getColumnIndex(t.id)]);return s?.formatter||i?.formatter||t.formatter||this._options.formatterFactory?.getFormatter(t)||this._options.defaultFormatter}getEditor(e,t){const i=this.columns[t],s=this.data?.getItemMetadata?.(e),n=s?.columns;return void 0!==n?.[i.id]?.editorClass?n[i.id].editorClass:void 0!==n?.[t]?.editorClass?n[t].editorClass:i.editorClass||this._options?.editorFactory?.getEditor(i)}getDataItemValueForColumn(e,t){return this._options.dataItemColumnValueExtractor?this._options.dataItemColumnValueExtractor(e,t):e[t.field]}appendRowHtml(e,t,i,s,n){const r=this.getDataItem(i),o=i<n&&!r;let a="slick-row"+(this.hasFrozenRows&&i<=this._options.frozenRow?" frozen":"")+(o?" loading":"")+(i===this.activeRow&&this._options.showCellSelection?" active":"")+(i%2==1?" odd":" even");r||(a+=` ${this._options.addNewRowCssClass}`);const l=this.data?.getItemMetadata?.(i);l?.cssClasses&&(a+=` ${l.cssClasses}`);const h=ie("div",{className:`slick-widget-content ${a}`,role:"row"}),c=this.getFrozenRowOffset(i),d=this.getRowTop(i)-c;let u,p,m;"transform"===this._options.rowTopOffsetRenderType?h.style.transform=`translateY(${d}px)`:h.style.top=`${d}px`,e.push(h),this.hasFrozenColumns()&&(u=h.cloneNode(!0),t.push(u));for(let e=0,t=this.columns.length;e<t;e++)if(m=this.columns[e],m&&!m.hidden){if(p=1,l?.columns){const i=l.columns[m.id]||l.columns[e];p=i?.colspan||1,"*"===p&&(p=t-e)}if(this.columnPosRight[Math.min(t-1,e+p-1)]>s.leftPx){if(!m.alwaysRenderColumn&&this.columnPosLeft[e]>s.rightPx)break;this.hasFrozenColumns()&&e>this._options.frozenColumn?this.appendCellHtml(u,i,e,p,r):this.appendCellHtml(h,i,e,p,r)}else(m.alwaysRenderColumn||this.hasFrozenColumns()&&e<=this._options.frozenColumn)&&this.appendCellHtml(h,i,e,p,r);p>1&&(e+=p-1)}}appendCellHtml(e,t,i,s,n){const r=this.columns[i];let o="slick-cell l"+i+" r"+Math.min(this.columns.length-1,i+s-1)+(r.cssClass?" "+r.cssClass:"");this.hasFrozenColumns()&&i<=this._options.frozenColumn&&(o+=" frozen"),t===this.activeRow&&i===this.activeCell&&this._options.showCellSelection&&(o+=" active"),Object.keys(this.cellCssClasses).forEach((e=>{this.cellCssClasses[e][t]?.[r.id]&&(o+=` ${this.cellCssClasses[e][t][r.id]}`)}));let a=null,l="";n&&(a=this.getDataItemValueForColumn(n,r),l=this.getFormatter(t,r)(t,i,a,r,n,this),null==l&&(l=""));const h=this.triggerEvent(this.onBeforeAppendCell,{row:t,cell:i,value:a,dataContext:n}).getReturnValue();let c="string"==typeof h?h:"";l?.addClasses&&(c+=se((c?" ":"")+l.addClasses).join(" "));const d=l?.toolTip?`${l.toolTip}`:"",u=ie("div",{className:se(`${o} ${c||""}`).join(" "),role:"gridcell",tabIndex:-1});if(u.setAttribute("aria-describedby",this.uid+r.id),d&&u.setAttribute("title",d),r.hasOwnProperty("cellAttrs")&&r.cellAttrs instanceof Object&&Object.keys(r.cellAttrs).forEach((e=>{r.cellAttrs.hasOwnProperty(e)&&u.setAttribute(e,r.cellAttrs[e])})),n){const e=He(l)?l:l.html||l.text;this.applyHtmlCode(u,e)}e.appendChild(u),l.insertElementAfterTarget&&ge(u,l.insertElementAfterTarget),this.rowsCache[t].cellRenderQueue.push(i),this.rowsCache[t].cellColSpans[i]=s}cleanupRows(e){Object.keys(this.rowsCache).forEach((t=>{if(this.rowsCache){let i=+t,s=!0;this.hasFrozenRows&&(this._options.frozenBottom&&i>=this.actualFrozenRow||!this._options.frozenBottom&&i<=this.actualFrozenRow)&&(s=!1),(i=parseInt(t,10))!==this.activeRow&&(i<e.top||i>e.bottom)&&s&&this.removeRowFromCache(i)}})),this._options.enableAsyncPostRenderCleanup&&this.startPostProcessingCleanup()}invalidate(){this.updateRowCount(),this.invalidateAllRows(),this.render()}invalidateAllRows(){this.currentEditor&&this.makeActiveCellNormal(),"object"==typeof this.rowsCache&&Object.keys(this.rowsCache).forEach((e=>{this.rowsCache&&this.removeRowFromCache(+e)})),this._options.enableAsyncPostRenderCleanup&&this.startPostProcessingCleanup()}invalidateRows(e){if(e?.length){this.vScrollDir=0;const t=e.length;for(let i=0;i<t;i++)this.currentEditor&&this.activeRow===e[i]&&this.makeActiveCellNormal(),this.rowsCache[e[i]]&&this.removeRowFromCache(e[i]);this._options.enableAsyncPostRenderCleanup&&this.startPostProcessingCleanup()}}invalidateRow(e){e>=0&&this.invalidateRows([e])}queuePostProcessedRowForCleanup(e,t,i){this.postProcessgroupId++,"object"==typeof t&&Object.keys(t).forEach((s=>{t.hasOwnProperty(s)&&this.postProcessedCleanupQueue.push({actionType:"C",groupId:this.postProcessgroupId,node:e.cellNodesByColumnIdx[+s],columnIdx:+s,rowIdx:i})})),e.rowNode||(e.rowNode=[]),this.postProcessedCleanupQueue.push({actionType:"R",groupId:this.postProcessgroupId,node:e.rowNode}),e.rowNode?.forEach((e=>e.remove()))}queuePostProcessedCellForCleanup(e,t,i){this.postProcessedCleanupQueue.push({actionType:"C",groupId:this.postProcessgroupId,node:e,columnIdx:t,rowIdx:i}),e.remove()}removeRowFromCache(e){const t=this.rowsCache[e];t?.rowNode&&(this._options.enableAsyncPostRenderCleanup&&this.postProcessedRows[e]?this.queuePostProcessedRowForCleanup(t,this.postProcessedRows[e],e):t.rowNode?.forEach((e=>e.parentElement?.removeChild(e))),delete this.rowsCache[e],delete this.postProcessedRows[e],this.renderedRows--,this.counter_rows_removed++)}applyFormatResultToCellNode(e,t,i){if(null==e&&(e=""),He(e))return void this.applyHtmlCode(t,e);const s=e.html||e.text;this.applyHtmlCode(t,s),e.removeClasses&&!i&&t.classList.remove(...se(e.removeClasses)),e.addClasses&&t.classList.add(...se(e.addClasses)),e.toolTip&&t.setAttribute("title",e.toolTip)}updateCell(e,t){const i=this.getCellNode(e,t);if(i){const s=this.columns[t],n=this.getDataItem(e);if(this.currentEditor&&this.activeRow===e&&this.activeCell===t)this.currentEditor.loadValue(n);else{const r=n?this.getFormatter(e,s)(e,t,this.getDataItemValueForColumn(n,s),s,n,this):"";this.applyFormatResultToCellNode(r,i),this.invalidatePostProcessingResults(e)}}}updateRow(e){const t=this.rowsCache[e];if(!t)return;let i;this.ensureCellNodesInRowsCache(e);const s=this.getDataItem(e);Object.keys(t.cellNodesByColumnIdx).forEach((n=>{if(!t.cellNodesByColumnIdx.hasOwnProperty(n))return;const r=+n,o=this.columns[r],a=t.cellNodesByColumnIdx[r];this.currentEditor&&e===this.activeRow&&r===this.activeCell?this.currentEditor.loadValue(s):s?(i=this.getFormatter(e,o)(e,r,this.getDataItemValueForColumn(s,o),o,s,this),this.applyFormatResultToCellNode(i,a)):re(a)})),this.invalidatePostProcessingResults(e)}getViewportRowCount(){const e=this.getViewportHeight(),t=this.getScrollbarDimensions()?.height||0;return Math.floor((e-t)/this._options.rowHeight)}getViewportHeight(){if(this._options.autoHeight&&-1===this._options.frozenColumn||(this.topPanelH=this._options.showTopPanel?this._options.topPanelHeight+this.getVBoxDelta(this._topPanelScrollers[0]):0,this.headerRowH=this._options.showHeaderRow?this._options.headerRowHeight+this.getVBoxDelta(this._headerRowScroller[0]):0,this.footerRowH=this._options.showFooterRow?this._options.footerRowHeight+this.getVBoxDelta(this._footerRowScroller[0]):0),this._options.autoHeight){let e=this._paneHeaderL.offsetHeight;e+=this._options.showHeaderRow?this._options.headerRowHeight+this.getVBoxDelta(this._headerRowScroller[0]):0,e+=this._options.showFooterRow?this._options.footerRowHeight+this.getVBoxDelta(this._footerRowScroller[0]):0,e+=this.getCanvasWidth()>this.viewportW&&this.scrollbarDimensions?.height||0,this.viewportH=this._options.rowHeight*this.getDataLengthIncludingAddNew()+(-1===this._options.frozenColumn?e:0)}else{const e=this._options.showColumnHeader?Ts.toFloat(Ts.height(this._headerScroller[0]))+this.getVBoxDelta(this._headerScroller[0]):0,t=this._options.createPreHeaderPanel&&this._options.showPreHeaderPanel?this._options.preHeaderPanelHeight+this.getVBoxDelta(this._preHeaderPanelScroller):0,i=this._options.createTopHeaderPanel&&this._options.showTopHeaderPanel?this._options.topHeaderPanelHeight+this.getVBoxDelta(this._topHeaderPanelScroller):0,s=getComputedStyle(this._container);this.viewportH=Ts.toFloat(s.height)-Ts.toFloat(s.paddingTop)-Ts.toFloat(s.paddingBottom)-e-this.topPanelH-this.headerRowH-this.footerRowH-t-i}return this.numVisibleRows=Math.ceil(this.viewportH/this._options.rowHeight),this.viewportH}getViewportWidth(){return this.viewportW=parseFloat(he(this._container,"width"))||this._options.devMode&&this._options.devMode.containerClientWidth||0,this.viewportW}resizeCanvas(){if(this.initialized){if(this.paneTopH=0,this.paneBottomH=0,this.viewportTopH=0,this.viewportBottomH=0,this.getViewportWidth(),this.getViewportHeight(),this.hasFrozenRows?this._options.frozenBottom?(this.paneTopH=this.viewportH-this.frozenRowsHeight-(this.scrollbarDimensions?.height||0),this.paneBottomH=this.frozenRowsHeight+(this.scrollbarDimensions?.height||0)):(this.paneTopH=this.frozenRowsHeight,this.paneBottomH=this.viewportH-this.frozenRowsHeight):this.paneTopH=this.viewportH,this.paneTopH+=this.topPanelH+this.headerRowH+this.footerRowH,this.hasFrozenColumns()&&this._options.autoHeight&&(this.paneTopH+=this.scrollbarDimensions?.height||0),this.viewportTopH=this.paneTopH-this.topPanelH-this.headerRowH-this.footerRowH,this._options.autoHeight){if(this.hasFrozenColumns()){const e=getComputedStyle(this._headerScrollerL);Ts.height(this._container,this.paneTopH+Ts.toFloat(e.height))}this._paneTopL.style.position="relative"}let e=Ts.height(this._paneHeaderL);e?e+=this._options.showTopHeaderPanel?this._options.topHeaderPanelHeight:0:e=(this._options.showHeaderRow?this._options.headerRowHeight:0)+(this._options.showPreHeaderPanel?this._options.preHeaderPanelHeight:0),Ts.setStyleSize(this._paneTopL,"top",e||e),Ts.height(this._paneTopL,this.paneTopH);const t=this._paneTopL.offsetTop+this.paneTopH;if(this._options.autoHeight||Ts.height(this._viewportTopL,this.viewportTopH),this.hasFrozenColumns()){let e=Ts.height(this._paneHeaderL);e&&(e+=this._options.showTopHeaderPanel?this._options.topHeaderPanelHeight:0),Ts.setStyleSize(this._paneTopR,"top",e),Ts.height(this._paneTopR,this.paneTopH),Ts.height(this._viewportTopR,this.viewportTopH),this.hasFrozenRows&&(Ts.setStyleSize(this._paneBottomL,"top",t),Ts.height(this._paneBottomL,this.paneBottomH),Ts.setStyleSize(this._paneBottomR,"top",t),Ts.height(this._paneBottomR,this.paneBottomH),Ts.height(this._viewportBottomR,this.paneBottomH))}else this.hasFrozenRows&&(Ts.width(this._paneBottomL,"100%"),Ts.height(this._paneBottomL,this.paneBottomH),Ts.setStyleSize(this._paneBottomL,"top",t));this.hasFrozenRows?(Ts.height(this._viewportBottomL,this.paneBottomH),this._options.frozenBottom?(Ts.height(this._canvasBottomL,this.frozenRowsHeight),this.hasFrozenColumns()&&Ts.height(this._canvasBottomR,this.frozenRowsHeight)):(Ts.height(this._canvasTopL,this.frozenRowsHeight),this.hasFrozenColumns()&&Ts.height(this._canvasTopR,this.frozenRowsHeight))):Ts.height(this._viewportTopR,this.viewportTopH),this.scrollbarDimensions&&this.scrollbarDimensions.width||(this.scrollbarDimensions=this.measureScrollbar()),this._options.forceFitColumns&&this.legacyAutosizeColumns(),this.updateRowCount(),this.handleScroll(),this.lastRenderedScrollLeft=-1,this.render()}}updatePagingStatusFromView(e){this.pagingActive=0!==e.pageSize,this.pagingIsLastPage=e.pageNum===e.totalPages-1}updateRowCount(){if(this.initialized){const e=this.getDataLength(),t=this.getDataLengthIncludingAddNew();let i=0,s=this.hasFrozenRows&&!this._options.frozenBottom?Ts.height(this._canvasBottomL):Ts.height(this._canvasTopL);i=this.hasFrozenRows?this.getDataLength()-this._options.frozenRow:t+(this._options.leaveSpaceForNewRows?this.numVisibleRows-1:0);const n=Ts.height(this._viewportScrollContainerY),r=this.viewportHasVScroll;this.viewportHasVScroll=this._options.alwaysShowVerticalScroll||!this._options.autoHeight&&i*this._options.rowHeight>n,this.makeActiveCellNormal();const o=e-1;"object"==typeof this.rowsCache&&Object.keys(this.rowsCache).forEach((e=>{const t=+e;t>o&&this.removeRowFromCache(t)})),this._options.enableAsyncPostRenderCleanup&&this.startPostProcessingCleanup(),this.activeCellNode&&this.activeRow>o&&this.resetActiveCell(),s=this.h,this._options.autoHeight?this.h=this._options.rowHeight*i:(this.th=Math.max(this._options.rowHeight*i,n-(this.scrollbarDimensions?.height||0)),this.th<this.maxSupportedCssHeight?(this.h=this.ph=this.th,this.n=1,this.cj=0):(this.h=this.maxSupportedCssHeight,this.ph=this.h/100,this.n=Math.floor(this.th/this.ph),this.cj=(this.th-this.h)/(this.n-1))),(this.h!==s||this.enforceFrozenRowHeightRecalc)&&(this.hasFrozenRows&&!this._options.frozenBottom?(Ts.height(this._canvasBottomL,this.h),this.hasFrozenColumns()&&Ts.height(this._canvasBottomR,this.h)):(Ts.height(this._canvasTopL,this.h),Ts.height(this._canvasTopR,this.h)),this.scrollTop=this._viewportScrollContainerY.scrollTop,this.scrollHeight=this._viewportScrollContainerY.scrollHeight,this.enforceFrozenRowHeightRecalc=!1);const a=this.scrollTop+this.offset<=this.th-n;0===this.th||0===this.scrollTop?this.page=this.offset=0:a?this.scrollTo(this.scrollTop+this.offset):this.scrollTo(this.th-n+(this.scrollbarDimensions?.height||0)),this.h!==s&&this._options.autoHeight&&this.resizeCanvas(),this._options.forceFitColumns&&r!==this.viewportHasVScroll&&this.legacyAutosizeColumns(),this.updateCanvasWidth(!1)}}getViewport(e,t){return this.getVisibleRange(e,t)}getVisibleRange(e,t){return e??=this.scrollTop,t??=this.scrollLeft,{top:this.getRowFromPosition(e),bottom:this.getRowFromPosition(e+this.viewportH)+1,leftPx:t,rightPx:t+this.viewportW}}getRenderedRange(e,t){const i=this.getVisibleRange(e,t),s=Math.round(this.viewportH/this._options.rowHeight),n=this._options.minRowBuffer;return-1===this.vScrollDir?(i.top-=s,i.bottom+=n):1===this.vScrollDir?(i.top-=n,i.bottom+=s):(i.top-=n,i.bottom+=n),i.top=Math.max(0,i.top),i.bottom=Math.min(this.getDataLengthIncludingAddNew()-1,i.bottom),i.leftPx-=this.viewportW,i.rightPx+=this.viewportW,i.leftPx=Math.max(0,i.leftPx),i.rightPx=Math.min(this.canvasWidth,i.rightPx),i}ensureCellNodesInRowsCache(e){const t=this.rowsCache[e];if(t?.cellRenderQueue.length&&t.rowNode?.length){const e=t.rowNode;let i=Array.from(e[0].children);e.length>1&&(i=i.concat(Array.from(e[1].children)));let s=i.length-1;for(;t.cellRenderQueue.length;){const e=t.cellRenderQueue.pop();t.cellNodesByColumnIdx[e]=i[s--]}}}cleanUpCells(e,t){if(this.hasFrozenRows&&(this._options.frozenBottom&&t>this.actualFrozenRow||t<=this.actualFrozenRow))return;const i=this.rowsCache[t],s=[];let n,r;for(Object.keys(i.cellNodesByColumnIdx).forEach((n=>{if(!i.cellNodesByColumnIdx.hasOwnProperty(n))return;const r=+n;if(r<=this._options.frozenColumn)return;if(Array.isArray(this.columns)&&this.columns[r]?.alwaysRenderColumn)return;const o=i.cellColSpans[r];(this.columnPosLeft[r]>e.rightPx||this.columnPosRight[Math.min(this.columns.length-1,(r||0)+o-1)]<e.leftPx)&&(t===this.activeRow&&Number(r)===this.activeCell||s.push(r))}));Me(n=s.pop());)r=i.cellNodesByColumnIdx[n],this._options.enableAsyncPostRenderCleanup&&this.postProcessedRows[t]?.[n]?this.queuePostProcessedCellForCleanup(r,n,t):r.parentElement?.removeChild(r),delete i.cellColSpans[n],delete i.cellNodesByColumnIdx[n],this.postProcessedRows[t]&&delete this.postProcessedRows[t][n]}cleanUpAndRenderCells(e){let t;const i=document.createElement("div"),s=[];let n,r,o,a,l=0;for(let o=e.top,a=e.bottom;o<=a;o++){if(t=this.rowsCache[o],!t)continue;this.ensureCellNodesInRowsCache(o),this.cleanUpCells(e,o),n=0;let a=this.data?.getItemMetadata?.(o)??{};a=a?.columns;const h=this.getDataItem(o);for(let s=0,l=this.columns.length;s<l;s++){if(!this.columns[s]||this.columns[s].hidden)continue;if(this.columnPosLeft[s]>e.rightPx)break;if(Me(r=t.cellColSpans[s])){s+=r>1?r-1:0;continue}if(r=1,a){const e=a[this.columns[s].id]||a[s];r=e?.colspan??1,"*"===r&&(r=l-s)}const c=r;this.columnPosRight[Math.min(l-1,s+c-1)]>e.leftPx&&(this.appendCellHtml(i,o,s,c,h),n++),s+=c>1?c-1:0}n&&(l+=n,s.push(o))}if(i.children.length)for(;Me(o=s.pop());){let e;for(t=this.rowsCache[o];Me(e=t.cellRenderQueue.pop());)a=i.lastChild,a&&(this.hasFrozenColumns()&&e>this._options.frozenColumn?t.rowNode[1].appendChild(a):t.rowNode[0].appendChild(a),t.cellNodesByColumnIdx[e]=a)}}renderRows(e){const t=[],i=[],s=[];let n=!1;const r=this.getDataLength();for(let o=e.top,a=e.bottom;o<=a;o++)this.rowsCache[o]||this.hasFrozenRows&&this._options.frozenBottom&&o===this.getDataLength()||(this.renderedRows++,s.push(o),this.rowsCache[o]={rowNode:null,cellColSpans:[],cellNodesByColumnIdx:[],cellRenderQueue:[]},this.appendRowHtml(t,i,o,e,r),this.activeCellNode&&this.activeRow===o&&(n=!0),this.counter_rows_rendered++);if(!s.length)return;const o=document.createElement("div"),a=document.createElement("div");t.forEach((e=>o.appendChild(e))),i.forEach((e=>a.appendChild(e)));for(let e=0,t=s.length;e<t;e++)this.hasFrozenRows&&s[e]>=this.actualFrozenRow?this.hasFrozenColumns()?this.rowsCache?.hasOwnProperty(s[e])&&o.firstChild&&a.firstChild&&(this.rowsCache[s[e]].rowNode=[o.firstChild,a.firstChild],this._canvasBottomL.appendChild(o.firstChild),this._canvasBottomR.appendChild(a.firstChild)):this.rowsCache?.hasOwnProperty(s[e])&&o.firstChild&&(this.rowsCache[s[e]].rowNode=[o.firstChild],this._canvasBottomL.appendChild(o.firstChild)):this.hasFrozenColumns()?this.rowsCache?.hasOwnProperty(s[e])&&o.firstChild&&a.firstChild&&(this.rowsCache[s[e]].rowNode=[o.firstChild,a.firstChild],this._canvasTopL.appendChild(o.firstChild),this._canvasTopR.appendChild(a.firstChild)):this.rowsCache?.hasOwnProperty(s[e])&&o.firstChild&&(this.rowsCache[s[e]].rowNode=[o.firstChild],this._canvasTopL.appendChild(o.firstChild));n&&(this.activeCellNode=this.getCellNode(this.activeRow,this.activeCell))}startPostProcessing(){this._options.enableAsyncPostRender&&(window.clearTimeout(this.h_postrender),this.h_postrender=window.setTimeout(this.asyncPostProcessRows.bind(this),this._options.asyncPostRenderDelay))}startPostProcessingCleanup(){this._options.enableAsyncPostRenderCleanup&&(window.clearTimeout(this.h_postrenderCleanup),this.h_postrenderCleanup=window.setTimeout(this.asyncPostProcessCleanupRows.bind(this),this._options.asyncPostRenderCleanupDelay))}invalidatePostProcessingResults(e){"object"==typeof this.postProcessedRows[e]&&Object.keys(this.postProcessedRows[e]).forEach((t=>{this.postProcessedRows[e].hasOwnProperty(t)&&(this.postProcessedRows[e][t]="C")})),this.postProcessFromRow=Math.min(this.postProcessFromRow,e),this.postProcessToRow=Math.max(this.postProcessToRow,e),this.startPostProcessing()}updateRowPositions(){this.rowsCache&&"object"==typeof this.rowsCache&&Object.keys(this.rowsCache).forEach((e=>{const t=e?parseInt(e,10):0,i=this.rowsCache[t].rowNode[0];"transform"===this._options.rowTopOffsetRenderType?i.style.transform=`translateY(${this.getRowTop(t)}px)`:i.style.top=`${this.getRowTop(t)}px`}))}render(){if(this.initialized){this.scrollThrottle.dequeue();const e=this.getVisibleRange(),t=this.getRenderedRange();if(this.cleanupRows(t),this.lastRenderedScrollLeft!==this.scrollLeft){if(this.hasFrozenRows){const e=Te(!0,{},t);this._options.frozenBottom?(e.top=this.actualFrozenRow,e.bottom=this.getDataLength()):(e.top=0,e.bottom=this._options.frozenRow),this.cleanUpAndRenderCells(e)}this.cleanUpAndRenderCells(t)}this.renderRows(t),this.hasFrozenRows&&(this._options.frozenBottom?this.renderRows({top:this.actualFrozenRow,bottom:this.getDataLength()-1,leftPx:t.leftPx,rightPx:t.rightPx}):this.renderRows({top:0,bottom:this._options.frozenRow-1,leftPx:t.leftPx,rightPx:t.rightPx})),this.postProcessFromRow=e.top,this.postProcessToRow=Math.min(this.getDataLengthIncludingAddNew()-1,e.bottom),this.startPostProcessing(),this.lastRenderedScrollTop=this.scrollTop,this.lastRenderedScrollLeft=this.scrollLeft,this.h_render=null,this.triggerEvent(this.onRendered,{startRow:e.top,endRow:e.bottom,grid:this})}}handleHeaderRowScroll(){const e=this._headerRowScrollContainer.scrollLeft;e!==this._viewportScrollContainerX.scrollLeft&&(this._viewportScrollContainerX.scrollLeft=e)}handleFooterRowScroll(){const e=this._footerRowScrollContainer.scrollLeft;e!==this._viewportScrollContainerX.scrollLeft&&(this._viewportScrollContainerX.scrollLeft=e)}handlePreHeaderPanelScroll(){this.handleElementScroll(this._preHeaderPanelScroller)}handleTopHeaderPanelScroll(){this.handleElementScroll(this._topHeaderPanelScroller)}handleElementScroll(e){const t=e.scrollLeft;t!==this._viewportScrollContainerX.scrollLeft&&(this._viewportScrollContainerX.scrollLeft=t)}handleScroll(e){return this.scrollHeight=this._viewportScrollContainerY.scrollHeight,this.scrollTop=this._viewportScrollContainerY.scrollTop,this.scrollLeft=this._viewportScrollContainerX.scrollLeft,this._handleScroll(e?"scroll":"system")}_handleScroll(e="system"){let t=this._viewportScrollContainerY.scrollHeight-this._viewportScrollContainerY.clientHeight,i=this._viewportScrollContainerY.scrollWidth-this._viewportScrollContainerY.clientWidth;t=Math.max(0,t),i=Math.max(0,i),this.scrollTop>t&&(this.scrollTop=t,this.scrollHeight=t),this.scrollLeft>i&&(this.scrollLeft=i);const s=Math.abs(this.scrollTop-this.prevScrollTop),n=Math.abs(this.scrollLeft-this.prevScrollLeft);if(n&&(this.prevScrollLeft=this.scrollLeft,this._viewportScrollContainerX.scrollLeft=this.scrollLeft,this._headerScrollContainer.scrollLeft=this.scrollLeft,this._topPanelScrollers[0].scrollLeft=this.scrollLeft,this._options.createFooterRow&&(this._footerRowScrollContainer.scrollLeft=this.scrollLeft),this._options.createPreHeaderPanel&&(this.hasFrozenColumns()?this._preHeaderPanelScrollerR.scrollLeft=this.scrollLeft:this._preHeaderPanelScroller.scrollLeft=this.scrollLeft),this._options.createTopHeaderPanel&&(this._topHeaderPanelScroller.scrollLeft=this.scrollLeft),this.hasFrozenColumns()?(this.hasFrozenRows&&(this._viewportTopR.scrollLeft=this.scrollLeft),this._headerRowScrollerR.scrollLeft=this.scrollLeft):(this.hasFrozenRows&&(this._viewportTopL.scrollLeft=this.scrollLeft),this._headerRowScrollerL.scrollLeft=this.scrollLeft)),s&&!this._options.autoHeight)if(this.vScrollDir=this.prevScrollTop<this.scrollTop?1:-1,this.prevScrollTop=this.scrollTop,"mousewheel"===e&&(this._viewportScrollContainerY.scrollTop=this.scrollTop),this.hasFrozenColumns()&&(this.hasFrozenRows&&!this._options.frozenBottom?this._viewportBottomL.scrollTop=this.scrollTop:this._viewportTopL.scrollTop=this.scrollTop),s<this.viewportH)this.scrollTo(this.scrollTop+this.offset);else{const e=this.offset;this.h===this.viewportH?this.page=0:this.page=Math.min(this.n-1,Math.floor(this.scrollTop*((this.th-this.viewportH)/(this.h-this.viewportH))*(1/this.ph))),this.offset=Math.round(this.page*this.cj),e!==this.offset&&this.invalidateAllRows()}if(n||s){const e=Math.abs(this.lastRenderedScrollLeft-this.scrollLeft),t=Math.abs(this.lastRenderedScrollTop-this.scrollTop);(e>20||t>20)&&(this._options.forceSyncScrolling||t<this.viewportH&&e<this.viewportW?this.render():this.scrollThrottle.enqueue(),this.triggerEvent(this.onViewportChanged,{}))}return this.triggerEvent(this.onScroll,{triggeredBy:e,scrollHeight:this.scrollHeight,scrollLeft:this.scrollLeft,scrollTop:this.scrollTop}),!(!n&&!s)}actionThrottle(e,t){let i=!1,s=!1;const n=()=>{s=!1},r=()=>{i=!0,window.clearTimeout(this._executionBlockTimer),this._executionBlockTimer=window.setTimeout(o,t),e.call(this)},o=()=>{s?(n(),r()):i=!1};return{enqueue:(()=>{i?s=!0:r()}).bind(this),dequeue:n.bind(this)}}asyncPostProcessRows(){const e=this.getDataLength();for(;this.postProcessFromRow<=this.postProcessToRow;){const t=this.vScrollDir>=0?this.postProcessFromRow++:this.postProcessToRow--,i=this.rowsCache[t];if(i&&!(t>=e))return this.postProcessedRows[t]||(this.postProcessedRows[t]={}),this.ensureCellNodesInRowsCache(t),Object.keys(i.cellNodesByColumnIdx).forEach((e=>{if(i.cellNodesByColumnIdx.hasOwnProperty(e)){const s=+e,n=this.columns[s],r=this.postProcessedRows[t][s];if(n.asyncPostRender&&"R"!==r){const e=i.cellNodesByColumnIdx[s];e&&n.asyncPostRender(e,t,this.getDataItem(t),n,"C"===r),this.postProcessedRows[t][s]="R"}}})),void(this.h_postrender=window.setTimeout(this.asyncPostProcessRows.bind(this),this._options.asyncPostRenderDelay))}}asyncPostProcessCleanupRows(){if(this.postProcessedCleanupQueue.length>0){const e=this.postProcessedCleanupQueue[0].groupId;for(;this.postProcessedCleanupQueue.length>0&&this.postProcessedCleanupQueue[0].groupId===e;){const e=this.postProcessedCleanupQueue.shift();if("R"===e?.actionType&&e.node.forEach((e=>{e.remove()})),"C"===e?.actionType){const t=this.columns[e.columnIdx];t.asyncPostRenderCleanup&&e.node&&t.asyncPostRenderCleanup(e.node,e.rowIdx,t)}}this.h_postrenderCleanup=window.setTimeout(this.asyncPostProcessCleanupRows.bind(this),this._options.asyncPostRenderCleanupDelay)}}updateCellCssStylesOnRenderedRows(e,t){let i,s,n;"object"==typeof this.rowsCache&&Object.keys(this.rowsCache).forEach((r=>{this.rowsCache&&(n=t?.[r],s=e?.[r],n&&Object.keys(n).forEach((e=>{s&&n[e]===s[e]||(i=this.getCellNode(+r,this.getColumnIndex(e)),i&&i.classList.remove(n[e]))})),s&&Object.keys(s).forEach((e=>{n&&n[e]===s[e]||(i=this.getCellNode(+r,this.getColumnIndex(e)),i&&i.classList.add(s[e]))})))}))}addCellCssStyles(e,t){if(this.cellCssClasses[e])throw new Error(`SlickGrid addCellCssStyles: cell CSS hash with key "${e}" already exists.`);this.cellCssClasses[e]=t,this.updateCellCssStylesOnRenderedRows(t,null),this.triggerEvent(this.onCellCssStylesChanged,{key:e,hash:t,grid:this})}removeCellCssStyles(e){this.cellCssClasses[e]&&(this.updateCellCssStylesOnRenderedRows(null,this.cellCssClasses[e]),delete this.cellCssClasses[e],this.triggerEvent(this.onCellCssStylesChanged,{key:e,hash:null,grid:this}))}setCellCssStyles(e,t){const i=this.cellCssClasses[e];this.cellCssClasses[e]=t,this.updateCellCssStylesOnRenderedRows(t,i),this.triggerEvent(this.onCellCssStylesChanged,{key:e,hash:t,grid:this})}getCellCssStyles(e){return this.cellCssClasses[e]}flashCell(e,t,i=250){const s=(e,t)=>{t<1||(window.clearTimeout(this._flashCellTimer),this._flashCellTimer=window.setTimeout((()=>{t%2==0?e.classList.add(this._options.cellFlashingCssClass||""):e.classList.remove(this._options.cellFlashingCssClass||""),s(e,t-1)}),i))};if(this.rowsCache[e]){const i=this.getCellNode(e,t);i&&s(i,5)}}highlightRow(e,t){const i=this.rowsCache[e];t||=this._options.rowHighlightDuration,Array.isArray(i?.rowNode)&&this._options.rowHighlightCssClass&&(i.rowNode.forEach((e=>e.classList.add(...se(this._options.rowHighlightCssClass)))),window.clearTimeout(this._highlightRowTimer),this._highlightRowTimer=window.setTimeout((()=>{i.rowNode?.forEach((e=>e.classList.remove(...se(this._options.rowHighlightCssClass))))}),t))}handleMouseWheel(e,t,i,s){this.scrollHeight=this._viewportScrollContainerY.scrollHeight,this.scrollTop=Math.max(0,this._viewportScrollContainerY.scrollTop-s*this._options.rowHeight),this.scrollLeft=this._viewportScrollContainerX.scrollLeft+10*i,this._handleScroll("mousewheel")&&e.preventDefault()}handleDragInit(e,t){const i=this.getCellFromEvent(e);if(!i||!this.cellExists(i.row,i.cell))return!1;const s=this.triggerEvent(this.onDragInit,t,e);return!!s.isImmediatePropagationStopped()&&s.getReturnValue()}handleDragStart(e,t){const i=this.getCellFromEvent(e);if(!i||!this.cellExists(i.row,i.cell))return!1;const s=this.triggerEvent(this.onDragStart,t,e);return!!s.isImmediatePropagationStopped()&&s.getReturnValue()}handleDrag(e,t){return this.triggerEvent(this.onDrag,t,e).getReturnValue()}handleDragEnd(e,t){this.triggerEvent(this.onDragEnd,t,e)}handleKeyDown(e){let t=this.triggerEvent(this.onKeyDown,{row:this.activeRow,cell:this.activeCell},e).isImmediatePropagationStopped();if(!t&&!e.shiftKey&&!e.altKey){if(this._options.editable&&this.currentEditor?.keyCaptureList&&this.currentEditor.keyCaptureList.indexOf(e.which)>-1)return;"Home"===e.key?t=e.ctrlKey?this.navigateTop():this.navigateRowStart():"End"===e.key&&(t=e.ctrlKey?this.navigateBottom():this.navigateRowEnd())}if(!t)if(e.shiftKey||e.altKey||e.ctrlKey)"Tab"!==e.key||!e.shiftKey||e.ctrlKey||e.altKey||(t=this.navigatePrev());else if("Escape"===e.key){if(!this.getEditorLock()?.isActive())return;this.cancelEditAndSetFocus()}else"PageDown"===e.key?(this.navigatePageDown(),t=!0):"PageUp"===e.key?(this.navigatePageUp(),t=!0):"ArrowLeft"===e.key?t=this.navigateLeft():"ArrowRight"===e.key?t=this.navigateRight():"ArrowUp"===e.key?t=this.navigateUp():"ArrowDown"===e.key?t=this.navigateDown():"Tab"===e.key?t=this.navigateNext():"Enter"===e.key&&(this._options.editable&&(this.currentEditor?this.activeRow===this.getDataLength()?this.navigateDown():this.commitEditAndSetFocus():this.getEditorLock()?.commitCurrentEdit()&&this.makeActiveCellEditable(void 0,void 0,e)),t=!0);t&&(e.stopPropagation(),e.preventDefault())}handleClick(e){const t=e instanceof bs?e.getNativeEvent():e;if(!this.currentEditor&&(t.target!==document.activeElement||t.target.classList.contains("slick-cell"))){const e=this.getTextSelection();this.setFocus(),this.setTextSelection(e)}const i=this.getCellFromEvent(t);if(i&&(null===this.currentEditor||this.activeRow!==i.row||this.activeCell!==i.cell)&&!(e=this.triggerEvent(this.onClick,{row:i.row,cell:i.cell},e||t)).isImmediatePropagationStopped()&&!t.defaultPrevented&&this.canCellBeActive(i.row,i.cell)&&(!this.getEditorLock()?.isActive()||this.getEditorLock()?.commitCurrentEdit())){this.scrollRowIntoView(i.row,!1);const e="slick-edit-preclick"===t.target?.className,s=this.columns[i.cell],n=!!(this._options.editable&&s?.editorClass&&this._options.suppressActiveCellChangeOnEdit);this.setActiveCellInternal(this.getCellNode(i.row,i.cell),null,e,n,t)}}handleContextMenu(e){const t=e.target.closest(".slick-cell");t&&(this.activeCellNode===t&&null!==this.currentEditor||this.triggerEvent(this.onContextMenu,{},e))}handleDblClick(e){const t=this.getCellFromEvent(e);!t||null!==this.currentEditor&&this.activeRow===t.row&&this.activeCell===t.cell||(this.triggerEvent(this.onDblClick,{row:t.row,cell:t.cell},e),e.defaultPrevented||this._options.editable&&this.gotoCell(t.row,t.cell,!0,e))}handleHeaderMouseEnter(e){const t=Ts.storage.get(e.target.closest(".slick-header-column"),"column");t&&this.triggerEvent(this.onHeaderMouseEnter,{column:t,grid:this},e)}handleHeaderMouseOver(e){const t=Ts.storage.get(e.target.closest(".slick-header-column"),"column");t&&this.triggerEvent(this.onHeaderMouseOver,{column:t,grid:this},e)}handleHeaderMouseLeave(e){const t=Ts.storage.get(e.target.closest(".slick-header-column"),"column");t&&this.triggerEvent(this.onHeaderMouseLeave,{column:t,grid:this},e)}handleHeaderMouseOut(e){const t=Ts.storage.get(e.target.closest(".slick-header-column"),"column");t&&this.triggerEvent(this.onHeaderMouseOut,{column:t,grid:this},e)}handleHeaderRowMouseEnter(e){const t=Ts.storage.get(e.target.closest(".slick-headerrow-column"),"column");t&&this.triggerEvent(this.onHeaderRowMouseEnter,{column:t,grid:this},e)}handleHeaderRowMouseOver(e){const t=Ts.storage.get(e.target.closest(".slick-headerrow-column"),"column");t&&this.triggerEvent(this.onHeaderRowMouseOver,{column:t,grid:this},e)}handleHeaderRowMouseLeave(e){const t=Ts.storage.get(e.target.closest(".slick-headerrow-column"),"column");t&&this.triggerEvent(this.onHeaderRowMouseLeave,{column:t,grid:this},e)}handleHeaderRowMouseOut(e){const t=Ts.storage.get(e.target.closest(".slick-headerrow-column"),"column");t&&this.triggerEvent(this.onHeaderRowMouseOut,{column:t,grid:this},e)}handleHeaderContextMenu(e){const t=e.target.closest(".slick-header-column"),i=t&&Ts.storage.get(t,"column");this.triggerEvent(this.onHeaderContextMenu,{column:i},e)}handleHeaderClick(e){if(!this.columnResizeDragging){const t=e.target.closest(".slick-header-column"),i=t&&Ts.storage.get(t,"column");i&&this.triggerEvent(this.onHeaderClick,{column:i},e)}}handlePreHeaderContextMenu(e){this.triggerEvent(this.onPreHeaderContextMenu,{node:e.target},e)}handlePreHeaderClick(e){this.columnResizeDragging||this.triggerEvent(this.onPreHeaderClick,{node:e.target},e)}handleFooterContextMenu(e){const t=e.target.closest(".slick-footerrow-column"),i=t&&Ts.storage.get(t,"column");this.triggerEvent(this.onFooterContextMenu,{column:i},e)}handleFooterClick(e){const t=e.target.closest(".slick-footerrow-column"),i=t&&Ts.storage.get(t,"column");this.triggerEvent(this.onFooterClick,{column:i},e)}handleCellMouseOver(e){this.triggerEvent(this.onMouseEnter,{},e)}handleCellMouseOut(e){this.triggerEvent(this.onMouseLeave,{},e)}cellExists(e,t){return!(e<0||e>=this.getDataLength()||t<0||t>=this.columns.length)}getCellFromPoint(e,t){let i=this.getRowFromPosition(t),s=0,n=0;for(let t=0;t<this.columns.length&&n<=e;t++)this.columns[t]&&(n+=this.columns[t].width,s++);return s-=1,i<-1&&(i=-1),{row:i,cell:s}}getCellFromNode(e){const t=/l\d+/.exec(e.className);if(!t)throw new Error(`SlickGrid getCellFromNode: cannot get cell - ${e.className}`);return parseInt(t[0].substr(1,t[0].length-1),10)}getRowFromNode(e){for(const t in this.rowsCache)if(this.rowsCache)for(const i in this.rowsCache[t].rowNode)if(this.rowsCache[t].rowNode?.[+i]===e)return t?parseInt(t,10):0;return null}getFrozenRowOffset(e){let t=0;return t=this.hasFrozenRows?this._options.frozenBottom?e>=this.actualFrozenRow?this.h<this.viewportTopH?this.actualFrozenRow*this._options.rowHeight:this.h:0:e>=this.actualFrozenRow?this.frozenRowsHeight:0:0,t}getCellFromEvent(e){const t=e instanceof bs?e.getNativeEvent():e;if(!t)return null;const i=t.touches?t.touches[0]:t,s=t.target.closest(".slick-cell");if(!s)return null;let n=this.getRowFromNode(s.parentNode);if(this.hasFrozenRows){let e=0;const t=le(Ts.parents(s,".grid-canvas")[0]);Ts.parents(s,".grid-canvas-bottom").length&&(e=this._options.frozenBottom?Ts.height(this._canvasTopL):this.frozenRowsHeight);const r=i.clientX-t.left,o=i.clientY-t.top+e+document.documentElement.scrollTop;n=this.getCellFromPoint(r,o).row}const r=this.getCellFromNode(s);return Ne(n)&&Ne(r)?{row:n,cell:r}:null}getCellNodeBox(e,t){if(!this.cellExists(e,t))return null;const i=this.getFrozenRowOffset(e),s=this.getRowTop(e)-i,n=s+this._options.rowHeight-1;let r=0;for(let e=0;e<t;e++)this.columns[e]&&!this.columns[e].hidden&&(r+=this.columns[e].width||0,this._options.frozenColumn===e&&(r=0));return{top:s,left:r,bottom:n,right:r+(this.columns[t]?.width||0)}}resetActiveCell(){this.setActiveCellInternal(null,!1)}focus(){this.setFocus()}setFocus(){-1===this.tabbingDirection?this._focusSink.focus():this._focusSink2.focus()}scrollCellIntoView(e,t,i){if(this.scrollRowIntoView(e,i),t<=this._options.frozenColumn)return;const s=this.getColspan(e,t);this.internalScrollColumnIntoView(this.columnPosLeft[t],this.columnPosRight[t+(s>1?s-1:0)])}internalScrollColumnIntoView(e,t){const i=this.scrollLeft+Ts.width(this._viewportScrollContainerX)-(this.viewportHasVScroll&&this.scrollbarDimensions?.width||0);e<this.scrollLeft?(this._viewportScrollContainerX.scrollLeft=e,this.handleScroll(),this.render()):t>i&&(this._viewportScrollContainerX.scrollLeft=Math.min(e,t-this._viewportScrollContainerX.clientWidth),this.handleScroll(),this.render())}scrollColumnIntoView(e){this.internalScrollColumnIntoView(this.columnPosLeft[e],this.columnPosRight[e])}setActiveCellInternal(e,t,i,s,n){if(Me(this.activeCellNode)&&(this.makeActiveCellNormal(),this.activeCellNode.classList.remove("active"),this.rowsCache[this.activeRow]?.rowNode?.forEach((e=>e.classList.remove("active")))),this.activeCellNode=e,Me(this.activeCellNode)){const e=le(this.activeCellNode);let s=Math.floor(le(Ts.parents(this.activeCellNode,".grid-canvas")[0]).top);const r=Ts.parents(this.activeCellNode,".grid-canvas-bottom").length;this.hasFrozenRows&&r&&(s-=this._options.frozenBottom?Ts.height(this._canvasTopL):this.frozenRowsHeight);const o=this.getCellFromPoint(e.left,Math.ceil(e.top)-s);this.activeRow=o.row,this.activeCell=this.activePosX=this.activeCell=this.activePosX=this.getCellFromNode(this.activeCellNode),!Me(t)&&this._options.autoEditNewRow&&(t=this.activeRow===this.getDataLength()||this._options.autoEdit),this._options.showCellSelection&&(this.activeCellNode.classList.add("active"),this.rowsCache[this.activeRow]?.rowNode?.forEach((e=>e.classList.add("active")))),this._options.editable&&t&&this.isCellPotentiallyEditable(this.activeRow,this.activeCell)&&(this._options.asyncEditorLoading?(window.clearTimeout(this.h_editorLoader),this.h_editorLoader=window.setTimeout((()=>{this.makeActiveCellEditable(void 0,i,n)}),this._options.asyncEditorLoadDelay)):this.makeActiveCellEditable(void 0,i,n))}else this.activeRow=this.activeCell=null;s||this.triggerEvent(this.onActiveCellChanged,this.getActiveCell())}clearTextSelection(){if(document.selection?.empty)try{document.selection.empty()}catch(e){}else if(window.getSelection){const e=window.getSelection();e?.removeAllRanges&&e.removeAllRanges()}}isCellPotentiallyEditable(e,t){const i=this.getDataLength();return!(e<i&&!this.getDataItem(e)||this.columns[t].cannotTriggerInsert&&e>=i||!this.columns[t]||this.columns[t].hidden||!this.getEditor(e,t))}makeActiveCellNormal(e=!1){if(this.currentEditor){if(this.triggerEvent(this.onBeforeCellEditorDestroy,{editor:this.currentEditor}),this.currentEditor.destroy(),this.currentEditor=null,this.activeCellNode){const t=this.getDataItem(this.activeRow);if(this.activeCellNode.classList.remove("editable"),this.activeCellNode.classList.remove("invalid"),t){const e=this.columns[this.activeCell],i=this.getFormatter(this.activeRow,e)(this.activeRow,this.activeCell,this.getDataItemValueForColumn(t,e),e,t,this);this.applyFormatResultToCellNode(i,this.activeCellNode),this.invalidatePostProcessingResults(this.activeRow)}e&&this.setFocus()}navigator.userAgent.toLowerCase().match(/msie/)&&this.clearTextSelection(),this.getEditorLock()?.deactivate(this.editController)}}editActiveCell(e,t,i){this.makeActiveCellEditable(e,t,i)}makeActiveCellEditable(e,t,i){if(!this.activeCellNode)return;if(!this._options.editable)throw new Error("SlickGrid makeActiveCellEditable : should never get called when grid options.editable is false");if(window.clearTimeout(this.h_editorLoader),!this.isCellPotentiallyEditable(this.activeRow,this.activeCell))return;const s=this.columns[this.activeCell],n=this.getDataItem(this.activeRow);if(!1===this.triggerEvent(this.onBeforeEditCell,{row:this.activeRow,cell:this.activeCell,item:n,column:s,target:"grid"}).getReturnValue())return void this.setFocus();this.getEditorLock()?.activate(this.editController),this.activeCellNode.classList.add("editable");const r=e||this.getEditor(this.activeRow,this.activeCell);if("function"==typeof r){e||r.suppressClearOnEdit||re(this.activeCellNode);let o=this.data?.getItemMetadata?.(this.activeRow);o=o?.columns;const a=o&&(o[s.id]||o[this.activeCell]),l={grid:this,gridPosition:this.absBox(this._container),position:this.absBox(this.activeCellNode),container:this.activeCellNode,column:s,columnMetaData:a,item:n||{},event:i,commitChanges:this.commitEditAndSetFocus.bind(this),cancelChanges:this.cancelEditAndSetFocus.bind(this)};this.currentEditor=new r(l),n&&this.currentEditor&&(this.currentEditor.loadValue(n),t&&"function"==typeof this.currentEditor?.preClick&&this.currentEditor.preClick()),this.serializedEditorValue=this.currentEditor?.serializeValue(),this.currentEditor?.position&&this.handleActiveCellPositionChange()}}commitEditAndSetFocus(e=!0){this.getEditorLock()?.commitCurrentEdit()&&(this.setFocus(),this._options.autoEdit&&!this._options.autoCommitEdit&&e&&this.navigateDown())}cancelEditAndSetFocus(){this.getEditorLock()?.cancelCurrentEdit()&&this.setFocus()}absBox(e){const t={top:e.offsetTop,left:e.offsetLeft,bottom:0,right:0,width:e.offsetWidth,height:e.offsetWidth,visible:!0};t.bottom=t.top+t.height,t.right=t.left+t.width;let i=e.offsetParent;for(;(e=e.parentNode)!==document.body&&e&&e.parentNode;){const s=getComputedStyle(e);t.visible&&e.scrollHeight!==e.offsetHeight&&"visible"!==s.overflowY&&(t.visible=t.bottom>e.scrollTop&&t.top<e.scrollTop+e.clientHeight),t.visible&&e.scrollWidth!==e.offsetWidth&&"visible"!==s.overflowX&&(t.visible=t.right>e.scrollLeft&&t.left<e.scrollLeft+e.clientWidth),t.left-=e.scrollLeft,t.top-=e.scrollTop,e===i&&(t.left+=e.offsetLeft,t.top+=e.offsetTop,i=e.offsetParent),t.bottom=t.top+t.height,t.right=t.left+t.width}return t}getActiveCellPosition(){return this.absBox(this.activeCellNode)}getGridPosition(){return this.absBox(this._container)}handleActiveCellPositionChange(){if(this.activeCellNode&&(this.triggerEvent(this.onActiveCellPositionChanged,{}),this.currentEditor)){const e=this.getActiveCellPosition();this.currentEditor.show&&this.currentEditor.hide&&(e.visible?this.currentEditor.show():this.currentEditor.hide()),this.currentEditor.position&&this.currentEditor.position(e)}}getCellEditor(){return this.currentEditor}getActiveCell(){return this.activeCellNode?{row:this.activeRow,cell:this.activeCell}:null}getActiveCellNode(){return this.activeCellNode}getTextSelection(){let e=null;if(window.getSelection){const t=window.getSelection();(t?.rangeCount||0)>0&&(e=t.getRangeAt(0))}return e}setTextSelection(e){if(window.getSelection&&e){const t=window.getSelection();t&&(t.removeAllRanges(),t.addRange(e))}}scrollRowIntoView(e,t){if(!this.hasFrozenRows||!this._options.frozenBottom&&e>this.actualFrozenRow-1||this._options.frozenBottom&&e<this.actualFrozenRow-1){const i=Ts.height(this._viewportScrollContainerY),s=this.hasFrozenRows&&!this._options.frozenBottom?e-this._options.frozenRow:e,n=s*this._options.rowHeight,r=(s+1)*this._options.rowHeight-i+(this.viewportHasHScroll&&this.scrollbarDimensions?.height||0);(s+1)*this._options.rowHeight>this.scrollTop+i+this.offset?(this.scrollTo(t?n:r),this.render()):s*this._options.rowHeight<this.scrollTop+this.offset&&(this.scrollTo(t?r:n),this.render())}}scrollRowToTop(e){this.scrollTo(e*this._options.rowHeight),this.render()}scrollPage(e){const t=e*this.numVisibleRows,i=this.scrollTop+this._options.rowHeight-1;if(this.scrollTo((this.getRowFromPosition(i)+t)*this._options.rowHeight),this.render(),this._options.enableCellNavigation&&Me(this.activeRow)){let e=this.activeRow+t;const i=this.getDataLengthIncludingAddNew();e>=i&&(e=i-1),e<0&&(e=0);let s=0,n=null;const r=this.activePosX;for(;s<=this.activePosX;)this.canCellBeActive(e,s)&&(n=s),s+=this.getColspan(e,s);null!==n?(this.setActiveCellInternal(this.getCellNode(e,n)),this.activePosX=r):this.resetActiveCell()}}navigatePageDown(){this.scrollPage(1)}navigatePageUp(){this.scrollPage(-1)}navigateTop(){this.navigateToRow(0)}navigateBottom(){return this.navigateToRow(this.getDataLength()-1)}navigateToRow(e){const t=this.getDataLength();if(!t)return!0;if(e<0?e=0:e>=t&&(e=t-1),this.scrollCellIntoView(e,0,!0),this._options.enableCellNavigation&&Me(this.activeRow)){let t=0,i=null;const s=this.activePosX;for(;t<=this.activePosX;)this.canCellBeActive(e,t)&&(i=t),t+=this.getColspan(e,t);null!==i?(this.setActiveCellInternal(this.getCellNode(e,i)),this.activePosX=s):this.resetActiveCell()}return!0}getColspan(e,t){const i=this.data?.getItemMetadata?.(e);if(!i||!i.columns)return 1;const s=i.columns[this.columns[t].id]||i.columns[t];let n=s?.colspan;return n="*"===n?this.columns.length-t:n||1,n}findFirstFocusableCell(e){let t=0;for(;t<this.columns.length;){if(this.canCellBeActive(e,t))return t;t+=this.getColspan(e,t)}return null}findLastFocusableCell(e){let t=0,i=null;for(;t<this.columns.length;)this.canCellBeActive(e,t)&&(i=t),t+=this.getColspan(e,t);return i}gotoRight(e,t,i){if(t>=this.columns.length)return null;do{t+=this.getColspan(e,t)}while(t<this.columns.length&&!this.canCellBeActive(e,t));return t<this.columns.length?{row:e,cell:t,posX:t}:null}gotoLeft(e,t,i){if(t<=0)return null;const s=this.findFirstFocusableCell(e);if(null===s||s>=t)return null;let n,r={row:e,cell:s,posX:s},o=!0;for(;o;){if(n=this.gotoRight(r.row,r.cell,r.posX),!n)return o=!1,null;if(n.cell>=t)return o=!1,r;r=n}}gotoDown(e,t,i){let s;const n=this.getDataLengthIncludingAddNew();let r=!0;for(;r;){if(++e>=n)return r=!1,null;for(s=t=0;t<=i;)s=t,t+=this.getColspan(e,t);if(this.canCellBeActive(e,s))return r=!1,{row:e,cell:s,posX:i}}}gotoUp(e,t,i){let s,n=!0;for(;n;){if(--e<0)return n=!1,null;for(s=t=0;t<=i;)s=t,t+=this.getColspan(e,t);if(this.canCellBeActive(e,s))return n=!1,{row:e,cell:s,posX:i}}}gotoNext(e,t,i){if(!Ne(e)&&!Ne(t)&&(e=t=i=0,this.canCellBeActive(e,t)))return{row:e,cell:t,posX:t};const s=this.gotoRight(e,t,i);if(s)return s;let n=null;const r=this.getDataLengthIncludingAddNew();for(e===r-1&&e--;++e<r;)if(n=this.findFirstFocusableCell(e),null!==n)return{row:e,cell:n,posX:n};return null}gotoPrev(e,t,i){if(!Ne(e)&&!Ne(t)&&(e=this.getDataLengthIncludingAddNew()-1,t=i=this.columns.length-1,this.canCellBeActive(e,t)))return{row:e,cell:t,posX:t};let s,n;for(;!s&&(s=this.gotoLeft(e,t,i),!s);){if(--e<0)return null;t=0,n=this.findLastFocusableCell(e),null!==n&&(s={row:e,cell:n,posX:n})}return s}gotoRowStart(e,t,i){const s=this.findFirstFocusableCell(e);return null===s?null:{row:e,cell:s,posX:s}}gotoRowEnd(e,t,i){const s=this.findLastFocusableCell(e);return null===s?null:{row:e,cell:s,posX:s}}navigateRight(){return this.navigate("right")}navigateLeft(){return this.navigate("left")}navigateDown(){return this.navigate("down")}navigateUp(){return this.navigate("up")}navigateNext(){return this.navigate("next")}navigatePrev(){return this.navigate("prev")}navigateRowStart(){return this.navigate("home")}navigateRowEnd(){return this.navigate("end")}navigate(e){if(!this._options.enableCellNavigation||!this.activeCellNode&&"prev"!==e&&"next"!==e)return!1;if(!this.getEditorLock()?.commitCurrentEdit())return!0;this.setFocus(),this.tabbingDirection={up:-1,down:1,left:-1,right:1,prev:-1,next:1,home:-1,end:1}[e];const t={up:this.gotoUp,down:this.gotoDown,left:this.gotoLeft,right:this.gotoRight,prev:this.gotoPrev,next:this.gotoNext,home:this.gotoRowStart,end:this.gotoRowEnd}[e].call(this,this.activeRow,this.activeCell,this.activePosX);if(t){const e=this.getDataLength();if(this.hasFrozenRows&&this._options.frozenBottom&&t.row===e)return;const i=t.row===e;return(!this._options.frozenBottom&&t.row>=this.actualFrozenRow||this._options.frozenBottom&&t.row<this.actualFrozenRow)&&this.scrollCellIntoView(t.row,t.cell,!i&&this._options.emulatePagingWhenScrolling),this.setActiveCellInternal(this.getCellNode(t.row,t.cell)),this.activePosX=t.posX,!0}return this.setActiveCellInternal(this.getCellNode(this.activeRow,this.activeCell)),!1}getCellNode(e,t){if(this.rowsCache[e]){this.ensureCellNodesInRowsCache(e);try{return this.rowsCache[e].cellNodesByColumnIdx.length>t?this.rowsCache[e].cellNodesByColumnIdx[t]:null}catch(i){return this.rowsCache[e].cellNodesByColumnIdx[t]}}return null}setActiveCell(e,t,i,s,n){!this.initialized||!this._options.enableCellNavigation||e>this.getDataLength()||e<0||t>=this.columns.length||t<0||(this.scrollCellIntoView(e,t,!1),this.setActiveCellInternal(this.getCellNode(e,t),i,s,n))}setActiveRow(e,t,i){t??=0,!this.initialized||e>this.getDataLength()||e<0||t>=this.columns.length||t<0||(this.activeRow=e,i||this.scrollCellIntoView(e,t,!1))}canCellBeActive(e,t){if(!this._options.enableCellNavigation||e>=this.getDataLengthIncludingAddNew()||e<0||t>=this.columns.length||t<0)return!1;if(!this.columns[t]||this.columns[t].hidden)return!1;const i=this.data?.getItemMetadata?.(e);if(void 0!==i?.focusable)return!!i.focusable;const s=i?.columns;return void 0!==s?.[this.columns[t].id]?.focusable?!!s[this.columns[t].id].focusable:void 0!==s?.[t]?.focusable?!!s[t].focusable:!!this.columns[t].focusable}canCellBeSelected(e,t){if(e>=this.getDataLength()||e<0||t>=this.columns.length||t<0)return!1;if(!this.columns[t]||this.columns[t].hidden)return!1;const i=this.data?.getItemMetadata?.(e);if(void 0!==i?.selectable)return!!i.selectable;const s=i?.columns&&(i.columns[this.columns[t].id]||i.columns[t]);return void 0!==s?.selectable?!!s.selectable:!!this.columns[t].selectable}gotoCell(e,t,i,s){if(!this.initialized||!this.canCellBeActive(e,t)||!this.getEditorLock()?.commitCurrentEdit())return;this.scrollCellIntoView(e,t,!1);const n=this.getCellNode(e,t),r=this.columns[t],o=!!(this._options.editable&&r?.editorClass&&this._options.suppressActiveCellChangeOnEdit);this.setActiveCellInternal(n,i||e===this.getDataLength()||this._options.autoEdit,null,o,s),this.currentEditor||this.setFocus()}commitCurrentEdit(){const e=this,t=e.getDataItem(e.activeRow),i=e.columns[e.activeCell];if(e.currentEditor){if(e.currentEditor.isValueChanged()){const s=e.currentEditor.validate();if(s.valid){const s=e.activeRow,n=e.activeCell,r=e.currentEditor,o=e.currentEditor.serializeValue(),a=e.serializedEditorValue;if(e.activeRow<e.getDataLength()){const l={row:s,cell:n,editor:r,serializedValue:o,prevSerializedValue:a,execute:()=>{r.applyValue(t,o),e.updateRow(s),e.triggerEvent(e.onCellChange,{command:"execute",row:s,cell:n,item:t,column:i})},undo:()=>{r.applyValue(t,a),e.updateRow(s),e.triggerEvent(e.onCellChange,{command:"undo",row:s,cell:n,item:t,column:i})}};e._options.editCommandHandler?(e.makeActiveCellNormal(!0),e._options.editCommandHandler(t,i,l)):(l.execute(),e.makeActiveCellNormal(!0))}else{const t={};e.currentEditor.applyValue(t,e.currentEditor.serializeValue()),e.makeActiveCellNormal(!0),e.triggerEvent(e.onAddNewRow,{item:t,column:i})}return!e.getEditorLock()?.isActive()}return e.activeCellNode&&(e.activeCellNode.classList.remove("invalid"),Ts.width(e.activeCellNode),e.activeCellNode.classList.add("invalid")),e.triggerEvent(e.onValidationError,{editor:e.currentEditor,cellNode:e.activeCellNode,validationResults:s,row:e.activeRow,cell:e.activeCell,column:i}),e.currentEditor.focus(),!1}e.makeActiveCellNormal(!0)}return!0}cancelCurrentEdit(){return this.makeActiveCellNormal(),!0}rowsToRanges(e){const t=[],i=this.columns.length-1;for(let s=0;s<e.length;s++)t.push(new ws(e[s],0,e[s],i));return t}getSelectedRows(){if(!this.selectionModel)throw new Error("SlickGrid Selection model is not set");return this.selectedRows.slice(0)}setSelectedRows(e,t){if(!this.selectionModel)throw new Error("SlickGrid Selection model is not set");const i=this.getEditorLock();"function"!=typeof i?.isActive||i.isActive()||this.selectionModel.setSelectedRanges(this.rowsToRanges(e),t||"SlickGrid.setSelectedRows")}sanitizeHtmlString(e){return"function"==typeof this._options?.sanitizer&&e&&"string"==typeof e?this._options.sanitizer(e):e}}class Fr{constructor(e){this.pluginName="AutoTooltips",this._defaults={enableForCells:!0,enableForHeaderCells:!1,maxToolTipLength:void 0,replaceExisting:!0},this._eventHandler=new Cs,this._addonOptions=e}get addonOptions(){return this._addonOptions}get eventHandler(){return this._eventHandler}init(e){this._addonOptions={...this._defaults,...this.addonOptions},this._grid=e,this._addonOptions.enableForCells&&this._eventHandler.subscribe(this._grid.onMouseEnter,this.handleMouseEnter.bind(this)),this._addonOptions.enableForHeaderCells&&this._eventHandler.subscribe(this._grid.onHeaderMouseEnter,this.handleHeaderMouseEnter.bind(this))}destroy(){this.dispose()}dispose(){this._eventHandler?.unsubscribeAll()}handleMouseEnter(e){const t=this._grid.getCellFromEvent(e);if(t){let e,i=this._grid.getCellNode(t.row,t.cell);this._addonOptions&&i&&(!i.title||this._addonOptions?.replaceExisting)&&(i.clientWidth<i.scrollWidth?(e=i.textContent?.trim()??"",this._addonOptions?.maxToolTipLength&&e.length>this._addonOptions?.maxToolTipLength&&(e=e.substring(0,this._addonOptions.maxToolTipLength-3)+"...")):e="",i.title=e),i=null}}handleHeaderMouseEnter(e,t){const i=t.column;let s;const n=e.target;if(n&&(s=n.closest(".slick-header-column"),s&&!i?.toolTip)){const e=n.clientWidth<s.clientWidth?i?.name??"":"";s.title=st(oe(e,"innerHTML"))}s=null}}class Br{constructor(){this.pluginName="CellExcelCopyManager",this._eventHandler=new Cs,this._bindingEventService=new Wt}get addonOptions(){return this._addonOptions}get eventHandler(){return this._eventHandler}get commandQueue(){return this._commandQueue}get gridOptions(){return this._grid?.getOptions()??{}}get undoRedoBuffer(){return this._undoRedoBuffer}init(e,t){this._grid=e,this.createUndoRedoBuffer(),this._cellSelectionModel=new qr,this._grid.setSelectionModel(this._cellSelectionModel),this._bindingEventService.bind(document.body,"keydown",this.handleBodyKeyDown.bind(this)),this._addonOptions={...this.getDefaultOptions(),...t},this._cellExternalCopyManagerPlugin=new $r,this._cellExternalCopyManagerPlugin.init(this._grid,this._addonOptions),this._eventHandler.subscribe(this._cellExternalCopyManagerPlugin.onCopyCells,((e,t)=>{this._addonOptions&&"function"==typeof this._addonOptions.onCopyCells&&this._addonOptions.onCopyCells(e,t)})),this._eventHandler.subscribe(this._cellExternalCopyManagerPlugin.onCopyCancelled,((e,t)=>{this._addonOptions&&"function"==typeof this._addonOptions.onCopyCancelled&&this._addonOptions.onCopyCancelled(e,t)})),this._eventHandler.subscribe(this._cellExternalCopyManagerPlugin.onPasteCells,((e,t)=>{this._addonOptions&&"function"==typeof this._addonOptions.onPasteCells&&this._addonOptions.onPasteCells(e,t)}))}dispose(){this._eventHandler.unsubscribeAll(),this._bindingEventService.unbindAll(),this._cellSelectionModel?.dispose(),this._cellExternalCopyManagerPlugin?.dispose()}createUndoRedoBuffer(){let e=0;this._commandQueue=[],this._undoRedoBuffer={queueAndExecuteCommand:t=>{this._commandQueue[e]=t,e++,t.execute()},undo:()=>{if(0===e)return;e--;const t=this._commandQueue[e];t&&Os.cancelCurrentEdit()&&t.undo()},redo:()=>{if(e>=this._commandQueue.length)return;const t=this._commandQueue[e];e++,t&&Os.cancelCurrentEdit()&&t.execute()}}}getDefaultOptions(){let e=0;return{clipboardCommandHandler:e=>{this._undoRedoBuffer.queueAndExecuteCommand.call(this._undoRedoBuffer,e)},dataItemColumnValueExtractor:(e,t,i=0,s=0)=>{const n=this._grid.getActiveCell(),r=this._grid.getCellEditor()&&n?.row===i&&n?.cell===s,o=this.addonOptions?.copyActiveEditorCell||!1;if(!this.gridOptions.editable||!t.editor||!r||o){const n=void 0!==t.exportWithFormatter?t.exportWithFormatter:this.gridOptions.textExportOptions?.exportWithFormatter;if(t.formatter&&n){const n=t.formatter(i,s,e[t.field],t,e,this._grid),r=He(n)?n:n.html||n.text;return t.sanitizeDataExport||this.gridOptions.textExportOptions?.sanitizeDataExport?st((r instanceof HTMLElement?r.innerHTML:r)??""):n}}return null},readOnlyMode:!1,includeHeaderWhenCopying:!1,newRowCreator:t=>{for(let i=0;i<t;i++)this._grid.getData().addItem({[this.gridOptions.datasetIdPropertyName||"id"]:"newRow_"+e++})},replaceNewlinesWith:!1,removeDoubleQuotesOnPaste:!1}}handleBodyKeyDown(e){"Z"===e.key&&(e.ctrlKey||e.metaKey)&&(e.shiftKey?this._undoRedoBuffer.redo():this._undoRedoBuffer.undo())}}class Hr{init(e){this._grid=e,e.hasDataView()&&(this._dataView=e.getData())}getDataItem(e){return this._dataView?this._dataView.getItem(e):this._grid.getDataItem(e)}getDataItems(){return this._dataView?this._dataView.getItems():this._grid.getData()}getDataLength(){return this._dataView?this._dataView.getItemCount():this._grid.getDataLength()}setDataItems(e){this._dataView?this._dataView.setItems(e):this._grid.setData(e)}}const zr=()=>{};class $r{constructor(){this.pluginName="CellExternalCopyManager",this._bodyElement=document.body,this._copiedCellStyle="copied",this._copiedCellStyleLayerKey="copy-manager",this._copiedRanges=null,this._dataWrapper=new Hr,this.onCopyCells=new ys("onCopyCells"),this.onCopyCancelled=new ys("onCopyCancelled"),this.onPasteCells=new ys("onPasteCells"),this.onBeforePasteCell=new ys("onBeforePasteCell"),this._eventHandler=new Cs}get addonOptions(){return this._addonOptions}get eventHandler(){return this._eventHandler}init(e,t){this._grid=e,this._dataWrapper.init(e),this._addonOptions={...this._addonOptions,...t},this._copiedCellStyleLayerKey=this._addonOptions.copiedCellStyleLayerKey||"copy-manager",this._copiedCellStyle=this._addonOptions.copiedCellStyle||"copied",this._bodyElement=this._addonOptions.bodyElement||document.body,this._onCopyInit=this._addonOptions.onCopyInit||void 0,this._onCopySuccess=this._addonOptions.onCopySuccess||void 0;const i=e.getPubSubService();i&&Ts.addSlickEventPubSubWhenDefined(i,this),this._eventHandler.subscribe(this._grid.onKeyDown,this.handleKeyDown.bind(this));const s=e.getSelectionModel();if(!s)throw new Error("Selection model is mandatory for this plugin. Please set a selection model on the grid before adding this plugin: grid.setSelectionModel(new SlickCellSelectionModel())");this._eventHandler.subscribe(s.onSelectedRangesChanged,(()=>{this._grid.getEditorLock().isActive()||this._grid.focus()})),e&&"function"==typeof this._addonOptions?.onBeforePasteCell&&this._eventHandler.subscribe(this.onBeforePasteCell,((t,i)=>{const s=e.getColumns()[i.cell],n={row:i.row,cell:i.cell,dataView:e.getData(),grid:e,columnDef:s,dataContext:e.getDataItem(i.row)};return this._addonOptions.onBeforePasteCell?.(t,n)}))}dispose(){this._eventHandler.unsubscribeAll()}clearCopySelection(){this._grid.removeCellCssStyles(this._copiedCellStyleLayerKey)}getHeaderValueForColumn(e){if("function"==typeof this._addonOptions.headerColumnValueExtractor){const t=oe(this._addonOptions.headerColumnValueExtractor(e),"innerHTML");if(t)return st(t)}return oe(e.name||"","innerHTML")}getDataItemValueForColumn(e,t,i,s,n){if("function"==typeof this._addonOptions.dataItemColumnValueExtractor){const n=this._addonOptions.dataItemColumnValueExtractor(e,t,i,s);if(n)return n instanceof HTMLElement?st(n.innerHTML):n}let r="";if(t)if(t.editorClass){const i=document.createElement("p"),s=new t.editorClass({container:i,column:t,event:n,position:{top:0,left:0},gridPosition:{top:0,left:0},grid:this._grid,cancelChanges:zr,commitChanges:zr});s.loadValue(e),r=s.serializeValue(),s.destroy(),i.remove()}else r=e[t.field||""];return r}setDataItemValueForColumn(e,t,i){if(!t?.denyPaste){if(this._addonOptions.dataItemColumnValueSetter){const s=this._addonOptions.dataItemColumnValueSetter(e,t,i);if(!0!==s)return s}if(t.editorClass){const s=document.createElement("div"),n=new t.editorClass({container:s,column:t,event:null,position:{top:0,left:0},gridPosition:{top:0,left:0},grid:this._grid,cancelChanges:zr,commitChanges:zr});n.loadValue(e);const r=n.validate(void 0,i);if(!r.valid){const e=this._grid.getActiveCell();this._grid.onValidationError.notify({editor:n,cellNode:this._grid.getActiveCellNode(),validationResults:r,row:e?.row,cell:e?.cell,column:t,grid:this._grid})}n.applyValue(e,i),n.destroy(),s.remove()}else e[t.field]=i}}setIncludeHeaderWhenCopying(e){this._addonOptions.includeHeaderWhenCopying=e}createTextBox(e){const t=ie("textarea",{value:e,style:{position:"absolute",left:"-1000px",top:`${document.body.scrollTop}px`}},this._bodyElement);return t.select(),t}decodeTabularData(e,t){const i=e.getColumns(),s=t.value.split(/[\n\f\r](?=(?:[^"]*"[^"]*")*[^"]*$)/);""===s[s.length-1]&&s.pop();let n=0;const r=[];this._bodyElement.removeChild(t);for(const e of s)e.startsWith('"')&&e.endsWith('"')?r[n++]=[e.replaceAll("\n",this._addonOptions.replaceNewlinesWith||"\n").replaceAll("\r","").replaceAll('"',this._addonOptions.removeDoubleQuotesOnPaste?"":'"')]:r[n++]=e.split("\t");const o=this._grid.getActiveCell(),a=this._grid.getSelectionModel()?.getSelectedRanges(),l=a?.length?a[0]:null;let h,c;if(l)h=l.fromRow,c=l.fromCell;else{if(!o)return;h=o.row,c=o.cell}let d=!1,u=r.length,p=r.length?r[0].length:0;1===r.length&&1===r[0].length&&l&&(d=!0,u=l.toRow-l.fromRow+1,p=l.toCell-l.fromCell+1);const m=this._dataWrapper.getDataLength()-h;if(m<u&&"function"==typeof this._addonOptions.newRowCreator){const e=u-m,t=this._dataWrapper.getDataLength();this._addonOptions.newRowCreator(e);const i=this._dataWrapper.getDataLength();i!==t+e&&console.warn(`[Slickgrid-Universal] The "newRowCreator" did not add the correct amount of rows, it should add "${e}" rows but it added "${i-t}" rows`),this._grid.render()}if(h+u>this._dataWrapper.getDataLength()&&"function"==typeof this._addonOptions.newRowCreator){const e=h+u-this._dataWrapper.getDataLength();this._addonOptions.newRowCreator(e)}const f={isClipboardCommand:!0,clippedRange:r,oldValues:[],cellExternalCopyManager:this,_options:this._addonOptions,setDataItemValueForColumn:this.setDataItemValueForColumn,markCopySelection:this.markCopySelection,oneCellToMultiple:d,activeRow:h,activeCell:c,destH:u,destW:p,maxDestY:this._dataWrapper.getDataLength(),maxDestX:this._grid.getColumns().length,h:0,w:0,execute:()=>{f.h=0;for(let e=0;e<f.destH;e++){f.oldValues[e]=[],f.w=0,f.h++;let t=0;for(let s=0;s<f.destW;s++){const n=h+e,o=c+s,a=i[o];if(a.hidden)f.destW++,t++;else if(f.w++,n<f.maxDestY&&o<f.maxDestX){const i=this._dataWrapper.getDataItem(n);if(!1===this._grid.triggerEvent(this.onBeforePasteCell,{row:n,cell:o,dt:i,column:a,target:"grid"}).getReturnValue())continue;f.oldValues[e][s-t]=i[a.field],d?this.setDataItemValueForColumn(i,a,r[0][0]):this.setDataItemValueForColumn(i,a,r[e]?r[e][s-t]:""),this._grid.updateCell(n,o),this._grid.onCellChange.notify({row:n,cell:o,item:i,grid:this._grid,column:{}})}}}const e=new ws(h,c,h+f.h-1,c+f.w-1);this.markCopySelection([e]),this._grid.getSelectionModel()?.setSelectedRanges([e]),this.onPasteCells.notify({ranges:[e]})},undo:()=>{for(let e=0;e<f.destH;e++)for(let t=0;t<f.destW;t++){const s=h+e,n=c+t;if(s<f.maxDestY&&n<f.maxDestX){const r=this._dataWrapper.getDataItem(s);d?this.setDataItemValueForColumn(r,i[n],f.oldValues[0][0]):this.setDataItemValueForColumn(r,i[n],f.oldValues[e][t]),this._grid.updateCell(s,n),this._grid.onCellChange.notify({row:s,cell:n,item:r,grid:this._grid,column:{}})}}const e=new ws(h,c,h+f.h-1,c+f.w-1);this.markCopySelection([e]),this._grid.getSelectionModel()?.setSelectedRanges([e]),this.onPasteCells.notify({ranges:[e]}),"function"==typeof this._addonOptions.onPasteCells&&this._addonOptions.onPasteCells(new bs,{ranges:[e]})}};this._addonOptions.clipboardCommandHandler?this._addonOptions.clipboardCommandHandler(f):f.execute()}handleKeyDown(e){let t;if(!this._grid.getEditorLock().isActive()||this._grid.getOptions().autoEdit){if("Escape"===e.key&&this._copiedRanges&&(e.preventDefault(),this.clearCopySelection(),this.onCopyCancelled.notify({ranges:this._copiedRanges}),"function"==typeof this._addonOptions.onCopyCancelled&&this._addonOptions.onCopyCancelled(e,{ranges:this._copiedRanges}),this._copiedRanges=null),("c"===e.key||"Insert"===e.key)&&(e.ctrlKey||e.metaKey)&&!e.shiftKey&&("function"==typeof this._onCopyInit&&this._onCopyInit.call(this),t=this._grid.getSelectionModel()?.getSelectedRanges()??[],0!==t.length)){this._copiedRanges=t,this.markCopySelection(t),this.onCopyCells.notify({ranges:t}),"function"==typeof this._addonOptions.onCopyCells&&this._addonOptions.onCopyCells(e,{ranges:t});const i=this._grid.getColumns();let s="";for(let n=0;n<t.length;n++){const r=t[n],o=[];for(let t=r.fromRow;t<r.toRow+1;t++){const s=[],n=this._dataWrapper.getDataItem(t);if(0===o.length&&this._addonOptions.includeHeaderWhenCopying){const e=[];for(let t=r.fromCell;t<r.toCell+1;t++)i[t]&&(i[t].name instanceof HTMLElement?st(i[t].name.innerHTML):i[t].name).length>0&&!i[t].hidden&&e.push(this.getHeaderValueForColumn(i[t]));o.push(e.join("\t"))}for(let o=r.fromCell;o<r.toCell+1;o++)i[o]&&(i[o].name instanceof HTMLElement?st(i[o].name.innerHTML):i[o].name).length>0&&!i[o].hidden&&s.push(this.getDataItemValueForColumn(n,i[o],t,o,e));o.push(s.join("\t"))}s+=o.join("\r\n")+"\r\n"}if(window.clipboardData)return window.clipboardData.setData("Text",s),!0;{const e=document.activeElement,i=this.createTextBox(s);if(i.focus(),window.setTimeout((()=>{this._bodyElement.removeChild(i),e?e.focus():console.log("No element to restore focus to after copy?")}),this.addonOptions?.clipboardPasteDelay??100),"function"==typeof this._onCopySuccess){const e=1===t.length?t[0].toRow+1-t[0].fromRow:t.length;this._onCopySuccess(e)}return!1}}if(!this._addonOptions.readOnlyMode&&("v"===e.key&&(e.ctrlKey||e.metaKey)&&!e.shiftKey||"Insert"===e.key&&e.shiftKey&&!e.ctrlKey)){const e=this.createTextBox("");return window.setTimeout((()=>this.decodeTabularData(this._grid,e)),this.addonOptions?.clipboardPasteDelay??100),!1}}}markCopySelection(e){this.clearCopySelection();const t=this._grid.getColumns(),i={};for(const s of e)for(let e=s.fromRow;e<=s.toRow;e++){i[e]={};for(let n=s.fromCell;n<=s.toCell&&n<t.length;n++)i[e][t[n].id]=this._copiedCellStyle}this._grid.setCellCssStyles(this._copiedCellStyleLayerKey,i),window.clearTimeout(this._clearCopyTI),this._clearCopyTI=window.setTimeout((()=>this.clearCopySelection()),this.addonOptions?.clearCopySelectionDelay||2e3)}}class Vr{constructor(e,t,i){this.extensionUtility=e,this.pubSubService=t,this.sharedService=i,this._addonOptions={},this._camelPluginName="",this._gridUid="",this._menuCssPrefix="",this._menuPluginCssPrefix="",this._bindEventService=new Wt,this._eventHandler=new Cs}get addonOptions(){return this._addonOptions}set addonOptions(e){this._addonOptions=e}get eventHandler(){return this._eventHandler}get grid(){return this.sharedService.slickGrid}get gridOptions(){return this.sharedService.gridOptions??{}}get gridUid(){return this._gridUid||(this.grid?.getUID()??"")}get gridUidSelector(){return this.gridUid?`.${this.gridUid}`:""}get menuCssClass(){return this._menuPluginCssPrefix||this._menuCssPrefix}get menuElement(){return this._menuElm||document.querySelector(`.${this.menuCssClass}${this.gridUidSelector}`)}dispose(){this._eventHandler?.unsubscribeAll(),this._bindEventService.unbindAll(),this.pubSubService.unsubscribeAll(),this._commandTitleElm?.remove(),this._optionTitleElm?.remove(),this.disposeAllMenus(),re(this._menuElm),this.menuElement?.remove(),this._menuElm?.remove()}disposeAllMenus(){this.disposeSubMenus(),this._bindEventService.unbindAll("parent-menu"),document.querySelectorAll(`.${this.menuCssClass}${this.gridUidSelector}`).forEach((e=>e.remove()))}disposeSubMenus(){this._bindEventService.unbindAll("sub-menu"),document.querySelectorAll(`.${this.menuCssClass}.slick-submenu${this.gridUidSelector}`).forEach((e=>e.remove()))}setOptions(e){this._addonOptions={...this._addonOptions,...e}}addSubMenuTitleWhenExists(e,t){if("divider"!==e&&e?.subMenuTitle){const i=document.createElement("div");i.className="slick-menu-title",i.textContent=e.subMenuTitle;const s=e.subMenuTitleCssClass;s&&i.classList.add(...se(s)),t.appendChild(i)}}populateCommandOrOptionItems(e,t,i,s,n,r,o){if(n&&s&&t)for(const a of s)this.populateSingleCommandOrOptionItem(e,t,i,a,n,r,o)}populateCommandOrOptionTitle(e,t,i,s){if(t){const n=s>0,r=this._menuElm?.querySelector(`.slick-${e}-header`)??ie("div",{className:`slick-${e}-header`}),o=`${e}Title`;n||(t?.[o]?(re(r),this[`_${e}TitleElm`]=ie("span",{className:"slick-menu-title",textContent:t[o]}),r.appendChild(this[`_${e}TitleElm`]),r.classList.add("with-title")):r.classList.add("no-title"),i.appendChild(r))}}populateSingleCommandOrOptionItem(e,t,i,s,n,r,o){let a=null;if(n&&s&&t){const t=n?.level||0,l="headerButtons"===this._camelPluginName?"":"-item",h=`${this._menuCssPrefix}${l}`;let c=!0,d=!0;if("object"==typeof s&&(c=this.extensionUtility.runOverrideFunctionWhenExists(s.itemVisibilityOverride,n),d=this.extensionUtility.runOverrideFunctionWhenExists(s.itemUsabilityOverride,n)),!c)return null;if("object"==typeof s&&s.itemUsabilityOverride&&(s.disabled=!d),a=ie("li",{className:h,role:"menuitem"}),"object"==typeof s&&Me(s[e])&&(a.dataset[e]=s?.[e]),i&&i.appendChild(a),"object"==typeof s&&s.divider||"divider"===s)return a.classList.add(`${h}-divider`),a;if(s.disabled&&a.classList.add(`${h}-disabled`),(s.hidden||s.showOnHover)&&a.classList.add(`${h}-hidden`),s.cssClass&&a.classList.add(...se(s.cssClass)),s.tooltip&&(a.title=s.tooltip),"headerButtons"!==this._camelPluginName){const e=ie("div",{className:`${this._menuCssPrefix}-icon`});a.appendChild(e),s.iconCssClass?e.classList.add(...se(s.iconCssClass)):s.commandItems||s.optionItems||(e.textContent="â¦");const t=ie("span",{className:`${this._menuCssPrefix}-content`,textContent:"object"==typeof s&&s.title||""},a);s.textCssClass&&t.classList.add(...se(s.textCssClass))}const u=t>0?"sub-menu":"parent-menu";if(this._bindEventService.bind(a,"click",(i=>r.call(this,i,e,s,t,n?.column)),void 0,u),"mouseover"===this._addonOptions?.subMenuOpenByEvent&&"function"==typeof o&&this._bindEventService.bind(a,"mouseover",(i=>o.call(this,i,e,s,t,n?.column)),void 0,u),s.commandItems||s.optionItems){const e=document.createElement("span");e.className="sub-item-chevron",this._addonOptions.subItemChevronClass?e.classList.add(...se(this._addonOptions.subItemChevronClass)):e.textContent="â®",a.classList.add("slick-submenu-item"),a.appendChild(e)}}return a}}class Wr extends Vr{constructor(e,t,i){super(e,t,i),this.extensionUtility=e,this.pubSubService=t,this.sharedService=i,this._currentCell=-1,this._currentRow=-1,this._lastMenuTypeClicked="",this._subMenuParentId=""}createParentMenu(e){this.menuElement?.remove(),this._menuElm=void 0;const t=this.grid.getCellFromEvent(e);if(t){this._currentCell=t.cell??0,this._currentRow=t.row??0;const i=this._addonOptions?.commandItems||[],s=this._addonOptions?.optionItems||[],n={cell:this._currentCell,row:this._currentRow,grid:this.grid};if(this.closeMenu(e,n),"function"==typeof e.stopPropagation&&(this.pubSubService.publish(`on${je(this._camelPluginName)}BeforeMenuShow`,n),"function"==typeof this.addonOptions?.onBeforeMenuShow&&!1===this.addonOptions.onBeforeMenuShow(e,n)))return;if(this._menuElm=this.createMenu(i,s),this._menuElm&&(this._menuElm.style.top=`${(e.pageY||0)+5}px`,this._menuElm.style.left=`${e.pageX}px`,this._menuElm.style.display="block",document.body.appendChild(this._menuElm)),this.pubSubService.publish(`on${je(this._camelPluginName)}AfterMenuShow`,n),"function"==typeof this.addonOptions?.onAfterMenuShow&&!1===this.addonOptions.onAfterMenuShow(e,n))return}return this._menuElm}createMenu(e,t,i=0,s){const n=this.grid.getColumns()[this._currentCell],r=this.grid.getDataItem(this._currentRow),o=s?.command||s?.option;let a=1===i&&o?String(o).replace(/\s/g,""):"";a&&(this._subMenuParentId=a),i>1&&(a=this._subMenuParentId);let l=!0,h=!0;if("contextMenu"===this._camelPluginName){if(l=this.checkIsColumnAllowed(this._addonOptions?.optionShownOverColumnIds??[],n.id),h=this.checkIsColumnAllowed(this._addonOptions?.commandShownOverColumnIds??[],n.id),!n||!(h&&e.length||l&&t.length))return void this.hideMenu()}else if(!n||!n.cellMenu||!e.length&&!t.length)return;const c=`${this.menuCssClass} slick-menu-level-${i} ${this.gridUid}`,d=document.body.querySelector(`.${this.menuCssClass}.slick-menu-level-${i}${this.gridUidSelector}`);if(d){if(d.dataset.subMenuParent===a)return d;this.disposeSubMenus()}const u=document.createElement("div");u.className=c,i>0&&(u.classList.add("slick-submenu"),this.gridOptions?.darkMode&&u.classList.add("slick-dark-mode"),a&&(u.dataset.subMenuParent=a));const p=isNaN(this.addonOptions.maxHeight)?this.addonOptions.maxHeight:`${this.addonOptions.maxHeight??0}px`,m=isNaN(this.addonOptions.maxWidth)?this.addonOptions.maxWidth:`${this.addonOptions.maxWidth??0}px`;p&&(u.style.maxHeight=p),m&&(u.style.maxWidth=m),this.addonOptions?.width&&(u.style.width=ue(this.addonOptions?.width));const f=ie("button",{ariaLabel:"Close",className:"close",type:"button",textContent:"Ã",dataset:{dismiss:this._menuCssPrefix}});if(!this.addonOptions.hideOptionSection&&l&&t.length>0){const e=ie("div",{className:`${this._menuCssPrefix}-option-list`,role:"menu"},u);this.populateCommandOrOptionTitle("option",this.addonOptions,e,i),!this.addonOptions.hideCloseButton&&i<1&&this.populateCommandOrOptionCloseBtn("option",f,e),s&&i>0&&this.addSubMenuTitleWhenExists(s,e),this.populateCommandOrOptionItems("option",this.addonOptions,e,t,{cell:this._currentCell,row:this._currentRow,column:n,dataContext:r,grid:this.grid,level:i},this.handleMenuItemCommandClick,this.handleMenuItemMouseOver)}if(!this.addonOptions.hideCommandSection&&h&&e.length>0){const o=ie("div",{className:`${this._menuCssPrefix}-command-list`,role:"menu"},u);this.populateCommandOrOptionTitle("command",this.addonOptions,o,i),!this.addonOptions.hideCloseButton&&i<1&&(!l||0===t.length||this.addonOptions.hideOptionSection)&&this.populateCommandOrOptionCloseBtn("command",f,o),s&&i>0&&this.addSubMenuTitleWhenExists(s,o),this.populateCommandOrOptionItems("command",this.addonOptions,o,e,{cell:this._currentCell,row:this._currentRow,column:n,dataContext:r,grid:this.grid,level:i},this.handleMenuItemCommandClick,this.handleMenuItemMouseOver)}return i++,u}closeMenu(e,t){if(this.menuElement){if("function"==typeof this.addonOptions?.onBeforeMenuClose&&!1===this.addonOptions.onBeforeMenuClose(e,t))return;this.hideMenu()}}hideMenu(){this.menuElement?.remove(),this._menuElm=null,this.disposeSubMenus()}checkIsColumnAllowed(e,t){return!(e?.length>0)||e.findIndex((e=>e===t))>=0}handleBodyMouseDown(e){if(this.menuElement){let t=!1;const i=e.target.closest(`.${this.menuCssClass}`);(this.menuElement.contains(e.target)||i)&&(t=!0),(this.menuElement!==e.target&&!t&&!e.defaultPrevented||"close"===e.target.className&&i)&&this.closeMenu(e,{cell:this._currentCell,row:this._currentRow,grid:this.grid})}}handleCloseButtonClicked(e){e.defaultPrevented||this.closeMenu(e,{cell:0,row:0,grid:this.grid})}handleMenuItemMouseOver(e,t,i,s=0){void 0===i?.[t]||"divider"===i||i.disabled||i.divider||(i.commandItems||i.optionItems?(this.repositionSubMenu(i,t,s,e),this._lastMenuTypeClicked=t):0===s&&this.disposeSubMenus())}handleMenuItemCommandClick(e,t,i,s=0){if(void 0!==i?.[t]&&"divider"!==i&&!i.disabled&&!i.divider&&void 0!==this._currentCell&&void 0!==this._currentRow){if("option"===t&&!this.grid.getEditorLock().commitCurrentEdit())return;const n=this._currentCell,r=this._currentRow,o=this.grid.getColumns()[this._currentCell],a=this.grid.getDataItem(this._currentRow),l=void 0!==i[t]?i[t]:"";if(void 0===l||i[`${t}Items`])(i.commandItems||i.optionItems)&&this.repositionSubMenu(i,t,s,e);else{const s={cell:this._currentCell,row:this._currentRow,grid:this.grid,[t]:l,item:i,column:o,dataContext:a},h="command"===t?"onCommand":"onOptionSelected",c=`${this._camelPluginName}:${h}`;this.pubSubService.publish(c,s),"function"==typeof this._addonOptions?.[h]&&this._addonOptions[h](e,s),"function"==typeof i.action&&i.action.call(this,e,s),e.defaultPrevented||this.closeMenu(e,{cell:n,row:r,grid:this.grid})}this._lastMenuTypeClicked=t}}populateCommandOrOptionCloseBtn(e,t,i){this._bindEventService.bind(t,"click",(e=>this.handleCloseButtonClicked(e)),void 0,"parent-menu");const s=i.querySelector(`.slick-${e}-header`)??ie("div",{className:`slick-${e}-header`});s?.appendChild(t),i.appendChild(s),s.classList.add("with-close")}repositionSubMenu(e,t,i,s){(s.target.classList.contains("slick-cell")||this._lastMenuTypeClicked!==t)&&this.disposeSubMenus();const n=this.createMenu(e?.commandItems||[],e?.optionItems||[],i+1,e);n&&(n.style.display="block",document.body.appendChild(n),this.repositionMenu(s,n))}repositionMenu(e,t){const i=t?.classList.contains("slick-submenu"),s=i?e.target.closest(`.${this._menuCssPrefix}-item`):e.target.closest(".slick-cell");if(t&&s){t.style.top="0px",t.style.left="0px";const n=e?.touches?.[0]??e,r=le(s);let o=s&&"cellMenu"===this._camelPluginName?r.left:n.pageX,a=s&&"cellMenu"===this._camelPluginName?r.top:n.pageY;i&&"contextMenu"===this._camelPluginName&&(o=r.left,a=r.top);const l=s.offsetWidth||0,h=t?.offsetHeight||0,c=t?.offsetWidth||this._addonOptions.width||0,d=this.gridOptions.rowHeight||0,u=Number(this._addonOptions.autoAdjustDropOffset||0),p=Number(this._addonOptions.autoAlignSideOffset||0);if(this._addonOptions.autoAdjustDrop||this._addonOptions.dropDirection){const{bottom:e,top:n}=te(s),r=e+u-d;"top"==(r<h&&n-u+d>r?"top":"bottom")||"top"===this._addonOptions.dropDirection?(t.classList.remove("dropdown"),t.classList.add("dropup"),a-=i?h-u-s.clientHeight:h-u):(t.classList.remove("dropup"),t.classList.add("dropdown"),a+=u,"cellMenu"===this._camelPluginName&&(a+=i?u:d+u))}if(this._addonOptions.autoAlignSide||"left"===this._addonOptions.dropSide){const e=this.grid.getGridPosition();let n=o+Number(c);i&&(n+=s.clientWidth);const r=document.documentElement.clientWidth;"left"==(n>=e.width||n>=r?"left":"right")||!i&&"left"===this._addonOptions.dropSide?(t.classList.remove("dropright"),t.classList.add("dropleft"),"cellMenu"!==this._camelPluginName||i?o-=Number(c)-p:o-=Number(c)-l-p):(t.classList.remove("dropleft"),t.classList.add("dropright"),o+=i?p+s.offsetWidth:p)}t.style.top=`${a}px`,t.style.left=`${o}px`}}}class Ur extends Wr{constructor(e,t,i){super(e,t,i),this.extensionUtility=e,this.pubSubService=t,this.sharedService=i,this.pluginName="CellMenu",this._defaults={autoAdjustDrop:!0,autoAlignSide:!0,autoAdjustDropOffset:0,autoAlignSideOffset:0,hideMenuOnScroll:!0,subMenuOpenByEvent:"mouseover"},this._camelPluginName="cellMenu",this._menuCssPrefix="slick-menu",this._menuPluginCssPrefix="slick-cell-menu",this.init(i.gridOptions.cellMenu)}init(e){this._addonOptions={...this._defaults,...e},this.sortMenuItems(this.sharedService.allColumns),this._eventHandler.subscribe(this.grid.onClick,this.handleCellClick.bind(this)),this._addonOptions.hideMenuOnScroll&&this._eventHandler.subscribe(this.grid.onScroll,this.closeMenu.bind(this))}translateCellMenu(){const e=this.sharedService?.gridOptions,t=this.sharedService.allColumns;e?.enableTranslate&&Array.isArray(t)&&t.forEach((e=>{if(e?.cellMenu&&(Array.isArray(e.cellMenu.commandItems)||Array.isArray(e.cellMenu.optionItems))){const t=e.cellMenu.commandItems||[],i=e.cellMenu.optionItems||[];e.cellMenu.commandTitleKey&&(e.cellMenu.commandTitle=this.extensionUtility.translateWhenEnabledAndServiceExist(e.cellMenu.commandTitleKey,"TEXT_COMMANDS")||e.cellMenu.commandTitle),e.cellMenu.optionTitleKey&&(e.cellMenu.optionTitle=this.extensionUtility.translateWhenEnabledAndServiceExist(e.cellMenu.optionTitleKey,"TEXT_COMMANDS")||e.cellMenu.optionTitle),this.extensionUtility.translateMenuItemsFromTitleKey(t,"commandItems"),this.extensionUtility.translateMenuItemsFromTitleKey(i,"optionItems")}}))}handleCellClick(e,t){this.disposeAllMenus();const i=this.grid.getCellFromEvent(e);if(i){const s=this.grid.getDataItem(i.row),n=this.grid.getColumns()[i.cell];n?.cellMenu&&!this.gridOptions.cellMenu?.activateCellOnMenuClick&&e.preventDefault(),this._addonOptions={...this._addonOptions,...n.cellMenu};const r=t||{};if(r.column=n,r.dataContext=s,r.grid=this.grid,!this.extensionUtility.runOverrideFunctionWhenExists(this._addonOptions.menuUsabilityOverride,r))return;this._menuElm=this.createParentMenu(e),this._menuElm&&(this.repositionMenu(e,this._menuElm),this._menuElm.ariaExpanded="true",this._menuElm.style.display="block",this.gridOptions.darkMode&&this._menuElm.classList.add("slick-dark-mode")),this._bindEventService.bind(document.body,"mousedown",this.handleBodyMouseDown.bind(this))}}sortMenuItems(e){e.forEach((e=>{e?.cellMenu?.commandItems&&this.extensionUtility.sortItems(e.cellMenu.commandItems||[],"positionOrder"),e?.cellMenu?.optionItems&&this.extensionUtility.sortItems(e.cellMenu.optionItems||[],"positionOrder")}))}}class jr{constructor(e,t){this.grid=e,this.pluginName="CellRangeDecorator",this._defaults={selectionCssClass:"slick-range-decorator",selectionCss:{border:"2px dashed red",zIndex:"9999"},offset:{top:-1,left:-1,height:-2,width:-2}},this._options=De(this._defaults,t)}get addonOptions(){return this._options}get addonElement(){return this._elem}destroy(){this.hide()}init(){}hide(){this._elem?.remove(),this._elem=null}show(e){this._elem||(this._elem=ie("div",{className:this._options.selectionCssClass}),Object.keys(this._options.selectionCss).forEach((e=>{this._elem.style[e]=this._options.selectionCss[e]})),this._elem.style.position="absolute",this.grid.getActiveCanvasNode()?.appendChild(this._elem));const t=this.grid.getCellNodeBox(e.fromRow,e.fromCell),i=this.grid.getCellNodeBox(e.toRow,e.toCell);return t&&i&&this._options?.offset&&(this._elem.style.top=`${t.top+this._options.offset.top}px`,this._elem.style.left=`${t.left+this._options.offset.left}px`,this._elem.style.height=`${i.bottom-t.top+this._options.offset.height}px`,this._elem.style.width=`${i.right-t.left+this._options.offset.width}px`),this._elem}}class Gr{constructor(e){this.pluginName="CellRangeSelector",this._currentlySelectedRange=null,this._canvas=null,this._dragging=!1,this._gridUid="",this._columnOffset=0,this._rowOffset=0,this._isRightCanvas=!1,this._isBottomCanvas=!1,this._xDelayForNextCell=0,this._yDelayForNextCell=0,this._viewportHeight=0,this._viewportWidth=0,this._isRowMoveRegistered=!1,this._scrollLeft=0,this._scrollTop=0,this._defaults={autoScroll:!0,minIntervalToShowNextCell:30,maxIntervalToShowNextCell:600,accelerateInterval:5,selectionCss:{border:"2px dashed blue"}},this.onBeforeCellRangeSelected=new ys("onBeforeCellRangeSelected"),this.onCellRangeSelecting=new ys("onCellRangeSelecting"),this.onCellRangeSelected=new ys("onCellRangeSelected"),this._eventHandler=new Cs,this._options=De(this._defaults,e)}get addonOptions(){return this._options}get eventHandler(){return this._eventHandler}get gridUid(){return this._gridUid||(this._grid?.getUID()??"")}get gridUidSelector(){return this.gridUid?`.${this.gridUid}`:""}init(e){this._grid=e,this._decorator=this._options.cellDecorator||new jr(e,this._options),this._canvas=e.getCanvasNode(),this._gridOptions=e.getOptions(),this._gridUid=e.getUID();const t=e.getPubSubService();t&&Ts.addSlickEventPubSubWhenDefined(t,this),this._eventHandler.subscribe(this._grid.onDrag,this.handleDrag.bind(this)).subscribe(this._grid.onDragInit,this.handleDragInit.bind(this)).subscribe(this._grid.onDragStart,this.handleDragStart.bind(this)).subscribe(this._grid.onDragEnd,this.handleDragEnd.bind(this)).subscribe(this._grid.onScroll,this.handleScroll.bind(this))}destroy(){this.dispose()}dispose(){this._eventHandler?.unsubscribeAll(),re(this._activeCanvas),re(this._canvas),this._decorator?.destroy(),this.stopIntervalTimer()}getCellDecorator(){return this._decorator}getCurrentRange(){return this._currentlySelectedRange}getMouseOffsetViewport(e,t){const i=e?.touches?.[0]??e,s=this._activeViewport.scrollLeft,n=this._activeViewport.scrollTop,r=s+this._viewportWidth,o=n+this._viewportHeight,a=le(this._activeViewport),l=a.left,h=a.top,c=l+this._viewportWidth,d=h+this._viewportHeight,u={e,dd:t,viewport:{left:s,top:n,right:r,bottom:o,offset:{left:l,top:h,right:c,bottom:d}},offset:{x:0,y:0},isOutsideViewport:!1};return i.pageX<l?u.offset.x=i.pageX-l:i.pageX>c&&(u.offset.x=i.pageX-c),i.pageY<h?u.offset.y=h-i.pageY:i.pageY>d&&(u.offset.y=d-i.pageY),u.isOutsideViewport=!!u.offset.x||!!u.offset.y,u}stopIntervalTimer(){this._autoScrollTimerId&&(window.clearInterval(this._autoScrollTimerId),this._autoScrollTimerId=void 0)}handleDrag(e,t){if(!this._dragging&&!this._gridOptions.enableRowMoveManager)return;this._gridOptions.enableRowMoveManager||e.stopImmediatePropagation();const i=e.getNativeEvent();if(this.addonOptions.autoScroll&&(this._draggingMouseOffset=this.getMouseOffsetViewport(i,t),this._draggingMouseOffset.isOutsideViewport))return this.handleDragOutsideViewport();this.stopIntervalTimer(),this.handleDragTo(i,t)}handleDragOutsideViewport(){if(this._xDelayForNextCell=this.addonOptions.maxIntervalToShowNextCell-Math.abs(this._draggingMouseOffset.offset.x)*this.addonOptions.accelerateInterval,this._yDelayForNextCell=this.addonOptions.maxIntervalToShowNextCell-Math.abs(this._draggingMouseOffset.offset.y)*this.addonOptions.accelerateInterval,!this._autoScrollTimerId){let e=0,t=0;this._autoScrollTimerId=window.setInterval((()=>{let i=!1,s=!1;this._draggingMouseOffset.offset.x?(e+=this.addonOptions.minIntervalToShowNextCell,i=e>=this._xDelayForNextCell):e=0,this._draggingMouseOffset.offset.y?(t+=this.addonOptions.minIntervalToShowNextCell,s=t>=this._yDelayForNextCell):t=0,(i||s)&&(i&&(e=0),s&&(t=0),this.handleDragToNewPosition(i,s))}),this.addonOptions.minIntervalToShowNextCell)}}handleDragToNewPosition(e,t){let i=this._draggingMouseOffset.e.pageX,s=this._draggingMouseOffset.e.pageY;const n=this._draggingMouseOffset.offset.x,r=this._draggingMouseOffset.offset.y,o=this._draggingMouseOffset.viewport.offset;e&&n&&(i=n>0?o.right+this._moveDistanceForOneCell.x:o.left-this._moveDistanceForOneCell.x),t&&r&&(s=r>0?o.top-this._moveDistanceForOneCell.y:o.bottom+this._moveDistanceForOneCell.y),this.handleDragTo({pageX:i,pageY:s},this._draggingMouseOffset.dd)}handleDragTo(e,t){const i=e?.touches?.[0]??e,s=this._grid.getCellFromPoint(i.pageX-le(this._activeCanvas).left+this._columnOffset,i.pageY-le(this._activeCanvas).top+this._rowOffset);if(void 0!==s){if(this._gridOptions.frozenColumn>=0&&(!this._isRightCanvas&&s.cell>this._gridOptions.frozenColumn||this._isRightCanvas&&s.cell<=this._gridOptions.frozenColumn))return;if(this._gridOptions.frozenRow>=0&&(!this._isBottomCanvas&&s.row>=this._gridOptions.frozenRow||this._isBottomCanvas&&s.row<this._gridOptions.frozenRow))return;if(this.addonOptions.autoScroll&&this._draggingMouseOffset){const e=this._grid.getCellNodeBox(s.row,s.cell);if(e){const t=this._draggingMouseOffset.viewport;(e.left<t.left||e.right>t.right||e.top<t.top||e.bottom>t.bottom)&&this._grid.scrollCellIntoView(s.row,s.cell)}}if(!this._grid.canCellBeSelected(s.row,s.cell))return;if(t?.range){t.range.end=s;const e=new ws(t.range.start.row??0,t.range.start.cell??0,s.row,s.cell);this._decorator.show(e),this.onCellRangeSelecting.notify({range:e})}}}handleDragEnd(e,t){this._decorator.hide(),this._dragging&&(this._dragging=!1,e.stopImmediatePropagation(),this.stopIntervalTimer(),this.onCellRangeSelected.notify({range:new ws(t.range.start.row??0,t.range.start.cell??0,t.range.end.row,t.range.end.cell)}))}handleDragInit(e){this._activeCanvas=this._grid.getActiveCanvasNode(e),this._activeViewport=this._grid.getActiveViewportNode(e);const t=this._grid.getDisplayedScrollbarDimensions();if(this._viewportWidth=this._activeViewport.offsetWidth-t.width,this._viewportHeight=this._activeViewport.offsetHeight-t.height,this._moveDistanceForOneCell={x:this._grid.getAbsoluteColumnMinWidth()/2,y:this._gridOptions.rowHeight/2},this._rowOffset=0,this._columnOffset=0,this._isBottomCanvas=this._activeCanvas.classList.contains("grid-canvas-bottom"),this._gridOptions.frozenRow>-1&&this._isBottomCanvas){const e=`${this.gridUidSelector} .grid-canvas-${this._gridOptions.frozenBottom?"bottom":"top"}`;this._rowOffset=document.querySelector(e)?.clientHeight??0}this._isRightCanvas=this._activeCanvas.classList.contains("grid-canvas-right"),this._gridOptions.frozenColumn>-1&&this._isRightCanvas&&(this._columnOffset=document.querySelector(`${this.gridUidSelector} .grid-canvas-left`)?.clientWidth??0);const i=this._grid.getCellFromEvent(e),s=this._grid.getActiveCell();this._grid.getEditorLock().isActive()&&s&&i&&s.row===i.row&&s.cell===i.cell||(e.stopImmediatePropagation(),e.preventDefault())}handleDragStart(e,t){const i=this._grid.getCellFromEvent(e);if(i&&!1!==this.onBeforeCellRangeSelected.notify(i).getReturnValue()&&this._grid.canCellBeSelected(i.row,i.cell)&&(this._dragging=!0,e.stopImmediatePropagation()),!this._dragging)return;this._grid.focus();const s=le(this._canvas);let n=t.startX-s.left;this._gridOptions.frozenColumn>=0&&this._isRightCanvas&&(n+=this._scrollLeft);let r=t.startY-s.top;this._gridOptions.frozenRow>=0&&this._isBottomCanvas&&(r+=this._scrollTop);const o=this._grid.getCellFromPoint(n,r);return t.range={start:o,end:{}},this._currentlySelectedRange=t.range,this._decorator.show(new ws(o.row,o.cell))}handleScroll(e,t){this._scrollTop=t.scrollTop,this._scrollLeft=t.scrollLeft}}class qr{constructor(e){this.pluginName="CellSelectionModel",this._cachedPageRowCount=0,this._prevKeyDown="",this._ranges=[],this._defaults={selectActiveCell:!0},this.onSelectedRangesChanged=new ys("onSelectedRangesChanged"),this._eventHandler=new Cs,this._selector=void 0===e||void 0===e.cellRangeSelector?new Gr({selectionCss:{border:"2px solid black"}}):e.cellRangeSelector,this._addonOptions=e}get addonOptions(){return this._addonOptions}get cellRangeSelector(){return this._selector}get eventHandler(){return this._eventHandler}init(e){this._grid=e,void 0!==this._addonOptions&&void 0!==this._addonOptions.cellRangeSelector||(this._selector=new Gr({selectionCss:{border:"2px solid "+(this._grid.getOptions().darkMode?"white":"black")}})),e.hasDataView()&&(this._dataView=e.getData()),this._addonOptions={...this._defaults,...this._addonOptions};const t=e.getPubSubService();t&&this.onSelectedRangesChanged.setPubSubService(t),this._eventHandler.subscribe(this._grid.onActiveCellChanged,this.handleActiveCellChange.bind(this)).subscribe(this._grid.onKeyDown,this.handleKeyDown.bind(this)).subscribe(this._selector.onBeforeCellRangeSelected,this.handleBeforeCellRangeSelected.bind(this)).subscribe(this._selector.onCellRangeSelected,this.handleCellRangeSelected.bind(this)),e.registerPlugin(this._selector)}destroy(){this.dispose()}dispose(){this._selector&&(this._selector.onBeforeCellRangeSelected.unsubscribe(this.handleBeforeCellRangeSelected.bind(this)),this._selector.onCellRangeSelected.unsubscribe(this.handleCellRangeSelected.bind(this))),this._eventHandler.unsubscribeAll(),this._grid?.unregisterPlugin(this._selector),this._selector?.dispose()}getSelectedRanges(){return this._ranges}rangesAreEqual(e,t){let i=e.length!==t.length;if(!i)for(let s=0;s<e.length;s++)if(e[s].fromCell!==t[s].fromCell||e[s].fromRow!==t[s].fromRow||e[s].toCell!==t[s].toCell||e[s].toRow!==t[s].toRow){i=!0;break}return!i}refreshSelections(){this.setSelectedRanges(this.getSelectedRanges())}removeInvalidRanges(e){const t=[];for(let i=0;i<e.length;i++){const s=e[i];this._grid.canCellBeSelected(s.fromRow,s.fromCell)&&this._grid.canCellBeSelected(s.toRow,s.toCell)&&t.push(s)}return t}resetPageRowCount(){this._cachedPageRowCount=0}setSelectedRanges(e,t="SlickCellSelectionModel.setSelectedRanges"){if(!(this._ranges&&0!==this._ranges.length||e&&0!==e.length))return;const i=!this.rangesAreEqual(this._ranges,e);if(this._ranges=this.removeInvalidRanges(e),i){const e=new bs(new CustomEvent("click",{detail:{caller:t}}),this._ranges);this.onSelectedRangesChanged.notify(this._ranges,e)}}handleActiveCellChange(e,t){this._prevSelectedRow=void 0;const i=Me(t.cell),s=Me(t.row);this._addonOptions?.selectActiveCell&&s&&i?this.setSelectedRanges([new ws(t.row,t.cell)]):this._addonOptions?.selectActiveCell&&(s||i)||this.setSelectedRanges([])}handleBeforeCellRangeSelected(e){const t=this._grid.getCellFromEvent(e),i=this._grid.getActiveCell();if(this._grid.getEditorLock().isActive()&&i&&t&&i.row===t.row&&i.cell===t.cell)return e.stopPropagation(),!1}handleCellRangeSelected(e,t){this._grid.setActiveCell(t.range.fromRow,t.range.fromCell,!1,!1,!0),this.setSelectedRanges([t.range])}isKeyAllowed(e){return["ArrowLeft","ArrowRight","ArrowUp","ArrowDown","PageDown","PageUp","Home","End"].some((t=>t===e))}handleKeyDown(e){let t,i;const s=this._grid.getColumns().length,n=this._grid.getActiveCell();let r=0;if(r=this._dataView&&"getPagingInfo"in this._dataView?this._dataView?.getPagingInfo().pageSize||this._dataView.getLength():this._grid.getDataLength(),n&&(e.shiftKey||e.ctrlKey)&&!e.altKey&&this.isKeyAllowed(e.key)&&(t=this.getSelectedRanges().slice(),t.length||t.push(new ws(n.row,n.cell)),i=t.pop(),"function"==typeof i?.contains)){i.contains(n.row,n.cell)||(i=new ws(n.row,n.cell));let o=i.toRow-i.fromRow,a=i.toCell-i.fromCell;const l=n.row===i.fromRow?1:-1,h=n.cell===i.fromCell?1:-1,c=e.key.startsWith("Arrow");let d,u=0;c&&!e.ctrlKey?("ArrowLeft"===e.key?a-=h:"ArrowRight"===e.key?a+=h:"ArrowUp"===e.key?o-=l:"ArrowDown"===e.key&&(o+=l),u=n.row+l*o):(this._cachedPageRowCount<1&&(this._cachedPageRowCount=this._grid.getViewportRowCount()),void 0===this._prevSelectedRow&&(this._prevSelectedRow=n.row),e.shiftKey&&!e.ctrlKey&&"Home"===e.key?(d=0,u=n.row):e.shiftKey&&!e.ctrlKey&&"End"===e.key?(d=s-1,u=n.row):e.ctrlKey&&e.shiftKey&&"Home"===e.key?(d=0,u=0):e.ctrlKey&&e.shiftKey&&"End"===e.key?(d=s-1,u=r-1):"PageUp"===e.key?(this._prevSelectedRow>=0&&(u=this._prevSelectedRow-this._cachedPageRowCount),u<0&&(u=0)):"PageDown"===e.key&&(this._prevSelectedRow<=r-1&&(u=this._prevSelectedRow+this._cachedPageRowCount),u>r-1&&(u=r-1)),this._prevSelectedRow=u),d??=n.cell+h*a;const p=new ws(n.row,n.cell,u,d);if(this.removeInvalidRanges([p]).length){t.push(p);const e=l>0?p.toRow:p.fromRow,i=h>0?p.toCell:p.fromCell;c?(this._grid.scrollRowIntoView(e),this._grid.scrollCellIntoView(e,i,!1)):(this._grid.scrollRowIntoView(u),this._grid.scrollCellIntoView(u,i,!1))}else t.push(i);this.setSelectedRanges(t),e.preventDefault(),e.stopPropagation(),this._prevKeyDown=e.key}}}class Kr{constructor(e){this.pluginName="RowSelectionModel",this._inHandler=!1,this._ranges=[],this._defaults={autoScrollWhenDrag:!0,cellRangeSelector:void 0,dragToSelect:!1,selectActiveRow:!0},this.onSelectedRangesChanged=new ys("onSelectedRangesChanged"),this._eventHandler=new Cs,this._options={...this._defaults,...e}}get addonOptions(){return this._options}get eventHandler(){return this._eventHandler}get gridOptions(){return this._grid?.getOptions()}init(e){this._grid=e,this._options={...this._defaults,...this._options},this._selector=this.addonOptions.cellRangeSelector;const t=e.getPubSubService();t&&this.onSelectedRangesChanged.setPubSubService(t),!this._selector&&this._options.dragToSelect&&(this._selector=new Gr({selectionCss:{border:"none"},autoScroll:this._options.autoScrollWhenDrag}),this.addonOptions.cellRangeSelector=this._selector),this._eventHandler.subscribe(this._grid.onActiveCellChanged,this.handleActiveCellChange.bind(this)).subscribe(this._grid.onClick,this.handleClick.bind(this)).subscribe(this._grid.onKeyDown,this.handleKeyDown.bind(this)),this._selector&&(this._grid.registerPlugin(this._selector),this._selector.onCellRangeSelecting.subscribe(this.handleCellRangeSelected.bind(this)),this._selector.onCellRangeSelected.subscribe(this.handleCellRangeSelected.bind(this)),this._selector.onBeforeCellRangeSelected.subscribe(this.handleBeforeCellRangeSelected.bind(this)))}destroy(){this.dispose()}dispose(){this._eventHandler.unsubscribeAll(),this.disposeSelector()}disposeSelector(){this._selector&&(this._selector.onCellRangeSelecting.unsubscribe(this.handleCellRangeSelected.bind(this)),this._selector.onCellRangeSelected.unsubscribe(this.handleCellRangeSelected.bind(this)),this._selector.onBeforeCellRangeSelected.unsubscribe(this.handleBeforeCellRangeSelected.bind(this)),this._grid.unregisterPlugin(this._selector),this._selector?.destroy(),this._selector?.dispose())}getCellRangeSelector(){return this._selector}getSelectedRanges(){return this._ranges}getSelectedRows(){return this.rangesToRows(this._ranges)}refreshSelections(){this.setSelectedRows(this.getSelectedRows())}setSelectedRows(e){this.setSelectedRanges(this.rowsToRanges(e),"SlickRowSelectionModel.setSelectedRows")}setSelectedRanges(e,t="SlickRowSelectionModel.setSelectedRanges"){if(!(this._ranges&&0!==this._ranges.length||e&&0!==e.length))return;this._ranges=e;const i=new bs(new CustomEvent("click",{detail:{caller:t}}),this._ranges);this.onSelectedRangesChanged.notify(this._ranges,i)}getRowsRange(e,t){let i;const s=[];for(i=e;i<=t;i++)s.push(i);for(i=t;i<e;i++)s.push(i);return s}handleBeforeCellRangeSelected(e,t){let i=!1;if(this.gridOptions.enableRowMoveManager&&(i=this.isHandlerColumn(t.cell)??!1),this._grid.getEditorLock().isActive()||i)return e.stopPropagation(),!1;this._grid.setActiveCell(t.row,t.cell)}handleCellRangeSelected(e,t){if(!this.gridOptions.multiSelect||!this.addonOptions.selectActiveRow)return!1;this.setSelectedRanges([new ws(t.range.fromRow,0,t.range.toRow,this._grid.getColumns().length-1)])}handleActiveCellChange(e,t){this._options.selectActiveRow&&null!==t.row&&this.setSelectedRanges([new ws(t.row,0,t.row,this._grid.getColumns().length-1)])}handleClick(e){const t=this._grid.getCellFromEvent(e);if(!t||!this._grid.canCellBeActive(t.row,t.cell))return!1;if(!this.gridOptions.multiSelect||!e.ctrlKey&&!e.shiftKey&&!e.metaKey)return!1;let i=this.rangesToRows(this._ranges);const s=i.indexOf(t.row);if(-1===s&&(e.ctrlKey||e.metaKey))i.push(t.row),this._grid.setActiveCell(t.row,t.cell);else if(-1!==s&&(e.ctrlKey||e.metaKey))i=i.filter((e=>e!==t.row)),this._grid.setActiveCell(t.row,t.cell);else if(i.length&&e.shiftKey){const e=i.pop(),s=Math.min(t.row,e),n=Math.max(t.row,e);i=[];for(let t=s;t<=n;t++)t!==e&&i.push(t);i.push(e),this._grid.setActiveCell(t.row,t.cell)}const n=this.rowsToRanges(i);return this.setSelectedRanges(n),e.stopImmediatePropagation(),!0}handleKeyDown(e){const t=this._grid.getActiveCell();if(this.gridOptions.multiSelect&&t&&e.shiftKey&&!e.ctrlKey&&!e.altKey&&!e.metaKey&&("ArrowUp"===e.key||"ArrowDown"===e.key)){let i,s=this.getSelectedRows();s.sort(((e,t)=>e-t)),s.length||(s=[t.row]);let n=s[0],r=s[s.length-1];if(i="ArrowDown"===e.key?t.row<r||n===r?++r:++n:t.row<r?--r:--n,i>=0&&i<this._grid.getDataLength()){this._grid.scrollRowIntoView(i);const e=this.rowsToRanges(this.getRowsRange(n,r));this.setSelectedRanges(e)}e.preventDefault(),e.stopPropagation()}}isHandlerColumn(e){const t=this._grid.getColumns()[e].behavior||"";return/move|selectAndMove/.test(t)}rangesToRows(e){const t=[];for(let i=0;i<e.length;i++)for(let s=e[i].fromRow;s<=e[i].toRow;s++)t.push(s);return t}rowsToRanges(e){const t=[],i=this._grid.getColumns().length-1;return e.forEach((e=>t.push(new ws(e,0,e,i)))),t}}const Yr="mdi-icon-check",Xr="mdi-icon-uncheck";class Zr{constructor(e,t){this.pubSubService=e,this.pluginName="CheckboxSelectColumn",this._defaults={columnId:"_checkbox_selector",cssClass:null,field:"_checkbox_selector",hideSelectAllCheckbox:!1,name:"",toolTip:"Select/Deselect All",width:30,reorderable:!1,applySelectOnAllPages:!0,hideInColumnTitleRow:!1,hideInFilterHeaderRow:!0},this._addonOptions=this._defaults,this._checkboxColumnCellIndex=null,this._isSelectAllChecked=!1,this._isUsingDataView=!1,this._selectedRowsLookup={},this._selectAll_UID=this.createUID(),this._bindEventService=new Wt,this._eventHandler=new Cs,this._addonOptions={...this._defaults,...t}}get addonOptions(){return this._addonOptions}get headerRowNode(){return this._headerRowNode}get gridOptions(){return this._grid?.getOptions()??{}}get selectAllUid(){return this._selectAll_UID}set selectedRowsLookup(e){this._selectedRowsLookup=e}init(e){this._grid=e,this._isUsingDataView=!Array.isArray(e.getData()),this._isUsingDataView&&(this._dataView=e.getData()),this.gridOptions.backendServiceApi&&(this._addonOptions.applySelectOnAllPages=!1),this._eventHandler.subscribe(e.onSelectedRowsChanged,this.handleSelectedRowsChanged.bind(this)).subscribe(e.onClick,this.handleClick.bind(this)).subscribe(e.onKeyDown,this.handleKeyDown.bind(this)),this._isUsingDataView&&this._dataView&&(this._eventHandler.subscribe(e.onAfterSetColumns,this.handleDataViewSelectedIdsChanged.bind(this)),this._addonOptions.applySelectOnAllPages&&this._eventHandler.subscribe(this._dataView.onSelectedRowIdsChanged,this.handleDataViewSelectedIdsChanged.bind(this)).subscribe(this._dataView.onPagingInfoChanged,this.handleDataViewSelectedIdsChanged.bind(this))),this._addonOptions.hideInFilterHeaderRow||this.addCheckboxToFilterHeaderRow(e),this._addonOptions.hideInColumnTitleRow||this._eventHandler.subscribe(this._grid.onHeaderClick,this.handleHeaderClick.bind(this)),this._rowSelectionModel&&this._grid.getSelectionModel()||(this._rowSelectionModel=new Kr(this.gridOptions.rowSelectionOptions),this._grid.setSelectionModel(this._rowSelectionModel)),this.gridOptions.preselectedRows&&this._rowSelectionModel&&this._grid.getSelectionModel()&&window.setTimeout((()=>this.selectRows(this.gridOptions.preselectedRows||[]))),"function"==typeof this._addonOptions.selectableOverride&&this.selectableOverride(this._addonOptions.selectableOverride)}dispose(){this._bindEventService.unbindAll(),this._eventHandler.unsubscribeAll()}create(e,t){if(this._addonOptions={...this._defaults,...t.checkboxSelector},Array.isArray(e)&&t){const i=this.getColumnDefinition();if(!e.some((e=>e.id===i.id))){const s=t?.checkboxSelector?.columnIndexPosition??0;s>0?e.splice(s,0,i):e.unshift(i),this.pubSubService.publish("onPluginColumnsChanged",{columns:e,pluginName:this.pluginName})}}return this}getOptions(){return this._addonOptions}setOptions(e){if(this._addonOptions={...this._addonOptions,...e},this._addonOptions.hideSelectAllCheckbox)this.hideSelectAllFromColumnHeaderTitleRow(),this.hideSelectAllFromColumnHeaderFilterRow();else if(this._addonOptions.hideInColumnTitleRow?(this.hideSelectAllFromColumnHeaderTitleRow(),this._addonOptions.name&&this._grid.updateColumnHeader(this._addonOptions.columnId||"",this._addonOptions.name,"")):(this.renderSelectAllCheckbox(this._isSelectAllChecked),this._eventHandler.subscribe(this._grid.onHeaderClick,this.handleHeaderClick.bind(this))),this._addonOptions.hideInFilterHeaderRow)this.hideSelectAllFromColumnHeaderFilterRow();else{const e=this.headerRowNode?.querySelector("#filter-checkbox-selectall-container");if(e){e.style.display="flex",e.ariaChecked=String(this._isSelectAllChecked);const t=e.querySelector('input[type="checkbox"]');t&&(t.ariaChecked=String(this._isSelectAllChecked),t.checked=this._isSelectAllChecked)}}}deSelectRows(e){const t=[];for(const i of e)this._selectedRowsLookup[i]&&(t[t.length]=i);this._grid.setSelectedRows(this._grid.getSelectedRows().filter((e=>t.indexOf(e)<0)),"SlickCheckboxSelectColumn.deSelectRows")}selectRows(e){const t=[];for(const i of e)this._selectedRowsLookup[i]&&(t[t.length]=i);const i=this._grid.getSelectedRows()?.concat(t);this._grid.setSelectedRows(i)}createCheckboxElement(e,t=!1){const i=this.gridOptions?.preventDocumentFragmentUsage?document.createElement("span"):new DocumentFragment,s=ie("label",{className:"checkbox-selector-label",htmlFor:e}),n=ie("div",{className:"icon-checkbox-container"});return n.appendChild(ie("input",{id:e,type:"checkbox",checked:t,ariaChecked:String(t)})),n.appendChild(ie("div",{className:`mdi ${t?Yr:Xr}`})),s.appendChild(n),i.appendChild(s),i}getColumnDefinition(){const e=String(this._addonOptions?.columnId??this._defaults.columnId);return{id:e,name:this._addonOptions.hideSelectAllCheckbox||this._addonOptions.hideInColumnTitleRow?this._addonOptions.name||"":this.createCheckboxElement(`header-selector${this._selectAll_UID}`),toolTip:this._addonOptions.hideSelectAllCheckbox||this._addonOptions.hideInColumnTitleRow?"":this._addonOptions.toolTip,field:e,cssClass:this._addonOptions.cssClass,excludeFromExport:!0,excludeFromColumnPicker:!0,excludeFromGridMenu:!0,excludeFromQuery:!0,excludeFromHeaderMenu:!0,hideSelectAllCheckbox:this._addonOptions.hideSelectAllCheckbox,resizable:!1,reorderable:this._addonOptions.reorderable,sortable:!1,width:this._addonOptions.width||30,maxWidth:this._addonOptions.width||30,formatter:this.checkboxSelectionFormatter.bind(this)}}hideSelectAllFromColumnHeaderTitleRow(){this._grid.updateColumnHeader(this._addonOptions.columnId||"",this._addonOptions.name||"","")}hideSelectAllFromColumnHeaderFilterRow(){const e=this.headerRowNode?.querySelector("#filter-checkbox-selectall-container");e&&(e.style.display="none")}toggleRowSelection(e){this.toggleRowSelectionWithEvent(null,e)}toggleRowSelectionWithEvent(e,t){const i=this._grid.getDataItem(t);if(!this.checkSelectableOverride(t,i,this._grid))return;const s=this._grid.getSelectedRows();"function"==typeof this._addonOptions.onRowToggleStart&&this._addonOptions.onRowToggleStart(e,{row:t,previousSelectedRows:s});const n=this._selectedRowsLookup[t]?this._grid.getSelectedRows().filter((e=>e!==t)):this._grid.getSelectedRows().concat(t);this._grid.setSelectedRows(n,"click.toggle"),this._grid.setActiveCell(t,this.getCheckboxColumnCellIndex()),this._addonOptions.onRowToggleEnd&&this._addonOptions.onRowToggleEnd(e,{row:t,previousSelectedRows:s})}selectableOverride(e){this._selectableOverride=e}addCheckboxToFilterHeaderRow(e){this._eventHandler.subscribe(e.onHeaderRowCellRendered,((e,t)=>{if(t.column.field===(this._addonOptions.field||"_checkbox_selector")){re(t.node);const e=`header-filter-selector${this._selectAll_UID}`,i=ie("label",{id:"filter-checkbox-selectall-container",htmlFor:e}),s=ie("div",{className:"icon-checkbox-container"});s.appendChild(ie("input",{id:e,type:"checkbox",ariaChecked:"false"})),s.appendChild(ie("div",{className:"mdi mdi-icon-uncheck"})),i.appendChild(s),t.node.appendChild(i),this._headerRowNode=t.node,this._headerRowNode.classList.add("checkbox-header"),this._bindEventService.bind(i,"click",(e=>this.handleHeaderClick(e,t)))}}))}checkboxSelectionFormatter(e,t,i,s,n,r){if(n&&this.checkSelectableOverride(e,n,r)){const t=this.createUID()+e;return this.createCheckboxElement(`selector${t}`,!!this._selectedRowsLookup[e])}return null}checkSelectableOverride(e,t,i){return"function"!=typeof this._selectableOverride||this._selectableOverride(e,t,i)}createUID(){return Math.round(1e7*Math.random())}getCheckboxColumnCellIndex(){if(null===this._checkboxColumnCellIndex){this._checkboxColumnCellIndex=0;const e=this._grid.getColumns();for(let t=0;t<e.length;t++)e[t].id===this._addonOptions.columnId&&(this._checkboxColumnCellIndex=t)}return this._checkboxColumnCellIndex}handleDataViewSelectedIdsChanged(){const e=this._dataView.getAllSelectedFilteredIds(),t=this._dataView.getFilteredItems();let i=0;if("function"==typeof this._selectableOverride&&e.length>0)for(let e=0;e<this._dataView.getItemCount();e++){const s=this._dataView.getItemByIdx(e),n=this._dataView.getIdPropertyName(),r=s[n];t.findIndex((e=>e[n]===r))>=0&&!this.checkSelectableOverride(e,s,this._grid)&&i++}if(this._isSelectAllChecked=e.length+i>=t.length,this._addonOptions.hideInColumnTitleRow||this._addonOptions.hideSelectAllCheckbox||this.renderSelectAllCheckbox(this._isSelectAllChecked),!this._addonOptions.hideInFilterHeaderRow){const e=this.headerRowNode?.querySelector(`#header-filter-selector${this._selectAll_UID}`),t=this.headerRowNode?.querySelector(".icon-checkbox-container .mdi");e&&(e.ariaChecked=String(this._isSelectAllChecked),e.checked=this._isSelectAllChecked),t&&(t.className=`mdi ${this._isSelectAllChecked?Yr:Xr}`)}}handleClick(e,t){if(this._grid.getColumns()[t.cell].id===this._addonOptions.columnId&&"checkbox"===e.target.type){if(e.target.ariaChecked=String(e.target.checked),this._grid.getEditorLock().isActive()&&!this._grid.getEditorLock().commitCurrentEdit())return e.preventDefault(),void e.stopImmediatePropagation();this.toggleRowSelectionWithEvent(e,t.row),e.stopPropagation(),e.stopImmediatePropagation()}}handleHeaderClick(e,t){if(t.column.id===this._addonOptions.columnId&&"checkbox"===e.target.type){if(e.target.ariaChecked=String(e.target.checked),this._grid.getEditorLock().isActive()&&!this._grid.getEditorLock().commitCurrentEdit())return e.preventDefault(),void e.stopImmediatePropagation();let t=e.target.checked;const i=t?"click.selectAll":"click.unselectAll",s=this._grid.getSelectedRows();this._addonOptions.onSelectAllToggleStart&&this._addonOptions.onSelectAllToggleStart(e,{previousSelectedRows:s,caller:i});let n=[];if(t){const e=[];for(let t=0;t<this._grid.getDataLength();t++){const i=this._grid.getDataItem(t);i.__group||i.__groupTotals||!this.checkSelectableOverride(t,i,this._grid)||e.push(t)}n=e,t=!0}if(this._isUsingDataView&&this._dataView&&this._addonOptions.applySelectOnAllPages){const e=[],i=this._dataView.getFilteredItems();for(let t=0;t<i.length;t++){const s=i[t];this.checkSelectableOverride(t,s,this._grid)&&e.push(s[this._dataView.getIdPropertyName()])}this._dataView.setSelectedIds(e,{isRowBeingAdded:t})}this._grid.setSelectedRows(n,i),this._addonOptions.onSelectAllToggleEnd&&this._addonOptions.onSelectAllToggleEnd(e,{rows:n,previousSelectedRows:s,caller:i}),e.stopPropagation(),e.stopImmediatePropagation()}}handleKeyDown(e,t){" "===e.key&&this._grid.getColumns()[t.cell].id===this._addonOptions.columnId&&(this._grid.getEditorLock().isActive()&&!this._grid.getEditorLock().commitCurrentEdit()||this.toggleRowSelectionWithEvent(e,t.row),e.preventDefault(),e.stopImmediatePropagation())}handleSelectedRowsChanged(){const e=this._grid.getSelectedRows(),t={};let i=0,s=0,n=0,r=0;if("function"==typeof this._selectableOverride)for(n=0;n<this._grid.getDataLength();n++){const e=this._grid.getDataItem(n);this.checkSelectableOverride(s,e,this._grid)||r++}const o=[];for(s=0;s<e.length;s++){i=e[s];const n=this._grid.getDataItem(i);this.checkSelectableOverride(s,n,this._grid)?(t[i]=!0,t[i]!==this._selectedRowsLookup[i]&&(this._grid.invalidateRow(i),delete this._selectedRowsLookup[i])):o.push(i)}if("object"==typeof this._selectedRowsLookup&&Object.keys(this._selectedRowsLookup).forEach((e=>{void 0!==e&&this._grid.invalidateRow(+e)})),this._selectedRowsLookup=t,this._grid.render(),this._isSelectAllChecked=(e?.length??0)+r>=this._grid.getDataLength(),!(this._isUsingDataView&&this._addonOptions.applySelectOnAllPages||(this._addonOptions.hideInColumnTitleRow||this._addonOptions.hideSelectAllCheckbox||this.renderSelectAllCheckbox(this._isSelectAllChecked),this._addonOptions.hideInFilterHeaderRow))){const e=this.headerRowNode?.querySelector(`#header-filter-selector${this._selectAll_UID}`);e&&(e.ariaChecked=String(this._isSelectAllChecked),e.checked=this._isSelectAllChecked)}if(o.length>0){for(const t of o){const i=e.indexOf(t);e.splice(i,1)}this._grid.setSelectedRows(e,"click.toggle")}}renderSelectAllCheckbox(e){const t=this._grid.updateColumnHeader(this._addonOptions.columnId||"",this.createCheckboxElement(`header-selector${this._selectAll_UID}`,!!e),this._addonOptions.toolTip);t?.classList.add("header-checkbox-selectall")}}class Qr extends Vr{constructor(e,t,i,s,n){super(e,i,s),this.extensionUtility=e,this.filterService=t,this.pubSubService=i,this.sharedService=s,this.sortService=n,this._areVisibleColumnDifferent=!1,this._columns=[],this._columnCheckboxes=[],this._commandMenuElm=null,this._headerElm=null,this._isMenuOpen=!1,this._subMenuParentId="",this._defaults={dropSide:"left",showButton:!0,hideForceFitButton:!1,hideSyncResizeButton:!1,forceFitTitle:"Force fit columns",marginBottom:15,menuWidth:18,minHeight:150,contentMinWidth:0,resizeOnShowHeaderRow:!1,syncResizeTitle:"Synchronous resize",subMenuOpenByEvent:"mouseover",headerColumnValueExtractor:e=>oe(e.columnPickerLabel||e.name||"","innerHTML")},this._menuCssPrefix="slick-menu",this._menuPluginCssPrefix="slick-grid-menu",this._camelPluginName="gridMenu",this._columns=this.sharedService.allColumns??[],this._gridUid=this.grid?.getUID()??"",this.onAfterMenuShow=new ys("onAfterMenuShow"),this.onBeforeMenuShow=new ys("onBeforeMenuShow"),this.onMenuClose=new ys("onMenuClose"),this.onCommand=new ys("onCommand"),this.onColumnsChanged=new ys("onColumnsChanged"),this.initEventHandlers(),this.init()}get addonOptions(){return this._addonOptions||{}}get columns(){return this._columns}set columns(e){this._columns=e}get gridOptions(){return this.grid?.getOptions()||{}}get gridUidSelector(){return this.gridUid?`.${this.gridUid}`:""}initEventHandlers(){this._eventHandler.subscribe(this.grid.onColumnsReordered,ao.bind(this)),this._eventHandler.subscribe(this.grid.onClick,(e=>this.hideMenu(e))),this._eventHandler.subscribe(this.grid.onBeforeDestroy,this.dispose.bind(this)),this._eventHandler.subscribe(this.grid.onSetOptions,((e,t)=>{if(t&&t.optionsBefore&&t.optionsAfter){const e=t.optionsBefore.frozenColumn>=0&&-1===t.optionsAfter.frozenColumn,i=-1===t.optionsBefore.frozenColumn&&t.optionsAfter.frozenColumn>=0;(e||i)&&this.recreateGridMenu()}}))}init(){this._gridUid=this.grid.getUID()??"",Ts.addSlickEventPubSubWhenDefined(this.pubSubService,this),this._userOriginalGridMenu={...this.sharedService.gridOptions.gridMenu},this._addonOptions={...this._defaults,...this.getDefaultGridMenuOptions(),...this.sharedService.gridOptions.gridMenu},this.sharedService.gridOptions.gridMenu=this._addonOptions;const e=this._userOriginalGridMenu.commandItems,t=this._userOriginalGridMenu&&Array.isArray(e)?e:[];this._addonOptions.commandItems=[...t,...this.addGridMenuCustomCommands(t)],this.extensionUtility.translateMenuItemsFromTitleKey(this._addonOptions.commandItems||[],"commandItems"),this.extensionUtility.sortItems(this._addonOptions.commandItems,"positionOrder"),this.createGridMenu()}dispose(){this.deleteMenu(),super.dispose()}deleteMenu(){this._bindEventService.unbindAll(),this._menuElm?.remove(),this._menuElm=null,this._gridMenuButtonElm?.remove(),this._headerElm&&(this._headerElm.style.width="100%")}createColumnPickerContainer(){this._menuElm&&(io.call(this,this._menuElm),this._listElm=ie("div",{className:"slick-column-picker-list",role:"menu"}),this._bindEventService.bind(this._menuElm,"click",so.bind(this),void 0,"parent-menu"))}createGridMenu(){const e=this._gridUid?`.${this._gridUid}`:"",t=this._addonOptions?.menuWidth||this._defaults.menuWidth,i=this.gridOptions.hasOwnProperty("frozenColumn")&&this.gridOptions.frozenColumn>=0?"right":"left",s=this.grid.getContainerNode();if(this._headerElm=s.querySelector(`.slick-header-${i}`),this._headerElm&&this._addonOptions){if(this._headerElm.style.width=`calc(100% - ${t}px)`,(this._addonOptions.resizeOnShowHeaderRow??this._defaults.resizeOnShowHeaderRow)&&this.gridOptions.showHeaderRow){const i=s.querySelector(`${e} .slick-headerrow`);i&&(i.style.width=`calc(100% - ${t}px)`)}if(this._addonOptions.showButton??this._defaults.showButton){this._gridMenuButtonElm=ie("button",{className:"slick-grid-menu-button",ariaLabel:"Grid Menu"}),this._addonOptions?.iconCssClass&&this._gridMenuButtonElm.classList.add(...se(this._addonOptions.iconCssClass));const e="preheader"===this._addonOptions.iconButtonContainer?"firstChild":"lastChild";this._headerElm.parentElement.insertBefore(this._gridMenuButtonElm,this._headerElm.parentElement[e]),this._bindEventService.bind(this._gridMenuButtonElm,"click",this.showGridMenu.bind(this))}this.sharedService.gridOptions.gridMenu={...this._defaults,...this._addonOptions},this.translateTitleLabels(this._addonOptions),this.translateTitleLabels(this.sharedService.gridOptions.gridMenu),this._bindEventService.bind(document.body,"mousedown",this.handleBodyMouseDown.bind(this)),this._bindEventService.bind(document.body,"beforeunload",this.dispose.bind(this))}}createCommandMenu(e,t=0,i){const s=i?.command;let n=1===t&&s?s.replace(/\s/g,""):"";n&&(this._subMenuParentId=n),t>1&&(n=this._subMenuParentId);const r=`${this.menuCssClass} slick-menu-level-${t} ${this._gridUid}`,o=document.body.querySelector(`.${this.menuCssClass}.slick-menu-level-${t}${this.gridUidSelector}`);if(o){if(o.dataset.subMenuParent===n)return o;this.disposeSubMenus()}const a=ie("div",{role:"menu",className:r,ariaLabel:t>1?"SubMenu":"Grid Menu"});t>0&&(a.classList.add("slick-submenu"),n&&(a.dataset.subMenuParent=n));const l={grid:this.grid,menu:this._menuElm,columns:this.columns,allColumns:this.getAllColumns(),visibleColumns:this.getVisibleColumns(),level:t};return this._commandMenuElm=this.recreateCommandList(e,a,l,i),t++,a}getAllColumns(){return this._columns}getVisibleColumns(){return this.grid.getColumns()}hideMenu(e){const t={grid:this.grid,menu:this._menuElm,allColumns:this.columns,visibleColumns:this.getVisibleColumns()};if(this.pubSubService.publish("onGridMenuMenuClose",t),("function"!=typeof this._addonOptions?.onMenuClose||!1!==this._addonOptions.onMenuClose(e,t))&&!1!==this.onMenuClose.notify(t,null,this).getReturnValue()){if(this._isMenuOpen=!1,"function"==typeof this.grid?.autosizeColumns){const e=this.grid.getUID()||"";this._areVisibleColumnDifferent&&e&&null!==document.querySelector(`.${e}`)&&(this.gridOptions.enableAutoSizeColumns&&this.grid.autosizeColumns(),this._areVisibleColumnDifferent=!1)}this.disposeSubMenus(),this._menuElm?.remove(),this._menuElm=null}}recreateGridMenu(){this.deleteMenu(),this.init()}repositionMenu(e,t,i,s){const n=e?.touches?.[0]??e,r=t.classList.contains("slick-submenu"),o=r?e.target.closest(".slick-menu-item"):n.target;if(o){const e=i||this._gridMenuButtonElm,n=le(i),a=le(o),l=s??this._addonOptions,h=getComputedStyle(e),c=parseInt(h?.width??this._defaults?.menuWidth,10),d=t?.offsetWidth??0,u=l?.contentMinWidth??this._defaults.contentMinWidth??0,p=(u>d?u:d)||0,m=n.top,f=n.right;let g,_;if(r?(_=a.top,g=a.left):(_=m+e.offsetHeight,g="right"===l?.dropSide?f-c:f-p),r){const e=t?.clientHeight||0,{bottom:i,top:s}=te(o);"top"==(i<e&&s>i?"top":"bottom")?(t.classList.remove("dropdown"),t.classList.add("dropup"),_-=e-o.clientHeight):(t.classList.remove("dropup"),t.classList.add("dropdown"))}const v=this.grid.getGridPosition();let b=g+Number(d);r&&(b+=o.clientWidth);const y=document.documentElement.clientWidth;"left"==(b>=v.width||b>=y?"left":"right")||!r&&"left"===l?.dropSide?(t.classList.remove("dropright"),t.classList.add("dropleft"),r&&(g-=Number(d))):(t.classList.remove("dropleft"),t.classList.add("dropright"),r&&(g+=o.offsetWidth)),t.style.top=`${_}px`,t.style.left=`${g}px`,u>0&&(t.style.minWidth=`${u}px`),t.style.opacity="1",t.style.display="block"}}openGridMenu(){const e=new MouseEvent("click",{bubbles:!0,cancelable:!0,composed:!1});Object.defineProperty(e,"target",{writable:!0,configurable:!0,value:ie("button",{className:"slick-grid-menu-button"})}),this.showGridMenu(e)}showGridMenu(e,t){const i=e?.touches?.[0]??e;if(e.preventDefault(),re(this._menuElm),this._menuElm?.remove(),this._addonOptions){const s={grid:this.grid,menu:this._menuElm,columns:this.columns,allColumns:this.getAllColumns(),visibleColumns:this.getVisibleColumns()},n={...this._addonOptions,...t};if(n&&!this.extensionUtility.runOverrideFunctionWhenExists(n.menuUsabilityOverride,s))return;if("function"==typeof e.stopPropagation&&(this.pubSubService.publish("onGridMenuBeforeMenuShow",s),"function"==typeof n?.onBeforeMenuShow&&!1===n.onBeforeMenuShow(e,s)||!1===this.onBeforeMenuShow.notify(s,null,this).getReturnValue()))return;this._menuElm=this.createCommandMenu(this._addonOptions?.commandItems??[]),this.createColumnPickerContainer(),ao.call(this),this._columnCheckboxes=[],oo.call(this,n),document.body.appendChild(this._menuElm),this.gridOptions.darkMode&&this._menuElm.classList.add("slick-dark-mode"),this._menuElm.style.opacity="0";const r=(void 0!==n?.marginBottom?n.marginBottom:this._defaults.marginBottom)||0;this._menuElm.style.minHeight=ue(n?.minHeight,""),void 0!==n?.height?this._menuElm.style.height=ue(n.height,""):this._menuElm.style.maxHeight=ue(n?.maxHeight,window.innerHeight-i.clientY-r+"px");let o="BUTTON"===e.target.nodeName?e.target:e.target.querySelector("button");o||(o=e.target.parentElement),this._menuElm.ariaExpanded="true",this._menuElm.appendChild(this._listElm),this.repositionMenu(e,this._menuElm,o,n),this._isMenuOpen=!0,this.pubSubService.publish("onGridMenuAfterMenuShow",s),"function"==typeof n?.onAfterMenuShow&&n.onAfterMenuShow(e,s),this.onAfterMenuShow.notify(s,null,this)}}translateGridMenu(){if(this.sharedService.gridOptions.gridMenu){this.sharedService.gridOptions.gridMenu.commandItems=[],this.sharedService.gridOptions.gridMenu.commandTitle="",this.sharedService.gridOptions.gridMenu.columnTitle="",this.sharedService.gridOptions.gridMenu.forceFitTitle="",this.sharedService.gridOptions.gridMenu.syncResizeTitle="";const e=this._userOriginalGridMenu&&Array.isArray(this._userOriginalGridMenu.commandItems)?this._userOriginalGridMenu.commandItems:[];this.sharedService.gridOptions.gridMenu.commandItems=[...e,...this.addGridMenuCustomCommands(e)],this.extensionUtility.translateMenuItemsFromTitleKey(this._addonOptions?.commandItems||[],"commandItems"),this.extensionUtility.sortItems(this.sharedService.gridOptions.gridMenu.commandItems,"positionOrder"),this.translateTitleLabels(this.sharedService.gridOptions.gridMenu),this.translateTitleLabels(this._addonOptions),this.extensionUtility.translateItems(this._columns,"nameKey","name")}}translateTitleLabels(e){e&&(e.commandTitle=this.extensionUtility.getPickerTitleOutputString("commandTitle","gridMenu"),e.columnTitle=this.extensionUtility.getPickerTitleOutputString("columnTitle","gridMenu"),e.forceFitTitle=this.extensionUtility.getPickerTitleOutputString("forceFitTitle","gridMenu"),e.syncResizeTitle=this.extensionUtility.getPickerTitleOutputString("syncResizeTitle","gridMenu"))}addGridMenuCustomCommands(e){const t=this.gridOptions.backendServiceApi||null,i=[],s=j(this.gridOptions),n=this._addonOptions?.commandLabels;if(this._addonOptions&&this.gridOptions){if(!this._addonOptions.hideClearFrozenColumnsCommand){const t="clear-pinning";e.some((e=>"divider"!==e&&e.hasOwnProperty("command")&&e.command===t))||i.push({iconCssClass:this._addonOptions.iconClearFrozenColumnsCommand||"mdi mdi-pin-off-outline",titleKey:`${s}${n?.clearFrozenColumnsCommandKey??"CLEAR_PINNING"}`,disabled:!1,command:t,positionOrder:52})}if(this.gridOptions.enableFiltering&&!this.sharedService.hideHeaderRowAfterPageLoad){if(!this._addonOptions.hideClearAllFiltersCommand){const t="clear-filter";e.some((e=>"divider"!==e&&e.hasOwnProperty("command")&&e.command===t))||i.push({iconCssClass:this._addonOptions.iconClearAllFiltersCommand||"mdi mdi-filter-remove-outline",titleKey:`${s}${n?.clearAllFiltersCommandKey??"CLEAR_ALL_FILTERS"}`,disabled:!1,command:t,positionOrder:50})}if(!this._addonOptions.hideToggleFilterCommand){const t="toggle-filter";e.some((e=>"divider"!==e&&e.hasOwnProperty("command")&&e.command===t))||i.push({iconCssClass:this._addonOptions.iconToggleFilterCommand||"mdi mdi-flip-vertical",titleKey:`${s}${n?.toggleFilterCommandKey??"TOGGLE_FILTER_ROW"}`,disabled:!1,command:t,positionOrder:53})}if(t&&!this._addonOptions.hideRefreshDatasetCommand){const t="refresh-dataset";e.some((e=>"divider"!==e&&e.hasOwnProperty("command")&&e.command===t))||i.push({iconCssClass:this._addonOptions.iconRefreshDatasetCommand||"mdi mdi-sync",titleKey:`${s}${n?.refreshDatasetCommandKey??"REFRESH_DATASET"}`,disabled:!1,command:t,positionOrder:58})}}if(!this._addonOptions.hideToggleDarkModeCommand){const t="toggle-dark-mode";e.some((e=>"divider"!==e&&e.hasOwnProperty("command")&&e.command===t))||i.push({iconCssClass:this._addonOptions.iconToggleDarkModeCommand||"mdi mdi-brightness-4",titleKey:`${s}${n?.toggleDarkModeCommandKey??"TOGGLE_DARK_MODE"}`,disabled:!1,command:t,positionOrder:54})}if(this.gridOptions.showPreHeaderPanel&&!this._addonOptions.hideTogglePreHeaderCommand){const t="toggle-preheader";e.some((e=>"divider"!==e&&e.hasOwnProperty("command")&&e.command===t))||i.push({iconCssClass:this._addonOptions.iconTogglePreHeaderCommand||"mdi mdi-flip-vertical",titleKey:`${s}${n?.togglePreHeaderCommandKey??"TOGGLE_PRE_HEADER_ROW"}`,disabled:!1,command:t,positionOrder:53})}if(this.gridOptions.enableSorting&&!this._addonOptions.hideClearAllSortingCommand){const t="clear-sorting";e.some((e=>"divider"!==e&&e.hasOwnProperty("command")&&e.command===t))||i.push({iconCssClass:this._addonOptions.iconClearAllSortingCommand||"mdi mdi-sort-variant-off",titleKey:`${s}${n?.clearAllSortingCommandKey??"CLEAR_ALL_SORTING"}`,disabled:!1,command:t,positionOrder:51})}if(this.gridOptions.enableTextExport&&!this._addonOptions.hideExportCsvCommand){const t="export-csv";e.some((e=>"divider"!==e&&e.hasOwnProperty("command")&&e.command===t))||i.push({iconCssClass:this._addonOptions.iconExportCsvCommand||"mdi mdi-download",titleKey:`${s}${n?.exportCsvCommandKey??"EXPORT_TO_CSV"}`,disabled:!1,command:t,positionOrder:55})}if(this.gridOptions.enableExcelExport&&!this._addonOptions.hideExportExcelCommand){const t="export-excel";e.some((e=>"divider"!==e&&e.hasOwnProperty("command")&&e.command===t))||i.push({iconCssClass:this._addonOptions.iconExportExcelCommand||"mdi mdi-file-excel-outline text-success",titleKey:`${s}${n?.exportExcelCommandKey??"EXPORT_TO_EXCEL"}`,disabled:!1,command:t,positionOrder:56})}if(this.gridOptions.enableTextExport&&!this._addonOptions.hideExportTextDelimitedCommand){const t="export-text-delimited";e.some((e=>"divider"!==e&&e.hasOwnProperty("command")&&e.command===t))||i.push({iconCssClass:this._addonOptions.iconExportTextDelimitedCommand||"mdi mdi-download",titleKey:`${s}${n?.exportTextDelimitedCommandKey??"EXPORT_TO_TAB_DELIMITED"}`,disabled:!1,command:t,positionOrder:57})}const r=this._addonOptions?.commandItems||[];(Array.isArray(i)&&i.length>0||Array.isArray(r)&&r.length>0)&&(this._addonOptions.commandTitle=this._addonOptions.commandTitle||this.extensionUtility.getPickerTitleOutputString("commandTitle","gridMenu"))}return i}executeGridMenuInternalCustomCommands(e,t){const i=this.sharedService?.externalRegisteredResources||[];if(t?.command)switch(t.command){case"clear-pinning":const e=[...this.sharedService.visibleColumns],t={frozenColumn:-1,frozenRow:-1,frozenBottom:!1,enableMouseWheelScrollHandler:!1};this.grid.setOptions(t),this.sharedService.gridOptions.frozenColumn=t.frozenColumn,this.sharedService.gridOptions.frozenRow=t.frozenRow,this.sharedService.gridOptions.frozenBottom=t.frozenBottom,this.sharedService.gridOptions.enableMouseWheelScrollHandler=t.enableMouseWheelScrollHandler,Array.isArray(e)&&this.grid.setColumns(e),this.gridOptions.enableAutoSizeColumns&&this.grid.autosizeColumns(),this.pubSubService.publish("onGridMenuClearAllPinning");break;case"clear-filter":this.filterService.clearFilters(),this.sharedService.dataView.refresh(),this.pubSubService.publish("onGridMenuClearAllFilters");break;case"clear-sorting":this.sortService.clearSorting(),this.sharedService.dataView.refresh(),this.pubSubService.publish("onGridMenuClearAllSorting");break;case"export-csv":const s=i.find((e=>"TextExportService"===e.className));s?.exportToFile?s.exportToFile({delimiter:w.comma,format:x.csv}):console.error("[Slickgrid-Universal] You must register the TextExportService to properly use Export to File in the Grid Menu. Example:: this.gridOptions = { enableTextExport: true, externalResources: [new TextExportService()] };");break;case"export-excel":const n=i.find((e=>"ExcelExportService"===e.className));n?.exportToExcel?n.exportToExcel():console.error("[Slickgrid-Universal] You must register the ExcelExportService to properly use Export to Excel in the Grid Menu. Example:: this.gridOptions = { enableExcelExport: true, externalResources: [new ExcelExportService()] };");break;case"export-text-delimited":const r=i.find((e=>"TextExportService"===e.className));r?.exportToFile?r.exportToFile({delimiter:w.tab,format:x.txt}):console.error("[Slickgrid-Universal] You must register the TextExportService to properly use Export to File in the Grid Menu. Example:: this.gridOptions = { enableTextExport: true, externalResources: [new TextExportService()] };");break;case"toggle-dark-mode":const o=this.sharedService.gridOptions.darkMode;this.grid.setOptions({darkMode:!o}),this.sharedService.gridOptions.darkMode=!o;break;case"toggle-filter":let a=this.gridOptions?.showHeaderRow??!1;a=!a,this.grid.setHeaderRowVisibility(a),!0===a&&(this.grid.setColumns(this.sharedService.columnDefinitions),this.grid.scrollColumnIntoView(0));break;case"toggle-preheader":const l=this.gridOptions?.showPreHeaderPanel??!1;this.grid.setPreHeaderPanelVisibility(!l);break;case"refresh-dataset":this.extensionUtility.refreshBackendDataset()}}getDefaultGridMenuOptions(){return{commandTitle:void 0,columnTitle:this.extensionUtility.getPickerTitleOutputString("columnTitle","gridMenu"),forceFitTitle:this.extensionUtility.getPickerTitleOutputString("forceFitTitle","gridMenu"),syncResizeTitle:this.extensionUtility.getPickerTitleOutputString("syncResizeTitle","gridMenu"),iconCssClass:"mdi mdi-menu",menuWidth:18,commandItems:[],hideClearAllFiltersCommand:!1,hideRefreshDatasetCommand:!1,hideToggleFilterCommand:!1}}handleBodyMouseDown(e){if(this.menuElement){let t=!1;const i=e.target.closest(`.${this.menuCssClass}`);(this.menuElement.contains(e.target)||i)&&(t=!0),(this._isMenuOpen&&this.menuElement!==e.target&&!t&&!e.defaultPrevented||"close"===e.target.className&&i)&&this.hideMenu(e)}}handleMenuItemCommandClick(e,t,i,s=0){if("divider"!==i&&!i.disabled&&!i.divider)if(i.command&&!i.commandItems){const t={grid:this.grid,command:i.command,item:i,allColumns:this.columns,visibleColumns:this.getVisibleColumns()};this.executeGridMenuInternalCustomCommands(e,t),this.pubSubService.publish("onGridMenuCommand",t),"function"==typeof this._addonOptions?.onCommand&&this._addonOptions.onCommand(e,t),this.onCommand.notify(t,null,this),"function"==typeof i.action&&i.action.call(this,e,t),this._addonOptions?.leaveOpen||e.defaultPrevented||this.hideMenu(e),e.preventDefault(),e.stopPropagation()}else i.commandItems&&this.repositionSubMenu(e,i,s)}handleMenuItemMouseOver(e,t,i,s=0){"divider"===i||i.disabled||i.divider||(i.commandItems?this.repositionSubMenu(e,i,s):0===s&&this.disposeSubMenus())}recreateCommandList(e,t,i,s){const n=i.level||0;if(e.length>0){const r=ie("div",{className:`${this._menuCssPrefix}-command-list`,role:"menu"},t);if(0===n){this.populateCommandOrOptionTitle("command",this.addonOptions,r,n);const e=t.querySelector(".slick-command-header")??ie("div",{className:"slick-command-header"});e.classList.add("with-close"),to.call(this,e),r.appendChild(e)}return s&&n>0&&this.addSubMenuTitleWhenExists(s,r),this.populateCommandOrOptionItems("command",this._addonOptions,r,e,i,this.handleMenuItemCommandClick,this.handleMenuItemMouseOver),r}return null}repositionSubMenu(e,t,i){const s=t?.commandItems||[],n=this.createCommandMenu(s,i+1,t);n.style.display="block",document.body.appendChild(n),this.repositionMenu(e,n)}}const Jr="mdi-icon-picker-check",eo="mdi-icon-picker-uncheck";function to(e){const t=ie("button",{type:"button",className:"close",ariaLabel:"Close",textContent:"Ã",dataset:{dismiss:this instanceof lo?"slick-column-picker":"slick-grid-menu"}});e.appendChild(t)}function io(e){const t=this;t.addonOptions?.columnTitle&&(t._columnTitleElm=ie("div",{className:"slick-menu-title",textContent:t.addonOptions?.columnTitle??t._defaults.columnTitle},e))}function so(e){const t=this,i=t instanceof lo?"columnPicker":"gridMenu",s=e.target?.closest(".icon-checkbox-container"),n=s?.querySelector(".mdi"),r=!!e.target.checked;if(e.target.ariaChecked=String(r),no(n,r),"autoresize"===e.target.dataset.option){const e=t.getVisibleColumns();return t.grid.setOptions({forceFitColumns:r}),void t.grid.setColumns(e)}if("syncresize"!==e.target.dataset.option){if("checkbox"===e.target.type){t._areVisibleColumnDifferent=!0;const s=e.target.dataset.columnid||"",o=[];if(t._columnCheckboxes.forEach(((e,i)=>{e.checked&&o.push(t.columns[i])})),!o.length)return e.target.checked=!0,void no(n,!0);if(t.grid.setColumns(o),(!t.sharedService.visibleColumns||Array.isArray(o)&&o.length!==t.sharedService.visibleColumns.length)&&(t.sharedService.visibleColumns=o),t.gridOptions.enableRowSelection&&r){const e=t.grid.getSelectedRows();t.grid.setSelectedRows(e)}const a=t.gridOptions.frozenColumn??-1;a>=0&&t.extensionUtility.readjustFrozenColumnIndexWhenNeeded(a,t.columns,o);const l={columnId:s,showing:r,allColumns:t.columns,visibleColumns:o,columns:o,grid:t.grid};t.pubSubService.publish(`on${je(i)}ColumnsChanged`,l),"function"==typeof t.addonOptions?.onColumnsChanged&&t.addonOptions.onColumnsChanged(e,l),t.onColumnsChanged.notify(l,null,t)}}else t.grid.setOptions({syncColumnCellResize:r})}function no(e,t=!1){e&&(e.className=`mdi ${t?Jr:eo}`)}function ro(e,t,i,s=!1){const n=ie("label",{className:"checkbox-picker-label",htmlFor:t}),r=ie("div",{className:"icon-checkbox-container"}),o=ie("input",{id:t,type:"checkbox",dataset:i}),a=ie("div",{className:`mdi ${s?Jr:eo}`}),l=ie("span",{className:"checkbox-label"});return r.appendChild(o),r.appendChild(a),n.appendChild(r),n.appendChild(l),e.appendChild(n),s&&(o.ariaChecked="true",o.checked=!0),{inputElm:o,labelElm:n,labelSpanElm:l}}function oo(e){const t=this,i=t instanceof Qr?"gridmenu-":"";for(const s of t.columns){const n=s.id,r=document.createElement("li");s.excludeFromColumnPicker&&(r.className="hidden");const o=`${t._gridUid}-${i}colpicker-${n}`,a=t.grid.getColumnIndex(n)>=0,{inputElm:l,labelElm:h,labelSpanElm:c}=ro(r,o,{columnid:`${n}`},a);t._columnCheckboxes.push(l);const d=("function"==typeof e?.headerColumnValueExtractor?e.headerColumnValueExtractor:t._defaults.headerColumnValueExtractor)(s,t.gridOptions);this.grid.applyHtmlCode(c,d),r.appendChild(h),t._listElm.appendChild(r)}if(e.hideForceFitButton&&e.hideSyncResizeButton||t._listElm.appendChild(document.createElement("hr")),!e?.hideForceFitButton){const s=document.createElement("li"),n=`${t._gridUid}-${i}colpicker-forcefit`,{labelSpanElm:r}=ro(s,n,{option:"autoresize"},t.gridOptions.forceFitColumns);r.textContent=e?.forceFitTitle??"",t._listElm.appendChild(s)}if(!e?.hideSyncResizeButton){const s=document.createElement("li"),n=`${t._gridUid}-${i}colpicker-syncresize`,{labelSpanElm:r}=ro(s,n,{option:"syncresize"},t.gridOptions.forceFitColumns);r.textContent=e?.syncResizeTitle??"",t._listElm.appendChild(s)}}function ao(){const e=this,t=e.grid.getColumns().slice(0),i=new Array(e.columns.length);for(let s=0;s<i.length;s++){const n=e.grid.getColumnIndex(e.columns[s].id);i[s]=void 0===n?e.columns[s]:t.shift()}e._columns=i}class lo{constructor(e,t,i){this.extensionUtility=e,this.pubSubService=t,this.sharedService=i,this._areVisibleColumnDifferent=!1,this._columns=[],this._gridUid="",this._menuElm=null,this._columnCheckboxes=[],this._defaults={hideForceFitButton:!1,hideSyncResizeButton:!1,forceFitTitle:"Force fit columns",minHeight:150,syncResizeTitle:"Synchronous resize",headerColumnValueExtractor:e=>oe(e.columnPickerLabel||e.name||"","innerHTML")},this._bindEventService=new Wt,this.onColumnsChanged=new ys("onColumnsChanged"),this._eventHandler=new Cs,this._columns=this.sharedService.allColumns??[],this._gridUid=this.grid?.getUID?.()??"",this.init()}get addonOptions(){return this.gridOptions.columnPicker||{}}get eventHandler(){return this._eventHandler}get columns(){return this._columns}set columns(e){this._columns=e}get gridOptions(){return this.sharedService.gridOptions??{}}get grid(){return this.sharedService.slickGrid}get menuElement(){return this._menuElm}init(){this._gridUid=this.grid.getUID()??"",this.gridOptions.columnPicker={...this._defaults,...this.gridOptions.columnPicker},this.onColumnsChanged.setPubSubService(this.pubSubService),this.addonOptions.columnTitle=this.extensionUtility.getPickerTitleOutputString("columnTitle","columnPicker"),this.addonOptions.forceFitTitle=this.extensionUtility.getPickerTitleOutputString("forceFitTitle","columnPicker"),this.addonOptions.syncResizeTitle=this.extensionUtility.getPickerTitleOutputString("syncResizeTitle","columnPicker"),this._eventHandler.subscribe(this.grid.onPreHeaderContextMenu,(e=>{["slick-column-name","slick-header-column"].some((t=>e.target?.classList.contains(t)))&&this.handleHeaderContextMenu(e)})),this._eventHandler.subscribe(this.grid.onHeaderContextMenu,this.handleHeaderContextMenu.bind(this)),this._eventHandler.subscribe(this.grid.onColumnsReordered,ao.bind(this)),this._eventHandler.subscribe(this.grid.onClick,this.disposeMenu.bind(this)),this._bindEventService.bind(document.body,"mousedown",this.handleBodyMouseDown.bind(this),void 0,"body"),this._bindEventService.bind(document.body,"beforeunload",this.dispose.bind(this),void 0,"body")}dispose(){this._eventHandler.unsubscribeAll(),this._bindEventService.unbindAll(),this.disposeMenu()}disposeMenu(){this._bindEventService.unbindAll("parent-menu"),this._listElm?.remove(),this._menuElm?.remove(),this._menuElm=null}createPickerMenu(){const e=ie("div",{ariaExpanded:"true",className:`slick-column-picker ${this._gridUid}`,role:"menu"});return ao.call(this),io.call(this,e),to.call(this,e),this._listElm=ie("div",{className:"slick-column-picker-list",role:"menu"}),this._bindEventService.bind(e,"click",so.bind(this),void 0,"parent-menu"),document.body.appendChild(e),e}getAllColumns(){return this._columns}getVisibleColumns(){return this.grid.getColumns()}translateColumnPicker(){this.addonOptions&&(this.addonOptions.columnTitle="",this.addonOptions.forceFitTitle="",this.addonOptions.syncResizeTitle="",this.addonOptions.columnTitle=this.extensionUtility.getPickerTitleOutputString("columnTitle","columnPicker"),this.addonOptions.forceFitTitle=this.extensionUtility.getPickerTitleOutputString("forceFitTitle","columnPicker"),this.addonOptions.syncResizeTitle=this.extensionUtility.getPickerTitleOutputString("syncResizeTitle","columnPicker")),this.extensionUtility.translateItems(this._columns,"nameKey","name"),this.translateTitleLabels(this.addonOptions)}handleBodyMouseDown(e){(this._menuElm!==e.target&&!this._menuElm?.contains(e.target)||"close"===e.target.className&&e.target.closest(".slick-column-picker"))&&this.disposeMenu()}handleHeaderContextMenu(e){e.preventDefault(),re(this._menuElm),this._columnCheckboxes=[],this._menuElm=this.createPickerMenu(),this.gridOptions.darkMode&&this._menuElm.classList.add("slick-dark-mode"),oo.call(this,this.addonOptions),document.body.appendChild(this._menuElm),this.repositionMenu(e)}repositionMenu(e){const t=e?.touches?.[0]??e;if(this._menuElm){const e=this.grid.getGridPosition(),i=this._menuElm.clientWidth||0;let s=t.pageX||0;e?.width&&s+i>=e.width&&(s-=i),this._menuElm.style.top=t.pageY-10+"px",this._menuElm.style.left=`${s}px`,this._menuElm.style.minHeight=ue(this.addonOptions.minHeight,""),this._menuElm.style.maxHeight=ue(this.addonOptions.maxHeight,window.innerHeight-t.clientY+"px"),this._menuElm.style.display="block",this._menuElm.ariaExpanded="true",this._menuElm.appendChild(this._listElm)}}translateTitleLabels(e){e&&(e.columnTitle=this.extensionUtility.getPickerTitleOutputString("columnTitle","gridMenu"))}}const ho=(e,t,i,s,n,r)=>{const o=s.params||{};if(!o.formatters||!Array.isArray(o.formatters))throw new Error('[Slickgrid-Universal] The multiple formatter requires the "formatters" to be provided as a column params.\n    For example: this.columnDefinitions = [{ id: title, field: title, formatter: Formatters.multiple, params: { formatters: [Formatters.lowercase, Formatters.uppercase] }');const a=o.formatters;let l=i;return a.forEach(((i,o)=>{if("function"!=typeof i)throw new Error(`[Slickgrid-Universal] the "params.formatters" at index(${o}) to be used by "Formatters.multiple" is invalid, please verify all formatter functions.`);l=i.call(void 0,e,t,l,s,n,r)})),l};function co(e,t){if(Array.isArray(e))for(const i of e)if(i.editor)if(i.formatter&&i.formatter!==ho&&i.formatter!==t){const e=i.formatter;i.formatter=ho,i.params={...i.params,formatters:[e,t]}}else i.formatter&&i.formatter===ho&&i.params?-1===i.params.formatters.findIndex((e=>e===t))&&(i.params.formatters=[...i.params.formatters,t]):i.formatter=t}function uo(e,t,i,s){let n,r,o="",a="";switch(i){case"currency":n=y.DEFAULT_FORMATTER_CURRENCY_MIN_DECIMAL,r=y.DEFAULT_FORMATTER_CURRENCY_MAX_DECIMAL;break;case"decimal":n=y.DEFAULT_FORMATTER_NUMBER_MIN_DECIMAL,r=y.DEFAULT_FORMATTER_NUMBER_MAX_DECIMAL;break;case"percent":n=y.DEFAULT_FORMATTER_PERCENT_MIN_DECIMAL,r=y.DEFAULT_FORMATTER_PERCENT_MAX_DECIMAL}const l=t&&"function"==typeof t.getOptions?t.getOptions():{},h=po("minDecimal",e,l,n),c=po("maxDecimal",e,l,r),d=po("decimalSeparator",e,l,y.DEFAULT_NUMBER_DECIMAL_SEPARATOR),u=po("thousandSeparator",e,l,y.DEFAULT_NUMBER_THOUSAND_SEPARATOR),p=po("displayNegativeNumberWithParentheses",e,l,y.DEFAULT_NEGATIVE_NUMBER_WRAPPED_IN_BRAQUET),m=po("currencyPrefix",e,l,""),f=po("currencySuffix",e,l,"");return"cell"===s&&(o=po("numberPrefix",e,l,""),a=po("numberSuffix",e,l,"")),{minDecimal:h,maxDecimal:c,decimalSeparator:d,thousandSeparator:u,wrapNegativeNumber:p,currencyPrefix:m,currencySuffix:f,numberPrefix:o,numberSuffix:a}}function po(e,t,i,s){const n=t&&t.params;return n&&n.hasOwnProperty(e)?n[e]:i?.formatterOptions?.hasOwnProperty(e)?i.formatterOptions[e]:s}function mo(e,t){const i=Lt(e,{withZeroPadding:!0});return(e,s,n,r,o,a)=>{const l=a&&"function"==typeof a.getOptions?a.getOptions():{},h=l?.formatterOptions?.dateSeparator??t,c=Lt(r?.type??E.date,{withDefaultIso8601:!0}),d=r?.params?.parseDateAsUtc??!1,u=Nt(n,c);let p=n;if(u){let e=u;d&&(e=At(m=u,Tt(m,"utc"))),p=Dt(e,i,"en-US")}var m;if(p&&h!==t){const e=new RegExp(t,"ig");p=p.replace(e,h)}return p}}function fo(e,t,i,s,n,r){let o="",a=s.field||s.id||"";if("string"==typeof s.field&&s.field.indexOf(".")>0){const e=s.field.split(".");a=e.length>0?e[0]:s.field}const l=n?.hasOwnProperty(a)?n[a]:null;if("function"==typeof e){const a=e(t,i,l,s,n,r);o=oe(He(a)?a:a.html||a.text)}else o=n?.hasOwnProperty(a)?l:"";return null==o&&(o=""),"object"!=typeof o||o instanceof Date||0!==Object.entries(o).length||(o=""),o}class go extends Wr{constructor(e,t,i,s){super(e,t,i),this.extensionUtility=e,this.pubSubService=t,this.sharedService=i,this.treeDataService=s,this._defaults={autoAdjustDrop:!0,autoAlignSide:!0,autoAdjustDropOffset:0,autoAlignSideOffset:0,hideMenuOnScroll:!1,optionShownOverColumnIds:[],commandShownOverColumnIds:[],subMenuOpenByEvent:"mouseover"},this.pluginName="ContextMenu",this._camelPluginName="contextMenu",this._menuCssPrefix="slick-menu",this._menuPluginCssPrefix="slick-context-menu",this.init(i.gridOptions.contextMenu)}init(e){this._addonOptions={...this._defaults,...e};const t=this._addonOptions&&Array.isArray(this._addonOptions.commandItems)?this._addonOptions.commandItems:[];this._addonOptions.commandItems=[...t,...this.addMenuCustomCommands(t)],this._addonOptions={...this._addonOptions},this.sharedService.gridOptions.contextMenu=this._addonOptions,this.sortMenuItems(),this._eventHandler.subscribe(this.grid.onContextMenu,this.handleOnContextMenu.bind(this)),this._eventHandler.subscribe(this.grid.onClick,this.hideMenu.bind(this)),this._addonOptions.hideMenuOnScroll&&this._eventHandler.subscribe(this.grid.onScroll,this.closeMenu.bind(this))}translateContextMenu(){const e=this.sharedService?.gridOptions??{},t=this.sharedService.gridOptions.contextMenu;if(t&&e?.enableTranslate){const e=t.commandItems||[],i=t.optionItems||[];t.commandTitleKey&&(t.commandTitle=this.extensionUtility.translateWhenEnabledAndServiceExist(t.commandTitleKey,"TEXT_COMMANDS")||t.commandTitle),t.optionTitleKey&&(t.optionTitle=this.extensionUtility.translateWhenEnabledAndServiceExist(t.optionTitleKey,"TEXT_COMMANDS")||t.optionTitle),this.extensionUtility.translateMenuItemsFromTitleKey(e,"commandItems"),this.extensionUtility.translateMenuItemsFromTitleKey(i,"optionItems")}}handleOnContextMenu(e,t){this.disposeAllMenus();const i=this.grid.getCellFromEvent(e);if(i){const s=this.grid.getDataItem(i.row),n=this.grid.getColumns()[i.cell],r=t||{};if(r.cell=i.cell,r.row=i.row,r.column=n,r.dataContext=s,r.grid=this.grid,!this.extensionUtility.runOverrideFunctionWhenExists(this._addonOptions.menuUsabilityOverride,r))return;this._menuElm=this.createParentMenu(e),this._menuElm&&e.preventDefault(),this._menuElm&&this.gridOptions.darkMode&&this._menuElm.classList.add("slick-dark-mode"),this._menuElm&&(this.repositionMenu(e,this._menuElm),this._menuElm.ariaExpanded="true",this._menuElm.style.display="block"),this._bindEventService.bind(document.body,"mousedown",this.handleBodyMouseDown.bind(this))}}addMenuCustomCommands(e){const t=[],i=this.sharedService&&this.sharedService.gridOptions||{},s=i?.contextMenu,n=this.sharedService?.dataView,r=j(i);if(s&&!s.hideCopyCellValueCommand){const i="copy";e.some((e=>"divider"!==e&&e.hasOwnProperty("command")&&e.command===i))||t.push({iconCssClass:s.iconCopyCellValueCommand||"mdi mdi-content-copy",titleKey:`${r}COPY`,disabled:!1,command:i,positionOrder:50,action:(e,t)=>{this.copyToClipboard(t)},itemUsabilityOverride:e=>{const t=e?.column,i=e?.dataContext;if("function"==typeof t.queryFieldNameGetterFn){const e=W(t,i,"");if(""!==e&&void 0!==e)return!0}else if(t&&i.hasOwnProperty(t.field))return""!==i[t.field]&&null!==i[t.field]&&void 0!==i[t.field];return!1}})}if(i?.enableTextExport&&s&&!s.hideExportCsvCommand){const i="export-csv";e.some((e=>"divider"!==e&&e.hasOwnProperty("command")&&e.command===i))||t.push({iconCssClass:s.iconExportCsvCommand||"mdi mdi-download",titleKey:`${r}EXPORT_TO_CSV`,disabled:!1,command:i,positionOrder:51,action:()=>{const e=(this.sharedService?.externalRegisteredResources||[]).find((e=>"TextExportService"===e.className));if(!e?.exportToFile)throw new Error("[Slickgrid-Universal] You must register the TextExportService to properly use Export to File in the Context Menu. Example:: this.gridOptions = { enableTextExport: true, externalResources: [new TextExportService()] };");e.exportToFile({delimiter:w.comma,format:x.csv})}})}if(i&&i.enableExcelExport&&s&&!s.hideExportExcelCommand){const i="export-excel";e.some((e=>"divider"!==e&&e.hasOwnProperty("command")&&e.command===i))||t.push({iconCssClass:s.iconExportExcelCommand||"mdi mdi-file-excel-outline text-success",titleKey:`${r}EXPORT_TO_EXCEL`,disabled:!1,command:i,positionOrder:52,action:()=>{const e=(this.sharedService?.externalRegisteredResources||[]).find((e=>"ExcelExportService"===e.className));if(!e?.exportToExcel)throw new Error("[Slickgrid-Universal] You must register the ExcelExportService to properly use Export to Excel in the Context Menu. Example:: this.gridOptions = { enableExcelExport: true, externalResources: [new ExcelExportService()] };");e.exportToExcel()}})}if(i?.enableTextExport&&s&&!s.hideExportTextDelimitedCommand){const i="export-text-delimited";e.some((e=>"divider"!==e&&e.hasOwnProperty("command")&&e.command===i))||t.push({iconCssClass:s.iconExportTextDelimitedCommand||"mdi mdi-download",titleKey:`${r}EXPORT_TO_TAB_DELIMITED`,disabled:!1,command:i,positionOrder:53,action:()=>{const e=(this.sharedService?.externalRegisteredResources||[]).find((e=>"TextExportService"===e.className));if(!e?.exportToFile)throw new Error("[Slickgrid-Universal] You must register the TextExportService to properly use Export to File in the Context Menu. Example:: this.gridOptions = { enableTextExport: true, externalResources: [new TextExportService()] };");e.exportToFile({delimiter:w.tab,format:x.txt})}})}if(i&&(i.enableGrouping||i.enableDraggableGrouping||i.enableTreeData)){if(s&&!s.hideCopyCellValueCommand&&t.push({divider:!0,command:"",positionOrder:54}),i&&!i.enableTreeData&&s&&!s.hideClearAllGrouping){const i="clear-grouping";e.some((e=>"divider"!==e&&e.hasOwnProperty("command")&&e.command===i))||t.push({iconCssClass:s.iconClearGroupingCommand||"mdi mdi-close",titleKey:`${r}CLEAR_ALL_GROUPING`,disabled:!1,command:i,positionOrder:55,action:()=>{n.setGrouping([]),this.pubSubService.publish("onContextMenuClearGrouping")},itemUsabilityOverride:()=>{const e=n&&n.getGrouping&&n.getGrouping();return Array.isArray(e)&&e.length>0}})}if(i&&s&&!s.hideCollapseAllGroups){const o="collapse-all-groups";e.some((e=>"divider"!==e&&e.hasOwnProperty("command")&&e.command===o))||t.push({iconCssClass:s.iconCollapseAllGroupsCommand||"mdi mdi-arrow-collapse",titleKey:`${r}COLLAPSE_ALL_GROUPS`,disabled:!1,command:o,positionOrder:56,action:()=>{i.enableTreeData?this.treeDataService.toggleTreeDataCollapse(!0):n.collapseAllGroups(),this.pubSubService.publish("onContextMenuCollapseAllGroups")},itemUsabilityOverride:()=>{if(i.enableTreeData)return!0;const e=n&&n.getGrouping&&n.getGrouping();return Array.isArray(e)&&e.length>0}})}if(i&&s&&!s.hideExpandAllGroups){const o="expand-all-groups";e.some((e=>"divider"!==e&&e.hasOwnProperty("command")&&e.command===o))||t.push({iconCssClass:s.iconExpandAllGroupsCommand||"mdi mdi-arrow-expand",titleKey:`${r}EXPAND_ALL_GROUPS`,disabled:!1,command:o,positionOrder:57,action:()=>{i.enableTreeData?this.treeDataService.toggleTreeDataCollapse(!1):n.expandAllGroups(),this.pubSubService.publish("onContextMenuExpandAllGroups")},itemUsabilityOverride:()=>{if(i.enableTreeData)return!0;const e=n&&n.getGrouping&&n.getGrouping();return Array.isArray(e)&&e.length>0}})}}return this.extensionUtility.translateMenuItemsFromTitleKey(t),t}copyToClipboard(e){try{if(e&&e.grid&&e.command){const t=this.sharedService?.gridOptions??{},i=e?.cell??0,s=e?.row??0,n=e?.column,r=e?.dataContext,o=this.sharedService?.slickGrid;let a=function(e,t,i,s,n,r){let o,a=!1;i?.hasOwnProperty("exportWithFormatter")?a=!!i.exportWithFormatter:r?.hasOwnProperty("exportWithFormatter")&&(a=!!r.exportWithFormatter),s&&i.exportCustomFormatter?o=i.exportCustomFormatter:a&&i.formatter&&(o=i.formatter);const l=fo(o,e,t,i,s,n);return r?.sanitizeDataExport&&"string"==typeof l?st(l):l}(s,i,n,r,o,t&&(t.excelExportOptions||t.textExportOptions));"function"==typeof n.queryFieldNameGetterFn&&(a=W(n,r,""));let l=a;"string"==typeof a&&(l=a.replace(/^([Â·|â®|â®]\s*)|([Â·|â®|â®])\s*/gi,"").replace(/[\u00b7|\u034f]/gi,"").trim());const h=document.createElement("textarea");h&&document.body&&(h.style.position="absolute",h.style.opacity="0",h.value=l,document.body.appendChild(h),h.select(),document.execCommand("copy",!1,l)&&h.remove())}}catch(e){}}sortMenuItems(){const e=this.sharedService?.gridOptions?.contextMenu;e&&(this.extensionUtility.sortItems(e.commandItems||[],"positionOrder"),this.extensionUtility.sortItems(e.optionItems||[],"positionOrder"))}}class _o{constructor(e,t,i){this.extensionUtility=e,this.pubSubService=t,this.sharedService=i,this.columnsGroupBy=[],this.pluginName="DraggableGrouping",this._gridColumns=[],this._gridUid="",this._reorderedColumns=[],this._subscriptions=[],this._defaults={dropPlaceHolderText:"Drop a column header here to group by the column",hideGroupSortIcons:!1,hideToggleAllButton:!1,toggleAllButtonText:"",toggleAllPlaceholderText:"Toggle all Groups"},this._bindingEventService=new Wt,this.onGroupChanged=new ys("onGroupChanged"),this._eventHandler=new Cs}get addonOptions(){return this._addonOptions}get dataView(){return this.grid?.getData()??{}}get dropboxElement(){return this._dropzoneElm}get droppableInstance(){return this._droppableInstance}get sortableLeftInstance(){return this._sortableLeftInstance}get sortableRightInstance(){return this._sortableRightInstance}get eventHandler(){return this._eventHandler}get grid(){return this._grid??this.sharedService.slickGrid??{}}get gridOptions(){return this.sharedService.gridOptions??{}}get gridUid(){return this._gridUid||(this.grid?.getUID()??"")}get gridContainer(){return this.grid.getContainerNode()}init(e,t){if(this._addonOptions={...this._defaults,...t},this._grid=e,e){if(this._gridUid=e.getUID(),this._gridColumns=e.getColumns(),this._dropzoneElm=e.getTopHeaderPanel()||e.getPreHeaderPanel(),this._dropzoneElm.classList.add("slick-dropzone"),this.onGroupChanged.setPubSubService(this.pubSubService),!this._addonOptions.hideToggleAllButton){this._groupToggler=ie("div",{className:"slick-group-toggle-all",title:this._addonOptions.toggleAllPlaceholderText??"",style:{display:"none"}});const e=ie("span",{className:"slick-group-toggle-all-icon"},this._groupToggler);this.gridOptions.enableTranslate&&this._addonOptions.toggleAllButtonTextKey&&(this._addonOptions.toggleAllButtonText=this.extensionUtility.translateWhenEnabledAndServiceExist(this._addonOptions.toggleAllButtonTextKey,"TEXT_TOGGLE_ALL_GROUPS")),this.gridOptions.enableTranslate&&this._addonOptions.toggleAllPlaceholderTextKey&&(this._addonOptions.toggleAllPlaceholderText=this.extensionUtility.translateWhenEnabledAndServiceExist(this._addonOptions.toggleAllPlaceholderTextKey,"TEXT_TOGGLE_ALL_GROUPS")),this._groupToggler.title=this._addonOptions.toggleAllPlaceholderText??"",this._addonOptions.toggleAllButtonText&&this._groupToggler.appendChild(ie("span",{className:"slick-group-toggle-all-text",textContent:this._addonOptions.toggleAllButtonText||""})),this._dropzoneElm.appendChild(this._groupToggler),this._subscriptions.push(this.pubSubService.subscribe("onContextMenuCollapseAllGroups",(()=>this.toggleGroupToggler(e,!0,!1))),this.pubSubService.subscribe("onContextMenuExpandAllGroups",(()=>this.toggleGroupToggler(e,!1,!1))))}this._dropzonePlaceholderElm=ie("div",{className:"slick-draggable-dropzone-placeholder"},this._dropzoneElm),this.gridOptions.enableTranslate&&this._addonOptions?.dropPlaceHolderTextKey&&(this._addonOptions.dropPlaceHolderText=this.extensionUtility.translateWhenEnabledAndServiceExist(this._addonOptions.dropPlaceHolderTextKey,"TEXT_TOGGLE_ALL_GROUPS")),this._dropzonePlaceholderElm.textContent=this._addonOptions?.dropPlaceHolderText??this._defaults.dropPlaceHolderText??"",this.setupColumnDropbox(),this._eventHandler.subscribe(e.onHeaderCellRendered,((e,t)=>{const i=t.node;if(!Le(t.column?.grouping)&&i&&(i.style.cursor="pointer",this._addonOptions.groupIconCssClass)){const e=ie("span",{className:"slick-column-groupable"},i);this._addonOptions.groupIconCssClass&&e.classList.add(...se(this._addonOptions.groupIconCssClass))}})),this._subscriptions.push(this.pubSubService.subscribe("onContextMenuClearGrouping",(()=>this.clearDroppedGroups())));for(const t of this._gridColumns){const i=t.field;e.updateColumnHeader(i)}}return this}dispose(){this.destroySortableInstances(),this._droppableInstance?.el&&this._droppableInstance?.destroy(),this.onGroupChanged.unsubscribe(),this._eventHandler.unsubscribeAll(),this.pubSubService.unsubscribeAll(this._subscriptions),this._bindingEventService.unbindAll(),re(this.gridContainer.querySelector(`.${this.gridUid} .slick-preheader-panel,.${this.gridUid} .slick-topheader-panel`))}clearDroppedGroups(){this.columnsGroupBy=[],this.updateGroupBy("clear-all");const e=this._dropzoneElm.querySelectorAll(".slick-dropped-grouping");for(const t of Array.from(e)){const e=this._dropzoneElm.querySelector(".slick-groupby-remove");e?.remove(),t?.remove()}this._dropzonePlaceholderElm.style.display="inline-block",this._groupToggler&&(this._groupToggler.style.display="none")}destroySortableInstances(){this._sortableLeftInstance?.el&&this._sortableLeftInstance?.destroy(),this._sortableRightInstance?.el&&this._sortableRightInstance?.destroy()}setAddonOptions(e){this._addonOptions={...this._addonOptions,...e}}setColumns(e){this._gridColumns=e}setDroppedGroups(e){this._dropzonePlaceholderElm.style.display="none";const t=Array.isArray(e)?e:[e];for(const e of t){const t=this.grid.getHeaderColumn(e);this.handleGroupByDrop(this._dropzoneElm,t)}}setupColumnReorder(e,t,i,s,n,r,o,a,l){this.destroySortableInstances();const h=e.getTopHeaderPanel()||e.getPreHeaderPanel(),c=h.querySelector(".slick-draggable-dropzone-placeholder"),d=h.querySelector(".slick-group-toggle-all"),u={animation:50,chosenClass:"slick-header-column-active",ghostClass:"slick-sortable-placeholder",draggable:".slick-header-column",dataIdAttr:"data-id",group:{name:"shared",pull:"clone",put:!1},revertClone:!0,onStart:()=>{c&&(c.style.display="inline-block"),h.querySelectorAll(".slick-dropped-grouping").forEach((e=>e.style.display="none")),d&&(d.style.display="none")},onEnd:i=>{h?.classList.remove("slick-dropzone-hover"),c?.parentElement?.classList.remove("slick-dropzone-placeholder-hover");const r=h.querySelectorAll(".slick-dropped-grouping");if(r.forEach((e=>e.style.display="flex")),r.length&&(c&&(c.style.display="none"),d&&(d.style.display="inline-flex")),!e.getEditorLock().commitCurrentEdit())return;const a=this.sortableLeftInstance?.toArray()??[];if(t.length>1){const e=this._sortableRightInstance?.toArray()??[];for(const t of e)a.push(t)}const u=[],p=e.getColumns();for(const t of a)u.push(p[o.call(e,t)]);s.call(e,u),l.call(e,e.onColumnsReordered,{grid:e,impactedColumns:u}),i.stopPropagation(),n.call(e)}};return this._sortableLeftInstance=Rr.create(this.gridContainer.querySelector(`.${e.getUID()} .slick-header-columns.slick-header-columns-left`),u),this._sortableRightInstance=Rr.create(this.gridContainer.querySelector(`.${e.getUID()} .slick-header-columns.slick-header-columns-right`),u),{sortableLeftInstance:this._sortableLeftInstance,sortableRightInstance:this._sortableRightInstance}}addColumnGroupBy(e){this.columnsGroupBy.push(e),this.updateGroupBy("add-group")}addGroupByRemoveClickHandler(e,t,i,s){this._bindingEventService.bind(t,"click",(()=>{const n=this._bindingEventService.boundedEvents.filter((e=>e.element===t));for(const e of n)this._bindingEventService.unbind(e.element,"click",e.listener);this.removeGroupBy(e,i,s)}))}addGroupSortClickHandler(e,t){const{grouping:i,type:s}=e;this._bindingEventService.bind(t,"click",(()=>{if(this.toggleGroupAll(e,!1),i){const n=i.sortAsc?A.desc:A.asc;i.comparer=(t,i)=>Ht(s||"text",t.value,i.value,n,e,this.gridOptions),this.getGroupBySortIcon(t,!i.sortAsc),this.updateGroupBy("sort-group"),i.sortAsc=!i.sortAsc,this.grid.invalidate()}}))}getGroupBySortIcon(e,t=!0){t?this._addonOptions.sortAscIconCssClass?(e.classList.remove(...se(this._addonOptions.sortDescIconCssClass)),e.classList.add(...se(this._addonOptions.sortAscIconCssClass))):(e.classList.add("slick-groupby-sort-asc-icon"),e.classList.remove("slick-groupby-sort-desc-icon")):this._addonOptions.sortDescIconCssClass?(e.classList.remove(...se(this._addonOptions.sortAscIconCssClass)),e.classList.add(...se(this._addonOptions.sortDescIconCssClass))):this._addonOptions.sortDescIconCssClass||(e.classList.add("slick-groupby-sort-desc-icon"),e.classList.remove("slick-groupby-sort-asc-icon"))}handleGroupByDrop(e,t){const i=t.getAttribute("data-id")?.replace(this._gridUid,"");let s=!0;for(const e of this.columnsGroupBy)e.id===i&&(s=!1);if(s){for(const s of this._gridColumns)if(s.id===i&&s.grouping&&!Le(s.grouping)){const i=t.querySelector(".slick-column-name"),n=ie("div",{id:`${this._gridUid}_${s.id}_entry`,className:"slick-dropped-grouping",dataset:{id:`${s.id}`}});ie("div",{className:"slick-dropped-grouping-title",style:{display:"inline-flex"},textContent:i?i.textContent:t.textContent},n);const r=ie("div",{className:"slick-groupby-remove"});let o;this._addonOptions.deleteIconCssClass&&r.classList.add(...se(this._addonOptions.deleteIconCssClass)),this._addonOptions.deleteIconCssClass||r.classList.add("slick-groupby-remove-icon"),!0!==this._addonOptions?.hideGroupSortIcons&&s.sortable&&(void 0===s.grouping?.sortAsc&&(s.grouping.sortAsc=!0),o=ie("div",{className:"slick-groupby-sort"},n),this.getGroupBySortIcon(o,s.grouping.sortAsc)),n.appendChild(r),n.appendChild(document.createElement("div")),e.appendChild(n),this._groupToggler&&0===this.columnsGroupBy.length&&this.toggleGroupAll(s),this.addColumnGroupBy(s),this.addGroupByRemoveClickHandler(s.id,r,t,n),o&&this.addGroupSortClickHandler(s,o)}this._groupToggler&&this.columnsGroupBy.length>0&&(this._groupToggler.style.display="inline-flex")}}toggleGroupAll({grouping:e},t){const i=this._groupToggler?.querySelector(".slick-group-toggle-all-icon");!0===t||e?.collapsed?(i?.classList.add("collapsed"),i?.classList.remove("expanded")):(i?.classList.add("expanded"),i?.classList.remove("collapsed"))}removeFromArray(e,t){if(Array.isArray(e)){const i=e.findIndex((e=>e.id===t.id));i>=0&&e.splice(i,1)}return e}removeGroupBy(e,t,i){i.remove();const s=[];this._gridColumns.forEach((e=>s[e.id]=e)),this.removeFromArray(this.columnsGroupBy,s[e]),0===this.columnsGroupBy.length&&(this._dropzonePlaceholderElm.style.display="inline-block",this._groupToggler&&(this._groupToggler.style.display="none")),this.updateGroupBy("remove-group")}addDragOverDropzoneListeners(){const e=this._dropzoneElm.querySelector(".slick-draggable-dropzone-placeholder");e&&this._dropzoneElm&&(this._bindingEventService.bind(e,"dragover",(e=>e.preventDefault())),this._bindingEventService.bind(e,"dragenter",(()=>this._dropzoneElm.classList.add("slick-dropzone-hover"))),this._bindingEventService.bind(e,"dragleave",(()=>this._dropzoneElm.classList.remove("slick-dropzone-hover"))))}setupColumnDropbox(){const e=this._dropzoneElm;this._droppableInstance=Rr.create(e,{group:"shared",ghostClass:"slick-droppable-sortitem-hover",draggable:".slick-dropped-grouping",dragoverBubble:!0,onAdd:t=>{const i=t.item;i.getAttribute("id")?.replace(this._gridUid,"")&&this.handleGroupByDrop(e,Rr.utils.clone(t.item)),i.parentNode?.removeChild(i)},onUpdate:()=>{const e=this._droppableInstance?.toArray()??[],t=[];for(const i of e)for(const e of this.columnsGroupBy)if(e.id===i){t.push(e);break}this.columnsGroupBy=t,this.updateGroupBy("sort-group")}}),this.addDragOverDropzoneListeners(),this._groupToggler&&this._bindingEventService.bind(this._groupToggler,"click",(e=>{const t=e.target.classList.contains("slick-group-toggle-all-icon")?e.target:e.currentTarget.querySelector(".slick-group-toggle-all-icon");this.toggleGroupToggler(t,t?.classList.contains("expanded"))}))}toggleGroupToggler(e,t=!0,i=!0){e&&(!0===t?(e.classList.add("collapsed"),e.classList.remove("expanded"),i&&this.dataView.collapseAllGroups()):(e.classList.remove("collapsed"),e.classList.add("expanded"),i&&this.dataView.expandAllGroups()))}updateGroupBy(e){if(0===this.columnsGroupBy.length)return this.dataView.setGrouping([]),this._dropzonePlaceholderElm.style.display="inline-block",void this.triggerOnGroupChangedEvent({caller:e,groupColumns:[]});const t=[];this.columnsGroupBy.forEach((e=>t.push(e.grouping))),this.dataView.setGrouping(t),this._dropzonePlaceholderElm.style.display="none",this.triggerOnGroupChangedEvent({caller:e,groupColumns:t})}triggerOnGroupChangedEvent(e){this._addonOptions&&"function"==typeof this._addonOptions.onGroupChanged&&this._addonOptions.onGroupChanged(new bs,e),this.onGroupChanged.notify(e)}}class vo extends Vr{constructor(e,t,i){super(e,t,i),this.extensionUtility=e,this.pubSubService=t,this.sharedService=i,this._buttonElms=[],this._defaults={buttonCssClass:"slick-header-button"},this.pluginName="HeaderButtons",this._menuCssPrefix="slick-header-button",this._camelPluginName="headerButtons",this._bindEventService=new Wt,this._eventHandler=new Cs,this.init(i.gridOptions.headerButton)}get addonOptions(){return this._addonOptions}set addonOptions(e){this._addonOptions=e}get eventHandler(){return this._eventHandler}get grid(){return this.sharedService.slickGrid}init(e){this._addonOptions={...this._defaults,...e},this._eventHandler.subscribe(this.grid.onHeaderCellRendered,this.handleHeaderCellRendered.bind(this)),this._eventHandler.subscribe(this.grid.onBeforeHeaderCellDestroy,this.handleBeforeHeaderCellDestroy.bind(this)),this.grid.setColumns(this.grid.getColumns())}dispose(){super.dispose(),this._buttonElms.forEach((e=>e.remove()))}handleHeaderCellRendered(e,t){const i=t.column;if(i.header?.buttons&&Array.isArray(i.header.buttons)){let e=i.header.buttons.length;for(;e--;){const s=i.header.buttons[e],n=this.populateSingleCommandOrOptionItem("command",this.addonOptions,null,s,t,this.handleButtonClick.bind(this));n&&s.handler&&!s.disabled&&this._bindEventService.bind(n,"click",(e=>s.handler.call(this,e))),n&&(this._buttonElms.push(n),t.node.appendChild(n))}}}handleBeforeHeaderCellDestroy(e,t){const i=t.column;if(i.header?.buttons&&this._addonOptions?.buttonCssClass){const e=(this._addonOptions?.buttonCssClass||"").replace(/(\s+)/g,".");e&&t.node.querySelectorAll(`.${e}`).forEach((e=>e.remove()))}}handleButtonClick(e,t,i,s,n){if(i.command&&!i.disabled){const t=i.command||"",s={grid:this.grid,column:n,button:i};t&&(s.command=t),"function"!=typeof i.action||i.disabled||i.action.call(this,e,s),null!==t&&!i.disabled&&this._addonOptions?.onCommand&&(this.pubSubService.publish("onHeaderButtonCommand",s),this._addonOptions.onCommand(e,s),n?.id&&this.grid.updateColumnHeader(n.id))}e.preventDefault(),e.stopPropagation()}}class bo extends Vr{constructor(e,t,i,s,n){super(e,i,s),this.extensionUtility=e,this.filterService=t,this.pubSubService=i,this.sharedService=s,this.sortService=n,this._subMenuParentId="",this._defaults={autoAlign:!0,autoAlignOffset:0,buttonCssClass:null,buttonImage:null,minWidth:100,hideColumnHideCommand:!1,hideSortCommands:!1,title:"",subMenuOpenByEvent:"mouseover"},this.pluginName="HeaderMenu",this._menuCssPrefix="slick-menu",this._menuPluginCssPrefix="slick-header-menu",this._camelPluginName="headerMenu",this.sharedService.gridOptions.headerMenu=this.addHeaderMenuCustomCommands(this.sharedService.columnDefinitions),this.init(s.gridOptions.headerMenu)}init(e){this._addonOptions={...this._defaults,...e},this._eventHandler.subscribe(this.grid.onBeforeSetColumns,((e,t)=>{this.sharedService.gridOptions.headerMenu=this.addHeaderMenuCustomCommands(t.newColumns)})),this._eventHandler.subscribe(this.grid.onHeaderCellRendered,this.handleHeaderCellRendered.bind(this)),this._eventHandler.subscribe(this.grid.onBeforeHeaderCellDestroy,this.handleBeforeHeaderCellDestroy.bind(this)),this._eventHandler.subscribe(this.grid.onClick,this.hideMenu.bind(this)),this.grid.setColumns(this.grid.getColumns()),this._bindEventService.bind(document.body,"mousedown",this.handleBodyMouseDown.bind(this))}dispose(){super.dispose(),this._menuElm=this._menuElm||document.body.querySelector(`.slick-header-menu${this.gridUidSelector}`),this._menuElm?.remove(),this._activeHeaderColumnElm=void 0}hideColumn(e){if(this.sharedService?.slickGrid?.getColumnIndex){const t=this.sharedService.slickGrid.getColumnIndex(e.id),i=this.sharedService.slickGrid.getColumns(),s=this.sharedService.gridOptions.frozenColumn??-1;s>=0&&s>=t&&(this.sharedService.gridOptions.frozenColumn=s-1,this.sharedService.slickGrid.setOptions({frozenColumn:this.sharedService.gridOptions.frozenColumn}));const n=Ie(i,t);this.sharedService.visibleColumns=n,this.sharedService.slickGrid.setColumns(n),this.pubSubService.publish("onHeaderMenuHideColumns",{columns:n,hiddenColumn:e})}}hideMenu(){this.disposeSubMenus(),this._menuElm?.remove(),this._menuElm=void 0}repositionSubMenu(e,t,i,s){const n=this.createCommandMenu(t.commandItems||[],s,i+1,t);document.body.appendChild(n),this.repositionMenu(e,n)}repositionMenu(e,t){const i=e.target,s=t.classList.contains("slick-submenu"),n=s?e.target.closest(".slick-menu-item"):i,r=ae(this.sharedService.gridContainerElement,i),o=this.grid.getGridPosition(),a=t.offsetWidth,l=le(n);let h=s?l.left:r?.left??0,c=s?l.top:(r?.top??0)+(this.addonOptions?.menuOffsetTop??0)+i.clientHeight;if(s){const e=t?.clientHeight||0,{bottom:i,top:s}=te(n);"top"==(i<e&&s>i?"top":"bottom")?(t.classList.remove("dropdown"),t.classList.add("dropup"),c-=e-n.clientHeight):(t.classList.remove("dropup"),t.classList.add("dropdown"))}if(s&&n){const e=h+Number(a)+n.clientWidth,i=document.documentElement.clientWidth;"left"==(e>=o.width||e>=i?"left":"right")?(t.classList.remove("dropright"),t.classList.add("dropleft"),h-=a):(t.classList.remove("dropleft"),t.classList.add("dropright"),h+=n.offsetWidth)}else h=r?.left??0,this.addonOptions.autoAlign&&o?.width&&h+(t.clientWidth??0)>=o.width&&(h=h+i.clientWidth-t.clientWidth+(this.addonOptions?.autoAlignOffset||0));t.style.top=`${c}px`,t.style.left=`${h}px`}translateHeaderMenu(){this.sharedService.gridOptions?.headerMenu&&this.resetHeaderMenuTranslations(this.sharedService.visibleColumns)}handleHeaderCellRendered(e,t){const i=t.column,s=i.header?.menu;if(s&&t.node){if(!this.extensionUtility.runOverrideFunctionWhenExists(this.addonOptions.menuUsabilityOverride,t))return;const e=ie("div",{className:"slick-header-menu-button",ariaLabel:"Header Menu"},t.node);this.addonOptions.buttonCssClass&&e.classList.add(...se(this.addonOptions.buttonCssClass)),this.addonOptions.tooltip&&(e.title=this.addonOptions.tooltip),this._bindEventService.bind(e,"click",(e=>{this.disposeAllMenus(),this.createParentMenu(e,t.column,s)}))}}handleBeforeHeaderCellDestroy(e,t){const i=t.column;i.header?.menu&&t.node.querySelectorAll(".slick-header-menu-button").forEach((e=>e.remove()))}handleBodyMouseDown(e){if(this.menuElement){let t=!1;const i=e.target.closest(`.${this.menuCssClass}`);(this.menuElement.contains(e.target)||i)&&(t=!0),(this._menuElm!==e.target&&!t&&!e.defaultPrevented||"close"===e.target.className&&i)&&this.hideMenu()}}handleMenuItemCommandClick(e,t,i,s=0,n){if("divider"!==i&&!i.disabled&&!i.divider)if(i.command&&!i.commandItems){const t={grid:this.grid,command:i.command,column:n,item:i};this.executeHeaderMenuInternalCommands(e,t),this.pubSubService.publish("onHeaderMenuCommand",t),"function"==typeof this.addonOptions?.onCommand&&this.addonOptions.onCommand(e,t),"function"==typeof i.action&&i.action.call(this,e,t),e.defaultPrevented||this.hideMenu(),e.preventDefault(),e.stopPropagation()}else i.commandItems&&this.repositionSubMenu(e,i,s,n)}handleMenuItemMouseOver(e,t,i,s=0,n){"divider"===i||i.disabled||i.divider||(i.commandItems?this.repositionSubMenu(e,i,s,n):0===s&&this.disposeSubMenus())}addHeaderMenuCustomCommands(e){const t=this.sharedService.gridOptions,i=t.headerMenu||{},s=j(t);return Array.isArray(e)&&t.enableHeaderMenu&&e.forEach((e=>{if(e&&!e.excludeFromHeaderMenu){e.header?e.header.menu||(e.header.menu={commandItems:[]}):e.header={menu:{commandItems:[]}};const n=e?.header?.menu?.commandItems??[];let r=!1;if(i&&!i.hideFreezeColumnsCommand&&(r=!0,n.some((e=>"divider"!==e&&"freeze-columns"===e?.command))||n.push({iconCssClass:i.iconFreezeColumns||"mdi mdi-pin-outline",titleKey:`${s}FREEZE_COLUMNS`,command:"freeze-columns",positionOrder:45})),i&&!i.hideColumnResizeByContentCommand&&this.sharedService.gridOptions.enableColumnResizeOnDoubleClick&&(r=!0,n.some((e=>"divider"!==e&&"column-resize-by-content"===e?.command))||n.push({iconCssClass:i.iconColumnResizeByContentCommand||"mdi mdi-arrow-expand-horizontal",titleKey:`${s}COLUMN_RESIZE_BY_CONTENT`,command:"column-resize-by-content",positionOrder:47})),r&&!n.some((e=>"divider"!==e&&48===e.positionOrder))&&n.push({divider:!0,command:"",positionOrder:48}),t.enableSorting&&e.sortable&&i&&!i.hideSortCommands&&(n.some((e=>"divider"!==e&&"sort-asc"===e?.command))||n.push({iconCssClass:i.iconSortAscCommand||"mdi mdi-sort-ascending",titleKey:`${s}SORT_ASCENDING`,command:"sort-asc",positionOrder:50}),n.some((e=>"divider"!==e&&"sort-desc"===e?.command))||n.push({iconCssClass:i.iconSortDescCommand||"mdi mdi-sort-descending",titleKey:`${s}SORT_DESCENDING`,command:"sort-desc",positionOrder:51}),n.some((e=>"divider"!==e&&52===e.positionOrder))||n.push({divider:!0,command:"",positionOrder:52}),i.hideClearSortCommand||n.some((e=>"divider"!==e&&"clear-sort"===e?.command))||n.push({iconCssClass:i.iconClearSortCommand||"mdi mdi-sort-variant-off",titleKey:`${s}REMOVE_SORT`,command:"clear-sort",positionOrder:58})),e.filter?.filterShortcuts&&!n.some((e=>"divider"!==e&&"filter-shortcuts-root-menu"===e?.command))){const t=[];e.filter.filterShortcuts.forEach((e=>{const i=e.title?qe(e.title):(e.titleKey||"").toLowerCase().replaceAll("_","-");t.push({...e,command:i,action:(t,i)=>{const s=this.filterService.getFiltersMetadata().find((e=>e.columnDef.id===i.column.id));s?.setValues(e.searchTerms,e.operator,!0)}})}));const o=i.filterShortcutsPositionOrder??55;n.push({iconCssClass:i.iconFilterShortcutSubMenu||"mdi mdi-filter-outline",titleKey:`${s}FILTER_SHORTCUTS`,command:"filter-shortcuts-root-menu",positionOrder:o,commandItems:t}),r&&!n.some((e=>"divider"!==e&&e.positionOrder===o+1))&&n.push({divider:!0,command:"",positionOrder:o+1})}t.enableFiltering&&e.filterable&&i&&!i.hideFilterCommand&&(i.hideClearFilterCommand||n.some((e=>"divider"!==e&&"clear-filter"===e?.command))||n.push({iconCssClass:i.iconClearFilterCommand||"mdi mdi-filter-remove-outline",titleKey:`${s}REMOVE_FILTER`,command:"clear-filter",positionOrder:57})),!i||i.hideColumnHideCommand||n.some((e=>"divider"!==e&&"hide-column"===e?.command))||n.push({iconCssClass:i.iconColumnHideCommand||"mdi mdi-close",titleKey:`${s}HIDE_COLUMN`,command:"hide-column",positionOrder:59}),this.extensionUtility.translateMenuItemsFromTitleKey(n),this.extensionUtility.sortItems(n,"positionOrder")}})),i}clearColumnFilter(e,t){t?.column&&this.filterService.clearFilterByColumnId(e,t.column.id)}clearColumnSort(e,t){t?.column&&this.sharedService&&this.sortService.clearSortByColumnId(e,t.column.id)}executeHeaderMenuInternalCommands(e,t){if(t?.command)switch(t.command){case"hide-column":this.hideColumn(t.column),this.sharedService.gridOptions?.enableAutoSizeColumns&&this.sharedService.slickGrid.autosizeColumns();break;case"clear-filter":this.clearColumnFilter(e,t);break;case"clear-sort":this.clearColumnSort(e,t);break;case"column-resize-by-content":this.pubSubService.publish("onHeaderMenuColumnResizeByContent",{columnId:t.column.id});break;case"freeze-columns":const i=[...this.sharedService.visibleColumns],s={frozenColumn:i.findIndex((e=>e.id===t.column.id)),enableMouseWheelScrollHandler:!0},n=this.sharedService.slickGrid.getColumns();this.sharedService.slickGrid.setOptions(s,!1,!0),this.sharedService.gridOptions.frozenColumn=s.frozenColumn,this.sharedService.gridOptions.enableMouseWheelScrollHandler=s.enableMouseWheelScrollHandler,this.sharedService.frozenVisibleColumnId=t.column.id,this.sharedService.hasColumnsReordered||Array.isArray(i)&&Array.isArray(this.sharedService.allColumns)&&i.length!==this.sharedService.allColumns.length?this.sharedService.slickGrid.setColumns(i):this.sharedService.slickGrid.setColumns(n),this.sharedService.slickGrid.getOptions().enableAutoSizeColumns&&this.sharedService.slickGrid.autosizeColumns();break;case"sort-asc":case"sort-desc":const r="sort-asc"===t.command;this.sortColumn(e,t,r)}}createParentMenu(e,t,i){const s={grid:this.grid,column:t,menu:i};"function"==typeof e.stopPropagation&&(this.pubSubService.publish("onHeaderMenuBeforeMenuShow",s),"function"==typeof this.addonOptions?.onBeforeMenuShow&&!1===this.addonOptions?.onBeforeMenuShow(e,s))||(this._menuElm=this.createCommandMenu(i.commandItems,t),this.grid.getContainerNode()?.appendChild(this._menuElm),this.repositionMenu(e,this._menuElm),this.pubSubService.publish("onHeaderMenuAfterMenuShow",s),"function"==typeof this.addonOptions?.onAfterMenuShow&&!1===this.addonOptions?.onAfterMenuShow(e,s)||(e.preventDefault(),e.stopPropagation()))}createCommandMenu(e,t,i=0,s){const n=s?.command;let r=1===i&&n?n.replace(/\s/g,""):"";r&&(this._subMenuParentId=r),i>1&&(r=this._subMenuParentId);const o=`${this.menuCssClass} slick-menu-level-${i} ${this.gridUid}`,a=document.body.querySelector(`.${this.menuCssClass}.slick-menu-level-${i}${this.gridUidSelector}`);if(a){if(a.dataset.subMenuParent===r)return a;this.disposeSubMenus()}const l=ie("div",{ariaExpanded:"true",ariaLabel:i>1?"SubMenu":"Header Menu",role:"menu",className:o,style:{minWidth:`${this.addonOptions.minWidth}px`}});i>0&&(l.classList.add("slick-submenu"),r&&(l.dataset.subMenuParent=r),this.gridOptions?.darkMode&&l.classList.add("slick-dark-mode"));const h=ie("div",{className:`${this._menuCssPrefix}-command-list`,role:"menu"},l),c={grid:this.grid,column:t,level:i,menu:{commandItems:e}};return s&&i>0&&this.addSubMenuTitleWhenExists(s,h),this.populateCommandOrOptionItems("command",this.addonOptions,h,e,c,this.handleMenuItemCommandClick,this.handleMenuItemMouseOver),i++,l}resetHeaderMenuTranslations(e){e.forEach((e=>{if(e?.header?.menu?.commandItems&&!e.excludeFromHeaderMenu){const t=e.header.menu.commandItems||[];this.extensionUtility.translateMenuItemsFromTitleKey(t)}}))}sortColumn(e,t,i=!0){if(t?.column){const s=t.column,n=this.sharedService.gridOptions.multiColumnSort?this.sortService.getCurrentColumnSorts(s.id+""):[];let r=h.local;n.push({columnId:s.id,sortCol:s,sortAsc:i}),this.sharedService.gridOptions.backendServiceApi?(this.sortService.onBackendSortChanged(e,{multiColumnSort:!0,sortCols:n,grid:this.sharedService.slickGrid}),r=h.remote):this.sharedService.dataView?(this.sortService.onLocalSortChanged(this.sharedService.slickGrid,n),r=h.local):t.grid.onSort.notify(n);const o=n.map((e=>({columnId:e?.sortCol?.id??"",sortAsc:e?.sortAsc??!0})));if(this.sharedService.slickGrid.setSortColumns(o),r){const e=[];o.forEach((t=>{e.push({columnId:`${t.columnId}`,direction:t.sortAsc?"ASC":"DESC"})})),this.sortService.emitSortChanged(r,e)}}}}const yo="slick-rbe-editmode",Co="slick-rbe-unsaved-highlight",wo="action-btns--delete",So="action-btns--edit",Eo="action-btns--update",xo="action-btns--cancel";class To{constructor(e,t,i){this.extensionUtility=e,this.pubSubService=t,this.pluginName="RowBasedEdit",this._defaults={actionsColumnLabel:"Actions",allowMultipleRows:!1,columnId:"_slick_rowbasededit_action",columnIndexPosition:-1,reorderable:!1},this._editedRows=new Map,this._currentLang="en",this._translations={},this.onBeforeEditCellHandler=(e,t)=>this._editedRows.has(t.item?.[this.gridOptions.datasetIdPropertyName??"id"]),this._eventHandler=new Cs,this._addonOptions=i}get addonOptions(){return this._addonOptions}get gridOptions(){return this._grid.getOptions()||{}}get eventHandler(){return this._eventHandler}init(e,t){this._grid=e,this._gridService=t,this._addonOptions={...this._defaults,...this.addonOptions};const i=this._grid.getData();if(this._eventHandler.subscribe(this._grid.onBeforeEditCell,this.onBeforeEditCellHandler),this.checkOptionsRequirements(this.gridOptions),this.gridOptions.autoEdit||(this._grid.setOptions({autoEdit:!0}),console.warn('[Slickgrid-Universal] The Row Based Edit Plugin works best with the gridOption "autoEdit" enabled, the option has now been set automatically for you.')),this._existingEditCommandHandler=this.gridOptions.editCommandHandler,this._grid.setOptions({editCommandHandler:this.rowBasedEditCommandHandler.bind(this)}),!0===this.gridOptions.enableExcelCopyBuffer){const e=this.gridOptions.excelCopyBufferOptions?.onBeforePasteCell;this._grid.setOptions({excelCopyBufferOptions:{...this.gridOptions.excelCopyBufferOptions,onBeforePasteCell:(t,s)=>{let n=!0;if(e&&(n=e(t,s),!1===n))return!1;const r=i.getItem(s.row),o=this.gridOptions.datasetIdPropertyName??"id";return!(!this._editedRows.has(r[o])||!0!==n)}}})}const s=i.getItemMetadata;i.getItemMetadata=this.updateItemMetadata(s?.bind?.(i)),this._eventHandler.subscribe(this._grid.onSetOptions,this.optionsUpdatedHandler.bind(this)),this._eventHandler.subscribe(i.onRowsOrCountChanged,this.handleAllRowRerender.bind(this)),this.translate()}destroy(){this.dispose()}dispose(){this._eventHandler?.unsubscribeAll(),this.pubSubService?.unsubscribeAll()}create(e,t){if(this._addonOptions={...this._defaults,...t.rowBasedEditOptions},Array.isArray(e)&&t){const i=this.getColumnDefinition();if(!e.some((e=>e.id===i.id))){const s=t?.rowBasedEditOptions?.columnIndexPosition??-1;-1===s?e.push(i):s>0&&s<e.length?e.splice(s,0,i):e.unshift(i),this.pubSubService.publish("onPluginColumnsChanged",{columns:e,pluginName:this.pluginName})}}return this}getColumnDefinition(){return{id:String(this._addonOptions?.columnId??this._defaults.columnId),name:this._addonOptions?.actionsColumnLabel,field:"action",minWidth:70,width:75,maxWidth:75,excludeFromExport:!0,reorderable:this._addonOptions?.reorderable,formatter:this.actionColumnFormatter.bind(this),onCellClick:this.onCellClickHandler.bind(this),...this._addonOptions?.actionColumnConfig??{}}}rowBasedEditCommandHandler(e,t,i){this._existingEditCommandHandler&&this._existingEditCommandHandler(e,t,i);const s=Array.isArray(i.prevSerializedValue)?i.prevSerializedValue:[i.prevSerializedValue],n=Array.isArray(i.serializedValue)?i.serializedValue:[i.serializedValue],r=this._gridService?.getAllColumnDefinitions().filter((e=>void 0!==e.editor)),o=[],a=this.gridOptions.datasetIdPropertyName??"id";s.forEach(((l,h)=>{const c=s[h],d=n[h];if(c!==d||""===d){const s=Array.isArray(i.prevSerializedValue)?r?.[h]:t;if(!s)return;this._grid.invalidate(),i.execute(),this.renderUnsavedCellStyling(e[a],s),o.push(s)}}));const l=this._editedRows.get(e[a]),h=[...l?.editCommands||[]];o.length>0&&h.push(i),this._editedRows.set(e[a],{columns:[...l?.columns||[],...o],editCommands:h,cssStyleKeys:l?.cssStyleKeys||[]})}translate(e=!1){return this._currentLang=this.extensionUtility.translaterService?.getCurrentLanguage()??"en",this._translations[this._currentLang]&&!e||(this._translations[this._currentLang]={btnUpdateTitle:this.getTitleOrDefault("updateButtonTitle","Update the row"),btnEditTitle:this.getTitleOrDefault("editButtonTitle","Edit the Row"),btnDeleteTitle:this.getTitleOrDefault("deleteButtonTitle","Delete the Row"),btnCancelTitle:this.getTitleOrDefault("cancelButtonTitle","Cancel changes of the Row")}),this._translations[this._currentLang]}checkOptionsRequirements(e){if(!e?.enableCellNavigation)throw new Error("[Slickgrid-Universal] Row Based Edit Plugin requires the gridOption cell navigation (enableCellNavigation = true)");if(!e?.editable)throw new Error("[Slickgrid-Universal] Row Based Edit Plugin requires the gridOption editable (editable = true)")}undoRowEdit(e){const t=this.gridOptions.datasetIdPropertyName??"id",i=this._editedRows.get(e[t]),s=this._grid.getData().getRowByItem(e);if(void 0!==s&&i?.editCommands&&i.editCommands.length||Os.cancelCurrentEdit()){for(;i.editCommands.length>0;){const e=i.editCommands.pop();e&&e.undo()}i.columns.forEach((e=>{this.removeUnsavedStylingFromCell(e,s)})),i.columns=[],this._grid.invalidate()}}renderUnsavedCellStyling(e,t){if(t){const i=this._grid.getData()?.getRowById(e);if(void 0!==i&&i>=0){const s={[i]:{[t.id]:"slick-rbe-unsaved-cell"}},n=`${Co}_${[t.id]}${i}`;this._grid.setCellCssStyles(n,s),this._editedRows.get(e)?.cssStyleKeys.push(n)}}}handleAllRowRerender(e,t){this._editedRows.forEach(((e,t)=>{e.cssStyleKeys.forEach((e=>{this._grid.removeCellCssStyles(e)})),e.cssStyleKeys=[],e.columns.forEach((e=>{this.renderUnsavedCellStyling(t,e)}))}))}removeUnsavedStylingFromCell(e,t){const i=`${Co}_${[e.id]}${t}`;this._grid.removeCellCssStyles(i)}removeUnsavedStylingFromRow(e){this._grid.getColumns().forEach((t=>{this.removeUnsavedStylingFromCell(t,e)}))}optionsUpdatedHandler(e,t){this._addonOptions={...this._defaults,...t.optionsAfter.rowBasedEditOptions}}async onCellClickHandler(e,t){const i=t.dataContext,s=e.target,n=this.gridOptions.datasetIdPropertyName??"id",r=this._editedRows.get(i[n]);if((s.classList.contains(wo)||s.parentElement?.classList.contains(wo))&&this._gridService){if(this._addonOptions?.actionButtons?.deleteButtonPrompt&&!window.confirm(this._addonOptions.actionButtons.deleteButtonPrompt))return;this.toggleEditmode(i,!1),this._gridService.deleteItem(i)}else if(s.classList.contains(So)||s.parentElement?.classList.contains(So)){if(!this._addonOptions?.allowMultipleRows&&this._editedRows.size>0)return;"function"==typeof this._addonOptions?.onBeforeEditMode&&this._addonOptions.onBeforeEditMode(t),this.toggleEditmode(i,!0)}else if(s.classList.contains(Eo)||s.parentElement?.classList.contains(Eo)){if(this._addonOptions?.actionButtons?.updateButtonPrompt&&(r?.editCommands.length||0)>0&&!window.confirm(this._addonOptions.actionButtons.updateButtonPrompt))return;if(this._grid.getCellEditor()&&this._grid.getActiveCell()?.row===t.row&&this._grid.getEditController()?.commitCurrentEdit(),this._addonOptions?.onBeforeRowUpdated&&!0!==await this._addonOptions.onBeforeRowUpdated(t))return;this.removeUnsavedStylingFromRow(t.row),this.toggleEditmode(i,!1)}else if(s.classList.contains(xo)||s.parentElement?.classList.contains(xo)){if(this._addonOptions?.actionButtons?.cancelButtonPrompt&&(r?.editCommands.length||0)>0&&!window.confirm(this._addonOptions.actionButtons.cancelButtonPrompt))return;this.undoRowEdit(i),this.toggleEditmode(i,!1)}}actionColumnFormatter(e,t,i,s,n){const r=this.gridOptions,o=this._editedRows.has(n?.[r.datasetIdPropertyName??"id"]),a=this._translations[this._currentLang]??this.translate(),l=document.createDocumentFragment();return l.appendChild(ie("span",{className:`${r.rowBasedEditOptions?.actionButtons?.editButtonClassName||"button-style padding-1px mr-2"} action-btns `+So,title:a.btnEditTitle,style:{display:o?"none":""}})).appendChild(ie("span",{className:r.rowBasedEditOptions?.actionButtons?.iconEditButtonClassName||"mdi mdi-table-edit text-color-primary"})),l.appendChild(ie("span",{className:`${r.rowBasedEditOptions?.actionButtons?.deleteButtonClassName||"button-style padding-1px"} action-btns `+wo,title:a.btnDeleteTitle,style:{display:o?"none":""}})).appendChild(ie("span",{className:r.rowBasedEditOptions?.actionButtons?.iconDeleteButtonClassName||"mdi mdi-close text-color-danger"})),l.appendChild(ie("span",{className:`${r.rowBasedEditOptions?.actionButtons?.updateButtonClassName||"button-style padding-1px mr-2"} action-btns `+Eo,title:a.btnUpdateTitle,style:{display:o?"":"none"}})).appendChild(ie("span",{className:r.rowBasedEditOptions?.actionButtons?.iconUpdateButtonClassName||"mdi mdi-check-bold text-color-success"})),l.appendChild(ie("span",{className:`${r.rowBasedEditOptions?.actionButtons?.cancelButtonClassName||"button-style padding-1px"} action-btns `+xo,title:a.btnCancelTitle,style:{display:o?"":"none"}})).appendChild(ie("span",{className:r.rowBasedEditOptions?.actionButtons?.iconCancelButtonClassName||"mdi mdi-cancel text-color-danger"})),l}toggleEditmode(e,t){const i=this.gridOptions.datasetIdPropertyName??"id";t?this._editedRows.set(e[i],{columns:[],editCommands:[],cssStyleKeys:[]}):this._editedRows.delete(e[i]),this._grid.invalidate()}updateItemMetadata(e){return t=>{const i=this._grid.getData().getItem(t);let s={cssClasses:""};if("function"==typeof e){const i=e(t);i&&(s=i)}if(s&&i){const e=this.gridOptions.datasetIdPropertyName??"id";this._editedRows.has(i[e])&&!s.cssClasses.includes(yo)?s.cssClasses=(s.cssClasses||"")+" "+yo:!this._editedRows.has(i[e])&&s.cssClasses.includes(yo)&&(s.cssClasses=s.cssClasses.replace(yo,""))}return s}}getTitleOrDefault(e,t){const i=this.gridOptions.rowBasedEditOptions?.actionButtons;return i?.[e+"Key"]&&this.extensionUtility.translaterService?.translate?.(i?.[e+"Key"]||"")||i?.[e]||t}}class Oo{constructor(e){this.pubSubService=e,this.pluginName="RowMoveManager",this._dragging=!1,this._defaults={autoScroll:!0,columnId:"_move",cssClass:"slick-row-move-column",cancelEditOnDrag:!1,disableRowSelection:!1,hideRowMoveShadow:!0,reorderable:!1,rowMoveShadowMarginTop:0,rowMoveShadowMarginLeft:0,rowMoveShadowOpacity:.9,rowMoveShadowScale:.75,singleRowMove:!1,width:40},this.onBeforeMoveRows=new ys("onBeforeMoveRows"),this.onMoveRows=new ys("onMoveRows"),this._eventHandler=new Cs}get addonOptions(){return this._addonOptions}get eventHandler(){return this._eventHandler}get gridOptions(){return this._grid?.getOptions()??{}}init(e,t){this._addonOptions={...this._defaults,...t},this._grid=e,this._canvas=this._grid.getCanvasNode(),Ts.addSlickEventPubSubWhenDefined(this.pubSubService,this),"function"==typeof this._addonOptions?.usabilityOverride&&this.usabilityOverride(this._addonOptions.usabilityOverride),this._eventHandler.subscribe(this._grid.onDragInit,this.handleDragInit.bind(this)).subscribe(this._grid.onDragStart,this.handleDragStart.bind(this)).subscribe(this._grid.onDrag,this.handleDrag.bind(this)).subscribe(this._grid.onDragEnd,this.handleDragEnd.bind(this))}dispose(){this._eventHandler?.unsubscribeAll()}create(e,t){if(this._addonOptions={...this._defaults,...t.rowMoveManager},Array.isArray(e)&&t){const i=this.getColumnDefinition();if(!e.some((e=>e.id===i.id))){const s=Array.isArray(e)&&e.find((e=>"selectAndMove"===e?.behavior))||i,n=t?.rowMoveManager?.columnIndexPosition??0;n>0?e.splice(n,0,s):e.unshift(s),this.pubSubService.publish("onPluginColumnsChanged",{columns:e,pluginName:this.pluginName})}}return this}getColumnDefinition(){const e=String(this._addonOptions?.columnId??this._defaults.columnId);return{id:e,name:"",behavior:"selectAndMove",excludeFromExport:!0,excludeFromColumnPicker:!0,excludeFromGridMenu:!0,excludeFromQuery:!0,excludeFromHeaderMenu:!0,field:e,reorderable:this._addonOptions.reorderable,resizable:!1,width:this._addonOptions.width||40,formatter:this.moveIconFormatter.bind(this)}}usabilityOverride(e){this._usabilityOverride=e}setOptions(e){this._addonOptions={...this._addonOptions,...e}}handleDragInit(e){e.stopImmediatePropagation()}handleDragEnd(e,t){if(this._dragging&&(this._dragging=!1,e.stopImmediatePropagation(),t.guide?.remove(),t.selectionProxy?.remove(),t.clonedSlickRow?.remove(),t.canMove)){const i={grid:this._grid,rows:t.selectedRows,insertBefore:t.insertBefore};"function"==typeof this._addonOptions.onMoveRows&&this._addonOptions.onMoveRows(e instanceof bs?e.getNativeEvent():e,i),this.onMoveRows.notify(i)}}handleDrag(e,t){if(this._dragging){e.stopImmediatePropagation();const i=e.getNativeEvent(),s=(i?.touches?.[0]??i).pageY-le(this._canvas).top;t.selectionProxy.style.top=s-5+"px",t.selectionProxy.style.display="block",t.clonedSlickRow&&(t.clonedSlickRow.style.top=s-6+"px",t.clonedSlickRow.style.display="block");const n=Math.max(0,Math.min(Math.round(s/(this.gridOptions.rowHeight||0)),this._grid.getDataLength()));if(n!==t.insertBefore){const e={grid:this._grid,rows:t.selectedRows,insertBefore:n};if(!1===this._addonOptions?.onBeforeMoveRows?.(i,e)||!1===this.onBeforeMoveRows.notify(e).getReturnValue()?t.canMove=!1:t.canMove=!0,this._usabilityOverride&&t.canMove){const e=this._grid.getDataItem(n);t.canMove=this.checkUsabilityOverride(n,e,this._grid)}t.canMove?t.guide.style.top=n*(this.gridOptions.rowHeight||0)+"px":t.guide.style.top="-1000px",t.insertBefore=n}}}handleDragStart(e,t){const i=this._grid.getCellFromEvent(e)||{cell:-1,row:-1},s=i.row,n=this._grid.getDataItem(s);if(this.checkUsabilityOverride(s,n,this._grid)){if(this._addonOptions.cancelEditOnDrag&&this._grid.getEditorLock().isActive()&&this._grid.getEditorLock().cancelCurrentEdit(),this._grid.getEditorLock().isActive()||!/move|selectAndMove/.test(this._grid.getColumns()[i.cell].behavior||""))return!1;if(this._dragging=!0,e.stopImmediatePropagation(),!this.addonOptions.hideRowMoveShadow){const e=this._grid.getCellNode(i.row,i.cell)?.closest(".slick-row");e&&(t.clonedSlickRow=e.cloneNode(!0),t.clonedSlickRow.classList.add("slick-reorder-shadow-row"),t.clonedSlickRow.style.display="none",t.clonedSlickRow.style.marginLeft=ue(this._addonOptions?.rowMoveShadowMarginLeft,"0px"),t.clonedSlickRow.style.marginTop=ue(this._addonOptions?.rowMoveShadowMarginTop,"0px"),t.clonedSlickRow.style.opacity=`${this._addonOptions?.rowMoveShadowOpacity??.95}`,t.clonedSlickRow.style.transform=`scale(${this.addonOptions?.rowMoveShadowScale??.75})`,this._canvas.appendChild(t.clonedSlickRow))}let s=this._addonOptions.singleRowMove?[i.row]:this._grid.getSelectedRows();0!==s.length&&s.some((e=>e===i.row))||(s=[i.row],this._addonOptions.disableRowSelection||this._grid.setSelectedRows(s));const n=this.gridOptions.rowHeight;t.selectedRows=s,t.selectionProxy=ie("div",{className:"slick-reorder-proxy",style:{display:"none",position:"absolute",zIndex:"99999",width:`${this._canvas.clientWidth}px`,height:n*s.length+"px"}},this._canvas),t.guide=ie("div",{className:"slick-reorder-guide",style:{position:"absolute",zIndex:"99999",width:`${this._canvas.clientWidth}px`,top:"-1000px"}},this._canvas),t.insertBefore=-1}}checkUsabilityOverride(e,t,i){return"function"!=typeof this._usabilityOverride||this._usabilityOverride(e,t,i)}moveIconFormatter(e,t,i,s,n,r){return this.checkUsabilityOverride(e,n,r)?{addClasses:"cell-reorder dnd",html:ie("div",{className:this._addonOptions.cssClass||""})}:""}}class ko{get extensionList(){return this._extensionList}get gridOptions(){return this.sharedService.gridOptions||{}}constructor(e,t,i,s,n,r,o,a){this.extensionUtility=e,this.filterService=t,this.pubSubService=i,this.sharedService=s,this.sortService=n,this.treeDataService=r,this.translaterService=o,this.lazyGridService=a,this._extensionCreatedList={},this._extensionList={},this._requireInitExternalExtensions=[]}dispose(){if(this.sharedService.visibleColumns=[],"object"==typeof this._extensionList){const e=Object.keys(this._extensionList);e.forEach((e=>{if(this._extensionList.hasOwnProperty(e)){const t=this._extensionList[e];"function"==typeof t?.instance?.dispose&&t.instance.dispose()}})),e.forEach((e=>{delete this._extensionList[e]}))}this._cellMenuPlugin=null,this._cellExcelCopyManagerPlugin=null,this._checkboxSelectColumn=null,this._contextMenuPlugin=null,this._columnPickerControl=null,this._draggleGroupingPlugin=null,this._gridMenuControl=null,this._groupItemMetadataProviderService=null,this._headerMenuPlugin=null,this._rowMoveManagerPlugin=null,this._rowSelectionModel=null,this._extensionCreatedList=null,this._extensionList={}}addExtensionToList(e,t){this._extensionList[e]=t}getAllColumns(){return this.sharedService.allColumns||[]}getVisibleColumns(){return this.sharedService.visibleColumns||[]}getCreatedExtensionByName(e){if(this._extensionCreatedList?.hasOwnProperty(e))return this._extensionCreatedList[e]}getExtensionByName(e){return this._extensionList?.[e]}getExtensionInstanceByName(e){return this.getExtensionByName(e)?.instance}autoResizeColumns(){this.sharedService.slickGrid.autosizeColumns()}bindDifferentExtensions(){if(this.gridOptions){if(this.gridOptions.enableTranslate&&this.translateItems(this.sharedService.allColumns,"nameKey","name"),this.gridOptions.enableRowBasedEdit){this._rowBasedEdit=this._rowBasedEdit||new To(this.extensionUtility,this.pubSubService,this.gridOptions.rowBasedEditOptions);const e=this.lazyGridService?.();if(!e)throw new Error("[Slickgrid-Universal] the RowBasedEdit Plugin requires a GridService to be configured and available");this._rowBasedEdit.init(this.sharedService.slickGrid,e),this.gridOptions.rowBasedEditOptions?.onExtensionRegistered&&this.gridOptions.rowBasedEditOptions.onExtensionRegistered(this._rowBasedEdit),this._extensionList[S.rowBasedEdit]={name:S.rowBasedEdit,instance:this._rowBasedEdit}}if(this.gridOptions.enableAutoTooltip){const e=new Fr(this.gridOptions?.autoTooltipOptions);this.sharedService.slickGrid.registerPlugin(e),this._extensionList[S.autoTooltip]={name:S.autoTooltip,instance:e}}if(this.gridOptions.enableExcelCopyBuffer&&(this._cellExcelCopyManagerPlugin=new Br,this._cellExcelCopyManagerPlugin.init(this.sharedService.slickGrid,this.sharedService.gridOptions.excelCopyBufferOptions),this.gridOptions.excelCopyBufferOptions?.onExtensionRegistered&&this.gridOptions.excelCopyBufferOptions.onExtensionRegistered(this._cellExcelCopyManagerPlugin),this._extensionList[S.cellExternalCopyManager]={name:S.cellExternalCopyManager,instance:this._cellExcelCopyManagerPlugin}),this.gridOptions.enableCellMenu&&(this._cellMenuPlugin=new Ur(this.extensionUtility,this.pubSubService,this.sharedService),this.gridOptions.cellMenu?.onExtensionRegistered&&this.gridOptions.cellMenu.onExtensionRegistered(this._cellMenuPlugin),this._extensionList[S.cellMenu]={name:S.cellMenu,instance:this._cellMenuPlugin}),!this._rowSelectionModel&&(this.gridOptions.enableRowSelection||this.gridOptions.enableCheckboxSelector||this.gridOptions.enableRowDetailView||this.gridOptions.enableRowMoveManager)){if(!this._rowSelectionModel||!this.sharedService.slickGrid.getSelectionModel()){const e=this.gridOptions.rowSelectionOptions??{};this.gridOptions.enableRowMoveManager&&!1!==this.gridOptions.rowMoveManager?.dragToSelect&&(e.dragToSelect=!0),this._rowSelectionModel=new Kr(e),this.sharedService.slickGrid.setSelectionModel(this._rowSelectionModel)}this._extensionList[S.rowSelection]={name:S.rowSelection,instance:this._rowSelectionModel}}if(this.gridOptions.enableCheckboxSelector){this._checkboxSelectColumn=this._checkboxSelectColumn||new Zr(this.pubSubService,this.gridOptions.checkboxSelector),this._checkboxSelectColumn.init(this.sharedService.slickGrid);const e=this.getCreatedExtensionByName(S.checkboxSelector),t=e?.instance;t&&(this.gridOptions.checkboxSelector?.onExtensionRegistered&&this.gridOptions.checkboxSelector.onExtensionRegistered(t),this._extensionList[S.checkboxSelector]={name:S.checkboxSelector,instance:this._checkboxSelectColumn})}if(this.gridOptions.enableColumnPicker&&(this._columnPickerControl=new lo(this.extensionUtility,this.pubSubService,this.sharedService),this.gridOptions.columnPicker?.onExtensionRegistered&&this.gridOptions.columnPicker.onExtensionRegistered(this._columnPickerControl),this._extensionList[S.columnPicker]={name:S.columnPicker,instance:this._columnPickerControl}),this.gridOptions.enableContextMenu&&(this._contextMenuPlugin=new go(this.extensionUtility,this.pubSubService,this.sharedService,this.treeDataService),this.gridOptions.contextMenu?.onExtensionRegistered&&this.gridOptions.contextMenu.onExtensionRegistered(this._contextMenuPlugin),this._extensionList[S.contextMenu]={name:S.contextMenu,instance:this._contextMenuPlugin}),this.gridOptions.enableDraggableGrouping&&(this._draggleGroupingPlugin&&(this._draggleGroupingPlugin.init(this.sharedService.slickGrid,this.gridOptions.draggableGrouping),this.gridOptions.draggableGrouping?.onExtensionRegistered&&this.gridOptions.draggableGrouping.onExtensionRegistered(this._draggleGroupingPlugin),this._extensionList[S.contextMenu]={name:S.contextMenu,instance:this._draggleGroupingPlugin}),this._extensionList[S.draggableGrouping]={name:S.draggableGrouping,instance:this._draggleGroupingPlugin}),this.gridOptions.enableGridMenu&&(this._gridMenuControl=new Qr(this.extensionUtility,this.filterService,this.pubSubService,this.sharedService,this.sortService),this.gridOptions.gridMenu?.onExtensionRegistered&&this.gridOptions.gridMenu.onExtensionRegistered(this._gridMenuControl),this._extensionList[S.gridMenu]={name:S.gridMenu,instance:this._gridMenuControl}),this.gridOptions.enableHeaderButton){const e=new vo(this.extensionUtility,this.pubSubService,this.sharedService);this.gridOptions.headerButton?.onExtensionRegistered&&this.gridOptions.headerButton.onExtensionRegistered(e),this._extensionList[S.headerButton]={name:S.headerButton,instance:e}}if(this.gridOptions.enableHeaderMenu&&(this._headerMenuPlugin=new bo(this.extensionUtility,this.filterService,this.pubSubService,this.sharedService,this.sortService),this.gridOptions.headerMenu?.onExtensionRegistered&&this.gridOptions.headerMenu.onExtensionRegistered(this._headerMenuPlugin),this._extensionList[S.headerMenu]={name:S.headerMenu,instance:this._headerMenuPlugin}),this.gridOptions.enableRowMoveManager){this._rowMoveManagerPlugin=this._rowMoveManagerPlugin||new Oo(this.pubSubService),this._rowMoveManagerPlugin.init(this.sharedService.slickGrid,this.gridOptions.rowMoveManager);const e=this.getCreatedExtensionByName(S.rowMoveManager),t=e?.instance;t&&(this._extensionList[S.rowMoveManager]={name:S.rowMoveManager,instance:this._rowMoveManagerPlugin})}this._requireInitExternalExtensions.length&&this._requireInitExternalExtensions.forEach((e=>{e.instance.init(this.sharedService.slickGrid,void 0)}))}}createExtensionsBeforeGridCreation(e,t){const i=[];t.enableCheckboxSelector&&(this.getCreatedExtensionByName(S.checkboxSelector)||(this._checkboxSelectColumn=new Zr(this.pubSubService,this.sharedService.gridOptions.checkboxSelector),i.push({name:S.checkboxSelector,instance:this._checkboxSelectColumn,columnIndexPosition:t?.checkboxSelector?.columnIndexPosition??i.length}))),t.enableRowMoveManager&&(this.getCreatedExtensionByName(S.rowMoveManager)||(this._rowMoveManagerPlugin=new Oo(this.pubSubService),i.push({name:S.rowMoveManager,instance:this._rowMoveManagerPlugin,columnIndexPosition:t?.rowMoveManager?.columnIndexPosition??i.length}))),t.enableRowBasedEdit&&(this.getCreatedExtensionByName(S.rowBasedEdit)||(this._rowBasedEdit=new To(this.extensionUtility,this.pubSubService),i.push({name:S.rowBasedEdit,instance:this._rowBasedEdit,columnIndexPosition:t?.rowMoveManager?.columnIndexPosition??i.length}))),t.preRegisterExternalExtensions&&t.preRegisterExternalExtensions(this.pubSubService).forEach((e=>{i.push(e),this._requireInitExternalExtensions.push(e),this._extensionList[e.name]||this.addExtensionToList(e.name,e)})),this.createExtensionByTheirColumnIndex(i,e,t),t.enableDraggableGrouping&&(this.getCreatedExtensionByName(S.draggableGrouping)||(this._draggleGroupingPlugin=new _o(this.extensionUtility,this.pubSubService,this.sharedService),this._draggleGroupingPlugin&&(t.enableColumnReorder=this._draggleGroupingPlugin.setupColumnReorder.bind(this._draggleGroupingPlugin),this._extensionCreatedList[S.draggableGrouping]={name:S.draggableGrouping,instance:this._draggleGroupingPlugin})))}hideColumn(e){if("function"==typeof this.sharedService?.slickGrid?.getColumns){const t=this.sharedService.slickGrid.getColumnIndex(e.id);this.sharedService.visibleColumns=this.removeColumnByIndex(this.sharedService.slickGrid.getColumns(),t),this.sharedService.slickGrid.setColumns(this.sharedService.visibleColumns)}}refreshBackendDataset(e){this.extensionUtility.refreshBackendDataset(e)}removeColumnByIndex(e,t){return Array.isArray(e)?e.filter(((e,i)=>t!==i)):e}translateAllExtensions(e){this.translateCellMenu(),this.translateContextMenu(),this.translateHeaderMenu(),this.translateRowEditPlugin(),this.translateColumnHeaders(e)}translateCellMenu(){this._cellMenuPlugin?.translateCellMenu()}translateColumnPicker(){this._columnPickerControl?.translateColumnPicker()}translateContextMenu(){this._contextMenuPlugin?.translateContextMenu()}translateGridMenu(){this._gridMenuControl?.translateGridMenu()}translateHeaderMenu(){this._headerMenuPlugin?.translateHeaderMenu()}translateRowEditPlugin(){this._rowBasedEdit?.translate()}translateColumnHeaders(e,t){if(this.sharedService&&this.gridOptions&&this.gridOptions.enableTranslate&&(!this.translaterService||!this.translaterService.translate))throw new Error('[Slickgrid-Universal] requires a Translate Service to be installed and configured when the grid option "enableTranslate" is enabled.');e&&this.translaterService?.use&&this.translaterService.getCurrentLanguage()!==e&&this.translaterService.use(e);let i=t;i||(i=this.sharedService.columnDefinitions),this.translateItems(i,"nameKey","name"),this.translateItems(this.sharedService.allColumns,"nameKey","name"),this.translateItems(this.sharedService.allColumns,"columnGroupKey","columnGroup"),this.renderColumnHeaders(i,Array.isArray(t))}renderColumnHeaders(e,t=!1){let i=e;i||(i=this.sharedService.columnDefinitions),Array.isArray(i)&&this.sharedService.slickGrid?.setColumns&&((i.length>this.sharedService.allColumns.length||t)&&(this.sharedService.allColumns=i),this.sharedService.slickGrid.setColumns(i)),this.gridOptions.enableColumnPicker&&this._columnPickerControl&&(this._columnPickerControl.columns=this.sharedService.allColumns,this._columnPickerControl.translateColumnPicker()),this.gridOptions.enableGridMenu&&this._gridMenuControl&&(this._gridMenuControl.columns=this.sharedService.allColumns??[],this._gridMenuControl.recreateGridMenu(),this._gridMenuControl.translateGridMenu())}createExtensionByTheirColumnIndex(e,t,i){e.sort(((e,t)=>(e?.columnIndexPosition??0)-(t?.columnIndexPosition??0))),e.forEach((e=>{const s=e.instance.create(t,i);s&&(this._extensionCreatedList[e.name]={name:e.name,instance:s})}))}translateItems(e,t,i){if(this.gridOptions?.enableTranslate&&!this.translaterService?.translate)throw new Error('[Slickgrid-Universal] requires a Translate Service to be installed and configured when the grid option "enableTranslate" is enabled.');this.extensionUtility.translateItems(e,t,i)}}function Io(e,t,i){if(i&&(e?.hasOwnProperty(i)||t?.hasOwnProperty(i)))return e[i]===t||e===t[i]||e[i]===t[i];if("object"==typeof e&&"object"==typeof t&&Object.keys(e).length!==Object.keys(t).length)return!1;for(const i in e)if(e.hasOwnProperty(i)&&e[i]!==t[i])return!1;return!0}const Ao=(e,t,i)=>{switch(e.toUpperCase()){case"<":case"LT":return t<i;case"<=":case"LE":return t<=i;case">":case"GT":return t>i;case">=":case"GE":return t>=i;case"!=":case"<>":case"NE":return t!==i;case"=":case"==":case"EQ":return t===i;case"IN":return!(!i||!Array.isArray(i))&&i.includes(t);case"NIN":case"NOT_IN":return!(!i||!Array.isArray(i)||i.includes(t));case"IN_CONTAINS":return!(!i||!Array.isArray(i)||"string"!=typeof t)&&i.some((e=>t.split(/[,]+/).map((e=>e.trim())).includes(e)));case"NIN_CONTAINS":case"NOT_IN_CONTAINS":return!(!i||!Array.isArray(i)||"string"!=typeof t||i.some((e=>t.split(/[,]+/).map((e=>e.trim())).includes(e))));case"IN_COLLECTION":return!!(t&&i&&Array.isArray(t)&&Array.isArray(i))&&i.some((e=>t.includes(e)));case"NOT_IN_COLLECTION":return!!(t&&i&&Array.isArray(t)&&Array.isArray(i))&&!i.some((e=>t.includes(e)))}return!0};function Do(e,t,i,s){return"*"===e||e===k.endsWith||"*z"===e?t.endsWith(i):""===e&&"*"===s||e===k.startsWith||"a*"===e?t.startsWith(i):""===e||e===k.contains?t.indexOf(i)>-1:"<>"===e||e===k.notContains?-1===t.indexOf(i):Ao(e||"==",t,i)}function Ro(e,t){let i;switch(Po(t)){case"boolean":i=function(e){return Ve(Array.isArray(e)&&e[0]||!1)}(e);break;case"date":i=function(e,t){const i=Array.isArray(e)&&e||[],s=Lt(t||E.dateIso),n=[];if(2===i.length||"string"==typeof i[0]&&i[0].indexOf("..")>0){const e=2===i.length?i:i[0].split(".."),t=Array.isArray(e)&&e[0]||"",r=Array.isArray(e)&&e[1]||"",o=Nt(t,s,!0),a=Nt(r,s,!0);if(!o||!a)return[];n.push(o,a)}else{const e=Nt(i[0],s,!0);if(!e)return[];n.push(e)}return n}(e,t);break;case"number":i=function(e){const t=Array.isArray(e)&&e||[0],i=[];let s,n;if(2===t.length||"string"==typeof t[0]&&t[0].indexOf("..")>0){const e=2===t.length?t:t[0].split("..");s=parseFloat(Array.isArray(e)?e[0]:""),n=parseFloat(Array.isArray(e)?e[1]:"")}else s=parseFloat(t[0]);return ze(s,!0)&&ze(n,!0)?i.push(s,n):ze(s,!0)&&i.push(s),i}(e);break;case"object":i=function(e){return(Array.isArray(e)&&e.length>0?e[0]:"")||""}(e);break;case"string":i=function(e){let t=Array.isArray(e)&&e||[""];const i=[];let s,n;if(1===t.length&&"string"==typeof t[0]){const e=t[0];e.indexOf("..")>0?t=e.split(".."):e.indexOf("*")>0&&e.indexOf("*")<e.length-1&&(t=e.split("*"))}if(2===t.length)s=`${t[0]}`,n=`${t[1]}`;else{const t=Array.isArray(e)&&e.length>0?e[0]:"";s=null==t?"":`${t}`}return void 0!==s&&void 0!==n?i.push(s,n):void 0!==s&&i.push(s),i}(e)}return i}function Po(e){if(q(e))return"date";switch(e){case E.boolean:return"boolean";case E.integer:case E.float:case E.number:return"number";case E.object:return"object";case E.string:case E.text:case E.password:case E.readonly:default:return"string"}}const Lo=(e,t)=>{if(function(e){switch(e&&e.toUpperCase()||""){case"IN":case"NIN":case"NOT_IN":case"IN_CONTAINS":case"NIN_CONTAINS":case"NOT_IN_CONTAINS":case"IN_COLLECTION":case"NOT_IN_COLLECTION":return!0;default:return!1}}(e.operator))return(e=>{const t=e.operator;let i;return i=!Array.isArray(e.cellValue)||"IN_COLLECTION"!==t&&"NOT_IN_COLLECTION"!==t?void 0===e.cellValue||null===e.cellValue?"":`${e.cellValue}`:e.cellValue.length?e.cellValue.map((e=>`${e}`)):[],Ao(t||"IN",i,e.searchTerms||[])})(e);switch(Po(e.filterSearchType||e.fieldType)){case"boolean":return((e,t)=>Ve(e.cellValue)===Ve(t))(e,t);case"date":return function(e,t){const i=Lt(e&&(e.filterSearchType||e.fieldType)||E.dateIso),[s,n]=t,r=Nt(e.cellValue,i,!0);if(!s&&!n||!r)return!1;const o="ISO8601"===i||i.toLowerCase().includes("h")?r.valueOf():Ot(new Date(r)).valueOf();if(s&&n){let t=e?.operator??e.defaultFilterRangeOperator;t!==k.rangeInclusive&&t!==k.rangeExclusive&&(t=e.defaultFilterRangeOperator);const i=t===k.rangeInclusive,r=Ao(i?">=":">",o,s.valueOf()),a=Ao(i?"<=":"<",o,n.valueOf());return r&&a}const a="ISO8601"===i||i.toLowerCase().includes("h")?s.valueOf():Ot(new Date(s)).valueOf();return Ao(e.operator||"==",o,a)}(e,t||[]);case"number":return((e,t)=>{const i=parseFloat(e.cellValue),[s,n]=t;if(void 0===s&&!e.operator)return!0;if(void 0!==s&&void 0!==n){let t=e?.operator??e.defaultFilterRangeOperator;t!==k.rangeInclusive&&t!==k.rangeExclusive&&(t=e.defaultFilterRangeOperator);const r=t===k.rangeInclusive,o=Ao(r?">=":">",i,+s),a=Ao(r?"<=":"<",i,+n);return o&&a}return Ao(e.operator||"==",i,+s)})(e,t||[]);case"object":return((e,t)=>{if(void 0===t&&!e.operator)return!0;switch((e.operator||"").toUpperCase()){case"!=":case"<>":case"NE":return!Io(e.cellValue,t,e.dataKey);default:return Io(e.cellValue,t,e.dataKey)}})(e,t);default:return((e,t)=>{let[i,s]=t;if(void 0===i&&!e.operator)return!0;e.cellValue=void 0===e.cellValue||null===e.cellValue?"":e.cellValue.toString();const n=e?.ignoreAccentOnStringFilterAndSort?We(e.cellValue,!0):e.cellValue.toLowerCase();if("string"==typeof i&&(i=e?.ignoreAccentOnStringFilterAndSort?We(i,!0):i.toLowerCase()),"string"==typeof s&&(s=e?.ignoreAccentOnStringFilterAndSort?We(s,!0):s.toLowerCase()),e.operator===k.startsWithEndsWith&&void 0!==i&&void 0!==s)return function(e,[t,i]){return e.startsWith(t)&&e.endsWith(i)}(n,[i,s]);if(void 0!==i&&void 0!==s){let t=e?.operator??e.defaultFilterRangeOperator;t!==k.rangeInclusive&&t!==k.rangeExclusive&&(t=e.defaultFilterRangeOperator);const r=t===k.rangeInclusive,o=Do(r?">=":">",n,i,e.searchInputLastChar),a=Do(r?"<=":"<",n,s,e.searchInputLastChar);return o&&a}return Do(e.operator,n,i,e.searchInputLastChar)})(e,t||[])}};class Mo{constructor(e,t,i,s,n){this.filterFactory=e,this.pubSubService=t,this.sharedService=i,this.backendUtilities=s,this.rxjs=n,this._isFilterFirstRender=!0,this._firstColumnIdRendered="",this._filtersMetadata=[],this._columnFilters={},this._isTreePresetExecuted=!1,this._previousFilters=[],this._onSearchChange=new ys,this._eventHandler=new Cs,this.rxjs&&(this.httpCancelRequests$=this.rxjs.createSubject())}get eventHandler(){return this._eventHandler}get isFilterFirstRender(){return this._isFilterFirstRender}get onSearchChange(){return this._onSearchChange}get _gridOptions(){return this._grid?.getOptions()??{}}get _columnDefinitions(){return this._grid?.getColumns()??[]}get _dataView(){return this._grid?.getData()??{}}addRxJsResource(e){this.rxjs=e}init(e){this._grid=e,this._gridOptions&&this._gridOptions.enableTreeData&&this._gridOptions.treeDataOptions&&this._grid.setSortColumns([{columnId:this._gridOptions.treeDataOptions.columnId,sortAsc:!0}])}dispose(){this._eventHandler.unsubscribeAll(),this.httpCancelRequests$&&this.rxjs?.isObservable(this.httpCancelRequests$)&&(this.httpCancelRequests$.next(),this.httpCancelRequests$.complete()),this.disposeColumnFilters(),this._onSearchChange=null}disposeColumnFilters(){if(this.removeAllColumnFiltersProperties(),Array.isArray(this._filtersMetadata)){let e=this._filtersMetadata.pop();for(;e;)"function"==typeof e?.destroy&&e.destroy(),e=this._filtersMetadata.pop()}}bindBackendOnFilter(e){this._filtersMetadata=[],this._eventHandler.subscribe(e.onHeaderRowCellRendered,((e,t)=>{t.column.id===this._firstColumnIdRendered&&(this._isFilterFirstRender=!1),this.addFilterTemplateToHeaderRow(t,this._isFilterFirstRender),""===this._firstColumnIdRendered&&(this._firstColumnIdRendered=t.column.id)})),this.subscribeToOnHeaderRowCellRendered(e),this._onSearchChange&&this._eventHandler.subscribe(this._onSearchChange,this.onBackendFilterChange.bind(this))}bindLocalOnFilter(e){this._filtersMetadata=[],this._dataView.setFilterArgs({columnFilters:this._columnFilters,grid:this._grid,dataView:this._dataView}),this._dataView.setFilter(this.customLocalFilter.bind(this)),this._onSearchChange&&this._eventHandler.subscribe(this._onSearchChange,(async(e,t)=>{const i=t?.clearFilterTriggered??!1;i||await this.emitFilterChanged(h.local,!0),!0===this._gridOptions.enableTreeData&&(this._tmpPreFilteredData=this.preFilterTreeData(this._dataView.getItems(),this._columnFilters)),i||await this.emitFilterChanged(h.local),null!==t.columnId&&this._dataView.refresh(),this._previousFilters=this.extractBasicFilterDetails(this._columnFilters)})),this._eventHandler.subscribe(e.onHeaderRowCellRendered,((e,t)=>{this.addFilterTemplateToHeaderRow(t)})),this.subscribeToOnHeaderRowCellRendered(e)}async clearFilterByColumnId(e,t){await this.pubSubService.publish("onBeforeFilterClear",{columnId:t},0);const i=this._gridOptions.backendServiceApi??!1,s=i?h.remote:h.local,n=Object.keys(this._columnFilters);let r;Array.isArray(n)&&(r=n.find((e=>e===`${t}`)));const o=this._filtersMetadata.find((e=>e.columnDef.id===t));return o?.clear&&o.clear(!0),i&&void 0!==r&&this.onBackendFilterChange(e,{grid:this._grid,columnFilters:this._columnFilters}),await this.emitFilterChanged(s),!0}async clearFilters(e=!0){e&&await this.pubSubService.publish("onBeforeFilterClear",!0,0),this._filtersMetadata.forEach((e=>{e?.clear&&e.clear(!1)})),this.removeAllColumnFiltersProperties(),Array.isArray(this._columnDefinitions)&&this._columnDefinitions.forEach((e=>{e.filter?.searchTerms&&delete e.filter.searchTerms})),this._dataView&&this._grid&&(this._dataView.refresh(),this._grid.invalidate());const t=this._gridOptions.backendServiceApi;if(t&&e){const i={clearFilterTriggered:!0,shouldTriggerQuery:e,grid:this._grid,columnFilters:this._columnFilters},s=t.service.processOnFilterChanged(void 0,i),n=this._gridOptions.pagination?.totalItems??0;this.backendUtilities?.executeBackendCallback(t,s,i,new Date,n,{errorCallback:this.resetToPreviousSearchFilters.bind(this),successCallback:e=>this._previousFilters=this.extractBasicFilterDetails(e.columnFilters),emitActionChangedCallback:this.emitFilterChanged.bind(this)})}else this._previousFilters=this.extractBasicFilterDetails(this._columnFilters);e&&this.pubSubService.publish("onFilterCleared",!0)}customLocalFilter(e,t){const i=t?.grid,s=t?.columnFilters??{},n=this._gridOptions.enableTreeData??!1,r=this._gridOptions.treeDataOptions;if(n&&r){const t=r.collapsedPropName??y.treeDataProperties.COLLAPSED_PROP,i=r.parentPropName??y.treeDataProperties.PARENT_PROP,s=r?.childrenPropName??y.treeDataProperties.CHILDREN_PROP,n=this._gridOptions.datasetIdPropertyName??"id",o=r.autoRecalcTotalsOnFilterChange??!1;let a=!1;if(null!==e[i]){let s=this._dataView.getItemById(e[i]);for(;s;){if(s[t]){if(!o)return!1;a=!0}s=this._dataView.getItemById(s[i])}}if(this._tmpPreFilteredData instanceof Set){const t=this._tmpPreFilteredData.has(e[n]);if(o){const i=z(this.sharedService.hierarchicalDataset,(t=>t[n]===e[n]),s);if(i&&(i.__filteredOut=!t),a)return!1}return t}}else if("object"==typeof s)for(const t of Object.keys(s)){const n=s[t],r=n.columnDef?.filter;if("function"==typeof r?.filterPredicate){if(!r.filterPredicate(e,n))return!1}else{const t=this.preProcessFilterConditionOnDataContext(e,n,i);if("boolean"==typeof t)return t;let s=n?.parsedSearchTerms;if(void 0===s&&(s=Ro(n.searchTerms,n.columnDef.type||E.string),void 0!==s&&(n.parsedSearchTerms=s)),!Lo(t,s))return!1}}return!0}parseFormInputFilterConditions(e,t){const i=Te(!0,[],e)||[];let s=Array.isArray(i)&&1===i.length?i[0]:"";const n=t.columnDef,r=n.filter?.type??n.type??E.string;let o=null;r!==E.object&&(s=null==s?"":`${s}`,o=!1!==(n.autoParseInputFilterOperator??this._gridOptions.autoParseInputFilterOperator)?s.match(/^((.*[^\\*\r\n])[*]{1}(.*[^*\r\n]))|^([<>!=*]{0,2})(.*[^<>!=*])([*]?)$/)||[]:[s,"","","","",s,""]);const a=o?.[2]||"",l=o?.[3]||"";let h=o?.[4]||t.operator,c=o?.[1]||o?.[5]||"";const d=o?.[6]||("*z"===h?"*":"");return"string"==typeof s&&(s=s.replace("'","''"),a&&l?(c=s,h=k.startsWithEndsWith):"*"===h||"*z"===h?h=k.endsWith:"a*"!==h&&"*"!==d||(h=k.startsWith)),Array.isArray(o)&&o.length>=1&&Array.isArray(i)&&1===i.length&&(i[0]=c.length>0&&" "===c.substring(0,1)?c.substring(1):c),{dataKey:n.dataKey,fieldType:r,searchTerms:i||[],operator:h,searchInputLastChar:d,filterSearchType:n.filterSearchType,defaultFilterRangeOperator:this._gridOptions.defaultFilterRangeOperator}}preProcessFilterConditionOnDataContext(e,t,i){const s=t.columnDef,n=t.columnId;let r=i.getColumnIndex(n);if(!s&&this.sharedService&&Array.isArray(this.sharedService.allColumns)&&(r=this.sharedService.allColumns.findIndex((e=>e.field===n))),!s)return!0;if(this._gridOptions.enableRowDetailView){const t=this._gridOptions.rowDetailView&&this._gridOptions.rowDetailView.keyPrefix||"__";e[`${t}isPadding`]&&e[`${t}parent`]&&(e=e[`${t}parent`])}let o=s.filter?.queryField||s.queryFieldFilter||s.queryField||s.field||"";"function"==typeof s.queryFieldNameGetterFn&&(o=s.queryFieldNameGetterFn(e));const a=s.filter?.type??s.type??E.string;let l=e[o];o?.indexOf(".")>=0&&(l=U(e,o));const h=t.operator,c=t.searchTerms||[];if(!c||Array.isArray(c)&&(0===c.length||1===c.length&&h===c[0]))return!0;if(c&&Array.isArray(c)&&a!==E.object)for(let e=0,t=c.length;e<t;e++)c[e]=(void 0===c[e]||null===c[e]?"":c[e])+"";if(!0===s?.params?.useFormatterOuputToFilter){const t=this._gridOptions.datasetIdPropertyName||"id",i=this._dataView&&"function"==typeof this._dataView.getIdxById?this._dataView.getIdxById(e[t]):0;l=st(s&&"function"==typeof s.formatter?s.formatter(i||0,r,l,s,e,this._grid):"")}return"number"==typeof l&&(l=l.toString()),{dataKey:s.dataKey,fieldType:a,searchTerms:c,cellValue:l,operator:h,searchInputLastChar:t.searchInputLastChar,filterSearchType:s.filterSearchType,ignoreAccentOnStringFilterAndSort:this._gridOptions.ignoreAccentOnStringFilterAndSort??!1,defaultFilterRangeOperator:this._gridOptions.defaultFilterRangeOperator}}preFilterTreeData(e,t){const i=this._gridOptions.treeDataOptions,s=i?.collapsedPropName??y.treeDataProperties.COLLAPSED_PROP,n=i?.parentPropName??y.treeDataProperties.PARENT_PROP,r=i?.hasChildrenPropName??y.treeDataProperties.HAS_CHILDREN_PROP,o=this._gridOptions.datasetIdPropertyName??"id",a=this._gridOptions.presets?.treeData?.toggledItems,l=this._gridOptions.treeDataOptions?.initiallyCollapsed??!1,h=this._gridOptions.treeDataOptions?.columnId,c=this._gridOptions.treeDataOptions?.excludeChildrenWhenFilteringTree,d=!c&&!0===this._gridOptions.treeDataOptions?.autoApproveParentItemWhenTreeColumnIsValid,u={},p=new Set,m=new Map;return Array.isArray(e)&&(e.forEach((e=>{u[e[o]]=e,delete u[e[o]].__used})),"object"==typeof t&&Object.keys(t).forEach((e=>{const i=t[e],s=i?.searchTerms?Te(!0,[],i.searchTerms):[],n=this.parseFormInputFilterConditions(s,i),r=i.columnDef,o=r?.filter?.type??r?.type??E.string,a=Ro(n.searchTerms,o);void 0!==a&&(i.parsedSearchTerms=a)})),e.forEach((e=>{const i=e[r];let f=!0;for(const s of Object.keys(t)){const r=t[s],a=this.preProcessFilterConditionOnDataContext(e,r,this._grid);if(a){const t=r?.parsedSearchTerms,s="boolean"==typeof a?a:Lo(a,t);if(s&&d&&i&&r.columnId===h){m.set(e[o],!0);break}if(s||!c&&!0===m.get(e[n])){if(i&&r.columnId===h&&m.set(e[o],!0),s||!c&&r.columnId===h)continue}else i&&!0!==m.get(e[n])&&r.columnId!==h&&m.set(e[o],!1)}f=!1}if(f){p.add(e[o]);let t=u[e[n]]??!1;const i=!l;for(!this._isTreePresetExecuted&&Array.isArray(a)&&a.some((e=>e.itemId===t.id&&e.isCollapsed===i))&&(t[s]=i);t;)t.__used??p.add(t[o]),u[t[o]].__used=!0,t=u[t[n]]??!1}}))),this._isTreePresetExecuted=!0,p}getColumnFilters(){return this._columnFilters}getPreviousFilters(){return this._previousFilters}getFiltersMetadata(){return this._filtersMetadata}getCurrentLocalFilters(){const e=[];if(this._columnFilters)for(const t of Object.keys(this._columnFilters)){const i=this._columnFilters[t],s={columnId:t||""},n=this.sharedService.allColumns.find((e=>e.id===s.columnId)),r=n?.filter?.emptySearchTermReturnAllValues??!0;i?.searchTerms&&(s.searchTerms=i.searchTerms),i.operator&&(s.operator=i.operator),i.targetSelector&&(s.targetSelector=i.targetSelector),Array.isArray(s.searchTerms)&&s.searchTerms.length>0&&(!r||""!==s.searchTerms[0])&&e.push(s)}return e}emitFilterChanged(e,t=!1){const i=t?"onBeforeFilterChange":"onFilterChanged";if(e===h.remote&&this._gridOptions.backendServiceApi){let e=[];const t=this._gridOptions.backendServiceApi.service;return t?.getCurrentFilters&&(e=t.getCurrentFilters()),this.pubSubService.publish(i,e)}if(e===h.local)return this.pubSubService.publish(i,this.getCurrentLocalFilters())}async onBackendFilterChange(e,t){const i=t?.shouldTriggerQuery;if(i&&await this.emitFilterChanged(h.remote,!0),!t||!t.grid)throw new Error('Something went wrong when trying to bind the "onBackendFilterChange(event, args)" function, it seems that "args" is not populated correctly');const s=this._gridOptions.backendServiceApi;if(!s||!s.process||!s.service)throw new Error('BackendServiceApi requires at least a "process" function and a "service" defined');const n=new Date;if(s.preProcess&&s.preProcess(),i){const i=await s.service.processOnFilterChanged(e,t),r=this._gridOptions.pagination?.totalItems??0;this.backendUtilities?.executeBackendCallback(s,i,t,n,r,{errorCallback:this.resetToPreviousSearchFilters.bind(this),successCallback:e=>this._previousFilters=this.extractBasicFilterDetails(e.columnFilters),emitActionChangedCallback:this.emitFilterChanged.bind(this),httpCancelRequestSubject:this.httpCancelRequests$})}}populateColumnFilterSearchTermPresets(e){return Array.isArray(e)&&(this._columnDefinitions.forEach((t=>{t.filter?.searchTerms&&delete t.filter.searchTerms;const i=e.find((e=>e.columnId===t.id));i&&Array.isArray(i?.searchTerms)&&(t.filter=t.filter||{},t.filter.operator=i.operator||t.filter.operator||"",t.filter.searchTerms=i.searchTerms)})),this._gridOptions.enableTreeData&&this.refreshTreeDataFilters(),this._previousFilters=this.extractBasicFilterDetails(this._columnFilters)),this._columnDefinitions}refreshTreeDataFilters(e){const t=e??this._dataView?.getItems()??[];this._dataView&&this._gridOptions.enableTreeData&&t.length>0?(this._tmpPreFilteredData=this.preFilterTreeData(t,this._columnFilters),this._dataView.refresh()):0===t.length&&Array.isArray(this.sharedService.hierarchicalDataset)&&this.sharedService.hierarchicalDataset.length>0&&queueMicrotask((()=>this.refreshTreeDataFilters()))}disableFilterFunctionality(e=!0,t=!0){const i=!this._gridOptions.enableFiltering;i!==e&&(t&&e&&this.clearFilters(),this.disableAllFilteringCommands(e),this._grid.setOptions({enableFiltering:i},!1,!0),this._grid.setHeaderRowVisibility(i),this._gridOptions.enableFiltering=!e,this.sharedService.gridOptions=this._gridOptions,this._grid.setColumns(this.sharedService.columnDefinitions))}resetToPreviousSearchFilters(){this.updateFilters(this._previousFilters,!1,!1,!1)}toggleFilterFunctionality(e=!0){const t=this._gridOptions.enableFiltering;this.disableFilterFunctionality(t,e)}toggleHeaderFilterRow(){let e=this._gridOptions.showHeaderRow??!1;e=!e,this._grid.setHeaderRowVisibility(e),!0===e&&this._grid.setColumns(this.sharedService.columnDefinitions)}setSortColumnIcons(e){this._grid&&Array.isArray(e)&&this._grid.setSortColumns(e)}async updateFilters(e,t=!0,i=!0,s=!1){if(!this._filtersMetadata||0===this._filtersMetadata.length||!this._gridOptions||!this._gridOptions.enableFiltering)throw new Error('[Slickgrid-Universal] in order to use "updateFilters" method, you need to have Filterable Columns defined in your grid and "enableFiltering" set in your Grid Options');if(Array.isArray(e)){this.clearFilters(!1),e.forEach((e=>{const t=this._filtersMetadata.find((t=>e.columnId===t.columnDef.id));if(e&&t){const i=e.operator||t.defaultOperator;this.updateColumnFilters(e.searchTerms,t.columnDef,i),t.setValues(e.searchTerms||[],i),(s||this._gridOptions.enableTreeData)&&this.callbackSearchEvent(void 0,{columnDef:t.columnDef,operator:i,searchTerms:e.searchTerms,shouldTriggerQuery:!0,forceOnSearchChangeEvent:!0})}}));const n=this._gridOptions.backendServiceApi,r=n?h.remote:h.local;if(t&&await this.emitFilterChanged(r,!0),this._dataView.refresh(),n){const t=n?.service;t?.updateFilters&&(t.updateFilters(e,!0),i&&this.backendUtilities?.refreshBackendDataset(this._gridOptions))}t&&await this.emitFilterChanged(r)}return!0}async updateSingleFilter(e,t=!0,i=!0){const s=this.sharedService.allColumns.find((t=>t.id===e.columnId));if(s&&e.columnId){this._columnFilters={};const n=s.filter?.emptySearchTermReturnAllValues??!0;Array.isArray(e.searchTerms)&&(e.searchTerms.length>1||1===e.searchTerms.length&&(!n||""!==e.searchTerms[0]))&&(this._columnFilters[e.columnId]={columnId:e.columnId,operator:e.operator,searchTerms:e.searchTerms,columnDef:s,type:s.type??E.string});const r=this._gridOptions.backendServiceApi,o=r?h.remote:h.local;if(t&&await this.emitFilterChanged(o,!0),r){const e=r?.service;e?.updateFilters&&(e.updateFilters(this._columnFilters,!0),i&&this.backendUtilities?.refreshBackendDataset(this._gridOptions))}else this._dataView.setFilterArgs({columnFilters:this._columnFilters,grid:this._grid}),this._gridOptions.enableTreeData&&this.refreshTreeDataFilters(),this._dataView.refresh();t&&await this.emitFilterChanged(o)}return!0}drawFilterTemplate(e,t){let i;if("string"==typeof t){if(i=document.querySelector(t),null===i)return null}else i=t;const s="string"==typeof e?this.sharedService.allColumns.find((t=>t.id===e)):e;if("selector"!==(s?.id??"")&&s?.filterable){let e,t;const n=this.filterFactory.createFilter(s.filter);t=s&&s.filter&&s.filter.operator||n&&n.operator,this._columnFilters[s.id]?(e=this._columnFilters[s.id].searchTerms||void 0,t=this._columnFilters[s.id].operator||void 0):s.filter&&(e=s.filter.searchTerms||void 0,this.updateColumnFilters(e,s,t));const r={grid:this._grid,operator:t,searchTerms:e,columnDef:s,filterContainerElm:i,callback:this.callbackSearchEvent.bind(this)};return n&&(n.init(r),e&&n.setValues&&n.setValues(e,t)),n}return null}addFilterTemplateToHeaderRow(e,t=!0){const i=e.column;if("selector"!==(i?.id??"")&&i?.filterable&&!i?.hidden){let s,n;const r=this.filterFactory.createFilter(i.filter);n=i&&i.filter&&i.filter.operator||r&&r.operator,this._columnFilters[i.id]?(s=this._columnFilters[i.id].searchTerms||void 0,n=this._columnFilters[i.id].operator||void 0):i.filter&&(s=i.filter.searchTerms||void 0,this.updateColumnFilters(s,i,n));const o={grid:this._grid,operator:n,searchTerms:s,columnDef:i,filterContainerElm:e.node,callback:this.callbackSearchEvent.bind(this)};if(r&&o.filterContainerElm){r.init(o,t);const e=this._filtersMetadata.findIndex((e=>r.columnDef.id===e.columnDef.id));-1===e?this._filtersMetadata.push(r):this._filtersMetadata[e]=r,s&&r.setValues&&r.setValues(s,n)}}}callbackSearchEvent(e,t){if(t){const i=e?.target?e.target.value:void 0,s=t.searchTerms&&Array.isArray(t.searchTerms)?t.searchTerms:i?[i]:void 0,n=t.columnDef||null,r=n?.id??"",o=n?.filter?.type??n?.type??E.string,a=t.operator||void 0,l=s&&Array.isArray(s),h=l&&s&&s.length,c={...this._columnFilters},d=n.filter?.emptySearchTermReturnAllValues??!0;let u;if(n&&r)if(!l||0===h||1===h&&Array.isArray(s)&&d&&""===s[0])delete this._columnFilters[r];else{const t=`${r}`,i={columnId:t,columnDef:n,parsedSearchTerms:[],type:o,targetSelector:this.getSelectorStringFromElement(e?.target)},l=this.parseFormInputFilterConditions(s,i);i.operator=a||l.operator||X(o),u=Ro(l.searchTerms,o),void 0!==u&&(i.parsedSearchTerms=u),i.searchTerms=l.searchTerms||[],this._columnFilters[t]=i}const p=e&&"function"!=typeof e.isPropagationStopped?Te({},new bs,e):e,m=e?.key;if(this._onSearchChange&&(t.forceOnSearchChangeEvent||"Enter"===m||!jt(c,this._columnFilters))){const i={clearFilterTriggered:t.clearFilterTriggered,shouldTriggerQuery:t.shouldTriggerQuery,columnId:r,columnDef:n,columnFilters:this._columnFilters,operator:a||X(o),searchTerms:s,parsedSearchTerms:u,grid:this._grid,target:e?.target};!1===this.pubSubService.publish("onBeforeSearchChange",i)?this._gridOptions.resetFilterSearchValueAfterOnBeforeCancellation&&this.resetToPreviousSearchFilters():this._onSearchChange.notify(i,p)}}}disableAllFilteringCommands(e=!0){const t=this._grid.getColumns();t.forEach((t=>{t?.header?.menu&&t.header.menu.commandItems?.forEach((t=>{t&&"string"!=typeof t&&"clear-filter"===t.command&&(t.hidden=e)}))}));const i=this._gridOptions.gridMenu?.commandItems;return i&&i.forEach((t=>{if(t&&"string"!=typeof t){const i=t.command;"clear-filter"!==i&&"toggle-filter"!==i||(t.hidden=e)}})),t}extractBasicFilterDetails(e){const t=[];if(e&&"object"==typeof e)for(const i of Object.keys(e)){const{operator:s,searchTerms:n}=e[`${i}`];t.push({columnId:i,operator:s,searchTerms:n})}return t}getSelectorStringFromElement(e){return e?.localName?e?.className?`${e.localName}.${Array.from(e.classList).join(".")}`:e.localName:""}removeAllColumnFiltersProperties(){"object"==typeof this._columnFilters&&Object.keys(this._columnFilters).forEach((e=>{e&&this._columnFilters[e]&&delete this._columnFilters[e]}))}subscribeToOnHeaderRowCellRendered(e){this._eventHandler.subscribe(e.onBeforeHeaderRowCellDestroy,((e,t)=>{const i=this._filtersMetadata.find((e=>e.columnDef.id===t.column.id));i?.destroy?.()}))}updateColumnFilters(e,t,i){const s=t.filter?.type??t.type??E.string,n=Ro(e,s);e&&t&&(this._columnFilters[t.id]={columnId:t.id,columnDef:t,searchTerms:e,operator:i,parsedSearchTerms:n,type:s})}}const No={skipError:!1,triggerEvent:!0},Fo={highlightRow:!0,resortGrid:!1,selectRow:!1,scrollRowIntoView:!0,skipError:!1,triggerEvent:!0},Bo={highlightRow:!1,selectRow:!1,scrollRowIntoView:!1,skipError:!1,triggerEvent:!0},Ho={autoResizeColumns:!0,triggerEvent:!0,hideFromColumnPicker:!1,hideFromGridMenu:!1};class zo{constructor(e,t,i,s,n,r,o){this.gridStateService=e,this.filterService=t,this.pubSubService=i,this.paginationService=s,this.sharedService=n,this.sortService=r,this.treeDataService=o}get _dataView(){return this._grid?.getData()}get _gridOptions(){return this._grid?.getOptions()??{}}dispose(){this._rowSelectionPlugin?.dispose()}init(e){this._grid=e}clearAllFiltersAndSorts(){this.sortService&&this.sortService.clearSorting&&this.sortService.clearSorting(!1),this.filterService&&this.filterService.clearFilters&&this.filterService.clearFilters()}clearPinning(e=!0){const t=[...this.sharedService.visibleColumns];this.sharedService.slickGrid.setOptions({frozenColumn:-1,frozenRow:-1,frozenBottom:!1,enableMouseWheelScrollHandler:!1}),e&&Array.isArray(t)&&this.sharedService.slickGrid.setColumns(t)}setPinning(e,t=!0,i=!1,s=!0){$e(e)?this.clearPinning():(this.sharedService.slickGrid.setOptions(e,i,s),this.sharedService.gridOptions={...this.sharedService.gridOptions,...e}),t&&this.sharedService.slickGrid.autosizeColumns()}getAllColumnDefinitions(){return this.sharedService.allColumns}getVisibleColumnDefinitions(){return this.sharedService.visibleColumns}getColumnFromEventArguments(e){if(!(e&&e.grid&&e.grid.getColumns&&e.grid.getDataItem))throw new Error("[Slickgrid-Universal] To get the column definition and data, we need to have these arguments passed as objects (row, cell, grid)");return{row:e.row,cell:e.cell,columnDef:e.grid.getColumns()[e.cell],dataContext:e.grid.getDataItem(e.row),dataView:this._dataView,grid:this._grid}}getDataItemByRowNumber(e){if(!this._grid||"function"!=typeof this._grid.getDataItem)throw new Error('[Slickgrid-Universal] We could not find SlickGrid Grid object or it\'s "getDataItem" method');return this._grid.getDataItem(e)}getDataItemByRowIndex(e){if(!this._grid||"function"!=typeof this._grid.getDataItem)throw new Error('[Slickgrid-Universal] We could not find SlickGrid Grid object and/or "getDataItem" method');return this._grid.getDataItem(e)}getDataItemByRowIndexes(e){if(!this._grid||"function"!=typeof this._grid.getDataItem)throw new Error('[Slickgrid-Universal] We could not find SlickGrid Grid object and/or "getDataItem" method');const t=[];return Array.isArray(e)&&e.forEach((e=>{t.push(this._grid.getDataItem(e))})),t}getSelectedRows(){if(!this._grid||"function"!=typeof this._grid.getSelectedRows)throw new Error('[Slickgrid-Universal] We could not find SlickGrid Grid object and/or "getSelectedRows" method');return this._grid.getSelectedRows()}getSelectedRowsDataItem(){if(!this._grid||"function"!=typeof this._grid.getSelectedRows)throw new Error('[Slickgrid-Universal] We could not find SlickGrid Grid object and/or "getSelectedRows" method');const e=this._grid.getSelectedRows();return this.getDataItemByRowIndexes(e)}hideColumnById(e,t){if(t={...Ho,...t},this._grid&&this._grid.getColumns&&this._grid.setColumns){const i=this._grid.getColumns(),s=i.findIndex((t=>t.id===e));if(s>=0){const n=Ie(i,s);this.sharedService.visibleColumns=n,this._grid.setColumns(n);const r=this.sharedService.allColumns.findIndex((t=>t.id===e));return r&&(t?.hideFromColumnPicker&&(this.sharedService.allColumns[r].excludeFromColumnPicker=!0),t?.hideFromGridMenu&&(this.sharedService.allColumns[r].excludeFromGridMenu=!0)),t?.autoResizeColumns&&this._grid.autosizeColumns(),t?.triggerEvent&&this.pubSubService.publish("onHeaderMenuHideColumns",{columns:n}),s}}return-1}hideColumnByIds(e,t){if(t={...Ho,...t},Array.isArray(e)){for(const i of e)this.hideColumnById(i,{...t,triggerEvent:!1,autoResizeColumns:!1});t?.autoResizeColumns&&this._grid.autosizeColumns(),t?.triggerEvent&&this.pubSubService.publish("onHeaderMenuHideColumns",{columns:this.sharedService.visibleColumns})}}highlightRow(e,t){this._grid.getSelectionModel()||(this._rowSelectionPlugin=new Kr(this._gridOptions.rowSelectionOptions),this._grid.setSelectionModel(this._rowSelectionPlugin)),t||=this._gridOptions.rowHighlightDuration,Array.isArray(e)?e.forEach((e=>this._grid.highlightRow(e))):this._grid.highlightRow(e,t)}setSelectedRow(e){this._grid?.setSelectedRows&&this._grid.setSelectedRows([e])}setSelectedRows(e){this._grid?.setSelectedRows&&this._grid.setSelectedRows(e)}renderGrid(){"function"==typeof this._grid?.invalidate&&this._grid.invalidate()}resetGrid(e){if(this.clearPinning(!1),this._grid){const t=this.sharedService.allColumns||[];Array.isArray(t)&&t.length>0&&(this._grid.setColumns(t),this._gridOptions?.enableAutoSizeColumns&&this._grid.autosizeColumns(),this.gridStateService.resetColumns(e))}"function"==typeof this.filterService?.clearFilters&&this.filterService.clearFilters(),"function"==typeof this.sortService?.clearSorting&&this.sortService.clearSorting()}addItem(e,t){const i={...Fo,...t};if(!(i?.skipError||this._grid&&this._gridOptions&&this._dataView))throw new Error("[Slickgrid-Universal] We could not find SlickGrid Grid, DataView objects");const s=this._gridOptions.datasetIdPropertyName||"id";if(!(i?.skipError||e&&e.hasOwnProperty(s)))throw new Error(`[Slickgrid-Universal] Adding an item requires the item to include an "${s}" property`);if(this._gridOptions?.enableTreeData&&"top"===t?.position)throw new Error('[Slickgrid-Universal] Please note that `addItem({ position: "top" })` is not supported when used with Tree Data because of the extra complexity.');const n=i?.position;"bottom"===n||this._gridOptions?.enableTreeData?this._dataView.addItem(e):this._dataView.insertItem(0,e);let r=0;const o=e?.[s]??"";return this._gridOptions?.enableTreeData?(this.invalidateHierarchicalDataset(),r=this._dataView.getRowById(o),i.scrollRowIntoView&&this._grid.scrollRowIntoView(r??0,!1)):i.resortGrid?(this._dataView.reSort(),r=this._dataView.getRowById(o)):(r="bottom"===n?this._dataView.getRowById(o):0,i.scrollRowIntoView&&this._grid.scrollRowIntoView(r??0)),i.highlightRow&&void 0!==r&&this.highlightRow(r),void 0!==r&&i.selectRow&&this._gridOptions&&(this._gridOptions.enableCheckboxSelector||this._gridOptions.enableRowSelection)&&this.setSelectedRow(r),i.triggerEvent&&this.pubSubService.publish("onItemAdded",e),!this._gridOptions?.backendServiceApi&&this._gridOptions.enablePagination&&("bottom"===n?this.paginationService.goToLastPage():this.paginationService.goToFirstPage()),r}addItems(e,t){const i={...Fo,...t},s=this._gridOptions.datasetIdPropertyName||"id",n=i?.position,r=[];if(!Array.isArray(e))return[this.addItem(e,i)||0];if(this._dataView.beginUpdate(!0),"bottom"===n||this._gridOptions?.enableTreeData?this._dataView.addItems(e):this._dataView.insertItems(0,e),this._dataView.endUpdate(),this._gridOptions?.enableTreeData){this.invalidateHierarchicalDataset();const t=e[0]?.[s]??"",n=this._dataView.getRowById(t);i.scrollRowIntoView&&this._grid.scrollRowIntoView(n??0,!1)}else i.resortGrid&&this._dataView.reSort();return n&&i.scrollRowIntoView&&!this._gridOptions?.enableTreeData&&("bottom"===n?this._grid.navigateBottom():this._grid.navigateTop()),e.forEach((e=>r.push(this._dataView.getRowById(e[s])))),i.highlightRow&&this.highlightRow(r),i.selectRow&&this._gridOptions&&(this._gridOptions.enableCheckboxSelector||this._gridOptions.enableRowSelection)&&this.setSelectedRows(r),i.triggerEvent&&this.pubSubService.publish("onItemAdded",e),r}deleteItem(e,t){t={...No,...t};const i=this._gridOptions.datasetIdPropertyName||"id";if(!(t?.skipError||e&&e.hasOwnProperty(i)))throw new Error(`[Slickgrid-Universal] Deleting an item requires the item to include an "${i}" property`);return this.deleteItemById(e[i],t)}deleteItems(e,t){t={...No,...t};const i=this._gridOptions.datasetIdPropertyName||"id";if(!Array.isArray(e))return this.deleteItem(e,t),[e[i]];this._dataView.beginUpdate(!0);const s=[];return e.forEach((e=>{void 0!==e?.[i]&&s.push(e[i])})),this._dataView.deleteItems(s),this._dataView.endUpdate(),t.triggerEvent&&this.pubSubService.publish("onItemDeleted",e),s}deleteItemById(e,t){if(t={...No,...t},!t?.skipError&&null==e)throw new Error('[Slickgrid-Universal] Cannot delete a row without a valid "id"');return!(this.gridStateService&&this.gridStateService.needToPreserveRowSelection())&&this._grid&&this._gridOptions&&(this._gridOptions.enableCheckboxSelector||this._gridOptions.enableRowSelection)&&this.setSelectedRows([]),this._dataView.deleteItem(e),t.triggerEvent&&this.pubSubService.publish("onItemDeleted",e),e}deleteItemByIds(e,t){if(t={...No,...t},Array.isArray(e)){this._dataView.beginUpdate(!0);for(let t=0;t<e.length;t++)null!==e[t]&&this.deleteItemById(e[t],{triggerEvent:!1});return this._dataView.endUpdate(),t.triggerEvent&&this.pubSubService.publish("onItemDeleted",e),e}return[]}updateItem(e,t){t={...Bo,...t};const i=this._gridOptions.datasetIdPropertyName||"id",s=e&&e.hasOwnProperty(i)?e[i]:void 0;if(!t?.skipError&&void 0===s)throw new Error(`[Slickgrid-Universal] Calling Update of an item requires the item to include an "${i}" property`);return this.updateItemById(s,e,t)}updateItems(e,t){t={...Bo,...t};const i=this._gridOptions.datasetIdPropertyName||"id";if(!Array.isArray(e))return[this.updateItem(e,t)];this._dataView.beginUpdate(!0);const s=[],n=[];return e.forEach((e=>{const t=e&&e.hasOwnProperty(i)?e[i]:void 0;if(n.push(t),void 0!==this._dataView.getIdxById(t)){const e=this._dataView.getRowById(t);void 0!==e&&(s.push(e),this._grid.updateRow(e))}})),this._dataView.updateItems(n,e),this._dataView.endUpdate(),this._gridOptions?.enableTreeData&&this.invalidateHierarchicalDataset(),t.highlightRow&&this.highlightRow(s),t.selectRow&&this._gridOptions&&(this._gridOptions.enableCheckboxSelector||this._gridOptions.enableRowSelection)&&this.setSelectedRows(s),t.triggerEvent&&this.pubSubService.publish("onItemUpdated",e),s}updateItemById(e,t,i){if(i={...Bo,...i},!i?.skipError&&void 0===e)throw new Error('[Slickgrid-Universal] Cannot update a row without a valid "id"');const s=this._dataView.getRowById(e);if(!i?.skipError&&!t&&!this._gridOptions.enablePagination)throw new Error(`[Slickgrid-Universal] The item to update in the grid was not found with id: ${e}`);return void 0!==this._dataView.getIdxById(e)&&(this._dataView.updateItem(e,t),void 0!==s&&this._grid.updateRow(s),this._gridOptions?.enableTreeData&&this.invalidateHierarchicalDataset(),i.scrollRowIntoView&&void 0!==s&&this._grid.scrollRowIntoView(s),i.highlightRow&&void 0!==s&&this.highlightRow(s),void 0!==s&&i.selectRow&&this._gridOptions&&(this._gridOptions.enableCheckboxSelector||this._gridOptions.enableRowSelection)&&this.setSelectedRow(s),i.triggerEvent&&this.pubSubService.publish("onItemUpdated",t)),s}upsertItem(e,t){t={...Fo,...t};const i=this._gridOptions.datasetIdPropertyName||"id",s=e&&e.hasOwnProperty(i)?e[i]:void 0;if(!t?.skipError&&void 0===s)throw new Error(`[Slickgrid-Universal] Calling Upsert of an item requires the item to include an "${i}" property`);return this.upsertItemById(s,e,t)}upsertItems(e,t){if(t={...Fo,...t},!Array.isArray(e))return[this.upsertItem(e,t)];this._dataView.beginUpdate(!0);const i=[];e.forEach((e=>{i.push(this.upsertItem(e,{...t,highlightRow:!1,resortGrid:!1,selectRow:!1,triggerEvent:!1}))})),this._dataView.endUpdate();const s=i.map((e=>void 0!==e.added?e.added:e.updated));if(t.highlightRow&&this.highlightRow(s),t.selectRow&&this._gridOptions&&(this._gridOptions.enableCheckboxSelector||this._gridOptions.enableRowSelection)&&this.setSelectedRows(s),t.triggerEvent){this.pubSubService.publish("onItemUpserted",e);const t=i.filter((e=>void 0!==e.added));Array.isArray(t)&&t.length>0&&this.pubSubService.publish("onItemAdded",t);const s=i.filter((e=>void 0!==e.updated));Array.isArray(s)&&s.length>0&&this.pubSubService.publish("onItemUpdated",s)}return i}upsertItemById(e,t,i){let s,n,r=!1;if(i={...Fo,...i},!i?.skipError&&void 0===e&&!this.hasRowSelectionEnabled())throw new Error('[Slickgrid-Universal] Calling Upsert of an item requires the item to include a valid and unique "id" property');return void 0===this._dataView.getRowById(e)?(s=this.addItem(t,i),r=!0):(n=this.updateItem(t,{highlightRow:i.highlightRow,selectRow:i.selectRow,triggerEvent:i.triggerEvent}),r=!1),i.triggerEvent&&(this.pubSubService.publish("onItemUpserted",t),r?this.pubSubService.publish("onItemAdded",t):this.pubSubService.publish("onItemUpdated",t)),{added:s,updated:n}}invalidateHierarchicalDataset(e){if(this._gridOptions?.enableTreeData&&this.treeDataService){const t=e??this._dataView.getItems(),i=this.sortService.getCurrentColumnSorts(),s=this.treeDataService.convertFlatParentChildToTreeDatasetAndSort(t||[],this.sharedService.allColumns,this._gridOptions,i);this.sharedService.hierarchicalDataset=s.hierarchical,this.filterService.refreshTreeDataFilters(e),this._dataView.setItems(s.flat),this._grid.invalidate()}}hasRowSelectionEnabled(){const e=this._grid.getSelectionModel();return!(!this._gridOptions.enableRowSelection&&!this._gridOptions.enableCheckboxSelector||!e)}}class $o{get eventHandler(){return this._eventHandler}constructor(){this._eventHandler=new Cs}dispose(){this._eventHandler.unsubscribeAll()}bindOnBeforeEditCell(e){const t=e?.getData();this._eventHandler.subscribe(e.onBeforeEditCell,((i,s)=>{if(!(i&&s&&e&&void 0!==s.cell&&e.getColumns&&e.getDataItem))return;const n=e.getColumns()[s.cell];if("function"==typeof n.onBeforeEditCell){const r={row:s.row,cell:s.cell,dataView:t,grid:e,columnDef:n,dataContext:e.getDataItem(s.row)};n.onBeforeEditCell(i instanceof bs?i.getNativeEvent():i,r)}}))}bindOnCellChange(e){const t=e?.getData();this._eventHandler.subscribe(e.onCellChange,((i,s)=>{if(!(i&&s&&e&&void 0!==s.cell&&e.getColumns&&e.getDataItem))return;const n=e.getColumns()[s.cell];if("function"==typeof n.onCellChange){const r={row:s.row,cell:s.cell,dataView:t,grid:e,columnDef:n,dataContext:e.getDataItem(s.row)};n.onCellChange(i instanceof bs?i.getNativeEvent():i,r)}}))}bindOnClick(e){const t=e?.getData();this._eventHandler.subscribe(e.onClick,((i,s)=>{if(!(i&&s&&e&&void 0!==s.cell&&e.getColumns&&e.getDataItem))return;const n=e.getColumns()[s.cell];if("function"==typeof n.onCellClick){const r={row:s.row,cell:s.cell,dataView:t,grid:e,columnDef:n,dataContext:e.getDataItem(s.row)};n.onCellClick(i instanceof bs?i.getNativeEvent():i,r)}}))}}class Vo{constructor(e,t,i,s,n,r){this.extensionService=e,this.filterService=t,this.pubSubService=i,this.sharedService=s,this.sortService=n,this.treeDataService=r,this._columns=[],this._subscriptions=[],this._selectedRowIndexes=[],this._selectedRowDataContextIds=[],this._wasRecheckedAfterPageChange=!0,this._eventHandler=new Cs}get _dataView(){return this._grid?.getData()??{}}get _gridOptions(){return this._grid?.getOptions()??{}}get selectedRowDataContextIds(){return this._selectedRowDataContextIds}set selectedRowDataContextIds(e){this._selectedRowDataContextIds=e}init(e){this._grid=e,this.subscribeToAllGridChanges(e)}dispose(){this._columns=[],this._eventHandler.unsubscribeAll(),this.pubSubService.unsubscribeAll(this._subscriptions)}changeColumnsArrangement(e,t=!0,i=!1){if(Array.isArray(e)&&e.length>0){const s=this.getAssociatedGridColumns(this._grid,e);if(s&&Array.isArray(s)&&s.length>0){if(Array.isArray(this.sharedService.allColumns)){const e=[];if(this._gridOptions.enableCheckboxSelector){const t=this._gridOptions?.checkboxSelector?.columnIndexPosition??0;e.push({columnId:"_checkbox_selector",columnIndexPosition:t})}if(this._gridOptions.enableRowDetailView){const t=this._gridOptions?.rowDetailView?.columnIndexPosition??0;e.push({columnId:"_detail_selector",columnIndexPosition:t})}if(this._gridOptions.enableRowMoveManager){const t=this._gridOptions?.rowMoveManager?.columnIndexPosition??0;e.push({columnId:"_move",columnIndexPosition:t})}this.addColumnDynamicWhenFeatureEnabled(e,this.sharedService.allColumns,s)}s.forEach((e=>e.originalWidth=e.width||e.originalWidth)),this._grid.setColumns(s),this.sharedService.visibleColumns=s,t?this._grid.autosizeColumns():(i||this._gridOptions.enableAutoResizeColumnsByCellContent&&!this._gridOptions.autosizeColumnsByCellContentOnFirstLoad)&&this.pubSubService.publish("onFullResizeByContentRequested",{caller:"GridStateService"})}}}getCurrentGridState(){const{frozenColumn:e,frozenRow:t,frozenBottom:i}=this.sharedService.gridOptions,s={columns:this.getCurrentColumns(),filters:this.getCurrentFilters(),sorters:this.getCurrentSorters(),pinning:{frozenColumn:e,frozenRow:t,frozenBottom:i}},n=this.getCurrentPagination();if(n&&(s.pagination=n),this.hasRowSelectionEnabled()){const e=this.getCurrentRowSelections();e&&(s.rowSelection=e)}if(this._gridOptions?.enableTreeData){const e=this.getCurrentTreeDataToggleState();e&&(s.treeData=e)}return s}getColumns(){return this._columns}getAssociatedCurrentColumns(e){const t=[];return e&&Array.isArray(e)&&e.forEach((e=>{e?.id&&t.push({columnId:e.id,cssClass:e.cssClass||"",headerCssClass:e.headerCssClass||"",width:e.width||0})})),t}getAssociatedGridColumns(e,t){const i=[],s=this.sharedService.allColumns||e.getColumns();return t&&Array.isArray(t)&&t.forEach((e=>{const t=s.find((t=>t.id===e.columnId));t?.id&&i.push({...t,cssClass:e.cssClass||t.cssClass,headerCssClass:e.headerCssClass||t.headerCssClass,width:e.width})})),this._columns=i,i}getCurrentColumns(){return this.getAssociatedCurrentColumns(this._grid.getColumns()||[])}getCurrentFilters(){if(this._gridOptions?.backendServiceApi){const e=this._gridOptions.backendServiceApi.service;if(e?.getCurrentFilters)return e.getCurrentFilters()}else if(this.filterService?.getCurrentLocalFilters)return this.filterService.getCurrentLocalFilters();return null}getCurrentPagination(){if(this._gridOptions?.enablePagination){if(!this._gridOptions.backendServiceApi)return this.sharedService.currentPagination;{const e=this._gridOptions.backendServiceApi.service;if(e?.getCurrentPagination)return e.getCurrentPagination()}}return null}getCurrentRowSelections(){return this._grid&&this._dataView&&this.hasRowSelectionEnabled()?{gridRowIndexes:this._grid.getSelectedRows()||[],dataContextIds:this._dataView.getAllSelectedIds()||[],filteredDataContextIds:this._dataView.getAllSelectedFilteredIds()||[]}:null}getCurrentSorters(){if(this._gridOptions?.backendServiceApi){const e=this._gridOptions.backendServiceApi.service;if(e?.getCurrentSorters)return e.getCurrentSorters()}else if(this.sortService?.getCurrentLocalSorters)return this.sortService.getCurrentLocalSorters();return null}getCurrentTreeDataToggleState(){return this._gridOptions?.enableTreeData&&this.treeDataService?this.treeDataService.getCurrentToggleState():null}needToPreserveRowSelection(){let e=!1;if(this._gridOptions?.dataView&&this._gridOptions.dataView.hasOwnProperty("syncGridSelection")){const t=this._gridOptions.dataView.syncGridSelection;"boolean"==typeof t?e=this._gridOptions.dataView.syncGridSelection:"object"==typeof t&&(e=t.preserveHidden||t.preserveHiddenOnSelectionChange),e&&this._gridOptions.backendServiceApi&&this._gridOptions.dataView.hasOwnProperty("syncGridSelectionWithBackendService")&&(e=this._gridOptions.dataView.syncGridSelectionWithBackendService)}return e}resetColumns(e){const t=e||this._columns,i=this.getAssociatedCurrentColumns(t);this.pubSubService.publish("onGridStateChanged",{change:{newValues:i,type:O.columns},gridState:this.getCurrentGridState()})}resetToOriginalColumns(e=!0){this._grid.setColumns(this.sharedService.allColumns),this.sharedService.visibleColumns=this.sharedService.allColumns,e&&this._grid.autosizeColumns()}resetRowSelectionWhenRequired(){if(!this.needToPreserveRowSelection()&&(this._gridOptions.enableRowSelection||this._gridOptions.enableCheckboxSelector)){const e=this.extensionService?.getExtensionByName?.(S.rowSelection);e?.instance&&this._grid.setSelectedRows([])}}subscribeToAllGridChanges(e){this._subscriptions.push(this.pubSubService.subscribe("onFilterChanged",(e=>{this.resetRowSelectionWhenRequired(),this.pubSubService.publish("onGridStateChanged",{change:{newValues:e,type:O.filter},gridState:this.getCurrentGridState()})}))),this._subscriptions.push(this.pubSubService.subscribe("onFilterCleared",(()=>{this.resetRowSelectionWhenRequired(),this.pubSubService.publish("onGridStateChanged",{change:{newValues:[],type:O.filter},gridState:this.getCurrentGridState()})}))),this._subscriptions.push(this.pubSubService.subscribe("onSortChanged",(e=>{this.resetRowSelectionWhenRequired(),this.pubSubService.publish("onGridStateChanged",{change:{newValues:e,type:O.sorter},gridState:this.getCurrentGridState()})}))),this._subscriptions.push(this.pubSubService.subscribe("onSortCleared",(()=>{this.resetRowSelectionWhenRequired(),this.pubSubService.publish("onGridStateChanged",{change:{newValues:[],type:O.sorter},gridState:this.getCurrentGridState()})}))),this.bindExtensionAddonEventToGridStateChange(S.columnPicker,"onColumnsChanged"),this.bindExtensionAddonEventToGridStateChange(S.gridMenu,"onColumnsChanged"),this.bindSlickGridColumnChangeEventToGridStateChange("onColumnsReordered",e),this.bindSlickGridColumnChangeEventToGridStateChange("onColumnsResized",e),this.bindSlickGridOnSetOptionsEventToGridStateChange(e),(this._gridOptions.enableRowSelection||this._gridOptions.enableCheckboxSelector)&&this._eventHandler.subscribe(this._dataView.onSelectedRowIdsChanged,((e,t)=>{const i=(this._selectedRowIndexes||[]).slice(),s=(this.selectedRowDataContextIds||[]).slice();if(this.selectedRowDataContextIds=t.filteredIds,this._selectedRowIndexes=t.rows,!jt(this.selectedRowDataContextIds,s)||!jt(this._selectedRowIndexes,i)){const e={gridRowIndexes:this._selectedRowIndexes||[],dataContextIds:t.selectedRowIds,filteredDataContextIds:t.filteredIds};this.pubSubService.publish("onGridStateChanged",{change:{newValues:e,type:O.rowSelection},gridState:this.getCurrentGridState()})}})),this._subscriptions.push(this.pubSubService.subscribe("onHeaderMenuHideColumns",(e=>{const t=this.getAssociatedCurrentColumns(e);this.pubSubService.publish("onGridStateChanged",{change:{newValues:t,type:O.columns},gridState:this.getCurrentGridState()})}))),this._subscriptions.push(this.pubSubService.subscribe("onTreeItemToggled",(e=>{this.pubSubService.publish("onGridStateChanged",{change:{newValues:e,type:O.treeData},gridState:this.getCurrentGridState()})}))),this._subscriptions.push(this.pubSubService.subscribe("onTreeFullToggleEnd",(e=>{this.pubSubService.publish("onGridStateChanged",{change:{newValues:e,type:O.treeData},gridState:this.getCurrentGridState()})})))}addColumnDynamicWhenFeatureEnabled(e,t,i){e.sort(((e,t)=>e.columnIndexPosition-t.columnIndexPosition)),e.forEach((e=>{const s=t.findIndex((t=>t.id===e.columnId)),n=i.findIndex((t=>t.id===e.columnId));if(s>=0&&-1===n){const e=t[s];0===s?i.unshift(e):i.splice(s,0,e)}}))}bindExtensionAddonEventToGridStateChange(e,t){const i=this.extensionService?.getExtensionByName?.(e),s=i?.instance?.[t];s&&"function"==typeof s.subscribe&&this._eventHandler.subscribe(s,((e,t)=>{const i=t?.columns,s=this.getAssociatedCurrentColumns(i);this.pubSubService.publish("onGridStateChanged",{change:{newValues:s,type:O.columns},gridState:this.getCurrentGridState()})}))}bindSlickGridColumnChangeEventToGridStateChange(e,t){const i=t?.[e];i&&"function"==typeof i.subscribe&&this._eventHandler.subscribe(i,(()=>{const e=t.getColumns(),i=this.getAssociatedCurrentColumns(e);this.pubSubService.publish("onGridStateChanged",{change:{newValues:i,type:O.columns},gridState:this.getCurrentGridState()})}))}bindSlickGridOnSetOptionsEventToGridStateChange(e){const t=e.onSetOptions;this._eventHandler.subscribe(t,((e,t)=>{const{frozenBottom:i,frozenColumn:s,frozenRow:n}=t.optionsBefore,{frozenBottom:r,frozenColumn:o,frozenRow:a}=t.optionsAfter;if(i!==r||s!==o||n!==a){const e={frozenBottom:r,frozenColumn:o,frozenRow:a},t=this.getCurrentGridState();this.pubSubService.publish("onGridStateChanged",{change:{newValues:e,type:O.pinning},gridState:t})}}))}hasRowSelectionEnabled(){const e=this._grid.getSelectionModel();return!(!this._gridOptions.enableRowSelection&&!this._gridOptions.enableCheckboxSelector||!e)}}class Wo{constructor(e){this.extensionUtility=e,this._subscriptions=[],this._eventHandler=new Cs}get _dataView(){return this._grid?.getData()??{}}get eventHandler(){return this._eventHandler}get _gridOptions(){return this._grid?.getOptions()??{}}get _columnDefinitions(){return this._grid?.getColumns()??[]}init(e){this._grid=e,e&&this._gridOptions&&this._gridOptions.createPreHeaderPanel&&(this._gridOptions.enableTranslate&&this.translateHeaderGrouping(),this._eventHandler.subscribe(e.onRendered,(()=>this.renderPreHeaderRowGroupingTitles())),this._eventHandler.subscribe(e.onAutosizeColumns,(()=>this.renderPreHeaderRowGroupingTitles())),this._eventHandler.subscribe(this._dataView.onRowCountChanged,(()=>this.delayRenderPreHeaderRowGroupingTitles(0))),this._eventHandler.subscribe(e.onSetOptions,((e,t)=>{t?.optionsBefore?.frozenColumn!==t?.optionsAfter?.frozenColumn&&this.delayRenderPreHeaderRowGroupingTitles(0)})),this.delayRenderPreHeaderRowGroupingTitles(75))}dispose(){this._eventHandler.unsubscribeAll()}delayRenderPreHeaderRowGroupingTitles(e=0){window.setTimeout((()=>this.renderPreHeaderRowGroupingTitles()),e)}renderPreHeaderRowGroupingTitles(){const e=this._columnDefinitions.length;if(void 0!==this._gridOptions?.frozenColumn&&this._gridOptions.frozenColumn>=0){const t=this._gridOptions.frozenColumn;this.renderHeaderGroups(this._grid.getPreHeaderPanelLeft(),0,t+1),this.renderHeaderGroups(this._grid.getPreHeaderPanelRight(),t+1,e)}else this.renderHeaderGroups(this._grid.getPreHeaderPanel(),0,e)}renderHeaderGroups(e,t,i){re(e),e.className="slick-header-columns",e.style.left="-1000px",e.style.width=`${this._grid.getHeadersWidth()}px`,e.parentElement?.classList.add("slick-header");const s=this._grid.getHeaderColumnWidthDiff();let n,r=null,o="",a=0;const l=this._gridOptions?.frozenHeaderWidthCalcDifferential??0,h=void 0!==this._gridOptions?.frozenColumn&&this._gridOptions.frozenColumn>=0;for(let c=t;c<i;c++)n=this._columnDefinitions[c],n&&(o===n.columnGroup&&c>0?(a+=n.width||0,r?.style&&(r.style.width=a-s-l+"px")):(a=n.width||0,r=ie("div",{className:"slick-state-default slick-header-column "+(h?"frozen":""),dataset:{group:n.columnGroup},style:{width:a-s+"px"}}),ie("span",{className:"slick-column-name",textContent:n.columnGroup||""},r),e.appendChild(r)),o=n.columnGroup||"")}translateHeaderGrouping(){const e=this._grid.getColumns();this.extensionUtility.translateItems(e,"columnGroupKey","columnGroup"),this._grid.setColumns(e),this.renderPreHeaderRowGroupingTitles()}}class Uo{constructor(e,t,i,s){this.pubSubService=e,this.sharedService=t,this.backendUtilities=i,this.rxjs=s,this._initialized=!1,this._isLocalGrid=!0,this._dataFrom=1,this._dataTo=1,this._itemsPerPage=0,this._pageCount=1,this._pageNumber=1,this._totalItems=0,this._availablePageSizes=[],this._subscriptions=[],this._isCursorBased=!1,this._eventHandler=new Cs}get dataView(){return this.grid?.getData()??{}}set paginationOptions(e){this._paginationOptions=e}get paginationOptions(){return this._paginationOptions}get availablePageSizes(){return this._availablePageSizes}get dataFrom(){return this._dataFrom}get dataTo(){return this._dataTo}get itemsPerPage(){return this._itemsPerPage}get pageCount(){return this._pageCount}get pageNumber(){return this._pageNumber}get totalItems(){return this._totalItems}set totalItems(e){this._totalItems=e,this._initialized&&this.refreshPagination()}get isCursorBased(){return this._isCursorBased}addRxJsResource(e){this.rxjs=e}init(e,t,i){if(this._availablePageSizes=t.pageSizes||[],this.grid=e,this._backendServiceApi=i,this._paginationOptions=t,this._isLocalGrid=!i,this._pageNumber=t.pageNumber||1,this._isCursorBased=i?.options?.useCursor??!1,i&&(!i.service||!i.process))throw new Error('BackendServiceApi requires the following 2 properties "process" and "service" to be defined.');this._isLocalGrid&&this.dataView&&(this._eventHandler.subscribe(this.dataView.onPagingInfoChanged,((e,t)=>{this._totalItems!==t.totalRows&&(this.updateTotalItems(t.totalRows),this._previousPagination={pageNumber:t.pageNum,pageSize:t.pageSize,pageSizes:this.availablePageSizes,totalItems:t.totalRows})})),queueMicrotask((()=>{this.dataView&&(this.dataView.setRefreshHints({isFilterUnchanged:!0}),this.dataView.setPagingOptions({pageSize:this.paginationOptions.pageSize,pageNum:this._pageNumber-1}))}))),this._subscriptions.push(this.pubSubService.subscribe(["onFilterChanged","onFilterCleared"],(()=>this.resetPagination()))),i?.options?.infiniteScroll&&this._subscriptions.push(this.pubSubService.subscribe("onSortChanged",(()=>this.resetPagination()))),this.dataView&&(this._subscriptions.push(this.pubSubService.subscribe("onItemAdded",(e=>this.processOnItemAddedOrRemoved(e,!0)))),this._subscriptions.push(this.pubSubService.subscribe("onItemDeleted",(e=>this.processOnItemAddedOrRemoved(e,!1))))),this.refreshPagination(!1,!1,!0);const s=this.getFullPagination();this._previousPagination={pageNumber:s.pageNumber,pageSize:s.pageSize,pageSizes:s.pageSizes,totalItems:this.totalItems},this._initialized=!0,v(t,"totalItems",(e=>this._totalItems=e))}dispose(){this._initialized=!1,this._eventHandler.unsubscribeAll(),this.pubSubService.unsubscribeAll(this._subscriptions)}getCurrentPagination(){return{pageNumber:this._pageNumber,pageSize:this._itemsPerPage,pageSizes:this._availablePageSizes}}getFullPagination(){return{pageCount:this._pageCount,pageNumber:this._pageNumber,pageSize:this._itemsPerPage,pageSizes:this._availablePageSizes,totalItems:this._totalItems,dataFrom:this._dataFrom,dataTo:this._dataTo}}getCurrentPageNumber(){return this._pageNumber}getCurrentItemPerPage(){return this._itemsPerPage}changeItemPerPage(e,t,i=!0){return this._pageNumber=1,this._pageCount=Math.ceil(this._totalItems/e),this._itemsPerPage=e,i?this.processOnPageChanged(this._pageNumber,t):Promise.resolve(this.getFullPagination())}goToFirstPage(e,t=!0){return this._pageNumber=1,t?this.isCursorBased&&this._cursorPageInfo?this.processOnPageChanged(this._pageNumber,e,{newPage:this._pageNumber,pageSize:this._itemsPerPage,first:this._itemsPerPage}):this.processOnPageChanged(this._pageNumber,e):Promise.resolve(this.getFullPagination())}goToLastPage(e,t=!0){return this._pageNumber=this._pageCount||1,t?this.isCursorBased&&this._cursorPageInfo?this.processOnPageChanged(this._pageNumber,e,{newPage:this._pageNumber,pageSize:this._itemsPerPage,last:this._itemsPerPage}):this.processOnPageChanged(this._pageNumber,e):Promise.resolve(this.getFullPagination())}goToNextPage(e,t=!0){return this._pageNumber<this._pageCount?(this._pageNumber++,t?this.isCursorBased&&this._cursorPageInfo?this.processOnPageChanged(this._pageNumber,e,{newPage:this._pageNumber,pageSize:this._itemsPerPage,first:this._itemsPerPage,after:this._cursorPageInfo.endCursor}):this.processOnPageChanged(this._pageNumber,e):Promise.resolve(this.getFullPagination())):Promise.resolve(!1)}goToPageNumber(e,t,i=!0){if(this.isCursorBased)return console.assert(!0,"Cursor based navigation cannot navigate to arbitrary page"),Promise.resolve(!1);const s=this._pageNumber;return e<1?this._pageNumber=1:e>this._pageCount?this._pageNumber=this._pageCount:this._pageNumber=e,this._pageNumber!==s?i?this.processOnPageChanged(this._pageNumber,t):Promise.resolve(this.getFullPagination()):Promise.resolve(!1)}goToPreviousPage(e,t=!0){return this._pageNumber>1?(this._pageNumber--,t?this.isCursorBased&&this._cursorPageInfo?this.processOnPageChanged(this._pageNumber,e,{newPage:this._pageNumber,pageSize:this._itemsPerPage,last:this._itemsPerPage,before:this._cursorPageInfo.startCursor}):this.processOnPageChanged(this._pageNumber,e):Promise.resolve(this.getFullPagination())):Promise.resolve(!1)}refreshPagination(e=!1,t=!0,i=!1){const s={...this.getFullPagination()};if(this._paginationOptions){const t=this._paginationOptions;this._itemsPerPage||(this._isLocalGrid?this._itemsPerPage=t.pageSize:this._itemsPerPage=+(this._backendServiceApi?.options?.paginationOptions?.first?this._backendServiceApi.options.paginationOptions.first:t.pageSize)),(e||this._totalItems!==t.totalItems)&&(e?(this._pageNumber=1,this.paginationOptions.pageNumber=1):!this._initialized&&t.pageNumber&&t.pageNumber>1&&(this._pageNumber=t.pageNumber||1),1===this._pageNumber&&this._backendServiceApi&&this._backendServiceApi.service.resetPaginationOptions()),this._availablePageSizes=t.pageSizes||[],!this._totalItems&&t.totalItems&&(this._totalItems=t.totalItems),this.recalculateFromToIndexes()}this._pageCount=Math.ceil(this._totalItems/this._itemsPerPage),this.sharedService.currentPagination=this.getCurrentPagination(),this.pubSubService.publish("onPaginationRefreshed",this.getFullPagination()),t&&!jt(s,this.getFullPagination())&&this.pubSubService.publish("onPaginationChanged",this.getFullPagination()),i&&!jt(s,this.getFullPagination())&&this.pubSubService.publish("onPaginationPresetsInitialized",this.getFullPagination());const n=this.getFullPagination();this._previousPagination={pageNumber:n.pageNumber,pageSize:n.pageSize,pageSizes:n.pageSizes,totalItems:this.totalItems}}resetPagination(e=!0,t=!0){this._isLocalGrid&&this.dataView&&this.sharedService?.gridOptions?.enablePagination&&this.dataView.setPagingOptions({pageSize:this._itemsPerPage,pageNum:0}),this._cursorPageInfo=void 0,this.refreshPagination(!0,e),t&&this.grid.scrollTo(0)}togglePaginationVisibility(e){if(this.grid&&this.sharedService?.gridOptions){const t=void 0!==e?e:!this.sharedService.gridOptions.enablePagination;if(t&&this.goToFirstPage(),this._isLocalGrid&&this.dataView){const t=e?this._itemsPerPage:0;this.dataView.setPagingOptions({pageSize:t,pageNum:0})}this.sharedService.gridOptions.enablePagination=t,this.pubSubService.publish("onPaginationVisibilityChanged",{visible:t})}}processOnPageChanged(e,t,i){return console.assert(!this.isCursorBased||i,"Configured for cursor based pagination - cursorArgs expected"),!1===this.pubSubService.publish("onBeforePaginationChange",this.getFullPagination())?(this.resetToPreviousPagination(),Promise.resolve(this.getFullPagination())):new Promise(((s,n)=>{if(this.recalculateFromToIndexes(),this._isLocalGrid&&this.dataView)this.dataView.setPagingOptions({pageSize:this._itemsPerPage,pageNum:e-1}),this.pubSubService.publish("onPaginationChanged",this.getFullPagination()),this.pubSubService.publish("onPaginationRefreshed",this.getFullPagination()),s(this.getFullPagination());else{const r=+this._itemsPerPage,o=new Date;if(this._backendServiceApi?.preProcess&&this._backendServiceApi.preProcess(),this._backendServiceApi?.process){const a=this.isCursorBased&&i?this._backendServiceApi.service.processOnPaginationChanged(t,i):this._backendServiceApi.service.processOnPaginationChanged(t,{newPage:e,pageSize:r}),l=this._backendServiceApi.process(a);l instanceof Promise?l.then((e=>{this.backendUtilities?.executeBackendProcessesCallback(o,e,this._backendServiceApi,this._totalItems);const t=this.getFullPagination();this._previousPagination={pageNumber:t.pageNumber,pageSize:t.pageSize,pageSizes:t.pageSizes,totalItems:this.totalItems},s(this.getFullPagination())})).catch((e=>{this.resetToPreviousPagination(),this.backendUtilities?.onBackendError(e,this._backendServiceApi),this._backendServiceApi?.onError&&this.backendUtilities?.onBackendError||n(l)})):this.rxjs?.isObservable(l)&&this._subscriptions.push(l.subscribe((e=>{const t=this.getFullPagination();this._previousPagination={pageNumber:t.pageNumber,pageSize:t.pageSize,pageSizes:t.pageSizes,totalItems:this.totalItems},s(this.backendUtilities?.executeBackendProcessesCallback(o,e,this._backendServiceApi,this._totalItems))}),(e=>{this.resetToPreviousPagination(),this.backendUtilities?.onBackendError(e,this._backendServiceApi),this._backendServiceApi?.onError&&this.backendUtilities?.onBackendError||n(l)}))),this.pubSubService.publish("onPaginationRefreshed",this.getFullPagination()),this.pubSubService.publish("onPaginationChanged",this.getFullPagination())}}}))}recalculateFromToIndexes(){((this._pageNumber-1)*this._itemsPerPage>this._totalItems||this._totalItems>0&&0===this._pageNumber)&&(this._pageNumber=1),0===this._totalItems?(this._dataFrom=0,this._dataTo=1,this._pageNumber=0):(this._dataFrom=this._pageNumber>1?this._pageNumber*this._itemsPerPage-this._itemsPerPage+1:1,this._dataTo=this._totalItems<this._itemsPerPage?this._totalItems:(this._pageNumber||1)*this._itemsPerPage,this._dataTo>this._totalItems&&(this._dataTo=this._totalItems)),(this._dataTo>this._totalItems||this._totalItems<this._itemsPerPage)&&(this._dataTo=this._totalItems)}resetToPreviousPagination(){const e=this._previousPagination?.pageNumber!==this.getFullPagination().pageNumber,t=this._previousPagination?.pageSize!==this.getFullPagination().pageSize;t&&this.changeItemPerPage(this._previousPagination?.pageSize??0,null,!1),e&&this.goToPageNumber(this._previousPagination?.pageNumber??0,null,!1),(e||t)&&(this.refreshPagination(),this._backendServiceApi?.service?.updatePagination?.(this._previousPagination?.pageNumber??0,this._previousPagination?.pageSize??0))}setCursorBased(e){this._isCursorBased=e,e&&this.setCursorPageInfo({startCursor:"",endCursor:"",hasNextPage:!1,hasPreviousPage:!1}),this.goToFirstPage(),this.pubSubService.publish("onPaginationSetCursorBased",{isCursorBased:e})}setCursorPageInfo(e){this._cursorPageInfo=e}updateTotalItems(e,t=!1){this._totalItems=e,this._paginationOptions&&(this._paginationOptions.totalItems=e,this.refreshPagination(!1,t))}processOnItemAddedOrRemoved(e,t=!0){if(null!==e){const i=this._dataTo,s=Array.isArray(e)?e.length:1,n=t?+s:-s;this._totalItems+=n,this.recalculateFromToIndexes(),this._dataTo=i+n,this.pubSubService.publish("onPaginationChanged",this.getFullPagination())}}}class jo{get eventHandler(){return this._eventHandler}get gridOptions(){return this._grid?.getOptions()??{}}get dataView(){return this._grid?.getData()}get gridUid(){return this._grid?.getUID()??""}get gridUidSelector(){return this.gridUid?`.${this.gridUid}`:""}get intervalRetryDelay(){return this._intervalRetryDelay}set intervalRetryDelay(e){this._intervalRetryDelay=e}get resizeByContentOptions(){return this.gridOptions?.resizeByContentOptions??{}}constructor(e){this.pubSubService=e,this._intervalRetryDelay=200,this._isStopResizeIntervalRequested=!1,this._hasResizedByContentAtLeastOnce=!1,this._totalColumnsWidthByContent=0,this._resizePaused=!1,this._subscriptions=[],this._eventHandler=new Cs,this._bindingEventService=new Wt}dispose(){this._eventHandler?.unsubscribeAll(),this.pubSubService.unsubscribeAll(this._subscriptions),window.clearInterval(this._intervalId),window.clearTimeout(this._timer),"container"===this.gridOptions.autoResize?.resizeDetection&&this._resizeObserver&&this._resizeObserver.disconnect(),this._bindingEventService.unbindAll()}init(e,t){if(!e||!this.gridOptions||!t)throw new Error('\n      [Slickgrid-Universal] Resizer Service requires a valid Grid object and DOM Element Container to be provided.\n      You can fix this by setting your gridOption to use "enableAutoResize" or create an instance of the ResizerService by calling bindAutoResizeDataGrid() once.');this._grid=e,this._gridContainerElm=t;const i=this.gridOptions?.gridHeight||this.gridOptions?.gridWidth?{height:this.gridOptions?.gridHeight,width:this.gridOptions?.gridWidth}:void 0;this._autoResizeOptions=this.gridOptions?.autoResize??{container:"grid1",bottomPadding:0},i?.width&&t?.style&&(t.style.width="string"==typeof i.width?i.width:`${i.width}px`),this._gridDomElm=e.getContainerNode(),"string"==typeof this._autoResizeOptions.container?this._pageContainerElm="string"==typeof this._autoResizeOptions.container?document.querySelector(this._autoResizeOptions.container):this._autoResizeOptions.container:this._pageContainerElm=this._autoResizeOptions.container,i&&(this._fixedHeight=i.height,this._fixedWidth=i.width),this.gridOptions.enableAutoResize&&this.bindAutoResizeDataGrid(),this.gridOptions.autoResize&&this._subscriptions.push(this.pubSubService.subscribe("onFullResizeByContentRequested",(()=>this.resizeColumnsByCellContent(!0)))),this.gridOptions.enableColumnResizeOnDoubleClick&&(this._subscriptions.push(this.pubSubService.subscribe("onHeaderMenuColumnResizeByContent",(e=>{this.handleSingleColumnResizeByContent(e.columnId)}))),this._eventHandler.subscribe(this._grid.onColumnsResizeDblClick,((e,t)=>{this.handleSingleColumnResizeByContent(t.triggeredByColumn)})))}bindAutoResizeDataGrid(e){if("container"===this.gridOptions.autoResize?.resizeDetection){if(!this._pageContainerElm||!this._pageContainerElm)throw new Error('\n          [Slickgrid-Universal] Resizer Service requires a container when gridOption.autoResize.resizeDetection="container"\n          You can fix this by setting your gridOption.autoResize.container');this._resizeObserver||(this._resizeObserver=new ResizeObserver((()=>this.resizeObserverCallback()))),this._resizeObserver.observe(this._pageContainerElm)}else{if(void 0===this._gridDomElm)return null;this.resizeGrid().then((()=>this.resizeGridWhenStylingIsBrokenUntilCorrected())).catch((e=>console.log("Error:",e))),this.resizeGrid(10,e),this._bindingEventService.bind(window,"resize",(()=>{this.handleResizeGrid(e)}))}}handleResizeGrid(e){this.pubSubService.publish("onGridBeforeResize"),this._resizePaused||(this.resizeGrid(0,e),this.resizeGrid(0,e))}resizeObserverCallback(){this._resizePaused||this.resizeGrid()}calculateGridNewDimensions(e){const t=e?.autoResize??{},i=le(this._gridDomElm);if(!window||!this._gridDomElm)return null;let s=void 0!==t?.bottomPadding?t.bottomPadding:20;if(s&&e.enablePagination&&(s+=35),s&&e.showCustomFooter){const e=this.gridOptions?.customFooterOptions?.footerHeight??25;s+=parseInt(`${e}`,10)}let n=0,r=0;"container"===t.calculateAvailableSizeBy?n=he(this._pageContainerElm,"height")||0:(n=window.innerHeight||0,r=i.top);const o=n-r-s,a=he(this._pageContainerElm,"width")||window.innerWidth||0,l=t?.maxHeight,h=t?.minHeight??180,c=t?.maxWidth,d=t?.minWidth??300;let u=o,p=t?.rightPadding?a-t.rightPadding:a;return u<h&&(u=h),l&&u>l&&(u=l),p<d&&(p=d),c&&p>c&&(p=c),{height:this._fixedHeight||u,width:this._fixedWidth||p}}getLastResizeDimensions(){return this._lastDimensions}pauseResizer(e){this._resizePaused=e}resizeGrid(e,t){return new Promise((i=>{(e=e||0)>0?(window.clearTimeout(this._timer),this._timer=window.setTimeout((()=>i(this.resizeGridCallback(t))),e)):i(this.resizeGridCallback(t))}))}resizeGridCallback(e){const t=this.resizeGridWithDimensions(e);return this.pubSubService.publish("onGridAfterResize",t),!this.gridOptions.enableAutoResizeColumnsByCellContent||this._lastDimensions?.width&&t?.width===this._lastDimensions?.width||this.resizeColumnsByCellContent(!1),this._lastDimensions=t,t}resizeGridWithDimensions(e){const t=this.calculateGridNewDimensions(this.gridOptions);if((e||t)&&this._gridDomElm){const i=e?.height?e.height:t?.height,s=e?.width?e.width:t?.width;this.gridOptions.autoHeight||(this._gridDomElm.style.height=`${i}px`),this._gridDomElm.style.width=`${s}px`,this._gridContainerElm&&(this._gridContainerElm.style.width=`${s}px`),this._grid?.resizeCanvas&&this._gridContainerElm&&this._grid.resizeCanvas(),this._grid&&this.gridOptions?.enableAutoSizeColumns?this.gridUid&&document.querySelector(this.gridUidSelector)&&(this._lastDimensions&&this._lastDimensions.height===i&&this._lastDimensions.width===s||this._grid.autosizeColumns()):!this.gridOptions.enableAutoResizeColumnsByCellContent||this._lastDimensions?.width&&s===this._lastDimensions?.width||this.resizeColumnsByCellContent(!1),this._lastDimensions={height:i||0,width:s||0}}return this._lastDimensions}requestStopOfAutoFixResizeGrid(e=!0){this._isStopResizeIntervalRequested=e}resizeColumnsByCellContent(e=!1){const t=this._grid.getColumns(),i=this.dataView.getItems(),s={};let n=!1,r=0;const o=this._gridContainerElm?.offsetWidth??0;if(!Array.isArray(i)||0===i.length||!e&&this._totalColumnsWidthByContent>0&&this._totalColumnsWidthByContent<o)return void this._grid.autosizeColumns();if(this._hasResizedByContentAtLeastOnce&&this.gridOptions?.resizeByContentOnlyOnFirstLoad&&!e)return;if(this.pubSubService.publish("onBeforeResizeByContent",void 0,0),0===this._totalColumnsWidthByContent||e){for(const e of t)s[e.id]=e.originalWidth??e.minWidth??0;r=this.calculateCellWidthByReadingDataset(t,s,this.resizeByContentOptions.maxItemToInspectCellContentWidth);let e=0;for(const i of t){const t=i.resizeAlwaysRecalculateWidth??this.resizeByContentOptions.alwaysRecalculateColumnWidth??!1;i.originalWidth&&!t?i.width=i.originalWidth:void 0!==s[i.id]&&(i.rerenderOnResize&&(n=!0),this.applyNewCalculatedColumnWidthByReference(i,s[i.id])),e+=i.width||0,this._totalColumnsWidthByContent=e}}this._grid.setColumns(t),this._hasResizedByContentAtLeastOnce=!0;const a={};for(const e of t)a[e.id]=e.width;this._totalColumnsWidthByContent>o?this._grid.reRenderColumns(n):this._grid.autosizeColumns(),this.pubSubService.publish("onAfterResizeByContent",{readItemCount:r,calculateColumnWidths:a})}calculateCellWidthByReadingDataset(e,t,i=1e3,s){const n=Array.isArray(e)?e:[e],r=this.dataView.getItems();let o=0;for(const[e,a]of r.entries()){if(e>i)break;Array.isArray(n)&&"object"==typeof t&&n.forEach(((i,n)=>{const r=this.calculateCellWidthByContent(a,i,e,s??n,t[i.id]);void 0!==r&&(t[i.id]=r)})),o=e+1}return o}calculateCellWidthByContent(e,t,i,s,n){const r=this.resizeByContentOptions.cellCharWidthInPx??7;if(!t.originalWidth){const o=t?.resizeCharWidthInPx??r,a=fo(t?.formatter,i,s,t,e,this._grid),l=He(a)?st(a):"",h=Math.ceil(l.length*o),c=t.resizeMaxWidthThreshold;t&&(void 0===n||h>n)&&(n=void 0!==c&&h>c?c:void 0!==t.maxWidth&&h>t.maxWidth?t.maxWidth:h)}return n}applyNewCalculatedColumnWidthByReference(e,t){const i=this.resizeByContentOptions.cellPaddingWidthInPx??6,s=this.resizeByContentOptions.formatterPaddingWidthInPx??6,n=e?.filter?.type??e?.type??E.string;let r=t;const o=e?.resizeCalcWidthRatio??this.resizeByContentOptions.defaultRatioForStringType??.9;r*="string"===n?o:1,r+=i,e.resizeExtraWidthPadding&&(r+=e.resizeExtraWidthPadding),e.editor&&this.gridOptions.editable&&(r+=s),void 0!==e.maxWidth&&r>e.maxWidth&&(r=e.maxWidth),void 0!==e.resizeMaxWidthThreshold&&r>e.resizeMaxWidthThreshold&&(r=e.resizeMaxWidthThreshold),r=Math.ceil(r),void 0!==e.originalWidth&&!0!==e.resizeAlwaysRecalculateWidth&&!0!==this.resizeByContentOptions.alwaysRecalculateColumnWidth||(e.width=this.readjustNewColumnWidthWhenOverLimit(e,r))}handleSingleColumnResizeByContent(e){const t=this._grid.getColumns(),i=t.findIndex((t=>t.id===e));if(i>=0){const s=t[i],n={[e]:s.originalWidth??s.minWidth??0};s.originalWidth=void 0,this.calculateCellWidthByReadingDataset(s,n,this.resizeByContentOptions.maxItemToInspectSingleColumnWidthByContent,i),this.applyNewCalculatedColumnWidthByReference(s,n[e]),this._grid.reRenderColumns(s?.rerenderOnResize??!1)}}readjustNewColumnWidthWhenOverLimit(e,t){const i=this.gridOptions.frozenColumn??-1,s=this._grid.getColumns().findIndex((t=>t.id===e.id))??0;let n=t;if(i>=0&&s<=i){const i=Array.from(this._grid.getViewports());if(i){const s=i.find((e=>e.classList.contains("slick-viewport-left")))?.clientWidth??0,r=i.find((e=>e.classList.contains("slick-viewport-right")))?.clientWidth??0,o=s+r,a=s-(e.width??0);a+t>o&&(n=s-a+r-(this.resizeByContentOptions.widthToRemoveFromExceededWidthReadjustment??50))}}return Math.ceil(n)}checkIsGridShown(){return!!document.querySelector(`${this.gridUidSelector}`)?.offsetParent}resizeGridWhenStylingIsBrokenUntilCorrected(){const e=this.gridOptions?.autoFixResizeTimeout??18e3,t=this.gridOptions?.autoFixResizeRequiredGoodCount??5,i=this._gridContainerElm.querySelector(`${this.gridUidSelector} .slick-header`),s=this._gridContainerElm.querySelector(`${this.gridUidSelector} .slick-viewport`);let n=0,r=0;if(i&&s&&this.gridOptions.autoFixResizeWhenBrokenStyleDetected){const o=this.dataView.getItemCount(),a=this._grid.getColumns()||[];this._intervalId=window.setInterval((async()=>{const l=le(i);let h=l.top;this.gridOptions?.enableFiltering&&this.gridOptions.headerRowHeight&&(h+=this.gridOptions.headerRowHeight),this.gridOptions?.createPreHeaderPanel&&this.gridOptions.showPreHeaderPanel&&this.gridOptions.preHeaderPanelHeight&&(h+=this.gridOptions.preHeaderPanelHeight),h+=44;const c=le(s).top,d=le(this._gridContainerElm);let u=0===l?.top||h-c>2||0===d.left&&0===d.top;const p=this._grid.getRenderedRange()?.rightPx??0;!u&&o>0&&0===p&&a.length>1&&(u=!0),this._isStopResizeIntervalRequested&&(u=!1,n=e),this.checkIsGridShown()&&(u||0===d.left||0===d.top)&&(await this.resizeGrid(),r<5&&this._grid.updateColumns(),this.checkIsGridShown()&&(u=!1)),this.checkIsGridShown()&&r++,this.checkIsGridShown()&&!u&&(r>=t||n++>=e)&&window.clearInterval(this._intervalId)}),this.intervalRetryDelay)}}}class Go{constructor(){this.currentPagination=null,this.isItemsDateParsed=!1,this.frozenVisibleColumnId="",this.hasColumnsReordered=!1,this.hideHeaderRowAfterPageLoad=!1}get allColumns(){return this._allColumns}set allColumns(e){this._allColumns=e}get columnDefinitions(){return this.slickGrid?.getColumns()??[]}get gridOptions(){return this._gridOptions||this.slickGrid?.getOptions()||{}}set gridOptions(e){this._gridOptions=e}get externalRegisteredResources(){return this._externalRegisteredResources}set externalRegisteredResources(e){this._externalRegisteredResources=e}get visibleColumns(){return this._visibleColumns}set visibleColumns(e){this._visibleColumns=e}get hierarchicalDataset(){return this._hierarchicalDataset}set hierarchicalDataset(e){this._hierarchicalDataset=e}}class qo{constructor(e,t,i,s,n){this.collectionService=e,this.sharedService=t,this.pubSubService=i,this.backendUtilities=s,this.rxjs=n,this._currentLocalSorters=[],this._isBackendGrid=!1,this._eventHandler=new Cs,this.rxjs&&(this.httpCancelRequests$=this.rxjs.createSubject())}get eventHandler(){return this._eventHandler}get _gridOptions(){return this._grid?.getOptions()??{}}get _columnDefinitions(){return this._grid?.getColumns()??[]}dispose(){this._eventHandler?.unsubscribeAll&&this._eventHandler.unsubscribeAll(),this.httpCancelRequests$&&this.rxjs?.isObservable(this.httpCancelRequests$)&&(this.httpCancelRequests$.next(),this.httpCancelRequests$.complete())}addRxJsResource(e){this.rxjs=e}bindBackendOnSort(e){this._isBackendGrid=!0,this._grid=e,this._dataView=e?.getData(),this._eventHandler.subscribe(e.onSort,this.onBackendSortChanged.bind(this))}bindLocalOnSort(e){this._isBackendGrid=!1,this._grid=e,this._dataView=e?.getData(),this.processTreeDataInitialSort(),this._eventHandler.subscribe(e.onSort,this.handleLocalOnSort.bind(this)),this._gridOptions.preParseDateColumns&&(this._eventHandler.subscribe(e.onCellChange,((e,t)=>this.preParseSingleDateItem(t.item))),this.pubSubService.subscribe(["onItemAdded","onItemUpdated"],(e=>this.preParseSingleDateItem(e))))}preParseSingleDateItem(e){this._gridOptions.preParseDateColumns&&(Array.isArray(e)?e:[e]).forEach((e=>this.collectionService.parseSingleDateItem(e,this._grid,this._gridOptions.preParseDateColumns)))}preParseAllDateItems(){if(this._gridOptions.preParseDateColumns){const e=this._dataView?.getItems()||[];this.collectionService.preParseByMutationDateItems(e,this._grid,this._gridOptions.preParseDateColumns),this.sharedService.isItemsDateParsed=!0}}handleLocalOnSort(e,t){const i=t.multiColumnSort?t.sortCols:new Array({columnId:t.sortCol?.id??"",sortAsc:t.sortAsc,sortCol:t.sortCol});this._currentLocalSorters=[],Array.isArray(i)&&i.forEach((e=>{e.sortCol&&this._currentLocalSorters.push({columnId:e.sortCol.id,direction:e.sortAsc?I.ASC:I.DESC})})),this.onLocalSortChanged(this._grid,i),this.emitSortChanged(h.local)}clearSortByColumnId(e,t){const i=this.getCurrentColumnSorts(),s=this.getCurrentColumnSorts(`${t}`);if(Array.isArray(i)&&Array.isArray(s)&&i.length!==s.length){if(this._gridOptions.backendServiceApi)this.onBackendSortChanged(e,{multiColumnSort:!0,sortCols:s,grid:this._grid});else if(this._dataView)this.onLocalSortChanged(this._grid,s,!0,!0);else{const e=this._gridOptions.multiColumnSort?s:s[0];this._grid.onSort.notify(e)}const t=s.map((e=>({columnId:e?.sortCol?.id??"",sortAsc:e?.sortAsc,sortCol:e?.sortCol})));this._grid.setSortColumns(t)}Array.isArray(s)&&0===s.length&&this.sortLocalGridByDefaultSortFieldId()}clearSorting(e=!0){if(this._grid&&this._gridOptions&&this._dataView)if(this._grid.setSortColumns([]),e)this._isBackendGrid?this.onBackendSortChanged(void 0,{grid:this._grid,multiColumnSort:!0,sortCols:[],clearSortTriggered:!0}):this._columnDefinitions&&Array.isArray(this._columnDefinitions)&&this._columnDefinitions.length>0&&this.sortLocalGridByDefaultSortFieldId();else if(this._isBackendGrid){const e=this._gridOptions.backendServiceApi?.service;e?.clearSorters&&e.clearSorters()}this._currentLocalSorters=[],this.pubSubService.publish("onSortCleared",!0)}disableSortFunctionality(e=!0,t=!0){const i=!this._gridOptions.enableSorting;let s;this._gridOptions.enableSorting=i,e?(t&&this.clearSorting(),this._eventHandler.unsubscribeAll(),s=this.disableAllSortingCommands(!0)):(s=this.disableAllSortingCommands(!1),this._eventHandler.subscribe(this._grid.onSort,((e,t)=>this.handleLocalOnSort(e,t)))),this._grid.setOptions({enableSorting:this._gridOptions.enableSorting},!1,!0),this.sharedService.gridOptions=this._gridOptions,this._grid.setColumns(s)}toggleSortFunctionality(e=!0){const t=this._gridOptions.enableSorting;this.disableSortFunctionality(t,e)}emitSortChanged(e,t){if(e===h.remote&&this._gridOptions.backendServiceApi){let e=[];const t=this._gridOptions.backendServiceApi.service;t?.getCurrentSorters&&(e=t.getCurrentSorters()),this.pubSubService.publish("onSortChanged",e)}else e===h.local&&(t&&(this._currentLocalSorters=t),this.pubSubService.publish("onSortChanged",this.getCurrentLocalSorters()))}getCurrentLocalSorters(){return this._currentLocalSorters}getCurrentColumnSorts(e){if(this._grid){const t=this._grid.getSortColumns();if(Array.isArray(t))return t.reduce(((t,i)=>(!i||e&&i.columnId===e||t.push({columnId:i.columnId||"",sortCol:this._columnDefinitions[this._grid.getColumnIndex(i.columnId||"")],sortAsc:i.sortAsc}),t)),[])}return[]}loadGridSorters(e){this._currentLocalSorters=[];const t=[];return Array.isArray(e)&&((this._gridOptions.multiColumnSort?e:e.slice(0,1)).forEach((e=>{const i=this._columnDefinitions.find((t=>t.id===e.columnId));if(i){if(!i.sortable){let e="[Slickgrid-Universal] Cannot add sort icon to a column that is not sortable, please add `sortable: true` to your column or remove it from your list of columns to sort.";throw this._gridOptions.enableTreeData&&(e+=" Also note that TreeData feature requires the column holding the tree (expand/collapse icons) to be sortable."),new Error(e)}t.push({columnId:i.id,sortAsc:e.direction.toUpperCase()===I.ASC,sortCol:i}),this._currentLocalSorters.push({columnId:String(i.id),direction:e.direction.toUpperCase()})}})),this.onLocalSortChanged(this._grid,t),this._grid.setSortColumns(t.map((e=>({columnId:e.columnId,sortAsc:e.sortAsc}))))),t}processTreeDataInitialSort(){if(this._gridOptions.enableTreeData&&this._gridOptions.treeDataOptions){const e=this._gridOptions.treeDataOptions,t=this._columnDefinitions.find((t=>t.id===e.columnId));if(t){let i=I.ASC,s={columnId:e.columnId,sortCol:t,sortAsc:!0};if(e?.initialSort?.columnId){const t=e.initialSort.columnId,n=this._columnDefinitions.find((e=>e.id===t));i=(e.initialSort.direction||I.ASC).toUpperCase(),s={columnId:t,sortCol:n,sortAsc:i===I.ASC}}s?.columnId&&this.sharedService?.hierarchicalDataset&&this.updateSorting([{columnId:s.columnId||"",direction:i}])}}}onBackendSortChanged(e,t){if(!t||!t.grid)throw new Error('Something went wrong when trying to bind the "onBackendSortChanged(event, args)" function, it seems that "args" is not populated correctly');const i=t.grid?.getOptions()??{},s=i.backendServiceApi;if(!s||!s.process||!s.service)throw new Error('BackendServiceApi requires at least a "process" function and a "service" defined');const n=new Date;s.preProcess&&s.preProcess();const r=s.service.processOnSortChanged(e,t),o=i?.pagination?.totalItems||0;this.backendUtilities?.executeBackendCallback(s,r,t,n,o,{emitActionChangedCallback:this.emitSortChanged.bind(this),errorCallback:()=>{this._grid.setSortColumns(t.previousSortColumns||[]);const e=t.previousSortColumns?.map((e=>({columnId:e.columnId,sortAsc:e.sortAsc,sortCol:this._columnDefinitions.find((t=>t.id===e.columnId))})));s?.service?.updateSorters?.(e||[])},httpCancelRequestSubject:this.httpCancelRequests$})}async onLocalSortChanged(e,t,i=!1,s=!1){const n=this._gridOptions.datasetIdPropertyName||"id",r=this._gridOptions.enableTreeData||!1,o=e.getData();if(await this.pubSubService.publish("onBeforeSortChange",{sortColumns:t},0),e&&o){if(this._gridOptions.preParseDateColumns&&!this.sharedService.isItemsDateParsed&&t.some((e=>q(e.sortCol?.type)))&&this.preParseAllDateItems(),i&&!r&&o.reSort(),r&&this._dataView&&this.sharedService&&Array.isArray(this.sharedService.hierarchicalDataset)){const e=this.sortHierarchicalDataset(this.sharedService.hierarchicalDataset,t);this._dataView.setItems(e.flat,n),this._dataView.onRowCountChanged.notify({previous:this._dataView.getFilteredItemCount(),current:this._dataView.getLength(),itemCount:this._dataView.getItemCount(),dataView:this._dataView,callingOnRowsChanged:!0})}else o.sort(this.sortComparers.bind(this,t));e.invalidate(),s&&this.emitSortChanged(h.local,t.map((e=>({columnId:e.sortCol?.id??"id",direction:e.sortAsc?I.ASC:I.DESC}))))}}sortHierarchicalDataset(e,t,i=!1){this.sortTreeData(e,t);const s=this._gridOptions.datasetIdPropertyName||"id",n=this._gridOptions.treeDataOptions||{columnId:""},r=F(e,{...n,identifierPropName:n.identifierPropName??s,shouldAddTreeLevelNumber:!0});if(i){this._currentLocalSorters=[],t.forEach((e=>{this._currentLocalSorters.push({columnId:e.columnId,direction:e.sortAsc?"ASC":"DESC"})}));const e=this._gridOptions.backendServiceApi?h.remote:h.local;this.emitSortChanged(e)}return{hierarchical:e,flat:r}}sortLocalGridByDefaultSortFieldId(){const e=this._gridOptions&&this._gridOptions.defaultColumnSortFieldId||this._gridOptions.datasetIdPropertyName||"id",t={id:e,field:e};this.onLocalSortChanged(this._grid,new Array({columnId:t.id,sortAsc:!0,sortCol:t,clearSortTriggered:!0}),!1,!0)}sortComparers(e,t,i){if(Array.isArray(e))for(const s of e){const e=this.sortComparer(s,t,i);if(void 0!==e)return e}return A.neutral}sortComparer(e,t,i,s){if(e?.sortCol){const n=e.sortCol,r=n.type||E.string,o=e.sortAsc?A.asc:A.desc;let a=s||n.queryFieldSorter||n.queryField||n.field;this._gridOptions.preParseDateColumns&&q(r)&&e?.columnId&&(a="string"==typeof this._gridOptions.preParseDateColumns?`${this._gridOptions.preParseDateColumns}${e.columnId}`:`${e.columnId}`);let l=a;"function"==typeof n.queryFieldNameGetterFn&&(a=n.queryFieldNameGetterFn(t),l=n.queryFieldNameGetterFn(i));let h=t[a],c=i[l];if(a?.indexOf(".")>=0&&(h=U(t,a)),l?.indexOf(".")>=0&&(c=U(i,l)),n.sortComparer){const e=n.sortComparer(h,c,o,n,this._gridOptions);if(e!==A.neutral)return e}else{const e=Ht(r,h,c,o,n,this._gridOptions);if(e!==A.neutral)return e}}}sortTreeData(e,t){Array.isArray(t)&&t.forEach((t=>{this.sortTreeChildren(e,t,0)}))}sortTreeChildren(e,t,i){const s=this._gridOptions.treeDataOptions?.childrenPropName??"children";e.sort(((e,i)=>this.sortComparer(t,e,i)??A.neutral)),e.forEach((e=>{e&&e.hasOwnProperty(s)&&Array.isArray(e[s])&&(i++,this.sortTreeChildren(e[s],t,i),i--)}))}updateSorting(e,t=!0,i=!0){if(!this._gridOptions||!this._gridOptions.enableSorting)throw new Error('[Slickgrid-Universal] in order to use "updateSorting" method, you need to have Sortable Columns defined in your grid and "enableSorting" set in your Grid Options');if(Array.isArray(e)){const s=this._gridOptions.backendServiceApi;if(s){const t=s?.service;t?.updateSorters&&(t.updateSorters(void 0,e),i&&this.backendUtilities?.refreshBackendDataset(this._gridOptions))}else this.loadGridSorters(e);if(t){const e=s?h.remote:h.local;this.emitSortChanged(e)}}}disableAllSortingCommands(e=!0){const t=this._grid.getColumns();t.forEach((t=>{void 0!==t.sortable&&(t.sortable=!e),t?.header?.menu&&t.header.menu.commandItems?.forEach((t=>{if(t&&"string"!=typeof t){const i=t.command;"sort-asc"!==i&&"sort-desc"!==i&&"clear-sort"!==i||(t.hidden=e)}}))}));const i=this._gridOptions.gridMenu?.commandItems;return i&&i.forEach((t=>{t&&"string"!=typeof t&&"clear-sorting"===t.command&&(t.hidden=e)})),t}}class Ko{constructor(e,t,i){this.pubSubService=e,this.sharedService=t,this.sortService=i,this._currentToggledItems=[],this._isLastFullToggleCollapsed=!1,this._isOneCpuCyclePassed=!1,this._isTreeDataEnabled=!1,this._subscriptions=[],this._treeDataRecalcHandler=null,this._eventHandler=new Cs,window.setTimeout((()=>this._isOneCpuCyclePassed=!0))}set currentToggledItems(e){this._currentToggledItems=e}get dataset(){return this.dataView?.getItems()}get datasetHierarchical(){return this.sharedService.hierarchicalDataset}get dataView(){return this._grid?.getData()}get eventHandler(){return this._eventHandler}get gridOptions(){return this._grid?.getOptions()??{}}get treeDataOptions(){return this.gridOptions.treeDataOptions}dispose(){this._eventHandler.unsubscribeAll(),this.pubSubService.unsubscribeAll(this._subscriptions)}init(e){if(this._grid=e,this._isTreeDataEnabled=this.gridOptions?.enableTreeData??!1,this._isLastFullToggleCollapsed=this.treeDataOptions?.initiallyCollapsed??!1,this._currentToggledItems=this.gridOptions.presets?.treeData?.toggledItems??[],this._lastToggleStateChange={type:this._isLastFullToggleCollapsed?"full-collapse":"full-expand",previousFullToggleType:this._isLastFullToggleCollapsed?"full-collapse":"full-expand",toggledItems:this._currentToggledItems},this._isTreeDataEnabled){if(this.gridOptions?.multiColumnSort)throw new Error('[Slickgrid-Universal] It looks like you are trying to use Tree Data with multi-column sorting, unfortunately it is not supported because of its complexity, you can disable it via "multiColumnSort: false" grid option and/or help in providing support for this feature.');if(!this.gridOptions?.enableFiltering)throw new Error('[Slickgrid-Universal] It looks like you are trying to use Tree Data without using the filtering option, unfortunately that is not possible with Tree Data since it relies heavily on the filters to expand/collapse the tree. You need to enable it via "enableFiltering: true"');if(this.gridOptions?.backendServiceApi||this.gridOptions?.enablePagination)throw new Error("[Slickgrid-Universal] It looks like you are trying to use Tree Data with Pagination and/or a Backend Service (OData, GraphQL) but unfortunately that is simply not supported because of its complexity.");if(!this.gridOptions.treeDataOptions||!this.gridOptions.treeDataOptions.columnId)throw new Error('[Slickgrid-Universal] When enabling tree data, you must also provide the "treeDataOption" property in your Grid Options with "childrenPropName" or "parentPropName" (depending if your array is hierarchical or flat) for the Tree Data to work properly.')}this._eventHandler.subscribe(e.onClick,this.handleOnCellClick.bind(this)),this._subscriptions.push(this.pubSubService.subscribe("onGridMenuClearAllSorting",this.clearSorting.bind(this))),this._treeDataRecalcHandler=this.setAutoRecalcTotalsCallbackWhenFeatEnabled(this.gridOptions),this._eventHandler.subscribe(this.dataView.onRowCountChanged,(()=>{"function"==typeof this._treeDataRecalcHandler&&this._isOneCpuCyclePassed&&(window.clearTimeout(this._timer),this._timer=window.setTimeout((()=>this._treeDataRecalcHandler?.()),this.treeDataOptions?.autoRecalcTotalsDebounce??0))}))}applyToggledItemStateChanges(e,t,i=!0,s=!1){if(Array.isArray(e)){const n=B(this.treeDataOptions,"collapsedPropName"),r=B(this.treeDataOptions,"hasChildrenPropName");this.dataView.beginUpdate(!0);const o="full-collapse"===(t??this._lastToggleStateChange.previousFullToggleType);t&&(this._lastToggleStateChange.previousFullToggleType=t),i&&(this.dataView.getItems()||[]).forEach((e=>{e[r]&&(e[n]=o)})),this.dynamicallyToggleItemState(e,s)}}dynamicallyToggleItemState(e,t=!0){Array.isArray(e)&&(this.dataView.beginUpdate(!0),e.forEach((e=>{const i=this.dataView.getItemById(e.itemId);if(this.updateToggledItem(i,e.isCollapsed,!0),t){const t=this._currentToggledItems.findIndex((t=>t.itemId===e.itemId));t>=0?this._currentToggledItems[t].isCollapsed=e.isCollapsed:this._currentToggledItems.push({itemId:e.itemId,isCollapsed:e.isCollapsed}),this.pubSubService.publish("onTreeItemToggled",{...this._lastToggleStateChange,fromItemId:e.itemId,toggledItems:this._currentToggledItems,type:e.isCollapsed?D.toggleCollapse:D.toggleExpand})}})),this.dataView.endUpdate(),this.dataView.refresh())}getCurrentToggleState(){return this._lastToggleStateChange}getInitialSort(e,t){const i=t?.treeDataOptions,s=i?.initialSort??{columnId:i?.columnId??"",direction:"ASC"},n=e.find((e=>e.id===s.columnId));return{columnId:s.columnId,sortAsc:"DESC"!==s?.direction?.toUpperCase(),sortCol:n}}getItemCount(e){if(void 0!==e){const t=B(this.treeDataOptions,"levelPropName");return this.dataView.getItems().filter((i=>i[t]===e)).length}return this.dataView.getItemCount()}getToggledItems(){return this._currentToggledItems}clearSorting(){const e=this.getInitialSort(this.sharedService.columnDefinitions,this.sharedService.gridOptions);this.sortService.loadGridSorters([{columnId:e.columnId,direction:e.sortAsc?"ASC":"DESC"}])}convertFlatParentChildToTreeDatasetAndSort(e,t,i,s){const n=this.convertFlatParentChildToTreeDataset(e,i),r=Array.isArray(s)&&s.length?s[0]:this.getInitialSort(t,i),o=this.sortService.sortHierarchicalDataset(n,[r],!0);return this._grid?.setSortColumns([r]),o}convertFlatParentChildToTreeDataset(e,t){const i=t?.datasetIdPropertyName??"id",s=t?.treeDataOptions??{columnId:"id"};return H(e,{...s,identifierPropName:s.identifierPropName??i,initiallyCollapsed:this._isLastFullToggleCollapsed})}enableAutoRecalcTotalsFeature(e=!0){e&&this._isTreeDataEnabled?this._treeDataRecalcHandler=this.recalculateTreeTotals.bind(this,this.gridOptions):this._treeDataRecalcHandler=null}recalculateTreeTotals(e){const t=e.treeDataOptions,i=t?.childrenPropName??y.treeDataProperties.CHILDREN_PROP,s=t?.levelPropName??y.treeDataProperties.TREE_LEVEL_PROP;t?.aggregators&&(t.aggregators.forEach((e=>{N(this.sharedService.hierarchicalDataset||[],{childrenPropName:i,levelPropName:s,aggregator:e})})),this._grid.invalidate())}sortHierarchicalDataset(e,t){const i=t??this.getInitialSort(this.sharedService.allColumns,this.gridOptions),s=Array.isArray(i)?i:[i];return this.sortService.sortHierarchicalDataset(e,s)}async toggleTreeDataCollapse(e,t=!0){if(this.gridOptions?.enableTreeData){const i=B(this.treeDataOptions,"hasChildrenPropName");t&&await this.pubSubService.publish("onTreeFullToggleStart",{collapsing:e}),this.dataView.beginUpdate(!0);const s=this.dataView.getItems()||[];s.forEach((t=>{t[i]&&this.updateToggledItem(t,e,!1)})),this.sharedService.hierarchicalDataset=this.convertFlatParentChildToTreeDataset(s,this.gridOptions),this.dataView.endUpdate(),this.dataView.refresh(),this._isLastFullToggleCollapsed=e}const i=e?D.fullCollapse:D.fullExpand;this._lastToggleStateChange={type:i,previousFullToggleType:i,toggledItems:null},t&&this.pubSubService.publish("onTreeFullToggleEnd",this._lastToggleStateChange)}handleOnCellClick(e,t){if(e&&t){const i=e.target||{},s=this.gridOptions.datasetIdPropertyName??"id",n=B(this.treeDataOptions,"collapsedPropName"),r=B(this.treeDataOptions,"childrenPropName");if("string"==typeof i?.className&&i.className.indexOf("toggle")>=0){const i=this.dataView.getItem(t.row);if(i){i[n]=!i[n];const e=i[n],t=i[s],o=this._currentToggledItems.findIndex((e=>e.itemId===t));o>=0?this._currentToggledItems[o].isCollapsed=e:this._currentToggledItems.push({itemId:t,isCollapsed:e}),this.dataView.updateItem(t,i);const a=e=>e[s]===t,l=z(this.sharedService.hierarchicalDataset||[],a,r);l&&(l[n]=e),this._grid.invalidate(),this._lastToggleStateChange={type:e?D.toggleCollapse:D.toggleExpand,previousFullToggleType:this._isLastFullToggleCollapsed?"full-collapse":"full-expand",toggledItems:this._currentToggledItems},this.pubSubService.publish("onTreeItemToggled",{...this._lastToggleStateChange,fromItemId:t})}e.stopImmediatePropagation()}}}updateToggledItem(e,t,i){const s=this.gridOptions?.datasetIdPropertyName??"id",n=B(this.treeDataOptions,"childrenPropName"),r=B(this.treeDataOptions,"collapsedPropName");if(e&&(e[r]=t,this.dataView.updateItem(e[s],e),i)){const i=t=>t[s]===e[s],o=z(this.sharedService.hierarchicalDataset||[],i,n);o&&(o[r]=t)}}setAutoRecalcTotalsCallbackWhenFeatEnabled(e){return e?.enableTreeData&&e?.treeDataOptions?.autoRecalcTotalsOnFilterChange&&e?.treeDataOptions?.aggregators?this.recalculateTreeTotals.bind(this,e):null}}class Yo{constructor(e){this.translaterService=e,this._debounceTypingDelay=0,this._shouldTriggerQuery=!0,this._inputType="text",this.inputFilterType="single",this.searchTerms=[],this._bindEventService=new Wt}get columnFilter(){return this.columnDef?.filter??{}}get defaultOperator(){return k.empty}get inputType(){return this._inputType}set inputType(e){this._inputType=e}get operator(){return this.columnFilter?.operator??this.defaultOperator}set operator(e){this.columnFilter&&(this.columnFilter.operator=e)}get gridOptions(){return this.grid?.getOptions()??{}}init(e){if(!e)throw new Error('[Slickgrid-Universal] A filter must always have an "init()" with valid arguments.');this.grid=e.grid,this.callback=e.callback,this.columnDef=e.columnDef,"compound"===this.inputFilterType&&(this.operator=e.operator||""),this.searchTerms=e?.searchTerms??[],this._cellContainerElm=e.filterContainerElm;const t=this.gridOptions?.backendServiceApi;this._debounceTypingDelay=(t?t?.filterTypingDebounce??this.gridOptions?.defaultBackendServiceFilterTypingDebounce:this.gridOptions?.filterTypingDebounce)??0;const i=Array.isArray(this.searchTerms)&&this.searchTerms.length>=0?this.searchTerms[0]:"";this.createDomFilterElement(i),this._bindEventService.bind(this._filterInputElm,["keyup","blur","change"],this.onTriggerEvent.bind(this)),this._bindEventService.bind(this._filterInputElm,"wheel",this.onTriggerEvent.bind(this),{passive:!0}),"compound"===this.inputFilterType&&this._selectOperatorElm&&this._bindEventService.bind(this._selectOperatorElm,"change",this.onTriggerEvent.bind(this))}clear(e=!0){this._filterInputElm&&(this._shouldTriggerQuery=e,this.searchTerms=[],this._filterInputElm.value="",this._currentValue=void 0,this.updateFilterStyle(!1),"compound"===this.inputFilterType&&this._selectOperatorElm&&(this._selectOperatorElm.selectedIndex=0),this.onTriggerEvent(void 0,!0))}destroy(){this._bindEventService.unbindAll(),this._selectOperatorElm?.remove?.(),this._filterInputElm?.remove?.()}getValues(){return this._filterInputElm.value}setValues(e,t,i=!1){const s=Array.isArray(e)?e:[e];let n="";for(const e of s)n="single"===this.inputFilterType?t?this.addOptionalOperatorIntoSearchString(e,t):e:`${e}`,this._filterInputElm.value=`${n??""}`,this._currentValue=this._filterInputElm.value;if(this.updateFilterStyle(""!==this.getValues()),this.operator=t||this.defaultOperator,t&&this._selectOperatorElm){const e=Y(this.operator);this._selectOperatorElm.value=e}i&&this.onTriggerEvent(void 0,!1)}addOptionalOperatorIntoSearchString(e,t){let i="",s="",n=null==e?"":`${e}`;if(t&&n){switch(t){case"<>":case"!=":case"=":case"==":case">":case">=":case"<":case"<=":i=t;break;case"EndsWith":case"*z":i="*";break;case"StartsWith":case"a*":s="*"}n=`${i}${n}${s}`}return n}getCompoundOperatorOptionValues(){const e=this.columnDef.type&&this.columnDef.type?this.columnDef.type:E.string;let t,i="text";if(this.columnFilter?.compoundOperatorList)t=this.columnFilter.compoundOperatorList;else switch(e){case E.string:case E.text:case E.readonly:case E.password:i="text",t=[{operator:"",desc:Xt("CONTAINS","TEXT_CONTAINS","Contains",s=this.gridOptions,n=this.translaterService)},{operator:"<>",desc:Xt("NOT_CONTAINS","TEXT_NOT_CONTAINS","Not Contains",s,n)},{operator:"=",desc:Xt("EQUALS","TEXT_EQUALS","Equals",s,n)},{operator:"!=",desc:Xt("NOT_EQUAL_TO","TEXT_NOT_EQUAL_TO","Not equal to",s,n)},{operator:"a*",desc:Xt("STARTS_WITH","TEXT_STARTS_WITH","Starts with",s,n)},{operator:"*z",desc:Xt("ENDS_WITH","TEXT_ENDS_WITH","Ends with",s,n)}];break;default:i="numeric",t=Zt(this.gridOptions,this.translaterService)}var s,n;return Qt(this.gridOptions,t,i),t}createDomFilterElement(e){const t=this.columnDef?.id??"";re(this._cellContainerElm);let i=this.gridOptions?.defaultFilterPlaceholder??"";this.columnFilter?.placeholder&&(i=this.columnFilter.placeholder);const s=`${e??""}`;if(this._filterInputElm=ie("input",{type:this._inputType||"text",autocomplete:"off",ariaAutoComplete:"none",placeholder:i,ariaLabel:this.columnFilter?.ariaLabel??`${Ke(t+"")} Search Filter`,className:`form-control filter-${t}`,value:s,dataset:{columnid:`${t}`}}),this.updateFilterStyle(!!e),void 0!==e&&(this._currentValue=s),"single"===this.inputFilterType)this._filterContainerElm=this._filterInputElm,this._filterInputElm.classList.add("search-filter"),this._cellContainerElm.appendChild(this._filterInputElm),this._cellContainerElm.appendChild(document.createElement("span"));else{this._filterInputElm.classList.add("compound-input"),this._selectOperatorElm=Kt(this.getCompoundOperatorOptionValues(),this.grid),this._filterContainerElm=ie("div",{className:`form-group search-filter filter-${t}`});const e=ie("div",{className:"input-group"},this._filterContainerElm);ie("div",{className:"input-group-addon input-group-prepend operator"},e).appendChild(this._selectOperatorElm),e.appendChild(this._filterInputElm),e.appendChild(ie("span")),this.operator&&(this._selectOperatorElm.value=Y(this.operator)),this._filterContainerElm&&this._cellContainerElm.appendChild(this._filterContainerElm)}}onTriggerEvent(e,t=!1){if(t)this.callback(e,{columnDef:this.columnDef,clearFilterTriggered:t,shouldTriggerQuery:this._shouldTriggerQuery}),this.updateFilterStyle(!1);else{const t=e?.type??"",i=this._selectOperatorElm?.value??this.operator;let s=this._filterInputElm.value;const n=this.gridOptions.enableFilterTrimWhiteSpace||this.columnFilter.enableTrimWhiteSpace;"string"==typeof s&&n&&(s=s.trim()),"select"!==e?.target?.tagName.toLowerCase()&&(this._currentValue=s),this.updateFilterStyle(""!==s);const r={columnDef:this.columnDef,operator:i,searchTerms:s?[s]:null,shouldTriggerQuery:this._shouldTriggerQuery},o="keyup"===t&&"Enter"!==e?.key?this._debounceTypingDelay:0,a=this.columnFilter.skipCompoundOperatorFilterWithNullInput??this.gridOptions.skipCompoundOperatorFilterWithNullInput,l=a&&Me(this._currentValue)||""===this._currentValue&&Me(this._lastSearchValue);"single"!==this.inputFilterType&&a&&!l||(o>0?(window.clearTimeout(this._timer),this._timer=window.setTimeout((()=>this.callback(e,r)),o)):this.callback(e,r)),this._lastSearchValue=s}this._shouldTriggerQuery=!0}updateFilterStyle(e){e?(this._filterContainerElm?.classList.add("filled"),this._filterInputElm.classList.add("filled")):(this._filterContainerElm?.classList.remove("filled"),this._filterInputElm.classList.remove("filled"))}}class Xo extends Yo{constructor(e){super(e),this.translaterService=e,this.inputType="text",this.inputFilterType="compound"}}const Zo="#86bff8";class Qo{constructor(e){this.translaterService=e,this._clearFilterTriggered=!1,this._shouldTriggerQuery=!0,this._sliderTrackFilledColor=Zo,this.sliderType="double",this.searchTerms=[],this._bindEventService=new Wt}get columnFilter(){return this.columnDef?.filter??{}}get currentValue(){return this._currentValue}get currentValues(){return this._currentValues}get defaultOperator(){return"compound"===this.sliderType?k.empty:"single"===this.sliderType?k.greaterThanOrEqual:this.gridOptions.defaultFilterRangeOperator||k.rangeInclusive}get filterOptions(){return{...this.gridOptions.defaultFilterOptions?.slider,...this.columnFilter?.filterOptions}}get gridOptions(){return this.grid?.getOptions()??{}}get sliderOptions(){return this._sliderOptions}get operator(){return this._operator||(this.columnFilter.operator??this.defaultOperator)}set operator(e){this._operator=e}init(e){if(!e)throw new Error('[Slickgrid-Universal] A filter must always have an "init()" with valid arguments.');this.grid=e.grid,this.callback=e.callback,this.columnDef=e.columnDef,this.operator=e.operator||"",this.searchTerms=e?.searchTerms??[],this._argFilterContainerElm=e.filterContainerElm,this._sliderTrackFilledColor=window.getComputedStyle(document.documentElement).getPropertyValue("--slick-slider-filter-filled-track-color")||Zo,this._filterElm=this.createDomFilterElement(this.searchTerms)}clear(e=!0){if(this._filterElm){this._clearFilterTriggered=!0,this._shouldTriggerQuery=e,this.searchTerms=[];const t=+(this.filterOptions?.sliderStartValue??y.SLIDER_DEFAULT_MIN_VALUE),i=+(this.filterOptions?.sliderEndValue??y.SLIDER_DEFAULT_MAX_VALUE);"double"===this.sliderType?(this._sliderLeftInputElm&&(this._sliderLeftInputElm.value=`${t}`),this._sliderRightInputElm&&(this._sliderRightInputElm.value=`${i}`),this._currentValues=[t,i],this._sliderLeftInputElm?.dispatchEvent(new Event("change")),this._sliderRightInputElm?.dispatchEvent(new Event("change"))):(this._sliderRightInputElm&&(this._sliderRightInputElm.value=`${t}`),this._selectOperatorElm&&(this._selectOperatorElm.selectedIndex=0),this._currentValue=t,this._sliderRightInputElm?.dispatchEvent(new Event("change"))),(this.filterOptions?.hideSliderNumber??this.filterOptions?.hideSliderNumbers)||("double"===this.sliderType?this.renderSliderValues(t,i):this.renderSliderValues(void 0,t)),this.updateFilterStyle(!1),this.callback(void 0,{columnDef:this.columnDef,clearFilterTriggered:!0,shouldTriggerQuery:e,searchTerms:[]})}}destroy(){this._bindEventService.unbindAll(),this._sliderTrackElm?.remove(),this._sliderLeftInputElm?.remove(),this._sliderRightInputElm?.remove()}renderSliderValues(e,t,i=!0){const s=e?.toString()||"",n=t?.toString()||"";this._leftSliderNumberElm?.textContent&&(this._leftSliderNumberElm.textContent=s),this._rightSliderNumberElm?.textContent&&(this._rightSliderNumberElm.textContent=n),this._sliderRangeContainElm.title="double"===this.sliderType?`${s} - ${n}`:`${n}`,i&&this.grid.onHeaderRowMouseLeave.notify({column:this.columnDef,grid:this.grid})}getValues(){return"double"===this.sliderType?this._currentValues:this._currentValue}setValues(e,t,i=!1){if(e){let t=[];const i=Array.isArray(e)?e?.[0]:e;if(Array.isArray(e)&&2===e.length?t=e:"string"==typeof i&&i.indexOf("..")>0?(t=i.split(".."),this._currentValue=+(t?.[0]??0)):(Me(i)||""===i)&&(this._currentValue=null===i?void 0:+i,t=[i]),"double"!==this.sliderType&&this._sliderRightInputElm)this._sliderRightInputElm.value="string"==typeof e?e:`${i}`,this.renderSliderValues(void 0,this._sliderRightInputElm.value);else if(Array.isArray(t)&&2===t.length&&!this.filterOptions?.hideSliderNumbers){const[e,i]=t;this._sliderLeftInputElm&&(this._sliderLeftInputElm.value=String(e??y.SLIDER_DEFAULT_MIN_VALUE)),this._sliderRightInputElm&&(this._sliderRightInputElm.value=String(i??y.SLIDER_DEFAULT_MAX_VALUE)),this.renderSliderValues(...t)}}else this._currentValue=void 0,this._currentValues=void 0;const s=this.getValues(),n=void 0===s?[]:Array.isArray(s)?s:[s];if(this.updateFilterStyle(n.length>0),void 0!==t&&(this.operator=t),this.operator&&this._selectOperatorElm){const e=Y(this.operator);this._selectOperatorElm.value=e}i&&this.callback(void 0,{columnDef:this.columnDef,operator:this.operator,searchTerms:n,shouldTriggerQuery:!0})}createDomFilterElement(e){const t=this.columnDef?.id??"",i=+(this.columnFilter.minValue??y.SLIDER_DEFAULT_MIN_VALUE),s=+(this.columnFilter.maxValue??y.SLIDER_DEFAULT_MAX_VALUE),n=+(this.columnFilter.valueStep??y.SLIDER_DEFAULT_STEP);re(this._argFilterContainerElm);const r=+((Array.isArray(e)&&e?.[0])??this.filterOptions?.sliderStartValue??i),o=+((Array.isArray(e)&&e?.[1])??this.filterOptions?.sliderEndValue??s);if(this._sliderRangeContainElm=ie("div",{className:`filter-input filter-${t} slider-input-container slider-values`,title:"double"===this.sliderType?`${r} - ${o}`:`${r}`}),this._sliderTrackElm=ie("div",{className:"slider-track"}),"compound"===this.sliderType){const e=ie("span",{className:"input-group-addon input-group-prepend operator"});this._selectOperatorElm=Kt(this.getOperatorOptionValues(),this.grid),e.appendChild(this._selectOperatorElm)}"double"===this.sliderType&&(this._sliderLeftInputElm=ie("input",{type:"range",className:"slider-filter-input",ariaLabel:this.columnFilter.ariaLabel??`${Ke(t+"")} Search Filter`,defaultValue:`${r}`,value:`${r}`,min:`${i}`,max:`${s}`,step:`${n}`}));const a="double"===this.sliderType?o:r;this._sliderRightInputElm=ie("input",{type:"range",className:"slider-filter-input",ariaLabel:this.columnFilter.ariaLabel??`${Ke(t+"")} Search Filter`,defaultValue:`${a}`,value:`${a}`,min:`${i}`,max:`${s}`,step:`${n}`});const l=this.filterOptions?.hideSliderNumber??this.filterOptions?.hideSliderNumbers,h=l?"":"input-group";if(this._divContainerFilterElm=ie("div",{className:`${h} search-filter slider-container slider-values filter-${t}`.trim()}),this._sliderRangeContainElm.appendChild(this._sliderTrackElm),"double"===this.sliderType&&this._sliderLeftInputElm&&this._sliderRangeContainElm.appendChild(this._sliderLeftInputElm),this._sliderRangeContainElm.appendChild(this._sliderRightInputElm),l)this._divContainerFilterElm.appendChild(this._sliderRangeContainElm);else{let e;"compound"===this.sliderType&&this._selectOperatorElm?(e=ie("span",{className:"input-group-addon input-group-prepend operator"}),e.appendChild(this._selectOperatorElm)):"double"===this.sliderType&&(e=ie("div",{className:"input-group-addon input-group-prepend slider-range-value"}),this._leftSliderNumberElm=ie("span",{className:`input-group-text lowest-range-${t}`,textContent:`${r}`}),e.appendChild(this._leftSliderNumberElm));const i=ie("div",{className:"input-group-addon input-group-append slider-range-value"});this._rightSliderNumberElm=ie("span",{className:`input-group-text highest-range-${t}`,textContent:`${a}`},i),e&&this._divContainerFilterElm.appendChild(e),this._divContainerFilterElm.appendChild(this._sliderRangeContainElm),this._divContainerFilterElm.appendChild(i)}return this._sliderOptions={minValue:i,maxValue:s,step:n},this._currentValues=[r,o],Array.isArray(e)&&e.length>0&&""!==e[0]&&(this.updateFilterStyle(!0),this._currentValue=r),void 0===this.filterOptions.sliderStartValue&&void 0===this.columnFilter.minValue||(this._currentValue=r),this._argFilterContainerElm.appendChild(this._divContainerFilterElm),this.updateTrackFilledColorWhenEnabled(),this._bindEventService.bind(this._sliderTrackElm,"click",this.sliderTrackClicked.bind(this)),this._bindEventService.bind(this._sliderRightInputElm,["input","change"],this.slideRightInputChanged.bind(this)),this._bindEventService.bind(this._sliderRightInputElm,["change","mouseup","touchend"],this.onValueChanged.bind(this)),"compound"===this.sliderType&&this._selectOperatorElm?this._bindEventService.bind(this._selectOperatorElm,["change"],this.onValueChanged.bind(this)):"double"===this.sliderType&&this._sliderLeftInputElm&&(this._bindEventService.bind(this._sliderLeftInputElm,["input","change"],this.slideLeftInputChanged.bind(this)),this._bindEventService.bind(this._sliderLeftInputElm,["change","mouseup","touchend"],this.onValueChanged.bind(this))),this._divContainerFilterElm}getOperatorOptionValues(){let e;return e=this.columnFilter.compoundOperatorList?this.columnFilter.compoundOperatorList:Zt(this.gridOptions,this.translaterService),Qt(this.gridOptions,e,"numeric"),e}onValueChanged(e){const t=parseInt(this._sliderRightInputElm?.value??"",10);let i,s;if("compound"===this.sliderType||"single"===this.sliderType)"select"!==e?.target?.tagName?.toLowerCase()&&(this._currentValue=+t),i=this._currentValue,s=[i||"0"];else if("double"===this.sliderType){const e=[parseInt(this._sliderLeftInputElm?.value??"",10),t];i=e.join(".."),s=e}if(this._clearFilterTriggered)this.updateFilterStyle(!1),this.callback(e,{columnDef:this.columnDef,clearFilterTriggered:this._clearFilterTriggered,searchTerms:[],shouldTriggerQuery:this._shouldTriggerQuery});else{const t=this._selectOperatorElm?.value??this.operator;this.updateFilterStyle(""!==i);const n=this.columnFilter.skipCompoundOperatorFilterWithNullInput??this.gridOptions.skipCompoundOperatorFilterWithNullInput,r=n&&Me(this._currentValue)||!Me(this._currentValue)&&Me(this._lastSearchValue);"compound"===this.sliderType&&n&&!r||this.callback(e,{columnDef:this.columnDef,operator:t||"",searchTerms:s,shouldTriggerQuery:this._shouldTriggerQuery})}this._clearFilterTriggered=!1,this._shouldTriggerQuery=!0,this.changeBothSliderFocuses(!1),this.grid.onHeaderRowMouseEnter.notify({column:this.columnDef,grid:this.grid},new bs(e)),this._lastSearchValue=i}changeBothSliderFocuses(e){const t=e?"add":"remove";this._sliderLeftInputElm?.classList[t]("focus"),this._sliderRightInputElm?.classList[t]("focus")}slideLeftInputChanged(e){const t=parseInt(this._sliderLeftInputElm?.value??"",10),i=parseInt(this._sliderRightInputElm?.value??"",10);this._sliderLeftInputElm&&i-t<=(this.filterOptions?.stopGapBetweenSliderHandles??0)&&(this._sliderLeftInputElm.value=String(t-(this.filterOptions?.stopGapBetweenSliderHandles??0))),this._sliderLeftInputElm&&this._sliderRightInputElm&&(+this._sliderLeftInputElm.value>=+this._sliderRightInputElm.value-20?(this._sliderLeftInputElm.style.zIndex="1",this._sliderRightInputElm.style.zIndex="0"):(this._sliderLeftInputElm.style.zIndex="0",this._sliderRightInputElm.style.zIndex="1")),this.sliderLeftOrRightChanged(e,"left",t,i)}slideRightInputChanged(e){const t=parseInt(this._sliderLeftInputElm?.value??"",10),i=parseInt(this._sliderRightInputElm?.value??"",10);"double"===this.sliderType&&this._sliderRightInputElm&&i-t<=(this.filterOptions?.stopGapBetweenSliderHandles??0)&&(this._sliderRightInputElm.value=String(t+(this.filterOptions?.stopGapBetweenSliderHandles??0))),this.sliderLeftOrRightChanged(e,"right",t,i)}sliderLeftOrRightChanged(e,t,i,s){let n=!0;this.updateTrackFilledColorWhenEnabled(),this.changeBothSliderFocuses(!0),this._sliderRangeContainElm.title="double"===this.sliderType?`${i} - ${s}`:`${s}`,"double"===this.sliderType&&this._sliderLeftInputElm&&this._sliderRightInputElm&&("left"===t&&i>s?(this._sliderLeftInputElm.value=`${s}`,n=!1):"right"===t&&i>s&&(this._sliderRightInputElm.value=`${i}`,n=!1)),(this.filterOptions?.hideSliderNumber??this.filterOptions?.hideSliderNumbers)||(this._leftSliderNumberElm?.textContent&&(this._leftSliderNumberElm.textContent=this._sliderLeftInputElm?.value??""),this._rightSliderNumberElm?.textContent&&(this._rightSliderNumberElm.textContent=this._sliderRightInputElm?.value??"")),n&&this.grid.onHeaderRowMouseEnter.notify({column:this.columnDef,grid:this.grid},new bs(e))}sliderTrackClicked(e){e.preventDefault();const t=100*(e.offsetX+0)/this._sliderTrackElm.offsetWidth;this._sliderRightInputElm&&"double"!==this.sliderType?(this._sliderRightInputElm.value=`${t}`,this._sliderRightInputElm.dispatchEvent(new Event("change"))):this._sliderLeftInputElm&&this._sliderRightInputElm&&(t<=50?(this._sliderLeftInputElm.value=`${t}`,this._sliderLeftInputElm.dispatchEvent(new Event("change"))):(this._sliderRightInputElm.value=`${t}`,this._sliderRightInputElm.dispatchEvent(new Event("change"))))}updateTrackFilledColorWhenEnabled(){if(this.filterOptions?.enableSliderTrackColoring&&this._sliderRightInputElm){let e=0;this._sliderLeftInputElm&&(e=(+this._sliderLeftInputElm.value-+this._sliderLeftInputElm.min)/(this.sliderOptions?.maxValue??0-+this._sliderLeftInputElm.min)*100);const t=(+this._sliderRightInputElm.value-+this._sliderRightInputElm.min)/(this.sliderOptions?.maxValue??0-+this._sliderRightInputElm.min)*100,i="linear-gradient(to right, %b %p1, %c %p1, %c %p2, %b %p2)".replace(/%b/g,"#eee").replace(/%c/g,this.filterOptions?.sliderTrackFilledColor||this._sliderTrackFilledColor||Zo).replace(/%p1/g,`${e}%`).replace(/%p2/g,`${t}%`);this._sliderTrackElm.style.background=i,this._sliderOptions.sliderTrackBackground=i}}updateFilterStyle(e){e?(this._divContainerFilterElm.classList.add("filled"),this._filterElm?.classList.add("filled")):(this._divContainerFilterElm.classList.remove("filled"),this._filterElm?.classList.remove("filled"))}}var Jo=Object.defineProperty,ea=(e,t,i)=>((e,t,i)=>t in e?Jo(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i)(e,"symbol"!=typeof t?t+"":t,i),ta=class{constructor(e){ea(this,"_distinctEvent"),ea(this,"_boundedEvents",[]),this._distinctEvent=e?.distinctEvent??!1}get boundedEvents(){return this._boundedEvents}dispose(){this.unbindAll(),this._boundedEvents=[]}bind(e,t,i,s,n=""){let r=Array.isArray(t)?t:[t];if("function"==typeof e?.forEach)e.forEach((e=>{for(let t of r)(!this._distinctEvent||this._distinctEvent&&!this.hasBinding(e,t))&&(e.addEventListener(t,i,s),this._boundedEvents.push({element:e,eventName:t,listener:i,groupName:n}))}));else for(let t of r)(!this._distinctEvent||this._distinctEvent&&!this.hasBinding(e,t))&&(e.addEventListener(t,i,s),this._boundedEvents.push({element:e,eventName:t,listener:i,groupName:n}))}hasBinding(e,t){return this._boundedEvents.some((i=>i.element===e&&(!t||i.eventName===t)))}unbind(e,t,i){if(e){let s=Array.isArray(e)?e:[e],n=Array.isArray(t)?t||"":[t||""];for(let e of s){i||(i=this._boundedEvents.find((i=>{if(i.element===e&&(!t||i.eventName===t))return i.listener})));for(let t of n)e?.removeEventListener?.(t,i)}}}unbindAll(e){if(e){let t=Array.isArray(e)?e:[e];for(let e=this._boundedEvents.length-1;e>=0;--e){let i=this._boundedEvents[e];if(t.some((e=>e===i.groupName))){let{element:t,eventName:s,listener:n}=i;this.unbind(t,s,n),this._boundedEvents.splice(e,1)}}}else for(;this._boundedEvents.length>0;){let e=this._boundedEvents.pop(),{element:t,eventName:i,listener:s}=e;this.unbind(t,i,s)}}},ia=typeof window<"u"&&void 0!==window.multipleSelect?window.multipleSelect:{locales:{}};ia.locales["en-US"]={formatSelectAll:()=>"[Select all]",formatAllSelected:()=>"All selected",formatCountSelected:(e,t)=>`${e} of ${t} selected`,formatNoMatchesFound:()=>"No matches found",formatOkButton:()=>"OK"};var sa=ia.locales,na={name:"",placeholder:"",classes:"",classPrefix:"",data:void 0,locale:void 0,selectAll:!0,single:void 0,singleRadio:!1,multiple:!1,hideOptgroupCheckboxes:!1,multipleWidth:80,width:void 0,dropWidth:void 0,maxHeight:250,maxHeightUnit:"px",position:"bottom",displayValues:!1,displayTitle:!1,displayDelimiter:", ",minimumCountSelected:3,ellipsis:!1,isOpen:!1,keepOpen:!1,openOnHover:!1,container:null,filter:!1,filterGroup:!1,filterPlaceholder:"",filterAcceptOnEnter:!1,filterByDataLength:void 0,customFilter(e){let{text:t,label:i,search:s}=e;return(i||t||"").includes(s)},showClear:!1,autoAdjustDropHeight:!1,autoAdjustDropPosition:!1,autoAdjustDropWidthByTextSize:!1,adjustedHeightPadding:10,useSelectOptionLabel:!1,useSelectOptionLabelToHtml:!1,navigationHighlight:!0,infiniteScroll:!1,virtualScroll:!0,cssStyler:()=>null,textTemplate:e=>e.innerHTML.trim(),labelTemplate:e=>e.label,onOpen:()=>!1,onClose:()=>!1,onCheckAll:()=>!1,onUncheckAll:()=>!1,onFocus:()=>!1,onBlur:()=>!1,onOptgroupClick:()=>!1,onBeforeClick:()=>!0,onClick:()=>!1,onFilter:()=>!1,onFilterClear:()=>!1,onClear:()=>!1,onAfterCreate:()=>!1,onDestroy:()=>!1,onAfterDestroy:()=>!1,onDestroyed:()=>!1};Object.assign(na,sa["en-US"]);var ra={BLOCK_ROWS:50,CLUSTER_BLOCKS:4,DEFAULTS:na,METHODS:["init","getOptions","refreshOptions","getSelects","setSelects","enable","disable","open","close","check","uncheck","checkAll","uncheckAll","checkInvert","focus","blur","refresh","destroy"]};function oa(e){let t=Object.prototype.toString.call(e).slice(8,-1).toLowerCase();return"object"===t?(()=>{let t={};for(let i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=oa(e[i]));return t})():"array"===t?e.map((e=>oa(e))):e}function aa(e){return null!=e&&""!==e}function la(e,t,i){if(Array.isArray(e))for(let s of e){if(s[t]===i||s[t]===""+ +s[t]&&+s[t]===i)return s;if("optgroup"===s.type)for(let e of s.children)if(e&&(e[t]===i||e[t]===""+ +e[t]&&+e[t]===i))return e}}function ha(e){return Object.keys(e).forEach((t=>void 0===e[t]?delete e[t]:"")),e}function ca(e,t){if("string"!=typeof e)return e;if("function"==typeof t)return t(e);if("function"==typeof e.normalize)return e.normalize("NFD").replace(/[\u0300-\u036F]/g,"");throw new Error("[Multiple-Select-Vanilla] `normalize()` function is not defined, you can optionally provide a custom parser via the `diacriticParser` option.")}function da(e){let t=0,i=0,s=0,n=0,r=window.innerHeight??0,o=window.innerWidth??0,a={left:window.pageXOffset||document.documentElement.scrollLeft||0,top:window.pageYOffset||document.documentElement.scrollTop||0},l=a.top,h=a.left,c=_a(e);if(c){let e=c.top??0,a=c.left??0;i=e-l,t=r-(e-l),s=a-h,n=o-(a-h)}return{top:i,bottom:t,left:s,right:n}}function ua(e=""){return e.split(" ").filter((e=>e))}function pa(e,t,i){let s=document.createElement(e);return t&&Object.keys(t).forEach((e=>{let i=t[e];"object"==typeof i?Object.assign(s[e],i):s[e]=t[e]})),i?.appendChild&&i.appendChild(s),s}function ma(e,t,i){let s=e.props?.innerHTML?function(e,t){let{[t]:i,...s}=e;return s}(e.props,"innerHTML"):e.props,n=pa(e.tagName,function(e,t){return"object"==typeof e?Object.fromEntries(t?Object.entries(e).filter((([e,i])=>!aa(i)&&!t.includes(e)||aa(i))):Object.entries(e).filter((([e,t])=>aa(t)))):e}(s,["className","title","style"]),t),r=i;if(r||(r=n),e.props.innerHTML&&(n.innerHTML=e.props.innerHTML),e.attrs)for(let t of Object.keys(e.attrs))n.setAttribute(t,e.attrs[t]);if(e.children)for(let t of e.children)ma(t,n,r);return t?.appendChild(n),n}function fa(e){return e.hasOwnProperty("tagName")?ma(e):document.createElement("li")}function ga(e){for(;e?.firstChild;)e.lastChild&&e.removeChild(e.lastChild);return e}function _a(e){if(!e)return;let t=e?.getBoundingClientRect?.(),i=0,s=0,n=0,r=0;return void 0!==t?.top&&void 0!==t.left&&(i=t.top+window.pageYOffset,s=t.left+window.pageXOffset,r=t.right,n=t.bottom),{top:i,left:s,bottom:n,right:r}}function va(e,t,i){if(!e)return 0;let s=Number.parseFloat(e.style[i]);if(!s||Number.isNaN(s)){switch(t){case"outer":s=e["width"===i?"offsetWidth":"offsetHeight"];break;case"scroll":s=e["width"===i?"scrollWidth":"scrollHeight"];break;default:s=e["width"===i?"clientWidth":"clientHeight"]}s=e.getBoundingClientRect()[i]}if(!s||Number.isNaN(s)){let t=e.style.display,n=e.style.position;e.style.display="block",e.style.position="absolute";let r=window.getComputedStyle(e)[i];s=Number.parseFloat(r),Number.isNaN(s)&&(s=0),e.style.display=t,e.style.position=n}return s||0}function ba(e,t){let i=null,s=e?.parentElement;for(;s;){let[e,n,r,o]=t.match(/^([a-z]*)([#.]{1})([a-z\-]+)$/i)||[];if(r&&o)for(let e of o.replace(r,"").split(" "))s.classList.contains(e)&&(n?s?.tagName.toLowerCase()===n&&(i=s):i=s);s=s.parentElement}return i}function ya(e,t){e?.style&&(e.style.display="none"===e.style.display&&!1!==t||!0===t?"block":"none")}var Ca=class{constructor(e){ea(this,"clusterRows"),ea(this,"cache"),ea(this,"scrollEl"),ea(this,"blockHeight"),ea(this,"clusterHeight"),ea(this,"contentEl"),ea(this,"parentEl"),ea(this,"itemHeight"),ea(this,"lastCluster"),ea(this,"scrollTop"),ea(this,"dataStart"),ea(this,"dataEnd"),ea(this,"rows"),ea(this,"destroy"),ea(this,"callback"),ea(this,"sanitizer"),this.rows=e.rows,this.scrollEl=e.scrollEl,this.contentEl=e.contentEl,this.parentEl=e.contentEl?.parentElement,this.callback=e.callback,this.cache={},this.scrollTop=this.scrollEl.scrollTop,this.initDOM(this.rows),this.scrollEl.scrollTop=this.scrollTop,this.lastCluster=0;let t=()=>{this.lastCluster!==(this.lastCluster=this.getNum())&&(this.initDOM(this.rows),this.callback())};this.scrollEl.addEventListener("scroll",t,!1),this.destroy=()=>{this.scrollEl.removeEventListener("scroll",t,!1),ga(this.contentEl)}}reset(e){this.lastCluster=0,this.cache={},ga(this.contentEl),this.initDOM(e)}initDOM(e){if(typeof this.clusterHeight>"u"){this.cache.scrollTop=this.scrollEl.scrollTop;let t=fa(e[0]);this.contentEl.appendChild(t),this.contentEl.appendChild(t),this.contentEl.appendChild(t),this.cache.data=[e[0]],this.getRowsHeight()}let t=this.initData(e,this.getNum()),i=this.checkChanges("data",t.rows),s=this.checkChanges("top",t.topOffset),n=this.checkChanges("bottom",t.bottomOffset);ga(this.contentEl),i&&s?(t.topOffset&&this.contentEl.appendChild(this.getExtra("top",t.topOffset)),t.rows.forEach((e=>this.contentEl.appendChild(fa(e)))),t.bottomOffset&&this.contentEl.appendChild(this.getExtra("bottom",t.bottomOffset))):n&&this.contentEl.lastChild&&(this.contentEl.lastChild.style.height=`${t.bottomOffset}px`)}getRowsHeight(){if(typeof this.itemHeight>"u"){let e=this.parentEl?.style.display||"";this.parentEl&&(""===e||"none"===e)&&(this.parentEl.style.display="block");let t=this.contentEl.children,i=t[Math.floor(t.length/2)];this.itemHeight=i.offsetHeight,this.parentEl&&(this.parentEl.style.display=e)}this.blockHeight=this.itemHeight*ra.BLOCK_ROWS,this.clusterRows=ra.BLOCK_ROWS*ra.CLUSTER_BLOCKS,this.clusterHeight=this.blockHeight*ra.CLUSTER_BLOCKS}getNum(){this.scrollTop=this.scrollEl.scrollTop;let e=(this.clusterHeight||0)-(this.blockHeight||0);return e&&Math.floor(this.scrollTop/e)||0}initData(e,t){if(e.length<ra.BLOCK_ROWS)return{topOffset:0,bottomOffset:0,rowsAbove:0,rows:e};let i=Math.max((this.clusterRows-ra.BLOCK_ROWS)*t,0),s=i+this.clusterRows,n=Math.max(i*this.itemHeight,0),r=Math.max((e.length-s)*this.itemHeight,0),o=[],a=i;n<1&&a++;for(let t=i;t<s;t++)e[t]&&o.push(e[t]);return this.dataStart=i,this.dataEnd=s,{topOffset:n,bottomOffset:r,rowsAbove:a,rows:o}}checkChanges(e,t){let i=t!==this.cache[e];return this.cache[e]=t,i}getExtra(e,t){let i=document.createElement("li");return i.className=`virtual-scroll-${e}`,t&&(i.style.height=`${t}px`),i}},wa=".ms-select-all, ul li[data-key]",Sa=class{constructor(e,t){this.elm=e,ea(this,"_bindEventService"),ea(this,"isAllSelected",!1),ea(this,"isPartiallyAllSelected",!1),ea(this,"fromHtml",!1),ea(this,"choiceElm"),ea(this,"selectClearElm"),ea(this,"closeElm"),ea(this,"clearSearchIconElm"),ea(this,"filterText",""),ea(this,"updateData",[]),ea(this,"data",[]),ea(this,"dataTotal"),ea(this,"dropElm"),ea(this,"okButtonElm"),ea(this,"filterParentElm"),ea(this,"lastFocusedItemKey",""),ea(this,"lastMouseOverPosition",""),ea(this,"ulElm"),ea(this,"parentElm"),ea(this,"labelElm"),ea(this,"selectAllParentElm"),ea(this,"selectAllElm"),ea(this,"searchInputElm"),ea(this,"selectGroupElms"),ea(this,"selectItemElms"),ea(this,"noResultsElm"),ea(this,"options"),ea(this,"selectAllName",""),ea(this,"selectGroupName",""),ea(this,"selectItemName",""),ea(this,"scrolledByMouse",!1),ea(this,"openDelayTimer"),ea(this,"updateDataStart"),ea(this,"updateDataEnd"),ea(this,"virtualScroll"),ea(this,"_currentHighlightIndex",-1),ea(this,"_currentSelectedElm"),ea(this,"isMoveUpRecalcRequired",!1),ea(this,"locales",{}),this.options=Object.assign({},ra.DEFAULTS,this.elm.dataset,t),this._bindEventService=new ta({distinctEvent:!0})}get isRenderAsHtml(){return this.options.renderOptionLabelAsHtml||this.options.useSelectOptionLabelToHtml}init(){this.initLocale(),this.initContainer(),this.initData(),this.initSelected(!0),this.initFilter(),this.initDrop(),this.initView(),this.options.onAfterCreate()}destroy(e=!0){this.elm&&this.parentElm&&(this.options.onDestroy({hardDestroy:e}),e&&this.options.onHardDestroy(),this.elm.parentElement&&this.parentElm.parentElement&&this.elm.parentElement.insertBefore(this.elm,this.parentElm.parentElement.firstChild),this.elm.classList.remove("ms-offscreen"),this._bindEventService.unbindAll(),this.virtualScroll?.destroy(),this.dropElm?.remove(),this.dropElm=void 0,this.parentElm.parentNode?.removeChild(this.parentElm),this.fromHtml&&(delete this.options.data,this.fromHtml=!1),this.options.onAfterDestroy({hardDestroy:e}),e&&(this.options.onAfterHardDestroy?.(),Object.keys(this.options).forEach((e=>delete this[e]))))}initLocale(){if(this.options.locale){if("object"==typeof this.options.locale)return void Object.assign(this.options,this.options.locale);let e=window.multipleSelect.locales,t=this.options.locale.split(/-|_/);if(t[0]=t[0].toLowerCase(),t[1]&&(t[1]=t[1].toUpperCase()),e[this.options.locale])Object.assign(this.options,e[this.options.locale]);else if(e[t.join("-")])Object.assign(this.options,e[t.join("-")]);else{if(!e[t[0]])throw new Error(`[multiple-select-vanilla] invalid locales "${this.options.locale}", make sure to import it before using it`);Object.assign(this.options,e[t[0]])}}}initContainer(){let e=this.elm.getAttribute("name")||this.options.name||"";this.options.classes&&this.elm.classList.add(this.options.classes),this.options.classPrefix&&(this.elm.classList.add(this.options.classPrefix),this.options.size&&this.elm.classList.add(`${this.options.classPrefix}-${this.options.size}`)),this.elm.style.display="none",this.labelElm=this.elm.closest("label"),!this.labelElm&&this.elm.id&&(this.labelElm=document.createElement("label"),this.labelElm.htmlFor=this.elm.id),this.labelElm?.querySelector("input")&&(this.labelElm=null),typeof this.options.single>"u"&&(this.options.single=!this.elm.multiple),this.parentElm=pa("div",{className:ua(`ms-parent ${this.elm.className||""} ${this.options.classes}`).join(" "),dataset:{test:"sel"}}),this.options.darkMode&&this.parentElm.classList.add("ms-dark-mode");let t=this.elm.getAttribute("title")||"";t&&(this.parentElm.title=t),this.options.placeholder=this.options.placeholder||this.elm.getAttribute("placeholder")||"",this.choiceElm=pa("button",{className:"ms-choice",type:"button"},this.parentElm),this.options.labelId&&(this.choiceElm.id=this.options.labelId,this.choiceElm.setAttribute("aria-labelledby",this.options.labelId)),this.choiceElm.appendChild(pa("span",{className:"ms-placeholder",textContent:this.options.placeholder})),this.options.showClear&&(this.selectClearElm=pa("div",{className:"ms-icon ms-icon-close"}),this.selectClearElm.style.display="none",this.choiceElm.appendChild(this.selectClearElm)),this.choiceElm.appendChild(pa("div",{className:"ms-icon ms-icon-caret"})),this.dropElm=pa("div",{className:`ms-drop ${this.options.position}`,ariaExpanded:"false"},this.parentElm),this.options.darkMode&&this.dropElm.classList.add("ms-dark-mode"),e&&(this.dropElm.dataset.name=e);let i=this.elm.getAttribute("data-test")||this.options.dataTest;i&&(this.parentElm.dataset.test=i,this.dropElm.dataset.test=i),this.closeElm=this.choiceElm.querySelector(".ms-icon-close"),this.options.dropWidth&&(this.dropElm.style.width="string"==typeof this.options.dropWidth?this.options.dropWidth:`${this.options.dropWidth}px`),function(e,t){e.parentNode?.insertBefore(t,e.nextSibling)}(this.elm,this.parentElm),this.elm.disabled&&(this.choiceElm.classList.add("disabled"),this.choiceElm.disabled=!0),this.selectAllName=`selectAll${e}`,this.selectGroupName=`selectGroup${e}`,this.selectItemName=`selectItem${e}`,this.options.keepOpen||(this._bindEventService.unbindAll("body-click"),this._bindEventService.bind(document.body,"click",(e=>{this.getEventTarget(e)===this.choiceElm||ba(this.getEventTarget(e),".ms-choice")===this.choiceElm||(this.getEventTarget(e)===this.dropElm||ba(this.getEventTarget(e),".ms-drop")!==this.dropElm&&this.getEventTarget(e)!==this.elm)&&this.options.isOpen&&this.close("body.click")}),void 0,"body-click"))}initData(){let e=[];if(this.options.data){if(Array.isArray(this.options.data))this.data=this.options.data.map((e=>"string"==typeof e||"number"==typeof e?{text:e,value:e}:e));else if("object"==typeof this.options.data){for(let[t,i]of Object.entries(this.options.data))e.push({value:t,text:`${i}`});this.data=e}}else this.elm.childNodes.forEach((t=>{let i=this.initRow(t);i&&e.push(i)})),this.options.data=e,this.data=e,this.fromHtml=!0;this.dataTotal=function(e){let t=0;return e.forEach(((e,i)=>{"optgroup"===e.type?(e._key=`group_${i}`,e.visible=typeof e.visible>"u"||e.visible,e.children.forEach(((e,s)=>{e&&(e.visible=typeof e?.visible>"u"||e.visible,e.divider||(e._key=`option_${i}_${s}`,t+=1))}))):(e.visible=typeof e.visible>"u"||e.visible,e.divider||(e._key=`option_${i}`,t+=1))})),t}(this.data||[])}initRow(e,t){let i={};return"option"===e.tagName?.toLowerCase()?(i.type="option",i.text=this.options.textTemplate(e),i.value=e.value,i.visible=!0,i.selected=!!e.selected,i.disabled=t||e.disabled,i.classes=e.getAttribute("class")||"",i.title=e.getAttribute("title")||"",e.dataset.value&&(i._value=e.dataset.value),Object.keys(e.dataset).length&&(i._data=e.dataset,i._data.divider&&(i.divider=i._data.divider)),i):"optgroup"===e.tagName?.toLowerCase()?(i.type="optgroup",i.label=this.options.labelTemplate(e),i.visible=!0,i.selected=!!e.selected,i.disabled=e.disabled,i.children=[],Object.keys(e.dataset).length&&(i._data=e.dataset),e.childNodes.forEach((e=>{i.children.push(this.initRow(e,i.disabled))})),i):null}initDrop(){this.initList(),this.update(!0),this.options.isOpen&&this.open(10),this.options.openOnHover&&this.parentElm&&(this._bindEventService.bind(this.parentElm,"mouseover",(()=>this.open(null))),this._bindEventService.bind(this.parentElm,"mouseout",(()=>this.close("hover.mouseout"))))}initFilter(){if(this.filterText="",this.options.filter||!this.options.filterByDataLength)return;let e=0;for(let t of this.data||[])"optgroup"===t.type?e+=t.children.length:e+=1;this.options.filter=e>this.options.filterByDataLength}initList(){if(this.options.filter&&(this.filterParentElm=pa("div",{className:"ms-search"},this.dropElm),this.filterParentElm.appendChild(pa("input",{autocomplete:"off",autocapitalize:"off",spellcheck:!1,type:"text",placeholder:this.options.filterPlaceholder||"ðï¸"})),this.options.showSearchClear&&this.filterParentElm.appendChild(pa("span",{className:"ms-icon ms-icon-close"}))),this.options.selectAll&&!this.options.single){let e=this.elm.getAttribute("name")||this.options.name||"";this.selectAllParentElm=pa("div",{className:"ms-select-all",dataset:{key:"select_all"}});let t=document.createElement("label"),i="ms-icon "+(this.isAllSelected?"ms-icon-check":this.isPartiallyAllSelected?"ms-icon-minus":"ms-icon-uncheck"),s=pa("div",{className:"icon-checkbox-container"},t);pa("input",{type:"checkbox",ariaChecked:String(this.isAllSelected),checked:this.isAllSelected,dataset:{name:`selectAll${e}`}},s),pa("div",{className:i},s),t.appendChild(pa("span",{textContent:this.formatSelectAll()})),this.selectAllParentElm.appendChild(t),this.dropElm?.appendChild(this.selectAllParentElm)}this.ulElm=document.createElement("ul"),this.ulElm.role="combobox",this.ulElm.ariaExpanded="false",this.ulElm.ariaMultiSelectable=String(!this.options.single),this.dropElm?.appendChild(this.ulElm),this.options.showOkButton&&!this.options.single&&(this.okButtonElm=pa("button",{className:"ms-ok-button",type:"button",textContent:this.formatOkButton()},this.dropElm)),this.initListItems()}initListItems(){let e=0,t=this.getListRows();if(this.options.selectAll&&!this.options.single&&(e=-1),t.length>ra.BLOCK_ROWS*ra.CLUSTER_BLOCKS){let i=this.dropElm&&"none"!==this.dropElm?.style.display;!i&&this.dropElm&&(this.dropElm.style.left="-10000",this.dropElm.style.display="block",this.dropElm.ariaExpanded="true");let s=()=>{if(this.virtualScroll){this._currentHighlightIndex=0,this.updateDataStart=this.virtualScroll.dataStart+e,this.updateDataEnd=this.virtualScroll.dataEnd+e,this.updateDataStart<0&&(this.updateDataStart=0,this._currentHighlightIndex=0);let t=this.getDataLength();this.updateDataEnd>t&&(this.updateDataEnd=t),this.ulElm&&(this.isMoveUpRecalcRequired?this.recalculateArrowMove("up"):this.virtualScroll.dataStart>this.updateDataStart&&this.recalculateArrowMove("down"))}};this.ulElm&&(this.virtualScroll?this.virtualScroll.reset(t):this.virtualScroll=new Ca({rows:t,scrollEl:this.ulElm,contentEl:this.ulElm,sanitizer:this.options.sanitizer,callback:()=>{s(),this.events()}})),s(),!i&&this.dropElm&&(this.dropElm.style.left="0",this.dropElm.style.display="none",this.dropElm.ariaExpanded="false")}else this.ulElm&&(ga(this.ulElm),t.forEach((e=>this.ulElm.appendChild(fa(e))))),this.updateDataStart=0,this.updateDataEnd=this.updateData.length;return this.events(),t}getEventTarget(e){return e.composedPath?e.composedPath()[0]:e.target}getListRows(){let e=[];return this.updateData=[],this.data?.forEach((t=>e.push(...this.initListItem(t)))),this.options.infiniteScroll&&e.push({tagName:"li",props:{className:"ms-infinite-option",role:"option"}}),e.push({tagName:"li",props:{className:"ms-no-results",textContent:this.formatNoMatchesFound()}}),e}initListItem(e,t=0){let i=e?.title||"",s=this.options.multiple?"multiple":"",n=this.options.single?"radio":"checkbox",r=!!e?.selected,o=this.options.single&&!this.options.singleRadio,a="";if(!e?.visible)return[];if(this.updateData.push(e),o&&(a="hide-radio "),e.selected&&(a+="selected "),"optgroup"===e.type){let t,i=[];if(this.options.hideOptgroupCheckboxes||this.options.single)t={tagName:"span",props:{dataset:{name:this.selectGroupName,key:e._key}}};else{let i={tagName:"input",props:{type:"checkbox",dataset:{name:this.selectGroupName,key:e._key},checked:r,disabled:e.disabled}};t=o?i:{tagName:"div",props:{className:"icon-checkbox-container"+("radio"===n?" radio":"")},children:[i,{tagName:"div",props:{className:"ms-icon "+(r?"radio"===n?"ms-icon-radio":"ms-icon-check":"ms-icon-uncheck")}}]}}!a.includes("hide-radio")&&(this.options.hideOptgroupCheckboxes||this.options.single)&&(a+="hide-radio ");let s={tagName:"span",props:{}};this.applyAsTextOrHtmlWhenEnabled(s.props,e.label);let l={tagName:"li",props:{className:ua(`group${this.options.single||e.disabled?" disabled":""} ${a}`).join(" "),role:"option",ariaSelected:String(r),dataset:{key:e._key}},children:[{tagName:"label",props:{className:ua("optgroup"+(this.options.single||e.disabled?" disabled":"")).join(" ")},children:[t,s]}]},h=this.options.cssStyler(e);return h&&(l.props.style=h),i.push(l),e.children.forEach((e=>i.push(...this.initListItem(e,1)))),i}if(a+=e.classes||"",t&&this.options.single&&(a+=`option-level-${t} `),e.divider)return[{tagName:"li",props:{className:"option-divider"}}];let l=s||a?(s+a).trim():"";e.disabled&&(l+=" disabled");let h=e.disabled?"disabled":"",c={tagName:"span",props:{}};this.applyAsTextOrHtmlWhenEnabled(c.props,e.text);let d={tagName:"input",props:{type:n,value:encodeURI(e.value),dataset:{key:e._key,name:this.selectItemName},checked:r,disabled:!!e.disabled}};e.selected&&(d.attrs={checked:"checked"});let u={tagName:"div",props:{className:"icon-checkbox-container"+("radio"===n?" radio":"")},children:[d,{tagName:"div",props:{className:"ms-icon "+(d.props.checked?"radio"===n?"ms-icon-radio":"ms-icon-check":"ms-icon-uncheck")}}]},p={tagName:"li",props:{role:"option",title:i,ariaSelected:String(r),dataset:{key:e._key}},children:[{tagName:"label",props:{className:h},children:[o?d:u,c]}]};l&&(p.props.className=l);let m=this.options.cssStyler(e);return m&&(p.props.style=m),[p]}initSelected(e=!1){let t=0;for(let e of this.data||[])if("optgroup"===e.type){let i=e.children.filter((e=>e?.selected&&!e.disabled&&e.visible)).length;e.children.length&&(e.selected=!this.options.single&&i&&i===e.children.filter((e=>e&&!e.disabled&&e.visible&&!e.divider)).length),t+=i}else t+=e.selected&&!e.disabled&&e.visible?1:0;this.isAllSelected=this.data?.filter((e=>e.selected&&!e.disabled&&e.visible)).length===this.data?.filter((e=>!e.disabled&&e.visible&&!e.divider)).length,this.isPartiallyAllSelected=!this.isAllSelected&&t>0,e||(this.isAllSelected?this.options.onCheckAll():0===t&&this.options.onUncheckAll())}initView(){let e;window.getComputedStyle?(e=window.getComputedStyle(this.elm).width,"auto"===e&&(e=va(this.dropElm,"outer","width")+20)):e=va(this.elm,"outer","width")+20,this.parentElm.style.width=`${this.options.width||e}px`,this.elm.classList.add("ms-offscreen")}events(){this._bindEventService.unbindAll(["ok-button","search-input","select-all-checkbox","input-checkbox-list","group-checkbox-list","hover-highlight","arrow-highlight","option-list-scroll"]),this.clearSearchIconElm=this.filterParentElm?.querySelector(".ms-icon-close"),this.searchInputElm=this.dropElm?.querySelector(".ms-search input"),this.selectAllElm=this.dropElm?.querySelector(`input[data-name="${this.selectAllName}"]`),this.selectGroupElms=this.dropElm?.querySelectorAll(`input[data-name="${this.selectGroupName}"],span[data-name="${this.selectGroupName}"]`),this.selectItemElms=this.dropElm?.querySelectorAll(`input[data-name="${this.selectItemName}"]:enabled`),this.noResultsElm=this.dropElm?.querySelector(".ms-no-results");let e=e=>{e.preventDefault(),!this.getEventTarget(e).classList.contains("ms-icon-close")&&(this.options.isOpen?this.close("toggle.close"):this.open())};this.labelElm&&this._bindEventService.bind(this.labelElm,"click",(t=>{"label"===this.getEventTarget(t).nodeName.toLowerCase()&&(e(t),(!this.options.filter||!this.options.isOpen)&&this.focus(),t.stopPropagation())})),this._bindEventService.bind(this.choiceElm,"click",e),this.options.onFocus&&this._bindEventService.bind(this.choiceElm,"focus",this.options.onFocus),this.options.onBlur&&this._bindEventService.bind(this.choiceElm,"blur",this.options.onBlur),this._bindEventService.bind(this.parentElm,"keydown",(e=>{"Escape"===e.code&&this.handleEscapeKey()})),this.closeElm&&this._bindEventService.bind(this.closeElm,"click",(e=>{e.preventDefault(),this._checkAll(!1,!0),this.initSelected(!1),this.updateSelected(),this.update(),this.options.onClear()})),this.clearSearchIconElm&&this._bindEventService.bind(this.clearSearchIconElm,"click",(e=>{e.preventDefault(),this.searchInputElm&&(this.searchInputElm.value="",this.searchInputElm.focus()),this._currentHighlightIndex=-1,this.moveHighlightDown(),this.filter(),this.options.onFilterClear()})),this.searchInputElm&&(this._bindEventService.bind(this.searchInputElm,"keydown",(e=>{"Tab"===e.code&&e.shiftKey&&this.close("key.shift+tab")}),void 0,"search-input"),this._bindEventService.bind(this.searchInputElm,"keyup",(e=>{if(this.options.filterAcceptOnEnter&&["Enter","Space"].includes(e.code)&&this.searchInputElm?.value){if(this.options.single){let e=[];this.selectItemElms?.forEach((t=>{"none"!==t.closest("li")?.style.display&&e.push(t)})),e.length&&e[0].hasAttribute("data-name")&&this.setSelects([e[0].value])}else this.selectAllElm?.click();return this.close(`key.${e.code.toLowerCase()}`),void this.focus()}this.filter()}),void 0,"search-input")),this.selectAllElm&&this._bindEventService.bind(this.selectAllElm,"click",(e=>this._checkAll(e.currentTarget?.checked)),void 0,"select-all-checkbox"),this.okButtonElm&&this._bindEventService.bind(this.okButtonElm,"click",(t=>{e(t),t.stopPropagation()}),void 0,"ok-button"),this.selectGroupElms&&this._bindEventService.bind(this.selectGroupElms,"click",(e=>{let t=e.currentTarget,i=t.checked,s=la(this.data,"_key",t.dataset.key);this._checkGroup(s,i),this.options.onOptgroupClick(ha({label:s.label,selected:s.selected,data:s._data,children:s.children.map((e=>{if(e)return ha({text:e.text,value:e.value,selected:e.selected,disabled:e.disabled,data:e._data})}))}))}),void 0,"group-checkbox-list"),this.selectItemElms&&this._bindEventService.bind(this.selectItemElms,"click",(e=>{let t=e.currentTarget,i=t.checked,s=la(this.data,"_key",t.dataset.key),n=()=>{this.options.single&&this.options.isOpen&&!this.options.keepOpen&&this.close("selection")};!1!==this.options.onBeforeClick(s)?(this._check(s,i),this.options.onClick(ha({text:s.text,value:s.value,selected:s.selected,data:s._data})),n()):n()}),void 0,"input-checkbox-list"),this.lastFocusedItemKey&&this.dropElm&&this.dropElm.querySelector(`li[data-key=${this.lastFocusedItemKey}]`)?.focus(),this.options.navigationHighlight&&this.dropElm&&(this._bindEventService.bind(this.dropElm,"mouseover",(e=>{let t=this.getEventTarget(e).closest(".ms-select-all")||this.getEventTarget(e).closest("li");if(this.dropElm?.contains(t)&&this.lastMouseOverPosition!==`${e.clientX}:${e.clientY}`){let e=this.dropElm?.querySelectorAll(wa)||[],i=Array.from(e).findIndex((e=>e.dataset.key===t.dataset.key));this._currentHighlightIndex!==i&&!t.classList.contains("disabled")&&(this._currentSelectedElm=t,this._currentHighlightIndex=i,this.changeCurrentOptionHighlight(t))}this.lastMouseOverPosition=`${e.clientX}:${e.clientY}`}),void 0,"hover-highlight"),this._bindEventService.bind(this.dropElm,"keydown",(e=>{switch(e.key){case"ArrowUp":e.preventDefault(),this.moveHighlightUp();break;case"ArrowDown":e.preventDefault(),this.moveHighlightDown();break;case"Escape":this.handleEscapeKey();break;case"Enter":case" ":if(document.activeElement!==this.okButtonElm){let t=this.getEventTarget(e).closest(".ms-select-all")||this.getEventTarget(e).closest("li");if(" "===e.key&&this.options.filter||this.options.filterAcceptOnEnter&&!t)return;e.preventDefault(),this._currentSelectedElm?.querySelector("input")?.click(),this.options.single&&(this.choiceElm.focus(),this.lastFocusedItemKey=this.choiceElm?.dataset.key||"")}break;case"Tab":e.preventDefault(),e.shiftKey?document.activeElement===this.okButtonElm?(this.focusSelectAllOrList(),this.highlightCurrentOption()):(this.close("key.shift+tab"),this.choiceElm.focus()):(this.changeCurrentOptionHighlight(),this.okButtonElm?.focus())}}),void 0,"arrow-highlight")),this.ulElm&&this.options.infiniteScroll&&this._bindEventService.bind(this.ulElm,"scroll",this.infiniteScrollHandler.bind(this),void 0,"option-list-scroll")}handleEscapeKey(){this.options.keepOpen||(this.close("key.escape"),this.choiceElm.focus())}infiniteScrollHandler(e,t,i){let s=!1;e&&this.getEventTarget(e)&&this.ulElm&&this.scrolledByMouse?this.getEventTarget(e).scrollTop+this.getEventTarget(e).clientHeight===this.ulElm.scrollHeight&&(s=!0):void 0!==t&&t+1===i&&(s=!0),s&&this.ulElm&&(this.virtualScroll?this.initListItems():this.ulElm.scrollTop=0,this._currentHighlightIndex=0,this.highlightCurrentOption())}open(e=0){return new Promise((t=>{null!==e&&e>=0?(window.clearTimeout(this.openDelayTimer),this.openDelayTimer=window.setTimeout((()=>{this.openDrop(),t()}),e)):(this.openDrop(),t())}))}openDrop(){if(!this.dropElm||this.choiceElm?.classList.contains("disabled"))return;if(this.options.isOpen=!0,this.parentElm.classList.add("ms-parent-open"),this.choiceElm?.querySelector("div.ms-icon-caret")?.classList.add("open"),this.dropElm.style.display="block",this.dropElm.ariaExpanded="true",this.selectAllElm?.parentElement&&(this.selectAllElm.parentElement.style.display="inline-flex"),this.noResultsElm&&(this.noResultsElm.style.display="none"),this.getDataLength()||(this.selectAllElm?.parentElement&&(this.selectAllElm.parentElement.style.display="none"),this.noResultsElm&&(this.noResultsElm.style.display="block")),this.options.container){let e,t=_a(this.dropElm);this.options.container instanceof Node?e=this.options.container:"string"==typeof this.options.container&&(e="body"===this.options.container?document.body:document.querySelector(this.options.container)),e.appendChild(this.dropElm),this.dropElm.style.top=`${t?.top??0}px`,this.dropElm.style.left=`${t?.left??0}px`,this.dropElm.style.minWidth="auto",this.dropElm.style.width=`${va(this.parentElm,"outer","width")}px`}let e=this.options.minHeight,t=this.options.maxHeight;"row"===this.options.maxHeightUnit&&(t=va(this.dropElm.querySelector("ul>li"),"outer","height")*this.options.maxHeight),this.ulElm??=this.dropElm.querySelector("ul"),this.ulElm&&(e&&(this.ulElm.style.minHeight=`${e}px`),this.ulElm.style.maxHeight=`${t}px`),this.dropElm.querySelectorAll(".multiple").forEach((e=>{e.style.width=`${this.options.multipleWidth}px`})),this.getDataLength()&&this.options.filter?(this.searchInputElm&&(this.searchInputElm.value="",this.searchInputElm.focus()),this.filter(!0)):this.focusSelectAllOrList(),this._currentHighlightIndex<0?this.moveHighlightDown():this.highlightCurrentOption(),this.options.autoAdjustDropWidthByTextSize&&this.adjustDropWidthByText();let i=this.options.position;if(this.options.autoAdjustDropHeight){if(this.options.autoAdjustDropPosition){let{bottom:e,top:t}=da(this.dropElm);i=e<this.dropElm.getBoundingClientRect().height&&t>e?"top":"bottom"}this.adjustDropHeight(i)}this.options.autoAdjustDropPosition&&this.adjustDropPosition(!0),this.options.onOpen()}focusSelectAllOrList(){this.selectAllElm?this.selectAllElm.focus():this.ulElm&&(this.ulElm.tabIndex=0,this.ulElm.focus())}highlightCurrentOption(){let e=this.dropElm?.querySelectorAll(wa)||[];if(this._currentHighlightIndex<=e.length){let t=e[this._currentHighlightIndex];t&&(this.lastFocusedItemKey=t.dataset.key||"",this._currentSelectedElm=t,this.scrolledByMouse=!1,t.scrollIntoView({block:"nearest"}),this.changeCurrentOptionHighlight(t),window.setTimeout((()=>this.scrolledByMouse=!0),10))}}changeCurrentOptionHighlight(e){e?.classList.add("highlighted"),(this.dropElm?.querySelectorAll(".ms-select-all.highlighted, ul li[data-key].highlighted")||[]).forEach((t=>{t!==e&&t.classList.remove("highlighted")}))}moveHighlightDown(){let e=this.dropElm?.querySelectorAll(wa)||[],t=e.length;this._currentHighlightIndex<t-1?(this._currentHighlightIndex++,e[this._currentHighlightIndex]?.classList.contains("disabled")&&this.moveHighlightDown()):this.options.infiniteScroll&&this.infiniteScrollHandler(null,this._currentHighlightIndex,t),this.highlightCurrentOption()}moveHighlightUp(){let e=this.dropElm?.querySelectorAll(wa)||[],t=this.options.single?0:1;if(this.virtualScroll&&this._currentHighlightIndex<=t&&this.updateDataStart>0&&this.ulElm){let t=e[this._currentHighlightIndex+(this.options.single?0:1)],i=t?.dataset.key;return this.lastFocusedItemKey=i,this.ulElm.scrollTop=this.ulElm.scrollTop-t?.getBoundingClientRect().height||10,void(this.isMoveUpRecalcRequired=!0)}this._currentHighlightIndex>0&&(this._currentHighlightIndex--,e[this._currentHighlightIndex]?.classList.contains("disabled")&&this.moveHighlightUp()),this.highlightCurrentOption()}recalculateArrowMove(e){let t=this.dropElm?.querySelectorAll(wa)||[],i=Array.from(t).findIndex((e=>e.dataset.key===this.lastFocusedItemKey));this._currentHighlightIndex=i-1,"down"===e?this.moveHighlightDown():"up"===e&&(this.moveHighlightUp(),this.isMoveUpRecalcRequired=!1)}close(e){this.options.isOpen=!1,this.parentElm.classList.remove("ms-parent-open"),this.choiceElm?.querySelector("div.ms-icon-caret")?.classList.remove("open"),this.dropElm&&(this.dropElm.style.display="none",this.dropElm.ariaExpanded="false",this.options.container&&(this.parentElm.appendChild(this.dropElm),this.dropElm.style.top="auto",this.dropElm.style.left="auto")),this.options.onClose(e)}applyAsTextOrHtmlWhenEnabled(e,t){e||(e={}),this.isRenderAsHtml?e.innerHTML="function"==typeof this.options.sanitizer?this.options.sanitizer(t):t:e.textContent=t}update(e=!1){let t=this.getSelects(),i=this.getSelects("text");this.options.displayValues&&(i=t);let s=this.choiceElm?.querySelector("span"),n=t.length,r=null,o=()=>{if(this.options.useSelectOptionLabel||this.options.useSelectOptionLabelToHtml){let e=t.join(this.options.displayDelimiter);return this.options.useSelectOptionLabelToHtml?e.replace(/(\b)(on[a-z]+)(\s*)=([^>]*)|javascript:([^>]*)[^>]*|(<\s*)(\/*)script([<>]*).*(<\s*)(\/*)script(>*)|(&lt;|&#60;)(\/*)(script|script defer)(.*)(&#62;|&gt;|&gt;">)/gi,""):e}return i.join(this.options.displayDelimiter)};if(s){if(0===n){let e=this.options.placeholder||"";s.classList.add("ms-placeholder"),this.applyAsTextOrHtmlWhenEnabled(s,e)}else r=n<this.options.minimumCountSelected?o():this.formatAllSelected()&&n===this.dataTotal?this.formatAllSelected():this.options.ellipsis&&n>this.options.minimumCountSelected?`${i.slice(0,this.options.minimumCountSelected).join(this.options.displayDelimiter)}...`:this.formatCountSelected(n,this.dataTotal)&&n>this.options.minimumCountSelected?this.formatCountSelected(n,this.dataTotal):o();if(null!==r&&(s?.classList.remove("ms-placeholder"),this.applyAsTextOrHtmlWhenEnabled(s,r)),this.options.showClear&&this.selectClearElm){let e=r?"block":"none";this.selectClearElm.style.display=e}if(this.options.displayTitle){let e=this.options.useSelectOptionLabel||this.options.useSelectOptionLabelToHtml?"value":"text";s.title=this.getSelects(e).join(this.options.displayDelimiter)}}let a=this.getSelects();this.options.single?this.elm.value=a.length?a[0]:"":Array.from(this.elm.options).forEach((e=>{e.selected=a.some((t=>t===e.value))})),e||this.elm.dispatchEvent(new Event("change"))}updateSelected(e){for(let e=this.updateDataStart;e<this.updateDataEnd;e++){let t=this.updateData[e],i=this.dropElm?.querySelector(`input[data-key=${t._key}]`);if(i){i.checked=t.selected;let e=i.closest("li"),s=e?.querySelector(".icon-checkbox-container div");e&&(t.selected&&!e.classList.contains("selected")?(e.classList.add("selected"),e.ariaSelected="true",s&&(s.className="ms-icon ms-icon-"+("radio"===i.type?"radio":"check"))):t.selected||(e.classList.remove("selected"),e.ariaSelected="false",s&&(s.className="ms-icon ms-icon-uncheck")))}}let t=0===this.data?.filter((e=>e.visible)).length;if(this.selectAllElm){this.selectAllElm.ariaChecked=String(this.isAllSelected);let e=this.dropElm?.querySelector(".ms-select-all .icon-checkbox-container div");if(e){let t="";t=this.isAllSelected?"ms-icon-check":this.isPartiallyAllSelected?"ms-icon-minus":"ms-icon-uncheck",e.className=`ms-icon ${t}`}this.selectAllElm.checked=this.isAllSelected,ya(this.selectAllElm.closest("li"),!t)}ya(this.noResultsElm,t),this.virtualScroll&&(this.virtualScroll.rows=e??this.getListRows())}getData(){return this.options.data}getDataLength(){return this.data?.length??0}getOptions(e=!0){let t=Object.assign({},this.options);return delete t.data,e?oa(t):this.options}refreshOptions(e){(function(e,t,i=!1){let s=Object.keys(e),n=Object.keys(t);if(i&&s.length!==n.length)return!1;for(let i of s)if(n.includes(i)&&e[i]!==t[i])return!1;return!0})(this.options,e,!0)||(this.options=Object.assign(this.options,e),this.destroy(!1),this.init())}getDropElement(){return this.dropElm}getParentElement(){return this.parentElm}getSelects(e="value"){let t=[];for(let i of this.data||[])if("optgroup"===i.type){let s=i.children.filter((e=>e?.selected));if(!s.length)continue;if("value"===e||this.options.single)t.push(...s.map((t=>"value"===e&&t._value||t[e])));else{let n=[];n.push("["),n.push(i.label),n.push(`: ${s.map((t=>t[e])).join(", ")}`),n.push("]"),t.push(n.join(""))}}else i.selected&&t.push("value"===e&&i._value||i[e]);return t}setSelects(e,t="value",i=!1){let s=!1,n=i=>{for(let n of i){let i=!1;if("text"===t){let t=document.createElement("div");this.applyAsTextOrHtmlWhenEnabled(t,n.text),i=e.includes(t.textContent?.trim()??"")}else i=e.includes(n._value||n.value),!i&&n.value===""+ +n.value&&(i=e.includes(+n.value));n.selected!==i&&(s=!0),n.selected=i}};for(let e of this.data||[])"optgroup"===e.type?n(e.children):n([e]);s&&(this.initSelected(i),this.updateSelected(),this.update(i))}enable(){this.choiceElm&&(this.choiceElm.classList.remove("disabled"),this.choiceElm.disabled=!1)}disable(){this.choiceElm&&(this.choiceElm?.classList.add("disabled"),this.choiceElm.disabled=!0)}check(e){let t=la(this.data,"value",e);t&&this._check(t,!0)}uncheck(e){let t=la(this.data,"value",e);t&&this._check(t,!1)}_check(e,t){this.options.single&&this._checkAll(!1,!0),e.selected=t,this.initSelected(),this.updateSelected(),this.update()}checkAll(){this._checkAll(!0)}uncheckAll(){this._checkAll(!1)}_checkAll(e,t){for(let i of this.data||[])"optgroup"===i.type?this._checkGroup(i,e,!0):!i.disabled&&!i.divider&&(t||i.visible)&&(i.selected=e);t||(this.initSelected(),this.updateSelected(),this.update())}_checkGroup(e,t,i){e.selected=t,e.children.forEach((e=>{e&&!e.disabled&&!e.divider&&(i||e.visible)&&(e.selected=t)})),i||(this.initSelected(),this.updateSelected(),this.update())}checkInvert(){if(!this.options.single){for(let e of this.data||[])if("optgroup"===e.type)for(let t of e.children)t&&(t.divider||(t.selected=!t.selected));else e&&!e.divider&&(e.selected=!e.selected);this.initSelected(),this.updateSelected(),this.update()}}focus(){this.choiceElm?.focus(),this.options.onFocus()}blur(){this.choiceElm?.blur(),this.options.onBlur()}refresh(){this.destroy(!1),this.init()}filter(e){let t=this.searchInputElm?.value.trim()??"",i=t.toLowerCase();if(this.filterText===i)return;this.filterText=i;for(let e of this.data||[])if("optgroup"===e.type)if(this.options.filterGroup){let s=`${e?.label??""}`;if(null!=e){let n=this.options.customFilter({label:ca(s.toString().toLowerCase(),this.options.diacriticParser),search:ca(i,this.options.diacriticParser),originalLabel:s,originalSearch:t,row:e});e.visible=n;for(let t of e.children)t&&(t.visible=n)}}else{for(let s of e.children)if(null!=s){let n=`${s?.text??""}`;s.visible=this.options.customFilter({text:ca(n.toString().toLowerCase(),this.options.diacriticParser),search:ca(i,this.options.diacriticParser),originalText:n,originalSearch:t,row:s,parent:e})}e.visible=e.children.filter((e=>e?.visible)).length>0}else{let s=`${e?.text??""}`;e.visible=this.options.customFilter({text:ca(s.toString().toLowerCase(),this.options.diacriticParser),search:ca(i,this.options.diacriticParser),originalText:s,originalSearch:t,row:e})}let s=this.initListItems();this.initSelected(e),this.updateSelected(s),e||this.options.onFilter(t)}adjustDropHeight(e){let t="top"!==e,i=(this.filterParentElm?.getBoundingClientRect().height??0)+(this.okButtonElm?.getBoundingClientRect().height??0)+(this.options.single?0:this.selectAllParentElm?.getBoundingClientRect().height??0)+5,{bottom:s,top:n}=da(this.parentElm),r=this.options.maxHeight;if(r=t?s-i-this.options.adjustedHeightPadding:n-i-this.options.adjustedHeightPadding,!this.options.maxHeight||this.options.maxHeight&&r<this.options.maxHeight){let e=this.dropElm?.querySelector("ul");return e&&(e.style.maxHeight=`${r}px`),!0}return!1}adjustDropPosition(e){let t="bottom";if(this.dropElm&&this.parentElm){let{bottom:i,top:s}=da(this.dropElm),{top:n,left:r}=_a(this.parentElm),o=this.dropElm.getBoundingClientRect().height,a=this.dropElm.getBoundingClientRect().width,l=document.body.offsetWidth||window.innerWidth,h=this.parentElm.getBoundingClientRect().width;if(i>o)t="bottom";else if(o>i&&s>i){if(this.options.container){let i=n-o;i<0&&(i=0),(i>0||e)&&(t="top",this.dropElm.style.top=`${i<0?0:i}px`)}else t="top",this.dropElm.classList.add(t);this.dropElm.classList.remove("bottom")}l-a<r&&(this.dropElm.style.left=r-(a-h)+"px")}return t}adjustDropWidthByText(){if(this.dropElm){let e=this.parentElm.scrollWidth;(this.options.dropWidth||this.options.width)&&(e=this.options.dropWidth||this.options.width||0);let t=this.dropElm.querySelector(".ms-select-all span"),i=this.dropElm.querySelector("ul"),s=26,n=t?.clientWidth??0+s,r=i.scrollHeight>i.clientHeight?this.getScrollbarWidth():0,o=0;this.dropElm.querySelectorAll("li label").forEach((e=>{e.scrollWidth>o&&(o=e.scrollWidth)})),o+=s+r,o<n&&(o=n),this.options.maxWidth&&o>this.options.maxWidth&&(o=this.options.maxWidth),this.options.minWidth&&o<this.options.minWidth&&(o=this.options.minWidth),("100%"===e||+e<o)&&(this.dropElm.style.width=`${o}px`,this.dropElm.style.maxWidth=`${o}px`)}}getScrollbarWidth(){let e=document.createElement("div");e.style.visibility="hidden",e.style.width="100px",document.body.appendChild(e);let t=e.offsetWidth;e.style.overflow="scroll";let i=document.createElement("div");i.style.width="100%",e.appendChild(i);let s=i.offsetWidth;return e.parentNode?.removeChild(e),t-s}formatAllSelected(){return this.options.allSelectedText||this.options.formatAllSelected()}formatCountSelected(e,t){return this.options.countSelectedText?this.options.countSelectedText.replace("#",`${e}`).replace("%",`${t}`):this.options.formatCountSelected(e,t)}formatNoMatchesFound(){return this.options.noMatchesFoundText||this.options.formatNoMatchesFound()}formatOkButton(){return this.options.okButtonText||this.options.formatOkButton()}formatSelectAll(){return this.options.selectAllText||this.options.formatSelectAll()}},Ea=(e,t)=>"string"==typeof e?xa(document.querySelectorAll(e),t):e instanceof Node?xa([e],t):xa(e,t);function xa(e,t){let i=Array.from(e),s=[];for(let e=0;e<i.length;e++){let n=i[e];try{void 0!==n._multipleSelect&&(n._multipleSelect.destroy(),delete n._multipleSelect),n._multipleSelect=new Sa(n,t||{}),n._multipleSelect.init();let i=n._multipleSelect.getOptions(!1);i.onHardDestroy=()=>delete n._multipleSelect,i.onAfterHardDestroyed=()=>s[e]=null,s.push(n._multipleSelect)}catch(e){console.error(e)}}return 1===s.length?s[0]:s}Ea.defaults=ra.DEFAULTS,Ea.locales={...sa},Ea.methods=ra.METHODS,typeof window<"u"&&(window.multipleSelect=Ea);class Ta{constructor(e,t,i,s=!0){this.translaterService=e,this.collectionService=t,this.rxjs=i,this._isMultipleSelect=!0,this._collectionLength=0,this._shouldTriggerQuery=!0,this.isFilled=!1,this.enableTranslateLabel=!1,this.subscriptions=[],this._isMultipleSelect=s}get collectionOptions(){return this.columnDef?.filter?.collectionOptions??{}}get columnFilter(){return this.columnDef?.filter??{}}get customStructure(){return this.columnDef?.filter?.customStructure}get gridOptions(){return this.grid?.getOptions()??{}}get defaultOperator(){return this.isMultipleSelect?k.in:k.equal}get filterOptions(){return{...this.gridOptions.defaultFilterOptions?.select,...this.columnFilter?.filterOptions}}get isMultipleSelect(){return this._isMultipleSelect}get msInstance(){return this._msInstance}get selectOptions(){return this.defaultOptions}get operator(){return this.columnFilter?.operator??this.defaultOperator}set operator(e){this.columnFilter&&(this.columnFilter.operator=e)}init(e){if(!e)throw new Error('[Slickgrid-Universal] A filter must always have an "init()" with valid arguments.');if(this.grid=e.grid,this.callback=e.callback,this.columnDef=e.columnDef,this.searchTerms=(e.hasOwnProperty("searchTerms")?e.searchTerms:[])||[],this.filterContainerElm=e.filterContainerElm,!this.grid||!this.columnDef||!this.columnFilter||!this.columnFilter.collection&&!this.columnFilter.collectionAsync)throw new Error("[Slickgrid-Universal] You need to pass a \"collection\" (or \"collectionAsync\") for the MultipleSelect/SingleSelect Filter to work correctly. Also each option should include a value/label pair (or value/labelKey when using Locale). For example:: { filter: model: Filters.multipleSelect, collection: [{ value: true, label: 'True' }, { value: false, label: 'False'}] }");if(this.enableTranslateLabel=this.columnFilter?.enableTranslateLabel??!1,this.labelName=this.customStructure?.label??"label",this.labelPrefixName=this.customStructure?.labelPrefix??"labelPrefix",this.labelSuffixName=this.customStructure?.labelSuffix??"labelSuffix",this.optionLabel=this.customStructure?.optionLabel??"value",this.valueName=this.customStructure?.value??"value",this.enableTranslateLabel&&(!this.translaterService||"function"!=typeof this.translaterService.translate))throw new Error('[select-filter] The Translate Service is required for the Select Filter to work correctly when "enableTranslateLabel" is set.');this._locales=this.gridOptions?.locales??y.locales,this.initMultipleSelectTemplate();let t=this.gridOptions?.defaultFilterPlaceholder||"";this.columnFilter?.placeholder&&(t=this.columnFilter.placeholder),this.defaultOptions.placeholder=t||"",this._isMultipleSelect&&this.columnDef?.filter&&(this.columnDef.filter.emptySearchTermReturnAllValues=this.columnDef.filter?.emptySearchTermReturnAllValues??!1);const i=this.columnFilter.collection||[];return new Promise((async(e,t)=>{try{let t;this.columnFilter.collectionAsync&&!this.columnFilter.collection?(t=Yt(this.columnFilter.collectionAsync,this.columnDef,this.renderDomElement.bind(this),this.rxjs,this.subscriptions),e(t)):(t=i,this.renderDomElement(i),e(i)),(this.columnFilter.collectionAsync||this.columnFilter.enableCollectionWatch)&&(await(t??this.columnFilter.collectionAsync),this.watchCollectionChanges())}catch(e){t(e)}}))}clear(e=!0){this._msInstance&&this._collectionLength>0&&(this._msInstance.setSelects([]),this.updateFilterStyle(!1),this.searchTerms=[],this._shouldTriggerQuery=e,this.callback(void 0,{columnDef:this.columnDef,clearFilterTriggered:!0,shouldTriggerQuery:this._shouldTriggerQuery}),this._shouldTriggerQuery=!0)}destroy(){"function"==typeof this._msInstance?.destroy&&this._msInstance.destroy(),this.filterElm?.remove(),ee(this.subscriptions)}getValues(){return this._msInstance?.getSelects()??[]}setValues(e,t,i=!1){void 0!==e&&this._msInstance&&(e=Array.isArray(e)?e.every((e=>Be(e)))?e.map(String):e:[e],this._msInstance.setSelects(e)),this.updateFilterStyle(this.getValues().length>0),this.operator=t||this.defaultOperator,i&&this.onTriggerEvent()}filterCollection(e){let t=e;if(this.columnFilter&&this.columnFilter.collectionFilterBy){const e=this.columnFilter.collectionFilterBy,i=this.columnFilter.collectionOptions?.filterResultAfterEachPass||null;t=this.collectionService?.filterCollection(t,e,i)||[]}return t}sortCollection(e){let t=e;if(this.columnFilter&&this.columnFilter.collectionSortBy){const e=this.columnFilter.collectionSortBy;t=this.collectionService?.sortCollection(this.columnDef,t,e,this.enableTranslateLabel)||[]}return t}watchCollectionChanges(){this.columnFilter?.collection&&(_(this.columnFilter.collection,this.watchCallback.bind(this)),v(this.columnFilter,"collection",this.propertyObserverCallback.bind(this)))}propertyObserverCallback(e){this.renderDomElement(e||[]),this.columnFilter.collection&&_(this.columnFilter.collection,this.watchCallback.bind(this))}watchCallback(e){this.renderDomElement(this.columnFilter.collection||e||[])}renderDomElement(e){if(!Array.isArray(e)&&this.collectionOptions?.collectionInsideObjectProperty&&(e=U(e,this.collectionOptions.collectionInsideObjectProperty||"")),!Array.isArray(e))throw new Error('The "collection" passed to the Select Filter is not a valid array.');let t=[];e.length>0&&(t=[...e]),this.collectionOptions?.addBlankEntry&&Array.isArray(t)&&t.length>0&&""!==t[0][this.valueName]&&t.unshift(this.createBlankEntry()),this.collectionOptions?.addCustomFirstEntry&&Array.isArray(t)&&t.length>0&&t[0][this.valueName]!==this.collectionOptions.addCustomFirstEntry[this.valueName]&&t.unshift(this.collectionOptions.addCustomFirstEntry),this.collectionOptions?.addCustomLastEntry&&Array.isArray(t)&&t.length>0&&t[t.length-1][this.valueName]!==this.collectionOptions.addCustomLastEntry[this.valueName]&&t.push(this.collectionOptions.addCustomLastEntry);let i=t;i=this.filterCollection(i),i=this.sortCollection(i);const s=_s("filter",i,this.columnDef,this.grid,this.isMultipleSelect,this.translaterService,this.searchTerms||[]);this.isFilled=s.hasFoundSearchTerm,this.createFilterElement(s.selectElement,s.dataCollection),this._collectionLength=i.length}createBlankEntry(){const e={[this.labelName]:"",[this.valueName]:""};return this.labelPrefixName&&(e[this.labelPrefixName]=""),this.labelSuffixName&&(e[this.labelSuffixName]=""),e}createFilterElement(e,t){const i=this.columnDef?.id??"";this.elementName=`filter-${i}`,this.defaultOptions.name=this.elementName,re(this.filterContainerElm),this.filterElm=e,this.filterElm.dataset.columnId=`${i}`,this.updateFilterStyle(this.isFilled),this.filterContainerElm.appendChild(e),this.filterElmOptions={...this.defaultOptions,...this.filterOptions,data:t},this._msInstance=Ea(e,this.filterElmOptions)}initMultipleSelectTemplate(){const e=this.gridOptions?.enableTranslate??!1,t={autoAdjustDropHeight:!0,autoAdjustDropPosition:!0,autoAdjustDropWidthByTextSize:!0,name:`${this.columnDef?.id??""}`,container:"body",darkMode:!!this.gridOptions.darkMode,filter:!1,maxHeight:275,single:!0,singleRadio:!0,showSearchClear:!0,renderOptionLabelAsHtml:this.columnFilter?.enableRenderHtml??!1,sanitizer:e=>this.grid.sanitizeHtmlString(e),onClose:()=>this.onTriggerEvent(),onClear:()=>this.clear()};if(this._isMultipleSelect){t.single=!1,t.singleRadio=!1,t.showOkButton=!0,t.displayTitle=!0;const i=j(this.gridOptions);t.countSelectedText=e&&this.translaterService?.translate?this.translaterService.translate(`${i}X_OF_Y_SELECTED`):this._locales?.TEXT_X_OF_Y_SELECTED,t.allSelectedText=e&&this.translaterService?.translate?this.translaterService.translate(`${i}ALL_SELECTED`):this._locales?.TEXT_ALL_SELECTED,t.noMatchesFoundText=e&&this.translaterService?.translate?this.translaterService.translate(`${i}NO_MATCHES_FOUND`):this._locales?.TEXT_NO_MATCHES_FOUND,t.okButtonText=e&&this.translaterService?.translate?this.translaterService.translate(`${i}OK`):this._locales?.TEXT_OK,t.selectAllText=e&&this.translaterService?.translate?this.translaterService.translate(`${i}SELECT_ALL`):this._locales?.TEXT_SELECT_ALL}this.defaultOptions=t}onTriggerEvent(){if(this._msInstance){const e=this.getValues();this.updateFilterStyle(Array.isArray(e)&&e.length>1||1===e.length&&""!==e[0]),this.searchTerms=e,this.callback(void 0,{columnDef:this.columnDef,operator:this.operator,searchTerms:e,shouldTriggerQuery:this._shouldTriggerQuery}),this._shouldTriggerQuery=!0}}updateFilterStyle(e){e?(this.isFilled=!0,this.filterElm?.classList.add("filled"),this._msInstance?.getParentElement()?.classList.add("filled")):(this.isFilled=!1,this.filterElm?.classList.remove("filled"),this._msInstance?.getParentElement()?.classList.remove("filled"))}}const Oa={autocompleter:class{constructor(e,t,i){this.translaterService=e,this.collectionService=t,this.rxjs=i,this._clearFilterTriggered=!1,this._shouldTriggerQuery=!0,this.searchTerms=[],this.isFilled=!1,this.isItemSelected=!1,this.valueName="label",this.enableTranslateLabel=!1,this.subscriptions=[],this._bindEventService=new Wt}get autocompleterOptions(){return this._autocompleterOptions||{}}get collectionOptions(){return this.columnDef?.filter?.collectionOptions??{}}get collection(){return this._collection}get columnFilter(){return this.columnDef?.filter||{}}get filterDomElement(){return this._filterElm}get filterOptions(){return{...this.gridOptions.defaultFilterOptions?.autocompleter,...this.columnFilter?.filterOptions}}get customStructure(){let e=this.columnFilter?.customStructure;const t=this.columnFilter?.type??this.columnDef?.type;return!e&&t===E.object&&this.columnDef?.dataKey&&this.columnDef?.labelKey&&(e={label:this.columnDef.labelKey,value:this.columnDef.dataKey}),e}get defaultOperator(){return k.equal}get gridOptions(){return this.grid?.getOptions()??{}}get instance(){return this._instance}get operator(){return this.columnFilter?.operator??this.defaultOperator}set operator(e){this.columnFilter&&(this.columnFilter.operator=e)}init(e){if(!e)throw new Error('[Slickgrid-Universal] A filter must always have an "init()" with valid arguments.');if(this.grid=e.grid,this.callback=e.callback,this.columnDef=e.columnDef,this.searchTerms=(e.hasOwnProperty("searchTerms")?e.searchTerms:[])||[],this.filterContainerElm=e.filterContainerElm,!(this.grid&&this.columnDef&&this.columnFilter&&(this.columnFilter.collection||this.columnFilter.collectionAsync||this.columnFilter.filterOptions)))throw new Error("[Slickgrid-Universal] You need to pass a \"collection\" (or \"collectionAsync\") for the AutoComplete Filter to work correctly. Also each option should include a value/label pair (or value/labelKey when using Locale). For example:: { filter: model: Filters.autocompleter, collection: [{ value: true, label: 'True' }, { value: false, label: 'False'}] }");this.enableTranslateLabel=this.columnFilter?.enableTranslateLabel??!1,this.labelName=this.customStructure?.label??"label",this.valueName=this.customStructure?.value??"value",this.labelPrefixName=this.customStructure?.labelPrefix??"labelPrefix",this.labelSuffixName=this.customStructure?.labelSuffix??"labelSuffix",this._locales=this.gridOptions?.locales??y.locales;const t=this.columnFilter.collection;return this._collection=t,this.renderDomElement(t),new Promise((async(e,i)=>{try{const i=this.columnFilter.collectionAsync;let s;i&&!this.columnFilter.collection?(s=Yt(i,this.columnDef,this.renderDomElement.bind(this),this.rxjs,this.subscriptions),e(s)):(s=t,e(t)),(i||this.columnFilter.enableCollectionWatch)&&(await(s??i),this.watchCollectionChanges())}catch(e){i(e)}}))}clear(e=!0){this._filterElm&&(this._clearFilterTriggered=!0,this._shouldTriggerQuery=e,this.searchTerms=[],this._filterElm.value="",this._filterElm.dispatchEvent(new CustomEvent("input")),this.updateFilterStyle(!1))}destroy(){"function"==typeof this._instance?.destroy&&this._instance.destroy(),this._filterElm,this._filterElm?.remove?.(),this._collection=void 0,this._bindEventService.unbindAll(),ee(this.subscriptions)}getValues(){return this._filterElm?.value||""}setValues(e,t,i=!1){e&&this._filterElm&&(this._filterElm.value=e),this.updateFilterStyle(""!==this.getValues()),this.operator=t||this.defaultOperator,i&&this.callback(void 0,{columnDef:this.columnDef,operator:this.operator,searchTerms:[this.getValues()],shouldTriggerQuery:!0})}filterCollection(e){let t=e;if(this.columnFilter&&this.columnFilter.collectionFilterBy){const e=this.columnFilter.collectionFilterBy,i=this.columnFilter.collectionOptions&&this.columnFilter.collectionOptions.filterResultAfterEachPass||null;t=this.collectionService?.filterCollection(t,e,i)||[]}return t}sortCollection(e){let t=e;if(this.columnFilter&&this.columnFilter.collectionSortBy){const e=this.columnFilter.collectionSortBy;t=this.collectionService?.sortCollection(this.columnDef,t,e,this.enableTranslateLabel)||[]}return t}watchCollectionChanges(){this.columnFilter?.collection&&(_(this.columnFilter.collection,(e=>{this.renderDomElement(this.columnFilter.collection||e||[])})),v(this.columnFilter,"collection",(e=>{this.renderDomElement(e||[]),this.columnFilter.collection&&_(this.columnFilter.collection,(e=>{this.renderDomElement(this.columnFilter.collection||e||[])}))})))}renderDomElement(e){!Array.isArray(e)&&this.collectionOptions?.collectionInsideObjectProperty&&(e=U(e,this.collectionOptions.collectionInsideObjectProperty||""));let t=e;t&&(t=this.filterCollection(t),t=this.sortCollection(t));const i=Array.isArray(this.searchTerms)&&this.searchTerms.length>=0?this.searchTerms[0]:"";this._collection=t,this._filterElm=this.createFilterElement(t,i),this._bindEventService.bind(this._filterElm,"input",this.handleOnInputChange.bind(this)),this._bindEventService.bind(this._filterElm,"blur",(()=>{this.isItemSelected||this.clear()}))}createFilterElement(e,t){this._collection=e;const i=this.columnDef?.id??"";re(this.filterContainerElm);let s=this.gridOptions?.defaultFilterPlaceholder??"";this.columnFilter?.placeholder&&(s=this.columnFilter.placeholder),this._filterElm=ie("input",{type:"text",ariaLabel:this.columnFilter?.ariaLabel??`${Ke(i+"")} Search Filter`,autocomplete:"off",ariaAutoComplete:"none",placeholder:s,className:`form-control search-filter filter-${i} slick-autocomplete-container`,value:t??"",dataset:{columnid:`${i}`}});const n=t;Array.isArray(e)&&(e=e.every((e=>Be(e)))?e.map((e=>({label:e,value:e}))):e.map((e=>({label:e?.[this.labelName],value:e?.[this.valueName],labelPrefix:e?.[this.labelPrefixName]??"",labelSuffix:e?.[this.labelSuffixName]??""})))),this._autocompleterOptions={input:this._filterElm,debounceWaitMs:200,className:`slick-autocomplete ${this.filterOptions?.className??""}`.trim(),emptyMsg:this.gridOptions.enableTranslate&&this.translaterService?.translate?this.translaterService.translate("NO_ELEMENTS_FOUND"):this._locales?.TEXT_NO_ELEMENTS_FOUND??"No elements found",customize:(e,t,i)=>{i.style.width=""},onSelect:e=>{this.isItemSelected=!0,this.handleSelect(e)},...this.filterOptions},this.gridOptions?.darkMode&&(this._autocompleterOptions.className+=" slick-dark-mode"),this.autocompleterOptions.className=se(this.autocompleterOptions.className).join(" "),this._autocompleterOptions.renderItem?.layout?(this._autocompleterOptions.className+=` autocomplete-custom-${qe(this._autocompleterOptions.renderItem.layout)}`,this._autocompleterOptions.render=this.renderCustomItem.bind(this)):Array.isArray(e)?this._autocompleterOptions.render=this._autocompleterOptions.render?.bind(this)??this.renderCollectionItem.bind(this):this._autocompleterOptions.render||(this._autocompleterOptions.render=this.renderRegularItem.bind(this)),this.filterOptions?.fetch?(Gt(this._filterElm,this._autocompleterOptions),this._instance=Vt(this._autocompleterOptions)):this._instance=Vt({...this._autocompleterOptions,fetch:(t,i)=>{e&&i(e.filter((e=>(("string"==typeof e?e:e?.label)||"").toLowerCase().includes(t.toLowerCase()))))}}),this._filterElm.value=n??"";const r=ie("div",{className:"autocomplete-filter-container"});return r.appendChild(this._filterElm),r.appendChild(ie("span")),t&&this._filterElm.classList.add("filled"),this.filterContainerElm.appendChild(r),this.filterContainerElm.appendChild(document.createElement("span")),this._filterElm}handleSelect(e){if(void 0!==e){const t=void 0,i=this.filterOptions?.renderItem??!1,s="string"==typeof e?e:i?e[this.labelName]:e.label;let n="string"==typeof e?e:i?e[this.valueName]:e.value;n=this.trimWhitespaceWhenEnabled(n),this.updateFilterStyle(""!==n),this.setValues(s),this.callback(t,{columnDef:this.columnDef,operator:this.operator,searchTerms:[n],shouldTriggerQuery:this._shouldTriggerQuery}),this._clearFilterTriggered=!1,this._shouldTriggerQuery=!0}return!1}handleOnInputChange(e){let t=e?.target?.value??"";const i=this.filterOptions.triggerOnEveryKeyStroke??!1;if(t=this.trimWhitespaceWhenEnabled(t),this._clearFilterTriggered||""===t||i){const i={columnDef:this.columnDef,shouldTriggerQuery:this._shouldTriggerQuery};this._clearFilterTriggered?i.clearFilterTriggered=this._clearFilterTriggered:(i.operator=this.operator,i.searchTerms=[t]),this.updateFilterStyle(""!==t),this.callback(e,i)}this._clearFilterTriggered=!1,this._shouldTriggerQuery=!0}renderRegularItem(e){return ie("div",{textContent:("string"==typeof e?e:e?.label??"")||""})}renderCustomItem(e){const t=this._autocompleterOptions?.renderItem?.templateCallback(e)??"",i=document.createElement("div");return this.grid.applyHtmlCode(i,t),i}renderCollectionItem(e){const t=this.columnFilter?.enableRenderHtml??!1,i=(e.labelPrefix||"")+(e.label||"")+(e.labelSuffix||""),s=this.grid.sanitizeHtmlString(i)||"",n=document.createElement("div");return n[t?"innerHTML":"textContent"]=s,n}trimWhitespaceWhenEnabled(e){let t=e;const i=this.gridOptions.enableFilterTrimWhiteSpace||this.columnFilter.enableTrimWhiteSpace;return"string"==typeof e&&i&&(t=e.trim()),t}updateFilterStyle(e){this.isItemSelected=e,e?this._filterElm.classList.add("filled"):this._filterElm.classList.remove("filled")}},compoundDate:class extends fs{constructor(e){super(e),this.translaterService=e,this.inputFilterType="compound"}},compoundInput:Xo,compoundInputNumber:class extends Yo{constructor(e){super(e),this.translaterService=e,this.inputType="number",this.inputFilterType="compound"}},compoundInputPassword:class extends Yo{constructor(e){super(e),this.translaterService=e,this.inputType="password",this.inputFilterType="compound"}},compoundInputText:Xo,compoundSlider:class extends Qo{constructor(e){super(e),this.translaterService=e,this.sliderType="compound"}},dateRange:class extends fs{constructor(e){super(e),this.translaterService=e,this.inputFilterType="range"}},input:Yo,inputMask:class extends Yo{constructor(e){super(e),this.translaterService=e,this._inputMask="",this.inputType="text"}get inputMask(){return this._inputMask}init(e){if(!e)throw new Error('[Slickgrid-Universal] A filter must always have an "init()" with valid arguments.');if(this.grid=e.grid,this.callback=e.callback,this.columnDef=e.columnDef,this.searchTerms=(e.hasOwnProperty("searchTerms")?e.searchTerms:[])||[],this._cellContainerElm=e.filterContainerElm,this.columnDef?.params?.mask?this._inputMask=this.columnDef.params.mask:this.columnFilter?.params?.mask&&(this._inputMask=this.columnFilter.params.mask),!this._inputMask)throw new Error("[Slickgrid-Universal] The Filters.inputMask requires the mask to be passed in the filter params or the column definition params\n        for example:: this.columnDefinitions: [{ id: 'phone', field: 'phone', filter: { model: Filters.inputMask, params: { mask: '000-000-0000' }}}]");const t=Array.isArray(this.searchTerms)&&this.searchTerms.length>=0?this.searchTerms[0]:"";this.createDomFilterElement(t),this._bindEventService.bind(this._filterInputElm,["keyup","blur","change"],this.onTriggerEvent.bind(this))}onTriggerEvent(e,t=!1){let i="";if(e?.target?.value){let t=e?.target?.value??"";const s=this.gridOptions.enableFilterTrimWhiteSpace||this.columnFilter.enableTrimWhiteSpace;"string"==typeof t&&s&&(t=t.trim());const n=this.unmaskValue(t),r=this.maskValue(n);i=n,e?.keyCode>=48&&(this._filterInputElm.value=r,e.preventDefault())}t?(this.callback(e,{columnDef:this.columnDef,clearFilterTriggered:t,shouldTriggerQuery:this._shouldTriggerQuery}),this._filterInputElm.classList.remove("filled")):(this._filterInputElm.classList.add("filled"),this.callback(e,{columnDef:this.columnDef,operator:this.operator,searchTerms:[i],shouldTriggerQuery:this._shouldTriggerQuery})),this._shouldTriggerQuery=!0}maskValue(e){let t=0,i="";return this._inputMask&&(i=this._inputMask.replace(/[09A]/gi,(i=>(("0"===i||"9"===i)&&/\d+/g.test(e[t])||"A"===i.toUpperCase()&&/[^\d]+/gi.test(e[t]))&&e[t++]||""))),i}unmaskValue(e){const t=e.replace(/[^0-9a-z]*/gi,""),i=this._inputMask.replace(/[^0-9a-z]*/gi,"");let s="";for(let e=0;e<i.length;e++)t[e]&&(("0"===i[e]||"9"===i[e])&&/\d+/g.test(t[e])||"A"===i[e].toUpperCase()&&/[^\d]+/gi.test(t[e]))&&(s+=t[e]);return s}},inputNumber:class extends Yo{constructor(e){super(e),this.translaterService=e,this.inputType="number"}},inputPassword:class extends Yo{constructor(e){super(e),this.translaterService=e,this.inputType="password"}},inputText:Yo,multipleSelect:class extends Ta{constructor(e,t,i){super(e,t,i,!0),this.translaterService=e,this.collectionService=t,this.rxjs=i}},singleSelect:class extends Ta{constructor(e,t,i){super(e,t,i,!1),this.translaterService=e,this.collectionService=t,this.rxjs=i}},slider:class extends Qo{constructor(e){super(e),this.translaterService=e,this.sliderType="single"}},sliderRange:class extends Qo{constructor(e){super(e),this.translaterService=e,this.sliderType="double"}}};class ka{constructor(e,t,i,s){this.config=e,this.translaterService=t,this.collectionService=i,this.rxjs=s,this._options=this.config?.options??{}}addRxJsResource(e){this.rxjs=e}createFilter(e){let t;return e?.model&&(t="function"==typeof e.model?new e.model(this.translaterService,this.collectionService,this.rxjs):e.model),!t&&this._options.defaultFilter&&(t=new this._options.defaultFilter(this.translaterService,this.collectionService,this.rxjs)),t}}const Ia={alwaysShowVerticalScroll:!0,autoEdit:!1,asyncEditorLoading:!1,autoFitColumnsOnFirstLoad:!0,autoFixResizeTimeout:1500,autoFixResizeRequiredGoodCount:2,autoFixResizeWhenBrokenStyleDetected:!1,autoParseInputFilterOperator:!0,autoResize:{applyResizeToContainer:!0,calculateAvailableSizeBy:"window",bottomPadding:20,minHeight:180,minWidth:300,rightPadding:0},cellHighlightCssClass:"slick-cell-modified",checkboxSelector:{cssClass:"slick-cell-checkboxsel",width:40},columnGroupSeparator:" - ",columnPicker:{hideForceFitButton:!1,hideSyncResizeButton:!0,headerColumnValueExtractor:Aa},cellMenu:{autoAdjustDrop:!0,autoAlignSide:!0,hideCloseButton:!0,hideCommandSection:!1,hideOptionSection:!1,showBulletWhenIconMissing:!0,subItemChevronClass:"mdi mdi-chevron-down mdi-rotate-270"},compositeEditorOptions:{labels:{cancelButtonKey:"CANCEL",cloneButtonKey:"CLONE",resetEditorButtonTooltipKey:"RESET_INPUT_VALUE",resetFormButtonKey:"RESET_FORM",massSelectionButtonKey:"APPLY_TO_SELECTION",massSelectionStatusKey:"X_OF_Y_MASS_SELECTED",massUpdateButtonKey:"APPLY_MASS_UPDATE",massUpdateStatusKey:"ALL_X_RECORDS_SELECTED",saveButtonKey:"SAVE"}},contextMenu:{autoAdjustDrop:!0,autoAlignSide:!0,hideCloseButton:!0,hideClearAllGrouping:!1,hideCollapseAllGroups:!1,hideCommandSection:!1,hideCopyCellValueCommand:!1,hideExpandAllGroups:!1,hideExportCsvCommand:!1,hideExportExcelCommand:!1,hideExportTextDelimitedCommand:!0,hideMenuOnScroll:!0,hideOptionSection:!1,iconCollapseAllGroupsCommand:"mdi mdi-arrow-collapse",iconExpandAllGroupsCommand:"mdi mdi-arrow-expand",iconClearGroupingCommand:"mdi mdi-close",iconCopyCellValueCommand:"mdi mdi-content-copy",iconExportCsvCommand:"mdi mdi-download",iconExportExcelCommand:"mdi mdi-file-excel-outline",iconExportTextDelimitedCommand:"mdi mdi-download",showBulletWhenIconMissing:!0,subItemChevronClass:"mdi mdi-chevron-down mdi-rotate-270"},customFooterOptions:{dateFormat:"YYYY-MM-DD, hh:mm a",hideRowSelectionCount:!1,hideTotalItemCount:!1,hideLastUpdateTimestamp:!0,footerHeight:25,leftContainerClass:"col-xs-12 col-sm-5",rightContainerClass:"col-xs-6 col-sm-7",metricSeparator:"|",metricTexts:{itemsKey:"ITEMS",ofKey:"OF",itemsSelectedKey:"ITEMS_SELECTED"}},customTooltip:{tooltipTextMaxLength:700,maxWidth:500},dataView:{syncGridSelection:{preserveHidden:!1,preserveHiddenOnSelectionChange:!0},syncGridSelectionWithBackendService:!1},datasetIdPropertyName:"id",defaultFilter:Oa.input,defaultBackendServiceFilterTypingDebounce:500,enableFilterTrimWhiteSpace:!1,defaultFilterPlaceholder:"ðï¸",defaultFilterRangeOperator:k.rangeInclusive,defaultColumnSortFieldId:"id",draggableGrouping:{hideToggleAllButton:!1,toggleAllButtonText:"",dropPlaceHolderTextKey:"DROP_COLUMN_HEADER_TO_GROUP_BY"},editable:!1,editorTypingDebounce:450,filterTypingDebounce:0,enableEmptyDataWarningMessage:!0,emptyDataWarning:{className:"slick-empty-data-warning",messageKey:"EMPTY_DATA_WARNING_MESSAGE",hideFrozenLeftWarning:!1,hideFrozenRightWarning:!1,leftViewportMarginLeft:"40%",rightViewportMarginLeft:"40%",frozenLeftViewportMarginLeft:"0px",frozenRightViewportMarginLeft:"40%"},enableAutoResize:!0,enableAutoSizeColumns:!0,enableCellNavigation:!1,enableColumnPicker:!0,enableColumnReorder:!0,enableColumnResizeOnDoubleClick:!0,enableContextMenu:!0,enableExcelExport:!1,enableTextExport:!1,enableGridMenu:!0,enableHeaderMenu:!0,enableMouseHoverHighlightRow:!0,enableSorting:!0,enableTextSelectionOnCells:!0,explicitInitialization:!0,excelExportOptions:{addGroupIndentation:!0,autoDetectCellFormat:!0,exportWithFormatter:!1,filename:"export",format:x.xlsx,groupingColumnHeaderTitle:"Group By",groupCollapsedSymbol:"â®",groupExpandedSymbol:"â®",groupingAggregatorRowText:"",sanitizeDataExport:!0},textExportOptions:{delimiter:w.comma,exportWithFormatter:!1,filename:"export",format:x.csv,groupingColumnHeaderTitle:"Group By",groupingAggregatorRowText:"",sanitizeDataExport:!0,useUtf8WithBom:!0},eventNamingStyle:zt.lowerCase,forceFitColumns:!1,frozenHeaderWidthCalcDifferential:1,gridMenu:{dropSide:"left",commandLabels:{clearAllFiltersCommandKey:"CLEAR_ALL_FILTERS",clearAllSortingCommandKey:"CLEAR_ALL_SORTING",clearFrozenColumnsCommandKey:"CLEAR_PINNING",exportCsvCommandKey:"EXPORT_TO_CSV",exportExcelCommandKey:"EXPORT_TO_EXCEL",exportTextDelimitedCommandKey:"EXPORT_TO_TAB_DELIMITED",refreshDatasetCommandKey:"REFRESH_DATASET",toggleDarkModeCommandKey:"TOGGLE_DARK_MODE",toggleFilterCommandKey:"TOGGLE_FILTER_ROW",togglePreHeaderCommandKey:"TOGGLE_PRE_HEADER_ROW"},hideClearAllFiltersCommand:!1,hideClearAllSortingCommand:!1,hideClearFrozenColumnsCommand:!0,hideExportCsvCommand:!1,hideExportExcelCommand:!1,hideExportTextDelimitedCommand:!0,hideForceFitButton:!1,hideRefreshDatasetCommand:!1,hideSyncResizeButton:!0,hideToggleFilterCommand:!1,hideToggleDarkModeCommand:!0,hideTogglePreHeaderCommand:!1,iconCssClass:"mdi mdi-menu",iconClearAllFiltersCommand:"mdi mdi-filter-remove-outline",iconClearAllSortingCommand:"mdi mdi-sort-variant-off",iconClearFrozenColumnsCommand:"mdi mdi-pin-off-outline",iconExportCsvCommand:"mdi mdi-download",iconExportExcelCommand:"mdi mdi-file-excel-outline",iconExportTextDelimitedCommand:"mdi mdi-download",iconRefreshDatasetCommand:"mdi mdi-sync",iconToggleDarkModeCommand:"mdi mdi-brightness-4",iconToggleFilterCommand:"mdi mdi-flip-vertical",iconTogglePreHeaderCommand:"mdi mdi-flip-vertical",menuWidth:16,resizeOnShowHeaderRow:!0,showBulletWhenIconMissing:!0,subItemChevronClass:"mdi mdi-chevron-down mdi-rotate-270",headerColumnValueExtractor:Aa},headerMenu:{autoAlign:!0,autoAlignOffset:4,minWidth:140,iconClearFilterCommand:"mdi mdi-filter-remove-outline",iconClearSortCommand:"mdi mdi-sort-variant-off",iconFilterShortcutSubMenu:"mdi mdi-filter-outline",iconFreezeColumns:"mdi mdi-pin-outline",iconSortAscCommand:"mdi mdi-sort-ascending",iconSortDescCommand:"mdi mdi-sort-descending",iconColumnHideCommand:"mdi mdi-close",iconColumnResizeByContentCommand:"mdi mdi-arrow-expand-horizontal",hideColumnResizeByContentCommand:!1,hideColumnHideCommand:!1,hideClearFilterCommand:!1,hideClearSortCommand:!1,hideFreezeColumnsCommand:!0,hideSortCommands:!1,subItemChevronClass:"mdi mdi-chevron-down mdi-rotate-270"},ignoreAccentOnStringFilterAndSort:!1,multiColumnSort:!0,numberedMultiColumnSort:!0,tristateMultiColumnSort:!1,sortColNumberInSeparateSpan:!0,suppressActiveCellChangeOnEdit:!1,pagination:{pageSizes:[10,15,20,25,30,40,50,75,100],pageSize:25,totalItems:0},headerRowHeight:35,rowHeight:35,topPanelHeight:30,translationNamespaceSeparator:":",resetFilterSearchValueAfterOnBeforeCancellation:!0,resizeByContentOnlyOnFirstLoad:!0,resizeByContentOptions:{alwaysRecalculateColumnWidth:!1,cellCharWidthInPx:7.8,cellPaddingWidthInPx:14,defaultRatioForStringType:.88,formatterPaddingWidthInPx:0,maxItemToInspectCellContentWidth:1e3,maxItemToInspectSingleColumnWidthByContent:5e3,widthToRemoveFromExceededWidthReadjustment:50},treeDataOptions:{exportIndentMarginLeft:5,exportIndentationLeadingChar:"ÍÍÍÍÍÍÍÍÍÂ·"}};function Aa(e,t){let i=e?.columnPickerLabel??e?.name??"";(i instanceof HTMLElement||i instanceof DocumentFragment)&&(i=i.textContent||"");const s=e?.columnGroup||"";return s?s+(t?.columnGroupSeparator??" - ")+i:i}const Da={Avg:class{constructor(e){this._isInitialized=!1,this._isTreeAggregator=!1,this._nonNullCount=0,this._sum=0,this._type="avg",this._field=e}get field(){return this._field}get isInitialized(){return this._isInitialized}get type(){return this._type}init(e,t=!1){this._sum=0,this._nonNullCount=0,this._isInitialized=!0,this._isTreeAggregator=t,t&&(e.__treeTotals||(e.__treeTotals={}),void 0===e.__treeTotals[this._type]&&(e.__treeTotals[this._type]={},e.__treeTotals.sum={},e.__treeTotals.count={}),e.__treeTotals[this._type][this._field]=0,e.__treeTotals.count[this._field]=0,e.__treeTotals.sum[this._field]=0)}accumulate(e,t=!1){const i=e?.hasOwnProperty(this._field)?e[this._field]:null;this._isTreeAggregator?t?(e.__treeTotals||(e.__treeTotals={}),this.addGroupTotalPropertiesWhenNotExist(e.__treeTotals),this._sum=parseFloat(e.__treeTotals.sum[this._field]??0),this._nonNullCount=e.__treeTotals.count[this._field]??0):ze(i)&&(this._sum=parseFloat(i),this._nonNullCount=1):ze(i)&&(this._nonNullCount++,this._sum+=parseFloat(i))}storeResult(e){let t=this._sum,i=this._nonNullCount;this.addGroupTotalPropertiesWhenNotExist(e),this._isTreeAggregator&&(t+=e.sum[this._field],i+=e.count[this._field],e.sum[this._field]=t,e.count[this._field]=i),0!==i&&(e[this._type][this._field]=0===i?t:t/i)}addGroupTotalPropertiesWhenNotExist(e){void 0===e[this._type]&&(e[this._type]={}),this._isTreeAggregator&&void 0===e.sum&&(e.sum={}),this._isTreeAggregator&&void 0===e.count&&(e.count={})}},Clone:class{constructor(e){this._isInitialized=!1,this._data="",this._type="clone",this._field=e}get field(){return this._field}get isInitialized(){return this._isInitialized}get type(){return this._type}init(e,t=!1){if(this._data="",this._isInitialized=!0,t)throw new Error("[Slickgrid-Universal] CloneAggregator is not currently supported for use with Tree Data")}accumulate(e){const t=e&&e.hasOwnProperty(this._field)?e[this._field]:null;null!==t&&""!==t&&(this._data=t)}storeResult(e){e&&void 0!==e[this._type]||(e[this._type]={}),e[this._type][this._field]=this._data}},Count:class{constructor(e){this._isInitialized=!1,this._isTreeAggregator=!1,this._count=0,this._type="count",this._field=e}get field(){return this._field}get isInitialized(){return this._isInitialized}get type(){return this._type}init(e,t=!1){this._count=0,this._isInitialized=!0,this._isTreeAggregator=t,t&&(e.__treeTotals||(e.__treeTotals={}),void 0===e.__treeTotals[this._type]&&(e.__treeTotals[this._type]={}),e.__treeTotals[this._type][this._field]=0)}accumulate(e,t=!1){const i=e?.hasOwnProperty(this._field)?e[this._field]:null;this._isTreeAggregator&&(t?(e.__treeTotals||(e.__treeTotals={}),void 0===e.__treeTotals[this._type]&&(e.__treeTotals[this._type]={}),this._count=e.__treeTotals[this._type][this._field]??0):ze(i)&&(this._count=1))}storeResult(e){e&&void 0!==e[this._type]||(e[this._type]={});let t=this._count;this._isTreeAggregator?t+=e[this._type][this._field]:t=e.group?.rows?.length??0,e[this._type][this._field]=t}},Distinct:class{constructor(e){this._isInitialized=!1,this._distinctValues=[],this._type="distinct",this._field=e}get field(){return this._field}get isInitialized(){return this._isInitialized}get type(){return this._type}init(e,t=!1){if(this._distinctValues=[],this._isInitialized=!0,t)throw new Error("[Slickgrid-Universal] CloneAggregator is not currently supported for use with Tree Data")}accumulate(e){const t=e&&e.hasOwnProperty(this._field)?e[this._field]:void 0;-1===this._distinctValues.indexOf(t)&&void 0!==t&&this._distinctValues.push(t)}storeResult(e){e&&void 0!==e[this._type]||(e[this._type]={}),e[this._type][this._field]=this._distinctValues}},Min:class{constructor(e){this._isInitialized=!1,this._isTreeAggregator=!1,this._min=null,this._type="min",this._field=e}get field(){return this._field}get isInitialized(){return this._isInitialized}get type(){return this._type}init(e,t=!1){this._min=null,this._isInitialized=!0,this._isTreeAggregator=t,t&&(e.__treeTotals||(e.__treeTotals={}),void 0===e.__treeTotals[this._type]&&(e.__treeTotals[this._type]={}),e.__treeTotals[this._type][this._field]=null)}accumulate(e,t=!1){const i=e?.hasOwnProperty(this._field)?e[this._field]:null;if(this._isTreeAggregator)if(t){e.__treeTotals||(e.__treeTotals={}),this.addGroupTotalPropertiesWhenNotExist(e.__treeTotals);const t=null!==e.__treeTotals[this._type][this._field]?parseFloat(e.__treeTotals[this._type][this._field]):null;null!==t&&ze(t)&&(null===this._min||t<this._min)&&(this._min=t)}else ze(i)&&this.keepMinValueWhenFound(i);else this.keepMinValueWhenFound(i)}storeResult(e){let t=this._min;if(this.addGroupTotalPropertiesWhenNotExist(e),this._isTreeAggregator&&null!==t){const i=e[this._type][this._field];ze(i)&&i<t&&(t=i)}e[this._type][this._field]=t}addGroupTotalPropertiesWhenNotExist(e){void 0===e[this._type]&&(e[this._type]={})}keepMinValueWhenFound(e){ze(e)&&(null===this._min||e<this._min)&&(this._min=parseFloat(e))}},Max:class{constructor(e){this._isInitialized=!1,this._isTreeAggregator=!1,this._max=null,this._type="max",this._field=e}get field(){return this._field}get isInitialized(){return this._isInitialized}get type(){return this._type}init(e,t=!1){this._max=null,this._isInitialized=!0,this._isTreeAggregator=t,t&&(e.__treeTotals||(e.__treeTotals={}),void 0===e.__treeTotals[this._type]&&(e.__treeTotals[this._type]={}),e.__treeTotals[this._type][this._field]=null)}accumulate(e,t=!1){const i=e?.hasOwnProperty(this._field)?e[this._field]:null;if(this._isTreeAggregator)if(t){e.__treeTotals||(e.__treeTotals={}),this.addGroupTotalPropertiesWhenNotExist(e.__treeTotals);const t=null!==e.__treeTotals[this._type][this._field]?parseFloat(e.__treeTotals[this._type][this._field]):null;null!==t&&ze(t)&&(null===this._max||t>this._max)&&(this._max=t)}else ze(i)&&this.keepMaxValueWhenFound(i);else this.keepMaxValueWhenFound(i)}storeResult(e){let t=this._max;if(this.addGroupTotalPropertiesWhenNotExist(e),this._isTreeAggregator&&null!==t){const i=e[this._type][this._field];ze(i)&&i>t&&(t=i)}e[this._type][this._field]=t}addGroupTotalPropertiesWhenNotExist(e){void 0===e[this._type]&&(e[this._type]={})}keepMaxValueWhenFound(e){ze(e)&&(null===this._max||e>this._max)&&(this._max=parseFloat(e))}},Sum:class{constructor(e){this._isInitialized=!1,this._isTreeAggregator=!1,this._sum=0,this._itemCount=0,this._type="sum",this._field=e}get field(){return this._field}get isInitialized(){return this._isInitialized}get type(){return this._type}init(e,t=!1){this._isTreeAggregator=t,this._isInitialized=!0,this._sum=0,this._itemCount=0,t&&(e.__treeTotals||(e.__treeTotals={}),void 0===e.__treeTotals[this._type]&&(e.__treeTotals[this._type]={},e.__treeTotals.count={}),e.__treeTotals.count[this._field]=0,e.__treeTotals[this._type][this._field]=0)}accumulate(e,t=!1){const i=e?.hasOwnProperty(this._field)?e[this._field]:null;this._isTreeAggregator?t?(e.__treeTotals||(e.__treeTotals={}),this.addGroupTotalPropertiesWhenNotExist(e.__treeTotals),this._sum=parseFloat(e.__treeTotals[this._type][this._field]??0),this._itemCount=e.__treeTotals.count[this._field]??0):ze(i)&&(this._sum=parseFloat(i),this._itemCount=1):ze(i)&&(this._sum+=parseFloat(i))}storeResult(e){e&&void 0!==e[this._type]||(e[this._type]={}),this.addGroupTotalPropertiesWhenNotExist(e);let t=this._sum,i=this._itemCount;this._isTreeAggregator&&(t+=e[this._type][this._field],i+=e.count[this._field],e.count[this._field]=i),e[this._type][this._field]=t}addGroupTotalPropertiesWhenNotExist(e){void 0===e[this._type]&&(e[this._type]={}),this._isTreeAggregator&&void 0===e.count&&(e.count={})}}};function Ra(e,t){const i=t.errorMessage,s=t.required,n=t.minLength,r=t.maxLength,o=t.operatorConditionalType||"inclusive",a={"{{minLength}}":n,"{{maxLength}}":r};let l=!0,h="";const c=e?.length??0;if(t.validator)return t.validator(e,t.editorArgs);if(s&&""===e)l=!1,h=i||y.VALIDATION_REQUIRED_FIELD;else if(void 0!==n&&void 0!==r&&("exclusive"===o&&(c<=n||c>=r)||"inclusive"===o&&(c<n||c>r)))l=!1,h=i||y.VALIDATION_EDITOR_TEXT_LENGTH_BETWEEN.replace(/{{minLength}}|{{maxLength}}/gi,(e=>a[e]));else if(void 0!==n&&null!==c&&("exclusive"===o&&c<=n||"inclusive"===o&&null!==c&&c<n)){l=!1;const e="inclusive"===o?y.VALIDATION_EDITOR_TEXT_MIN_LENGTH_INCLUSIVE:y.VALIDATION_EDITOR_TEXT_MIN_LENGTH;h=i||e.replace(/{{minLength}}/gi,(e=>a[e]))}else if(void 0!==r&&null!==c&&("exclusive"===o&&c>=r||"inclusive"===o&&null!==c&&c>r)){l=!1;const e="inclusive"===o?y.VALIDATION_EDITOR_TEXT_MAX_LENGTH_INCLUSIVE:y.VALIDATION_EDITOR_TEXT_MAX_LENGTH;h=i||e.replace(/{{maxLength}}/gi,(e=>a[e]))}return{valid:l,msg:h}}function Pa(e,t){const i=isNaN(e)?null:parseFloat(e),s=t.decimal||0,n=t.required,r=t.minValue,o=t.maxValue,a=t.operatorConditionalType||"inclusive",l=t.errorMessage,h={"{{minValue}}":r,"{{maxValue}}":o,"{{minDecimal}}":0,"{{maxDecimal}}":s};let c=!0,d="";if("function"==typeof t.validator)return t.validator(e,t.editorArgs);if(n&&""===e)c=!1,d=l||y.VALIDATION_REQUIRED_FIELD;else if(""!==e&&(isNaN(e)||0===s&&!/^[-+]?(\d*(\.)?(\d)*)$/.test(e)))c=!1,d=l||y.VALIDATION_EDITOR_VALID_NUMBER;else if(void 0!==r&&void 0!==o&&null!==i&&("exclusive"===a&&(i<=+r||i>=+o)||"inclusive"===a&&(i<+r||i>+o)))c=!1,d=l||y.VALIDATION_EDITOR_NUMBER_BETWEEN.replace(/{{minValue}}|{{maxValue}}/gi,(e=>h[e]));else if(void 0!==r&&null!==i&&("exclusive"===a&&i<=+r||"inclusive"===a&&i<+r)){c=!1;const e="inclusive"===a?y.VALIDATION_EDITOR_NUMBER_MIN_INCLUSIVE:y.VALIDATION_EDITOR_NUMBER_MIN;d=l||e.replace(/{{minValue}}/gi,(e=>h[e]))}else if(void 0!==o&&null!==i&&("exclusive"===a&&i>=+o||"inclusive"===a&&i>+o)){c=!1;const e="inclusive"===a?y.VALIDATION_EDITOR_NUMBER_MAX_INCLUSIVE:y.VALIDATION_EDITOR_NUMBER_MAX;d=l||e.replace(/{{maxValue}}/gi,(e=>h[e]))}else s>0&&!new RegExp(`^[-+]?(\\d*(\\.)?(\\d){0,${s}})$`).test(e)&&(c=!1,d=l||y.VALIDATION_EDITOR_DECIMAL_BETWEEN.replace(/{{minDecimal}}|{{maxDecimal}}/gi,(e=>h[e])));return{valid:c,msg:d}}function La(e,t){let i=isNaN(e)?null:parseInt(e,10);null!==i&&isNaN(i)&&(i=null);const s=t.errorMessage,n=t.required,r=t.minValue,o=t.maxValue,a=t.operatorConditionalType||"inclusive",l={"{{minValue}}":r,"{{maxValue}}":o};let h=!0,c="";if(t.validator)return t.validator(e,t.editorArgs);if(n&&""===e)h=!1,c=s||y.VALIDATION_REQUIRED_FIELD;else if(""===e||!isNaN(e)&&/^[+-]?\d+$/.test(e)){if(void 0!==r&&void 0!==o&&null!==i&&("exclusive"===a&&(i<=+r||i>=+o)||"inclusive"===a&&(i<+r||i>+o)))h=!1,c=s||y.VALIDATION_EDITOR_INTEGER_BETWEEN.replace(/{{minValue}}|{{maxValue}}/gi,(e=>l[e]));else if(void 0!==r&&null!==i&&("exclusive"===a&&i<=+r||"inclusive"===a&&null!==i&&i<+r)){h=!1;const e="inclusive"===a?y.VALIDATION_EDITOR_INTEGER_MIN_INCLUSIVE:y.VALIDATION_EDITOR_INTEGER_MIN;c=s||e.replace(/{{minValue}}/gi,(e=>l[e]))}else if(void 0!==o&&null!==i&&("exclusive"===a&&i>=+o||"inclusive"===a&&null!==i&&i>+o)){h=!1;const e="inclusive"===a?y.VALIDATION_EDITOR_INTEGER_MAX_INCLUSIVE:y.VALIDATION_EDITOR_INTEGER_MAX;c=s||e.replace(/{{maxValue}}/gi,(e=>l[e]))}}else h=!1,c=s||y.VALIDATION_EDITOR_VALID_INTEGER;return{valid:h,msg:c}}class Ma{constructor(e,t="text"){if(this.args=e,this._inputType="text",this._isValueTouched=!1,this.disabled=!1,!e)throw new Error("[Slickgrid-Universal] Something is wrong with this grid, an Editor must always have valid arguments.");this.grid=e.grid,this.gridOptions=e.grid?.getOptions(),this._bindEventService=new Wt,this.inputType=t,this.init()}get columnDef(){return this.args.column}get columnEditor(){return this.columnDef?.editor||{}}get dataContext(){return this.args.item}get editorDomElement(){return this._input}get hasAutoCommitEdit(){return this.gridOptions.autoCommitEdit??!1}get inputType(){return this._inputType}set inputType(e){this._inputType=e}get validator(){return this.columnEditor?.validator??this.columnDef?.validator}init(){const e=this.columnDef?.id??"",t=this.args.compositeEditorOptions;this._input=ie("input",{type:this._inputType||"text",autocomplete:"off",ariaAutoComplete:"none",ariaLabel:this.columnEditor?.ariaLabel??`${Ke(e+"")} Input Editor`,className:`editor-text editor-${e}`,placeholder:this.columnEditor?.placeholder??"",title:this.columnEditor?.title??""}),"number"===this.inputType&&(this._input.step=`${void 0!==this.columnEditor.valueStep?this.columnEditor.valueStep:this.getInputDecimalSteps()}`);const i=this.args.container;i&&"function"==typeof i.appendChild&&i.appendChild(this._input),this._bindEventService.bind(this._input,"focus",(()=>this._input?.select())),this._bindEventService.bind(this._input,"keydown",(e=>{this._isValueTouched=!0,this._lastInputKeyEvent=e,"ArrowLeft"!==e.key&&"ArrowRight"!==e.key&&"Home"!==e.key&&"End"!==e.key||e.stopImmediatePropagation()})),this.hasAutoCommitEdit&&!t&&this._bindEventService.bind(this._input,["focusout","blur"],(()=>{this._isValueTouched=!0,this.save()})),t&&(this._bindEventService.bind(this._input,["input","paste"],this.handleOnInputChange.bind(this)),"number"===this.inputType&&this._bindEventService.bind(this._input,"wheel",this.handleOnMouseWheel.bind(this),{passive:!0}))}destroy(){this._bindEventService.unbindAll(),this._input?.remove?.()}disable(e=!0){const t=this.disabled;if(this.disabled=e,this._input)if(e){this._input.setAttribute("disabled","disabled");const i=this.getValue();t!==e&&this.args?.compositeEditorOptions&&""!==i&&this.reset("",!0,!0)}else this._input.removeAttribute("disabled")}focus(){this.grid.focus(),this._input?.focus()}getDecimalPlaces(){let e=this.columnEditor?.decimal??this.columnEditor?.params?.decimalPlaces??void 0;return void 0===e&&(e=0),e||0===e?e:null}getInputDecimalSteps(){const e=this.getDecimalPlaces();let t="";for(let i=1;i<e;i++)t+="0";return e>0?`0.${t}1`:"1"}show(){this.args?.compositeEditorOptions&&this.applyInputUsabilityState()}getValue(){return this._input?.value||""}setValue(e,t=!1,i=!0){if(this._input&&(this._input.value=`${e}`,t)){this.applyValue(this.args.item,this.serializeValue());const e=this.args.compositeEditorOptions;e&&i&&this.handleChangeOnCompositeEditor(null,e,"system")}}applyValue(e,t){const i=this.columnDef&&this.columnDef.field;if(void 0!==i){const s=i?.indexOf(".")>0,n=this.validate(null,t),r=n?.valid?t:"";s?Ue(e,this.columnEditor?.complexObjectPath??i??"",r):i&&(e[i]=r)}}isValueChanged(){const e=this._input?.value,t=this._lastInputKeyEvent?.key;return!(!this.columnEditor?.alwaysSaveOnEnterKey||"Enter"!==t)||!(""===e&&(null===this._originalValue||void 0===this._originalValue))&&e!==this._originalValue}isValueTouched(){return this._isValueTouched}loadValue(e){const t=this.columnDef?.field;if(e&&void 0!==t&&this._input){const i=t?.indexOf(".")>0?U(e,t):e.hasOwnProperty(t)&&e[t]||"";this._originalValue=i,this._input.value=this._originalValue,this._input.select()}}reset(e,t=!0,i=!1){const s=e??this._originalValue??"";this._input&&(this._originalValue=s,this._input.value=`${s}`),this._isValueTouched=!1;const n=this.args.compositeEditorOptions;if(n&&t){const e=!i;this.handleChangeOnCompositeEditor(null,n,"user",e)}}save(){const e=this.validate(),t=e&&e.valid||!1;this.hasAutoCommitEdit&&t?this.grid.getEditorLock().commitCurrentEdit():this.args.commitChanges()}serializeValue(){return this._input?.value??""}validate(e,t){return this.args.compositeEditorOptions&&this.applyInputUsabilityState(),this.disabled?{valid:!0,msg:""}:Ra(void 0!==t?t:this._input&&this._input.value,{editorArgs:this.args,errorMessage:this.columnEditor.errorMessage,minLength:this.columnEditor.minLength,maxLength:this.columnEditor.maxLength,operatorConditionalType:this.columnEditor.operatorConditionalType,required:!this.args?.compositeEditorOptions&&this.columnEditor.required,validator:this.validator})}applyInputUsabilityState(){const e=this.grid.getActiveCell(),t=this.grid.onBeforeEditCell.notify({...e,item:this.dataContext,column:this.args.column,grid:this.grid,target:"composite",compositeEditorOptions:this.args.compositeEditorOptions}).getReturnValue();this.disable(!1===t)}handleChangeOnCompositeEditor(e,t,i="user",s=!1){const n=this.grid.getActiveCell(),r=this.args.column,o=this.columnDef?.id??"",a=this.dataContext,l=this.grid,h=this.serializeValue();this.validate().valid&&this.applyValue(this.dataContext,h),this.applyValue(t.formValues,h);const c=this.gridOptions?.compositeEditorOptions?.excludeDisabledFieldFormValues??!1;(s||this.disabled&&c&&t.formValues.hasOwnProperty(o))&&delete t.formValues[o],l.onCompositeEditorChange.notify({...n,item:a,grid:l,column:r,formValues:t.formValues,editors:t.editors,triggeredBy:i},new bs(e))}handleOnInputChange(e){this._isValueTouched=!0;const t=this.args.compositeEditorOptions;if(t){const i=this.gridOptions?.editorTypingDebounce??500;window.clearTimeout(this._timer),this._timer=window.setTimeout((()=>this.handleChangeOnCompositeEditor(e,t)),i)}}handleOnMouseWheel(e){this._isValueTouched=!0;const t=this.args.compositeEditorOptions;t&&this.handleChangeOnCompositeEditor(e,t)}}class Na{constructor(e,t,i=-1){if(this.args=e,this.isMultipleSelect=t,this.delayOpening=i,this._isValueTouched=!1,this._isDisposingOrCallingSave=!1,this.disabled=!1,this.enableTranslateLabel=!1,this.finalCollection=[],!e)throw new Error("[Slickgrid-Universal] Something is wrong with this grid, an Editor must always have valid arguments.");this.grid=e.grid,this.gridOptions=this.grid.getOptions()||{},this.gridOptions?.translater&&(this._translaterService=this.gridOptions.translater),this._locales=this.gridOptions.locales||y.locales;const s=this.columnDef?.id??"";this.elementName=`editor-${s}`;const n=this.args.compositeEditorOptions,r={autoAdjustDropHeight:!0,autoAdjustDropPosition:!0,autoAdjustDropWidthByTextSize:!0,container:"body",darkMode:!!this.gridOptions.darkMode,filter:!1,maxHeight:275,minHeight:25,name:this.elementName,single:!0,singleRadio:!0,renderOptionLabelAsHtml:this.columnEditor?.enableRenderHtml??!1,sanitizer:e=>this.grid.sanitizeHtmlString(e),onClick:()=>this._isValueTouched=!0,onCheckAll:()=>this._isValueTouched=!0,onUncheckAll:()=>this._isValueTouched=!0,onClose:e=>{"key.escape"!==e&&"body.click"!==e&&(this.hasAutoCommitEdit||this.isValueChanged())?n?this.handleChangeOnCompositeEditor(n):(this._isDisposingOrCallingSave=!0,this.save(this.hasAutoCommitEdit)):"key.escape"===e&&this.cancel()}};if(t)if(r.single=!1,r.singleRadio=!1,r.displayTitle=!0,r.showOkButton=!0,this._translaterService?.getCurrentLanguage()){const e=j(this.gridOptions);r.countSelectedText=this._translaterService.translate(`${e}X_OF_Y_SELECTED`),r.allSelectedText=this._translaterService.translate(`${e}ALL_SELECTED`),r.selectAllText=this._translaterService.translate(`${e}SELECT_ALL`),r.okButtonText=this._translaterService.translate(`${e}OK`),r.noMatchesFoundText=this._translaterService.translate(`${e}NO_MATCHES_FOUND`)}else r.countSelectedText=this._locales?.TEXT_X_OF_Y_SELECTED,r.allSelectedText=this._locales?.TEXT_ALL_SELECTED,r.selectAllText=this._locales?.TEXT_SELECT_ALL,r.okButtonText=this._locales?.TEXT_OK,r.noMatchesFoundText=this._locales?.TEXT_NO_MATCHES_FOUND;this.defaultOptions=r,this.init()}get collection(){return this.columnEditor?.collection??[]}get collectionOptions(){return this.columnEditor?.collectionOptions}get columnDef(){return this.args.column}get columnEditor(){return this.columnDef?.editor??{}}get dataContext(){return this.args.item}get editorOptions(){return{...this.gridOptions.defaultEditorOptions?.select,...this.columnEditor?.editorOptions}}get isCompositeEditor(){return!!this.args?.compositeEditorOptions}get customStructure(){return this.columnDef?.editor?.customStructure}get hasAutoCommitEdit(){return this.gridOptions.autoCommitEdit??!1}get msInstance(){return this._msInstance}get selectOptions(){return this.defaultOptions}get currentValues(){const e=new Set;if((this._msInstance?.getSelects("value")??[]).forEach((t=>e.add(t.toString()))),this.collection.every((e=>"number"==typeof e||"string"==typeof e)))return this.collection.filter((t=>e.has(t?.toString())));const t=this.collectionOptions?.separatorBetweenTextLabels??"",i=this.collectionOptions?.includePrefixSuffixToSelectedValues??!1;return this.collection.filter((t=>e.has(t?.[this.valueName]?.toString()))).map((e=>{const s=e[this.valueName];let n=e[this.labelPrefixName]||"",r=e[this.labelSuffixName]||"";const o=this.columnDef?.field??"",a=o?.indexOf(".")>0,l=this.columnEditor?.serializeComplexValueFormat??"object";return a&&"object"==typeof e&&"object"===l?e:(n=this.enableTranslateLabel&&this._translaterService&&n&&"string"==typeof n?this._translaterService.translate(n||" "):n,r=this.enableTranslateLabel&&this._translaterService&&r&&"string"==typeof r?this._translaterService.translate(r||" "):r,i?[n,s,r].filter((e=>e)).join(t):s)}))}get currentValue(){const e=this._msInstance?.getSelects()??[],t=e.length?e[0]:"",i=this.columnDef?.field;if(void 0!==i){if(this.collection.every((e=>"number"==typeof e||"string"==typeof e)))return J(this.collection,(e=>e?.toString?.()===`${t}`));const e=this.collectionOptions?.separatorBetweenTextLabels??"",s=this.collectionOptions?.includePrefixSuffixToSelectedValues??!1,n=J(this.collection,(e=>e.hasOwnProperty(this.valueName)&&e[this.valueName]?.toString()===`${t}`)),r=i?.indexOf(".")>0,o=this.columnEditor?.serializeComplexValueFormat??"object";if(r&&"object"==typeof n&&"object"===o)return n;if(n&&n.hasOwnProperty(this.valueName)){const t=n[this.valueName];if(s){let i=n[this.labelPrefixName]||"",s=n[this.labelSuffixName]||"";return i=this.enableTranslateLabel&&this._translaterService&&i&&"string"==typeof i?this._translaterService.translate(i||" "):i,s=this.enableTranslateLabel&&this._translaterService&&s&&"string"==typeof s?this._translaterService.translate(s||" "):s,[i,t,s].filter((e=>e)).join(e)}return t}}return""}get validator(){return this.columnEditor?.validator??this.columnDef?.validator}init(){if(!this.columnDef||!this.columnDef.editor||!this.columnDef.editor.collection&&!this.columnDef.editor.collectionAsync)throw new Error("[Slickgrid-Universal] You need to pass a \"collection\" (or \"collectionAsync\") inside Column Definition Editor for the MultipleSelect/SingleSelect Editor to work correctly.\n      Also each option should include a value/label pair (or value/labelKey when using Locale).\n      For example: { editor: { collection: [{ value: true, label: 'True' },{ value: false, label: 'False'}] } }");if(this._collectionService=new gs(this._translaterService),this.enableTranslateLabel=this.columnEditor?.enableTranslateLabel??!1,this.labelName=this.customStructure?.label??"label",this.labelPrefixName=this.customStructure?.labelPrefix??"labelPrefix",this.labelSuffixName=this.customStructure?.labelSuffix??"labelSuffix",this.optionLabel=this.customStructure?.optionLabel??"value",this.valueName=this.customStructure?.value??"value",this.enableTranslateLabel&&(!this._translaterService||"function"!=typeof this._translaterService.translate))throw new Error('[Slickgrid-Universal] requires a Translate Service to be installed and configured when the grid option "enableTranslate" is enabled.');this.renderDomElement(this.collection),(this.disabled||this.columnEditor?.collectionAsync&&Array.isArray(this.collection)&&0===this.collection.length)&&this.disable(!0)}getValue(){return this.isMultipleSelect?this.currentValues:this.currentValue}setValue(e,t=!1,i=!0){if(this.isMultipleSelect&&Array.isArray(e)?this.loadMultipleValues(e):this.loadSingleValue(e),t){this.applyValue(this.args.item,this.serializeValue());const e=this.args.compositeEditorOptions;e&&i&&this.handleChangeOnCompositeEditor(e,"system")}}cancel(){this.args?.cancelChanges&&this.args.cancelChanges()}hide(){this._msInstance&&this._msInstance.close()}show(e){!this.isCompositeEditor&&this._msInstance?this._msInstance.open(e):this.isCompositeEditor&&this.applyInputUsabilityState()}applyValue(e,t){const i=this.columnDef?.field,s=this.columnDef?.type;let n=t;if(void 0!==i){s!==E.number&&s!==E.integer&&s!==E.boolean||isNaN(parseFloat(t))||(n=parseFloat(t)),this.isMultipleSelect&&"string"==typeof t&&t.indexOf(",")>=0&&(n=t.split(","));const r=i?.indexOf(".")>0,o=this.validate(null,n);n=o?.valid?n:"",r?Ue(e,this.columnEditor?.complexObjectPath??i??"",n):e[i]=n}}destroy(){this._msInstance&&this.hasAutoCommitEdit&&this.isValueChanged()&&!this._isDisposingOrCallingSave&&!this.isCompositeEditor&&(this._isDisposingOrCallingSave=!0,this.save(!0)),this._isDisposingOrCallingSave=!0,"function"==typeof this._msInstance?.destroy&&this._msInstance.destroy(),this.editorElm?.remove(),this._msInstance=void 0}loadValue(e){const t=this.columnDef?.field,i=void 0!==t&&t?.indexOf(".")>0;if(e&&void 0!==t){const s=this.columnEditor?.complexObjectPath??t,n=i?U(e,s):e.hasOwnProperty(t)&&e[t],r=i&&n?.hasOwnProperty(this.valueName)?n[this.valueName]:n;this.isMultipleSelect&&Array.isArray(r)?this.loadMultipleValues(r):this.loadSingleValue(r)}}loadMultipleValues(e){if(Array.isArray(e)){this.originalValue=e.map((e=>"number"==typeof e||"boolean"==typeof e?`${e}`:e)),this._msInstance?.setSelects(this.originalValue);const t=this.args.compositeEditorOptions;t&&this.handleChangeOnCompositeEditor(t)}}loadSingleValue(e){this.originalValue="number"==typeof e||"boolean"==typeof e?`${e}`:e,this._msInstance?.setSelects([this.originalValue])}serializeValue(){return this.isMultipleSelect?this.currentValues:this.currentValue}changeEditorOption(e,t){this.columnEditor&&(this.columnEditor.editorOptions||(this.columnEditor.editorOptions={}),this.columnEditor.editorOptions[e]=t,this.editorElmOptions={...this.editorElmOptions,[e]:t},this._msInstance?.refreshOptions(this.editorElmOptions))}disable(e=!0){const t=this.disabled;if(this.disabled=e,this._msInstance)if(e){this._msInstance.disable();const i=this.getValue(),s=Array.isArray(i)&&this.isMultipleSelect?""===i?.[0]:""===i;t!==e&&this.isCompositeEditor&&!s&&this.reset("",!0,!0)}else this._msInstance.enable()}focus(){this.grid.focus(),this._msInstance?.focus()}isValueChanged(){const e=this._msInstance?.getSelects();if(this.isMultipleSelect)return!jt(e,this.originalValue);const t=Array.isArray(e)&&e.length>0?e[0]:void 0;return void 0!==t&&t!==this.originalValue}isValueTouched(){return this._isValueTouched}reset(e,t=!0,i=!1){const s=e??this.originalValue;if(this._msInstance){this.originalValue=this.isMultipleSelect?void 0!==s?[s]:[]:s;const e=void 0===this.originalValue?[]:[this.originalValue];this._msInstance.setSelects(e)}this._isValueTouched=!1;const n=this.args.compositeEditorOptions;if(n&&t){const e=!i;this.handleChangeOnCompositeEditor(n,"user",e)}}save(e=!1){const t=this.validate(),i=t?.valid??!1;(!this._isDisposingOrCallingSave||e)&&this.hasAutoCommitEdit&&i?this.grid.getEditorLock().commitCurrentEdit():this.args.commitChanges()}validate(e,t){const i=!this.isCompositeEditor&&this.columnEditor?.required,s=void 0!==t?t:this._msInstance?.getSelects(),n=this.columnEditor&&this.columnEditor.errorMessage;if(this.isCompositeEditor&&this.applyInputUsabilityState(),this.disabled)return{valid:!0,msg:""};if(this.validator){const e=void 0!==t?t:this.isMultipleSelect?this.currentValues:this.currentValue;return this.validator(e,this.args)}return i&&(""===s||Array.isArray(s)&&0===s.length)?{valid:!1,msg:n||y.VALIDATION_REQUIRED_FIELD}:{valid:!0,msg:null}}applyInputUsabilityState(){const e=this.grid.getActiveCell(),t=this.grid.onBeforeEditCell.notify({...e,item:this.dataContext,column:this.args.column,grid:this.grid,target:"composite",compositeEditorOptions:this.args.compositeEditorOptions}).getReturnValue();this.disable(!1===t)}filterCollection(e){let t=e;if(this.columnEditor&&this.columnEditor.collectionFilterBy){const e=this.columnEditor.collectionFilterBy,i=this.columnEditor.collectionOptions?.filterResultAfterEachPass??null;t=this._collectionService.filterCollection(t,e,i)}return t}sortCollection(e){let t=e;if(this.columnDef&&this.columnEditor&&this.columnEditor.collectionSortBy){const e=this.columnEditor.collectionSortBy;t=this._collectionService.sortCollection(this.columnDef,t,e,this.enableTranslateLabel)}return t}renderDomElement(e){if(!Array.isArray(e)&&this.collectionOptions?.collectionInsideObjectProperty&&(e=U(e,this.collectionOptions.collectionInsideObjectProperty)),!Array.isArray(e))throw new Error('The "collection" passed to the Select Editor is not a valid array.');let t=[];e.length>0&&(t=[...e]),this.collectionOptions?.addBlankEntry&&Array.isArray(t)&&t.length>0&&""!==t[0][this.valueName]&&(t.unshift(this.createBlankEntry()),this.collection.unshift(this.createBlankEntry())),this.collectionOptions?.addCustomFirstEntry&&Array.isArray(t)&&t.length>0&&t[0][this.valueName]!==this.collectionOptions.addCustomFirstEntry[this.valueName]&&(t.unshift(this.collectionOptions.addCustomFirstEntry),this.collection.unshift(this.collectionOptions.addCustomFirstEntry)),this.collectionOptions?.addCustomLastEntry&&Array.isArray(t)&&t.length>0&&t[t.length-1][this.valueName]!==this.collectionOptions.addCustomLastEntry[this.valueName]&&t.push(this.collectionOptions.addCustomLastEntry);let i=t;if(i=this.filterCollection(i),i=this.sortCollection(i),this.columnEditor?.collectionOverride){const e={column:this.columnDef,dataContext:this.dataContext,grid:this.grid,originalCollections:this.collection};if(this.args.compositeEditorOptions){const{formValues:t,modalType:i}=this.args.compositeEditorOptions;e.compositeEditorOptions={formValues:t,modalType:i}}i=this.columnEditor.collectionOverride(i,e)}this.finalCollection=i;const s=_s("editor",i,this.columnDef,this.grid,this.isMultipleSelect,this._translaterService);this.createDomElement(s.selectElement,s.dataCollection)}createBlankEntry(){const e={[this.labelName]:"",[this.valueName]:""};return this.labelPrefixName&&(e[this.labelPrefixName]=""),this.labelSuffixName&&(e[this.labelSuffixName]=""),e}createDomElement(e,t){const i=this.args.container;e&&i&&"function"==typeof i.appendChild&&(re(i),i.appendChild(e));const s=this.columnEditor?.placeholder??"";this.defaultOptions.placeholder=s||"",this.editorElmOptions={...this.defaultOptions,...this.editorOptions,data:t},this._msInstance=Ea(e,this.editorElmOptions),this.editorElm=this._msInstance.getParentElement(),this.isCompositeEditor||this.show(this.delayOpening)}handleChangeOnCompositeEditor(e,t="user",i=!1){const s=this.grid.getActiveCell(),n=this.args.column,r=this.columnDef?.id??"",o=this.dataContext,a=this.grid,l=this.serializeValue();this.validate().valid&&this.applyValue(this.dataContext,l),this.applyValue(e.formValues,l);const h=this.gridOptions?.compositeEditorOptions?.excludeDisabledFieldFormValues??!1;(i||this.disabled&&h&&e.formValues.hasOwnProperty(r))&&delete e.formValues[r],a.onCompositeEditorChange.notify({...s,item:o,grid:a,column:n,formValues:e.formValues,editors:e.editors,triggeredBy:t},new bs)}}const Fa={autocompleter:class{constructor(e){if(this.args=e,this._isValueTouched=!1,this._lastTriggeredByClearInput=!1,this.disabled=!1,this.forceUserInput=!1,this.finalCollection=[],!e)throw new Error("[Slickgrid-Universal] Something is wrong with this grid, an Editor must always have valid arguments.");this.grid=e.grid,this._bindEventService=new Wt,this.gridOptions?.translater&&(this._translater=this.gridOptions.translater),this._locales=this.gridOptions&&this.gridOptions.locales||y.locales,this.init()}get autocompleterOptions(){return this._autocompleterOptions||{}}get collection(){return this.columnEditor?.collection??[]}get editorDomElement(){return this._inputElm}get elementCollection(){return this._elementCollection}get columnDef(){return this.args.column}get columnEditor(){return this.columnDef?.editor||{}}get customStructure(){let e=this.columnEditor?.customStructure;const t=this.columnEditor?.type??this.columnDef?.type;return!e&&t===E.object&&this.columnDef?.dataKey&&this.columnDef?.labelKey&&(e={label:this.columnDef.labelKey,value:this.columnDef.dataKey}),e}get dataContext(){return this.args.item}get editorOptions(){return{...this.gridOptions.defaultEditorOptions?.autocompleter,...this.columnEditor?.editorOptions}}get gridOptions(){return this.grid?.getOptions()??{}}get instance(){return this._instance}get hasAutoCommitEdit(){return this.gridOptions.autoCommitEdit??!1}get validator(){return this.columnEditor?.validator??this.columnDef?.validator}init(){this.labelName=this.customStructure?.label??"label",this.valueName=this.customStructure?.value??"value",this.labelPrefixName=this.customStructure?.labelPrefix??"labelPrefix",this.labelSuffixName=this.customStructure?.labelSuffix??"labelSuffix";let e=this.columnEditor.collection;this.columnEditor?.collectionAsync&&!e&&(e=[]),this.renderDomElement(e),(this.disabled||this.columnEditor?.collectionAsync&&Array.isArray(e)&&0===e.length)&&this.disable(!0)}destroy(){this._bindEventService.unbindAll(),"function"==typeof this._instance?.destroy&&this._instance.destroy(),this._inputElm?.remove?.(),this._elementCollection=null}disable(e=!0){const t=this.disabled;if(this.disabled=e,this._inputElm)if(e){this._inputElm.disabled=!0;const i=this.getValue();t!==e&&this.args?.compositeEditorOptions&&""!==i&&this.clear(!0)}else this._inputElm.disabled=!1}focus(){this.grid.focus(),this._inputElm&&(this._inputElm.focus(),this._inputElm.select())}show(){this.args?.compositeEditorOptions&&this.applyInputUsabilityState()}getValue(){return this._inputElm.value}setValue(e,t=!1,i=!0){if(this._inputElm.value=e?.hasOwnProperty(this.labelName)?e[this.labelName]:e,t){this._currentValue=e,this._defaultTextValue="string"==typeof e?e:e?.[this.labelName]??"",this.applyValue(this.args.item,this.serializeValue());const t=this.args.compositeEditorOptions;t&&i&&this.handleChangeOnCompositeEditor(null,t,"system")}}applyValue(e,t){let i=t;const s=this.columnDef?.field;if(void 0!==s){Array.isArray(this.collection)&&this.collection.length>0&&(i=J(this.collection,(e=>e&&Fe(t)&&e.hasOwnProperty(this.valueName)?e[this.valueName].toString()===(t.hasOwnProperty(this.valueName)&&t[this.valueName].toString()):e&&"string"==typeof t&&e.hasOwnProperty(this.valueName)?e[this.valueName].toString()===t:e?.toString()===t),""));const n=s?.indexOf(".")>0,r=this.validate(null,i);i=r?.valid?i:"",n?Ue(e,this.columnEditor?.complexObjectPath??s??"",i):e[s]=i}}isValueChanged(){const e=this._inputElm.value,t=this._lastInputKeyEvent?.key;if(this.columnEditor?.alwaysSaveOnEnterKey&&"Enter"===t)return!0;const i=!(""===e&&(null===this._defaultTextValue||void 0===this._defaultTextValue))&&e!==this._defaultTextValue;return this._lastTriggeredByClearInput||i}isValueTouched(){return this._isValueTouched}loadValue(e){const t=this.columnDef?.field;if(e&&void 0!==t){const i=t?.indexOf(".")>0?U(e,t):e[t];this._currentValue=i,this._originalValue=i,this._defaultTextValue="string"==typeof i?i:i?.[this.labelName]??"",this._inputElm.value=this._defaultTextValue,this._inputElm.select()}}clear(e=!1){this._inputElm&&(this._currentValue="",this._defaultTextValue="",this.setValue("",!0)),this._isValueTouched=!0,this._lastTriggeredByClearInput=!0;const t=this.args.compositeEditorOptions;if(t){const i=!e;this.handleChangeOnCompositeEditor(null,t,"user",i)}else this.save()}reset(e,t=!0,i=!1){const s=e??this._originalValue??"";this._inputElm&&(this._currentValue=s,this._defaultTextValue="string"==typeof s?s:s?.[this.labelName]??"",this._inputElm.value=this._defaultTextValue),this._isValueTouched=!1;const n=this.args.compositeEditorOptions;if(n&&t){const e=!i;this.handleChangeOnCompositeEditor(null,n,"user",e)}}save(){const e=this.validate(),t=e?.valid??!1;if(this.hasAutoCommitEdit&&t)this.grid.getEditorLock().commitCurrentEdit();else{const e="Enter"!==this._lastInputKeyEvent?.key;this.args.commitChanges(e)}}serializeValue(){if(this._inputElm&&this.editorOptions.forceUserInput){const e=this.editorOptions?.minLength??3;this._currentValue=this._inputElm.value.length>e?this._inputElm.value:this._currentValue}return this.customStructure&&this._currentValue&&this._currentValue.hasOwnProperty(this.valueName)&&this.columnDef?.type!==E.object&&this.columnEditor?.type!==E.object?this._currentValue[this.valueName]:this._currentValue&&void 0!==this._currentValue.value?this.columnDef?.type===E.object||this.columnEditor?.type===E.object?{[this.labelName]:this._currentValue.label,[this.valueName]:this._currentValue.value}:this._currentValue.value:this._currentValue}validate(e,t){return this.args.compositeEditorOptions&&this.applyInputUsabilityState(),this.disabled?{valid:!0,msg:""}:Ra(void 0!==t?t:this._inputElm?.value,{editorArgs:this.args,errorMessage:this.columnEditor.errorMessage,minLength:this.columnEditor.minLength,maxLength:this.columnEditor.maxLength,operatorConditionalType:this.columnEditor.operatorConditionalType,required:!this.args?.compositeEditorOptions&&this.columnEditor.required,validator:this.validator})}applyInputUsabilityState(){const e=this.grid.getActiveCell(),t=this.grid.onBeforeEditCell.notify({...e,item:this.dataContext,column:this.args.column,grid:this.grid,target:"composite",compositeEditorOptions:this.args.compositeEditorOptions}).getReturnValue();this.disable(!1===t)}handleChangeOnCompositeEditor(e,t,i="user",s=!1){const n=this.grid.getActiveCell(),r=this.args.column,o=this.columnDef?.id??"",a=this.dataContext,l=this.grid,h=this.serializeValue();this.validate().valid&&this.applyValue(this.dataContext,h),this.applyValue(t.formValues,h);const c=this.gridOptions?.compositeEditorOptions?.excludeDisabledFieldFormValues??!1;(s||this.disabled&&c&&t.formValues.hasOwnProperty(o))&&delete t.formValues[o],l.onCompositeEditorChange.notify({...n,item:a,grid:l,column:r,formValues:t.formValues,editors:t.editors,triggeredBy:i},new bs(e))}handleSelect(e){if(void 0!==e){const t=e;this._currentValue=t,this._isValueTouched=!0;const i=this.args.compositeEditorOptions,s=this.editorOptions?.renderItem??!1,n="string"==typeof t?t:s?t[this.labelName]:t.label;if(this.setValue(n),i?this.handleChangeOnCompositeEditor(null,i):this.save(),"function"==typeof this.editorOptions.onSelectItem){const{row:t,cell:i}=this.grid.getActiveCell()||{};this.editorOptions.onSelectItem(e,t,i,this.args.column,this.args.item)}window.setTimeout((()=>this._lastTriggeredByClearInput=!1))}return!1}renderRegularItem(e){return ie("div",{textContent:("string"==typeof e?e:e?.label??"")||""})}renderCustomItem(e){const t=this._autocompleterOptions?.renderItem?.templateCallback(e)??"",i=document.createElement("div");return this.grid.applyHtmlCode(i,t),i}renderCollectionItem(e){const t=this.columnEditor?.enableRenderHtml??!1,i=(e.labelPrefix||"")+(e.label||"")+(e.labelSuffix||""),s=this.grid.sanitizeHtmlString(i)||"",n=document.createElement("div");return n[t?"innerHTML":"textContent"]=s,n}renderDomElement(e){const t=this.columnDef?.id??"",i=this.columnEditor?.placeholder??"",s=this.columnEditor?.title??"";this._editorInputGroupElm=ie("div",{className:"autocomplete-container input-group"});const n=ie("span",{className:"input-group-btn input-group-append",dataset:{clear:""}});this._clearButtonElm=ie("button",{type:"button",className:"btn btn-default btn-clear"}),this._clearButtonElm.appendChild(ie("i",{className:"icon-clear"})),this._inputElm=ie("input",{type:"text",placeholder:i,title:s,autocomplete:"off",ariaAutoComplete:"none",className:`autocomplete form-control editor-text input-group-editor editor-${t}`,dataset:{input:""}},this._editorInputGroupElm),this._editorInputGroupElm.appendChild(document.createElement("span")),this.editorOptions?.hideClearButton||(n.appendChild(this._clearButtonElm),this._editorInputGroupElm.appendChild(n),this._bindEventService.bind(this._clearButtonElm,"click",(()=>this.clear()))),this._bindEventService.bind(this._inputElm,"focus",(()=>this._inputElm?.select())),this._bindEventService.bind(this._inputElm,"keydown",(e=>{this._lastInputKeyEvent=e,"ArrowLeft"!==e.key&&"ArrowRight"!==e.key&&"Home"!==e.key&&"End"!==e.key||e.stopImmediatePropagation(),"Enter"===e.key&&""===e.target.value&&this.columnEditor.alwaysSaveOnEnterKey&&(this._currentValue=null)}));let r=e;if(r&&this.columnEditor?.collectionOverride){const e={column:this.columnDef,dataContext:this.dataContext,grid:this.grid,originalCollections:this.collection};if(this.args.compositeEditorOptions){const{formValues:t,modalType:i}=this.args.compositeEditorOptions;e.compositeEditorOptions={formValues:t,modalType:i}}r=this.columnEditor.collectionOverride(r,e)}r&&(this.finalCollection=r),Array.isArray(r)&&(r=this.collection.every((e=>Be(e)))?r.map((e=>({label:e,value:e}))):r.map((e=>({label:e?.[this.labelName],value:e?.[this.valueName],labelPrefix:e?.[this.labelPrefixName]??"",labelSuffix:e?.[this.labelSuffixName]??""}))),this._elementCollection=r),this._autocompleterOptions={input:this._inputElm,debounceWaitMs:200,className:`slick-autocomplete ${this.editorOptions?.className??""}`.trim(),emptyMsg:this.gridOptions.enableTranslate&&this._translater?.translate?this._translater.translate("NO_ELEMENTS_FOUND"):this._locales?.TEXT_NO_ELEMENTS_FOUND??"No elements found",customize:(e,t,i)=>{i.style.width=""},onSelect:this.handleSelect.bind(this),...this.editorOptions},this.gridOptions?.darkMode&&(this._autocompleterOptions.className+=" slick-dark-mode"),this.autocompleterOptions.className=se(this.autocompleterOptions.className).join(" "),this._autocompleterOptions.renderItem?.layout?(this._autocompleterOptions.className+=` autocomplete-custom-${qe(this._autocompleterOptions.renderItem.layout)}`,this._autocompleterOptions.render=this.renderCustomItem.bind(this)):Array.isArray(e)?this._autocompleterOptions.render=this._autocompleterOptions.render?.bind(this)??this.renderCollectionItem.bind(this):this._autocompleterOptions.render||(this._autocompleterOptions.render=this.renderRegularItem.bind(this)),this._autocompleterOptions?.fetch?(Gt(this._inputElm,this._autocompleterOptions),this._instance=Vt(this._autocompleterOptions)):this._instance=Vt({...this._autocompleterOptions,fetch:(e,t)=>{r&&t(r.filter((t=>(("string"==typeof t?t:t?.label)||"").toLowerCase().includes(e.toLowerCase()))))}}),this.args.container.appendChild(this._editorInputGroupElm),this.args.compositeEditorOptions||window.setTimeout((()=>this.focus()),50)}},checkbox:class{constructor(e){if(this.args=e,this._isValueTouched=!1,this.disabled=!1,!e)throw new Error("[Slickgrid-Universal] Something is wrong with this grid, an Editor must always have valid arguments.");this.grid=e.grid,this.gridOptions=this.grid.getOptions()||{},this._bindEventService=new Wt,this.init()}get columnDef(){return this.args.column}get columnEditor(){return this.columnDef?.editor||{}}get dataContext(){return this.args.item}get editorDomElement(){return this._input}get hasAutoCommitEdit(){return this.gridOptions.autoCommitEdit??!1}get validator(){return this.columnEditor?.validator??this.columnDef?.validator}init(){const e=this.columnDef?.id??"",t=this.args.compositeEditorOptions;this._checkboxContainerElm=ie("div",{className:`checkbox-editor-container editor-${e}`}),this._input=ie("input",{type:"checkbox",value:"true",ariaLabel:this.columnEditor?.ariaLabel??`${Ke(e+"")} Checkbox Editor`,className:`editor-checkbox editor-${e}`,title:this.columnEditor?.title??""});const i=this.args?.container;i&&"function"==typeof i.appendChild&&(t?(this._checkboxContainerElm.appendChild(this._input),i.appendChild(this._checkboxContainerElm)):i.appendChild(this._input)),this.hasAutoCommitEdit&&!t&&this._bindEventService.bind(this._input,"click",(()=>{this._isValueTouched=!0,this.save()})),t?this._bindEventService.bind(this._input,"change",(e=>{this._isValueTouched=!0,this.handleChangeOnCompositeEditor(e,t)})):this.focus()}destroy(){this._bindEventService.unbindAll(),this._input?.remove?.()}disable(e=!0){const t=this.disabled;if(this.disabled=e,this._input)if(e){this._input.setAttribute("disabled","disabled"),this._checkboxContainerElm.classList.add("disabled");const i=this.getValue();t!==e&&this.args?.compositeEditorOptions&&!1!==i&&this.reset(!1,!0,!0)}else this._input.removeAttribute("disabled"),this._checkboxContainerElm.classList.remove("disabled")}focus(){this.grid.focus(),this._input?.focus()}preClick(){this._input&&(this._input.checked=!this._input.checked)}show(){this.args?.compositeEditorOptions&&this.applyInputUsabilityState()}getValue(){return this._input?.checked??!1}setValue(e,t=!1,i=!0){const s=!!e;if(this._input&&(this._input.checked=s),t){this.applyValue(this.args.item,this.serializeValue());const e=this.args.compositeEditorOptions;e&&i&&this.handleChangeOnCompositeEditor(null,e,"system")}}applyValue(e,t){const i=this.columnDef&&this.columnDef.field;if(void 0!==i){const s=i?.indexOf(".")>0,n=this.validate(null,t),r=n&&n.valid?t:"";s?Ue(e,this.columnEditor?.complexObjectPath??i??"",r):e[i]=r}}isValueChanged(){return this.serializeValue()!==this._originalValue}isValueTouched(){return this._isValueTouched}loadValue(e){const t=this.columnDef&&this.columnDef.field;if(e&&void 0!==t&&this._input){const i=t?.indexOf(".")>0?U(e,t):e[t];this._originalValue=i,this._input.checked=!!this._originalValue}}reset(e,t=!0,i=!1){const s=e??this._originalValue??!1;this._input&&(this._originalValue=s,this._input.checked=!!s),this._isValueTouched=!1;const n=this.args.compositeEditorOptions;if(n&&t){const e=!i;this.handleChangeOnCompositeEditor(null,n,"user",e)}}save(){const e=this.validate(),t=e&&e.valid||!1;this.hasAutoCommitEdit&&t?this.grid.getEditorLock().commitCurrentEdit():this.args.commitChanges()}serializeValue(){return this._input?.checked??!1}validate(e,t){const i=!this.args?.compositeEditorOptions&&this.columnEditor.required,s=void 0!==t?t:this._input?.checked,n=this.columnEditor.errorMessage;return this.args.compositeEditorOptions&&this.applyInputUsabilityState(),this.disabled?{valid:!0,msg:""}:this.validator?this.validator(s,this.args):i&&!s?{valid:!1,msg:n||y.VALIDATION_REQUIRED_FIELD}:{valid:!0,msg:null}}applyInputUsabilityState(){const e=this.grid.getActiveCell(),t=this.grid.onBeforeEditCell.notify({...e,item:this.dataContext,column:this.args.column,grid:this.grid,target:"composite",compositeEditorOptions:this.args.compositeEditorOptions}).getReturnValue();this.disable(!1===t)}handleChangeOnCompositeEditor(e,t,i="user",s=!1){const n=this.grid.getActiveCell(),r=this.args.column,o=this.columnDef?.id??"",a=this.dataContext,l=this.grid,h=this.serializeValue();this.validate().valid&&this.applyValue(this.dataContext,h),this.applyValue(t.formValues,h);const c=this.gridOptions?.compositeEditorOptions?.excludeDisabledFieldFormValues??!1;(s||this.disabled&&c&&t.formValues.hasOwnProperty(o))&&delete t.formValues[o],l.onCompositeEditorChange.notify({...n,item:a,grid:l,column:r,formValues:t.formValues,editors:t.editors,triggeredBy:i},new bs(e))}},date:class{constructor(e){if(this.args=e,this._isValueTouched=!1,this._lastClickIsDate=!1,this._lastTriggeredByClearDate=!1,this.hasTimePicker=!1,this.disabled=!1,!e)throw new Error("[Slickgrid-Universal] Something is wrong with this grid, an Editor must always have valid arguments.");this.grid=e.grid,this.gridOptions=this.grid.getOptions()||{},this.gridOptions?.translater&&(this._translaterService=this.gridOptions.translater),this._bindEventService=new Wt,this.init()}get columnDef(){return this.args.column}get columnEditor(){return this.columnDef?.editor||{}}get dataContext(){return this.args.item}get editorDomElement(){return this._inputElm}get editorOptions(){return{...this.gridOptions.defaultEditorOptions?.date,...this.columnEditor?.editorOptions}}get hasAutoCommitEdit(){return this.gridOptions.autoCommitEdit??!1}get pickerOptions(){return this._pickerMergedOptions}get validator(){return this.columnEditor?.validator??this.columnDef?.validator}async init(){if(this.args&&this.columnDef){const e=this.args.compositeEditorOptions,t=this.columnDef?.id??"",i=this.args.grid.getOptions()||{};this.defaultDate=this.args.item?.[this.columnDef.field];const s=this.columnDef.outputType||this.columnEditor.type||this.columnDef.type||E.dateUtc,n=Lt(s),r=this._translaterService?.getCurrentLanguage?.()||i.locale||"en";n&&("ISO8601"===n||n.toLowerCase().includes("h"))&&(this.hasTimePicker=!0);const o=Lt(this.hasTimePicker?E.dateTimeIsoAM_PM:E.dateIso),a={input:!0,jumpToSelectedDate:!0,sanitizer:e=>this.grid.sanitizeHtmlString(e),toggleSelected:!1,actions:{clickDay:()=>{this._lastClickIsDate=!0},changeToInput:(e,t)=>{if(t.HTMLInputElement){let e="";if(t.selectedDates[0]?(e=t.selectedDates[0],t.HTMLInputElement.value=Mt(t.selectedDates[0],void 0,s)):t.HTMLInputElement.value="",e&&this.hasTimePicker){const i=Pt(e,o);i.setHours(+(t.selectedHours||0)),i.setMinutes(+(t.selectedMinutes||0)),t.HTMLInputElement.value=Mt(i,void 0,s)}this._lastClickIsDate&&(this.handleOnDateChange(),t.hide())}}},settings:{lang:r,iso8601:!1,visibility:{theme:this.gridOptions?.darkMode?"dark":"light",positionToInput:"auto",weekend:!1}}};this.hasTimePicker&&(a.settings.selection={time:24}),this._pickerMergedOptions=Te(!0,{},a,{settings:this.editorOptions,type:"default"});const l=`.editor-text.date-picker.editor-${t}.form-control.input-group-editor`;this._editorInputGroupElm=ie("div",{className:"vanilla-picker input-group"});const h=ie("span",{className:"input-group-btn input-group-append",dataset:{clear:""}});this._clearButtonElm=ie("button",{type:"button",className:"btn btn-default btn-clear"}),this._clearButtonElm.appendChild(ie("i",{className:"icon-clear"})),this._inputElm=ie("input",{placeholder:this.columnEditor?.placeholder??"",title:this.columnEditor&&this.columnEditor.title||"",className:l.replace(/\./g," "),dataset:{input:"",defaultdate:this.defaultDate},readOnly:!0!==this.columnEditor.editorOptions?.allowInput},this._editorInputGroupElm),this.args.container.appendChild(this._editorInputGroupElm),this.columnEditor.editorOptions?.hideClearButton||(h.appendChild(this._clearButtonElm),this._editorInputGroupElm.appendChild(h),this._bindEventService.bind(this._clearButtonElm,"click",(()=>{this.clear(),this.handleOnDateChange()}))),this._bindEventService.bind(this._inputElm,"keydown",(e=>{!0===this.columnEditor.editorOptions?.allowInput&&(this._isValueTouched=!0,this._lastInputKeyEvent=e,"ArrowLeft"!==e.key&&"ArrowRight"!==e.key&&"Home"!==e.key&&"End"!==e.key||e.stopImmediatePropagation())})),queueMicrotask((()=>{this.calendarInstance=new ms(this._inputElm,this._pickerMergedOptions),this.calendarInstance.init(),e||(this.show(),this.focus()),this.calendarInstance&&qt(this.columnEditor,this._inputElm,this.calendarInstance,{columnDef:this.columnDef,newVal:this.defaultDate,updatePickerUI:!0})}))}}destroy(){queueMicrotask((()=>{this.hide(),this.calendarInstance?.destroy(),re(this._editorInputGroupElm),re(this._inputElm),this._editorInputGroupElm?.remove(),this._inputElm?.remove()})),this._bindEventService.unbindAll()}clear(){this._lastTriggeredByClearDate=!0,this.calendarInstance&&(this.calendarInstance.settings.selected.dates=[],this._inputElm.value="")}disable(e=!0){const t=this.disabled;if(this.disabled=e,this._inputElm)if(e){this._inputElm.setAttribute("disabled","disabled"),this._clearButtonElm.disabled=!0;const i=this.getValue();t!==e&&this.args?.compositeEditorOptions&&""!==i&&this.reset("",!0,!0)}else this._inputElm.removeAttribute("disabled"),this._clearButtonElm.disabled=!1}changeEditorOption(e,t){this.columnEditor.editorOptions||(this.columnEditor.editorOptions={}),this.columnEditor.editorOptions[e]=t,this._pickerMergedOptions=Te(!0,{},this._pickerMergedOptions,{settings:{[e]:t}})}focus(){this.grid.focus(),this.show(),this._inputElm?.focus()}hide(){this.calendarInstance?.hide()}show(){const e=!!this.args?.compositeEditorOptions;!e&&this.calendarInstance?this.calendarInstance.show():e&&this.applyInputUsabilityState()}getValue(){return this._inputElm.value}setValue(e,t=!1,i=!0){if(this.calendarInstance&&qt(this.columnEditor,this._inputElm,this.calendarInstance,{columnDef:this.columnDef,newVal:e,updatePickerUI:!0}),t){this.applyValue(this.args.item,this.serializeValue());const e=this.args.compositeEditorOptions;e&&i&&this.handleChangeOnCompositeEditor(e,"system")}}applyValue(e,t){const i=this.columnDef?.field;if(this.columnDef&&void 0!==i){const s=this.columnDef.saveOutputType||this.columnDef.outputType||this.columnEditor.type||this.columnDef.type||E.dateUtc,n=this.columnDef.outputType||this.columnEditor.type||this.columnDef.type||E.dateUtc,r=i.indexOf(".")>0,o=this.validate(null,t),a=t&&o?.valid?Mt(t,n,s):"";r?Ue(e,this.columnEditor?.complexObjectPath??i,a):e[i]=a}}isValueChanged(){let e=!1;const t=this.getValue(),i=this._lastInputKeyEvent?.key;return!(!0!==this.columnEditor.editorOptions?.allowInput||!this.columnEditor?.alwaysSaveOnEnterKey||"Enter"!==i)||(this.columnDef&&(e=this._lastTriggeredByClearDate||!(""===t&&""===this._originalDate)&&t!==this._originalDate),e)}isValueTouched(){return this._isValueTouched}loadValue(e){const t=this.columnDef?.field;if(e&&this.columnDef&&void 0!==t){const i=t?.indexOf(".")>0?U(e,t):e[t],s=this.columnEditor.type||this.columnDef?.type||E.dateIso,n=this.columnDef.outputType||this.columnEditor.type||this.columnDef.type||E.dateIso;this._originalDate=Mt(i,s,n),this._inputElm.value=this._originalDate}}reset(e,t=!0,i=!1){const s=e??this._originalDate??"";this.calendarInstance&&(this._originalDate=s,this.calendarInstance.settings.selected.dates=[s],s||(this.calendarInstance.settings.selected.dates=[],this._inputElm.value="")),this._isValueTouched=!1;const n=this.args.compositeEditorOptions;if(n&&t){const e=!i;this.handleChangeOnCompositeEditor(n,"user",e)}}save(){const e=this.validate(),t=e?.valid??!1;this.hasAutoCommitEdit&&t?this.grid.getEditorLock().commitCurrentEdit():this.args.commitChanges()}serializeValue(){return this.getValue()||""}validate(e,t){const i=!this.args?.compositeEditorOptions&&this.columnEditor.required,s=t??this._inputElm?.value,n=this.columnEditor.errorMessage;return this.args.compositeEditorOptions&&this.applyInputUsabilityState(),this.disabled?{valid:!0,msg:""}:this.validator?this.validator(s,this.args):i&&""===s?{valid:!1,msg:n||y.VALIDATION_REQUIRED_FIELD}:{valid:!0,msg:null}}applyInputUsabilityState(){const e=this.grid.getActiveCell(),t=this.grid.onBeforeEditCell.notify({...e,item:this.dataContext,column:this.args.column,grid:this.grid,target:"composite",compositeEditorOptions:this.args.compositeEditorOptions}).getReturnValue();this.disable(!1===t)}handleOnDateChange(){if(this._isValueTouched=!0,this.args){const e=this.args.compositeEditorOptions;e?this.handleChangeOnCompositeEditor(e):this.save()}window.setTimeout((()=>this._lastTriggeredByClearDate=!1))}handleChangeOnCompositeEditor(e,t="user",i=!1){const s=this.grid.getActiveCell(),n=this.args.column,r=this.columnDef?.id??"",o=this.dataContext,a=this.grid,l=this.serializeValue();this.validate().valid&&this.applyValue(this.dataContext,l),this.applyValue(e.formValues,l);const h=this.gridOptions?.compositeEditorOptions?.excludeDisabledFieldFormValues??!1;(i||this.disabled&&h&&e.formValues.hasOwnProperty(r))&&delete e.formValues[r],a.onCompositeEditorChange.notify({...s,item:o,grid:a,column:n,formValues:e.formValues,editors:e.editors,triggeredBy:t},new bs)}},dualInput:class{constructor(e){if(this.args=e,this._isValueSaveCalled=!1,this._isLeftValueTouched=!1,this._isRightValueTouched=!1,this.disabled=!1,!e)throw new Error("[Slickgrid-Universal] Something is wrong with this grid, an Editor must always have valid arguments.");this.grid=e.grid,this.gridOptions=this.grid.getOptions()||{},this._eventHandler=new Cs,this._bindEventService=new Wt,this.init(),this._eventHandler.subscribe(this.grid.onValidationError,(()=>this._isValueSaveCalled=!0))}get columnDef(){return this.args.column}get columnEditor(){return this.columnDef?.editor||{}}get dataContext(){return this.args.item}get editorDomElement(){return{leftInput:this._leftInput,rightInput:this._rightInput}}get editorParams(){return this.columnEditor.params||{}}get eventHandler(){return this._eventHandler}get hasAutoCommitEdit(){return this.gridOptions.autoCommitEdit??!1}get isValueSaveCalled(){return this._isValueSaveCalled}get validator(){return this.columnEditor?.validator??this.columnDef?.validator}init(){if(!(this.editorParams&&this.editorParams.leftInput&&this.editorParams.leftInput.field&&this.editorParams.rightInput&&this.editorParams.rightInput.field))throw new Error("[Slickgrid-Universal] Please make sure that your Combo Input Editor has params defined with \"leftInput\" and \"rightInput\" (example: { editor: { model: Editors.comboInput, params: { leftInput: { field: 'firstName' }, { rightSide: { field: 'lastName' } }}}");this._leftFieldName=this.editorParams.leftInput?.field,this._rightFieldName=this.editorParams.rightInput?.field,this._leftInput=this.createInput("leftInput"),this._rightInput=this.createInput("rightInput");const e=this.args?.container;e&&"function"==typeof e.appendChild&&(e.appendChild(this._leftInput),e.appendChild(this._rightInput)),this._bindEventService.bind(this._leftInput,"keydown",(e=>this.handleKeyDown(e,"leftInput"))),this._bindEventService.bind(this._rightInput,"keydown",(e=>this.handleKeyDown(e,"rightInput"))),this.hasAutoCommitEdit&&(this._bindEventService.bind(this._leftInput,"focusout",(e=>this.handleFocusOut(e,"leftInput"))),this._bindEventService.bind(this._rightInput,"focusout",(e=>this.handleFocusOut(e,"rightInput"))));const t=this.args?.compositeEditorOptions;t?(this._bindEventService.bind(this._leftInput,"input",this.handleChangeOnCompositeEditorDebounce.bind(this)),this._bindEventService.bind(this._rightInput,"input",this.handleChangeOnCompositeEditorDebounce.bind(this))):window.setTimeout((()=>this._leftInput.select()),50)}handleFocusOut(e,t){const i=e.relatedTarget?.className||"";this.args.compositeEditorOptions||-1!==i.indexOf("dual-editor")||"focusout-right"===this._lastEventType||("rightInput"===t||"leftInput"===t&&"focusout-left"!==this._lastEventType)&&("leftInput"===t?this._isLeftValueTouched=!0:this._isRightValueTouched=!0,this.save());const s="leftInput"===t?"left":"right";this._lastEventType=`${e?.type}-${s}`}handleKeyDown(e,t){"leftInput"===t?this._isLeftValueTouched=!0:this._isRightValueTouched=!0,this._lastInputKeyEvent=e,"ArrowLeft"!==e.key&&"ArrowRight"!==e.key&&"Home"!==e.key&&"End"!==e.key&&"Tab"!==e.key||e.stopImmediatePropagation()}destroy(){this._eventHandler.unsubscribeAll(),this._bindEventService.unbindAll(),this._leftInput?.remove?.(),this._rightInput?.remove?.()}createInput(e){const t=this.editorParams[e],i=this.columnDef?.id??"",s=this.gridOptions.datasetIdPropertyName||"id",n=this.args?.item?.[s]??"";let r=t.type||"text";"float"!==r&&"integer"!==r||(r="number");const o=ie("input",{type:r||"text",id:`item-${n}-${e}`,ariaLabel:this.columnEditor?.ariaLabel??`${Ke(i+"")} Input Editor`,className:`dual-editor-text editor-${i} ${e.replace(/input/gi,"")}`,autocomplete:"off",ariaAutoComplete:"none",placeholder:t.placeholder||"",title:t.title||""});return"readonly"===r&&(o.readOnly=!0,r="text"),"number"===r&&(o.step=this.getInputDecimalSteps(e)),o}disable(e=!0){const t=this.disabled;this.disabled=e,this._leftInput&&this._rightInput&&(e?(this._leftInput.setAttribute("disabled","disabled"),this._rightInput.setAttribute("disabled","disabled"),t!==e&&this.args?.compositeEditorOptions&&this.reset("",!0,!0)):(this._leftInput.removeAttribute("disabled"),this._rightInput.removeAttribute("disabled")))}focus(){this.grid.focus()}show(){this.args?.compositeEditorOptions&&this.applyInputUsabilityState()}getValues(){const e={},t=this._leftInput.value,i=this._rightInput.value,s=this.editorParams.leftInput&&("float"===this.editorParams.leftInput.type||"integer"===this.editorParams.leftInput.type),n=this.editorParams.rightInput&&("float"===this.editorParams.rightInput.type||"integer"===this.editorParams.rightInput.type),r=""!==t&&s?+this._leftInput.value:t||"",o=""!==i&&n?+this._rightInput.value:i||"";return Ue(e,this._leftFieldName,r),Ue(e,this._rightFieldName,o),e}setValues(e){Array.isArray(e)&&2===e.length&&(this._leftInput.value=`${e[0]}`,this._rightInput.value=`${e[1]}`)}applyValue(e,t){this.applyValueByPosition(e,t,"leftInput"),this.applyValueByPosition(e,t,"rightInput")}applyValueByPosition(e,t,i){const s="leftInput"===i?this._leftFieldName:this._rightFieldName;if(void 0!==s){const n=s?.indexOf(".")>0;let r=s;if(n){const e=s.split(/\.(.*)/);r=e.length>1?e[1]:e}const o=n?U(t,r):t[s],a=this.validate(null,{position:i,inputValue:o});if(n){const i=U(t,r),n=a&&a.valid?i:"";Ue(e,this.columnEditor?.complexObjectPath??s??"",n)}else s&&(e[s]=a&&a.valid?t[s]:"")}}isValueChanged(){const e=this._leftInput.value,t=this._rightInput.value,i=this.editorParams?.leftInput,s=this.editorParams?.rightInput,n=this._lastInputKeyEvent?.key;if((i&&i.alwaysSaveOnEnterKey||s&&s.alwaysSaveOnEnterKey)&&"Enter"===n)return!0;const r=!(""===e&&(null===this._originalLeftValue||void 0===this._originalLeftValue))&&e!==this._originalLeftValue,o=!(""===t&&(null===this._originalRightValue||void 0===this._originalRightValue))&&t!==this._originalRightValue;return r||o}isValueTouched(){return this._isLeftValueTouched||this._isRightValueTouched}loadValue(e){this.loadValueByPosition(e,"leftInput"),this.loadValueByPosition(e,"rightInput"),this._leftInput.select()}loadValueByPosition(e,t){const i="leftInput"===t?this._leftFieldName:this._rightFieldName,s="leftInput"===t?"_originalLeftValue":"_originalRightValue",n="leftInput"===t?"_leftInput":"_rightInput";if(e&&void 0!==i){const r=i?.indexOf(".")>0?U(e,i):e.hasOwnProperty(i)?e[i]:"";if(this[s]=r,"float"===this.editorParams[t].type){const e=this.getDecimalPlaces(t);null===e||!this[s]&&0!==this[s]||void 0===this[s]||(this[s]=(+this[s]).toFixed(e))}this[n]&&(this[n].value=`${this[s]}`)}}reset(e,t=!0,i=!1){const s=e??this._originalLeftValue??"",n=e??this._originalRightValue??"";this._leftInput&&this._rightInput&&(this._originalLeftValue=s,this._originalRightValue=n,this._leftInput.value=`${s}`,this._rightInput.value=`${n}`),this._isLeftValueTouched=!1,this._isRightValueTouched=!1;const r=this.args.compositeEditorOptions;if(r&&t){const e=!i;this.handleChangeOnCompositeEditor(null,r,"user",e)}}save(){const e=this.validate(),t=e&&e.valid||!1;this._isValueSaveCalled||(this.hasAutoCommitEdit&&t?this.grid.getEditorLock().commitCurrentEdit():this.args.commitChanges(),this._isValueSaveCalled=!0)}serializeValue(){const e={},t=this.serializeValueByPosition("leftInput"),i=this.serializeValueByPosition("rightInput");return Ue(e,this._leftFieldName,t),Ue(e,this._rightFieldName,i),e}serializeValueByPosition(e){const t="leftInput"===e?this._leftInput.value:this._rightInput.value;if(""===t||isNaN(+t))return t;let i=parseFloat(t);const s=this.getDecimalPlaces(e);return null!==s&&(i||0===i)&&i.toFixed&&(i=parseFloat(i.toFixed(s))),i}getDecimalPlaces(e){const t="leftInput"===e?"leftInput":"rightInput",i=this.editorParams[t],s=i?.decimal;return void 0===s?0:s}getInputDecimalSteps(e){const t=this.getDecimalPlaces(e);let i="";for(let e=1;e<t;e++)i+="0";return t>0?`0.${i}1`:"1"}validate(e,t){if(this.args.compositeEditorOptions&&this.applyInputUsabilityState(),this.disabled)return{valid:!0,msg:""};if(t){const e=this.validateByPosition(t.position,t.inputValue);if(!e.valid)return"leftInput"===t.position?this._leftInput.select():this._rightInput.select(),e}else{const e=this.validateByPosition("leftInput"),t=this.validateByPosition("rightInput");if(!e.valid)return this._leftInput.select(),e;if(!t.valid)return this._rightInput.select(),t}return{valid:!0,msg:""}}validateByPosition(e,t){const i=this.editorParams[e];let s="";if(t)s=t;else{const t="leftInput"===e?this._leftInput:this._rightInput;s=t&&t.value}const n=this.validator;s="function"==typeof n?this.getValues():s;const r={editorArgs:this.args,errorMessage:i.errorMessage,required:!this.args?.compositeEditorOptions&&i.required,validator:"function"==typeof n?n:i.validator};switch(i.type){case"float":return Pa(s,{...r,decimal:this.getDecimalPlaces(e),minValue:i.minValue,maxValue:i.maxValue,operatorConditionalType:i.operatorConditionalType});case"integer":return La(s,{...r,minValue:i.minValue,maxValue:i.maxValue,operatorConditionalType:i.operatorConditionalType});default:return Ra(s,r)}}applyInputUsabilityState(){const e=this.grid.getActiveCell(),t=this.grid.onBeforeEditCell.notify({...e,item:this.dataContext,column:this.args.column,grid:this.grid,target:"composite",compositeEditorOptions:this.args.compositeEditorOptions}).getReturnValue();this.disable(!1===t)}handleChangeOnCompositeEditor(e,t,i="user",s=!1){const n=this.grid.getActiveCell(),r=this.args.column,o=this.columnEditor.params?.leftInput?.field??"",a=this.columnEditor.params?.rightInput?.field??"",l=this.dataContext,h=this.grid,c=this.serializeValue();this.validate().valid&&this.applyValue(this.dataContext,c),this.applyValue(t.formValues,c);const d=this.gridOptions?.compositeEditorOptions?.excludeDisabledFieldFormValues??!1;(s||this.disabled&&d&&t.formValues.hasOwnProperty(o))&&delete t.formValues[o],(s||this.disabled&&d&&t.formValues.hasOwnProperty(a))&&delete t.formValues[a],h.onCompositeEditorChange.notify({...n,item:l,grid:h,column:r,formValues:t.formValues,editors:t.editors,triggeredBy:i},new bs(e))}handleChangeOnCompositeEditorDebounce(e){const t=this.args?.compositeEditorOptions;if(t){const i=this.gridOptions?.editorTypingDebounce??500;window.clearTimeout(this._timer),this._timer=window.setTimeout((()=>this.handleChangeOnCompositeEditor(e,t)),i)}}},float:class extends Ma{constructor(e){super(e,"number"),this.args=e}loadValue(e){const t=this.columnDef&&this.columnDef.field;if(void 0!==t&&e&&void 0!==t&&this._input){const i=t?.indexOf(".")>0?U(e,t):e[t];this._originalValue=i;const s=this.getDecimalPlaces();null===s||!this._originalValue&&0!==this._originalValue||void 0===this._originalValue||(this._originalValue=(+this._originalValue).toFixed(s)),this._input.value=`${this._originalValue}`,this._input.select()}}serializeValue(){const e=this._input?.value;if(void 0===e||""===e||isNaN(+e))return e;let t=parseFloat(e);const i=this.getDecimalPlaces();return null!==i&&(t||0===t)&&t.toFixed&&(t=parseFloat(t.toFixed(i))),t}validate(e,t){return this.args.compositeEditorOptions&&this.applyInputUsabilityState(),this.disabled?{valid:!0,msg:""}:Pa(void 0!==t?t:this._input?.value,{editorArgs:this.args,errorMessage:this.columnEditor.errorMessage,decimal:this.getDecimalPlaces(),minValue:this.columnEditor.minValue,maxValue:this.columnEditor.maxValue,operatorConditionalType:this.columnEditor.operatorConditionalType,required:!this.args?.compositeEditorOptions&&this.columnEditor.required,validator:this.validator})}},integer:class extends Ma{constructor(e){super(e,"number"),this.args=e}loadValue(e){const t=this.columnDef?.field;if(void 0!==t&&e&&void 0!==t&&this._input){const i=t?.indexOf(".")>0?U(e,t):e[t];this._originalValue=isNaN(i)||null==i?i:`${i}`,this._input.value=`${this._originalValue}`,this._input.select()}}serializeValue(){const e=this._input?.value;if(void 0===e||""===e||isNaN(+e))return e;const t=isNaN(+e)?e:parseInt(e,10);return isNaN(+t)?e:t}validate(e,t){return this.args.compositeEditorOptions&&this.applyInputUsabilityState(),this.disabled?{valid:!0,msg:""}:La(void 0!==t?t:this.getValue(),{editorArgs:this.args,errorMessage:this.columnEditor.errorMessage,minValue:this.columnEditor.minValue,maxValue:this.columnEditor.maxValue,operatorConditionalType:this.columnEditor.operatorConditionalType,required:!this.args?.compositeEditorOptions&&this.columnEditor.required,validator:this.validator})}handleOnMouseWheel(e){this._isValueTouched=!0;const t=this.args.compositeEditorOptions;t&&this.handleChangeOnCompositeEditor(e,t)}},longText:class{constructor(e){if(this.args=e,this._isValueTouched=!1,this.disabled=!1,!e)throw new Error("[Slickgrid-Universal] Something is wrong with this grid, an Editor must always have valid arguments.");this.grid=e.grid,this.gridOptions=e.grid?.getOptions();const t=this.gridOptions||this.args.column.params||{};t?.translater&&(this._translater=t.translater),this._locales=this.gridOptions?.locales||y.locales,this._bindEventService=new Wt,this.init()}get columnDef(){return this.args.column}get columnEditor(){return this.columnDef?.editor??{}}get dataContext(){return this.args.item}get editorDomElement(){return this._textareaElm}get editorOptions(){return{...this.gridOptions.defaultEditorOptions?.longText,...this.columnEditor?.editorOptions}}get hasAutoCommitEdit(){return this.gridOptions?.autoCommitEdit??!1}get validator(){return this.columnEditor?.validator??this.columnDef?.validator}init(){let e="",t="";if(this._translater&&this._translater.translate&&this.gridOptions.enableTranslate){const i=j(this.gridOptions),s=this.editorOptions.buttonTexts?.cancelKey??`${i}CANCEL`,n=this.editorOptions.buttonTexts?.saveKey??`${i}SAVE`;e=this._translater.translate(`${i}${s}`),t=this._translater.translate(`${i}${n}`)}else e=this.editorOptions.buttonTexts?.cancel??this._locales?.TEXT_CANCEL??"Cancel",t=this.editorOptions.buttonTexts?.save??this._locales?.TEXT_SAVE??"Save";const i=this.args.compositeEditorOptions,s=this.columnDef?.id??"",n=this.columnEditor?.maxLength,r=this.editorOptions?.rows??4,o=i?this.args.container:document.body;this._wrapperElm=ie("div",{className:`slick-large-editor-text editor-${s}`,style:{position:i?"relative":"absolute"}}),this.gridOptions?.darkMode&&this._wrapperElm.classList.add("slick-dark-mode"),o.appendChild(this._wrapperElm),this._textareaElm=ie("textarea",{ariaLabel:this.columnEditor?.ariaLabel??`${Ke(s+"")} Text Editor`,cols:this.editorOptions?.cols??40,rows:i&&r>3?3:r,placeholder:this.columnEditor?.placeholder??"",title:this.columnEditor?.title??""},this._wrapperElm);const a=ie("div",{className:"editor-footer"}),l=ie("span",{className:"counter"});if(this._currentLengthElm=ie("span",{className:"text-length",textContent:"0"}),l.appendChild(this._currentLengthElm),void 0!==n&&(l.appendChild(ie("span",{className:"separator",textContent:"/"})),l.appendChild(ie("span",{className:"max-length",textContent:`${n}`}))),a.appendChild(l),!i){const i=ie("button",{className:"btn btn-cancel btn-default btn-xs",textContent:e},a),s=ie("button",{className:"btn btn-save btn-primary btn-xs",textContent:t},a);this._bindEventService.bind(i,"click",this.cancel.bind(this)),this._bindEventService.bind(s,"click",this.save.bind(this)),this.position(this.args?.position),this._textareaElm.focus(),this._textareaElm.select()}this._wrapperElm.appendChild(a),this._bindEventService.bind(this._textareaElm,"keydown",this.handleKeyDown.bind(this)),this._bindEventService.bind(this._textareaElm,"input",this.handleOnInputChange.bind(this)),this._bindEventService.bind(this._textareaElm,"paste",this.handleOnInputChange.bind(this))}cancel(){const e=this._defaultTextValue||"";this._textareaElm.value=e,this._currentLengthElm.textContent=`${e.length}`,this.args?.cancelChanges&&this.args.cancelChanges()}hide(){this._wrapperElm.style.display="none"}show(){this.args?.compositeEditorOptions?this.applyInputUsabilityState():this._wrapperElm.style.display="block"}destroy(){this._bindEventService.unbindAll(),this._wrapperElm?.remove?.()}disable(e=!0){const t=this.disabled;if(this.disabled=e,this._textareaElm&&this._wrapperElm)if(e){this._textareaElm.disabled=!0,this._wrapperElm.classList.add("disabled");const i=this.getValue();t!==e&&this.args?.compositeEditorOptions&&""!==i&&this.reset("",!0,!0)}else this._textareaElm.disabled=!1,this._wrapperElm.classList.remove("disabled")}focus(){this.grid.focus(),this._textareaElm&&(this._textareaElm.focus(),this._textareaElm.select())}getValue(){return this._textareaElm.value}setValue(e,t=!1,i=!0){if(this._textareaElm.value=e,this._currentLengthElm.textContent=`${e.length}`,t){this.applyValue(this.args.item,this.serializeValue());const e=this.args.compositeEditorOptions;e&&i&&this.handleChangeOnCompositeEditor(null,e,"system")}}applyValue(e,t){const i=this.columnDef?.field;if(void 0!==i){const s=i?.indexOf(".")>0,n=this.validate(void 0,t),r=n?.valid?t:"";s?Ue(e,this.columnEditor?.complexObjectPath??i??"",r):e[i]=r}}isValueChanged(){const e=this._textareaElm.value;return!(""===e&&(null===this._defaultTextValue||void 0===this._defaultTextValue))&&e!==this._defaultTextValue}isValueTouched(){return this._isValueTouched}loadValue(e){const t=this.columnDef?.field;if(e&&void 0!==t){const i=t?.indexOf(".")>0?U(e,t):e[t];this._defaultTextValue=i||"",this._textareaElm.value=this._defaultTextValue,this._currentLengthElm.textContent=this._defaultTextValue.length,this._textareaElm.defaultValue=this._defaultTextValue,this._textareaElm.select()}}position(e){const t=le(this.args.container),i=this.args.container.offsetHeight,s=this.args.container.offsetWidth,n=this._wrapperElm.getBoundingClientRect().height||this.args.position.height,r=this._wrapperElm.getBoundingClientRect().width||this.args.position.width,o=document.body.offsetHeight||window.innerHeight,a=document.body.offsetWidth||window.innerWidth;let l=this.args.container?t.top:e.top??0,h=this.args.container?t.left:e.left??0;const c=this.editorOptions?.position??"auto";("left"===c||"auto"===c&&h+r>a)&&(h-=r-s+(this.editorOptions?.marginRight??0)),("top"===c||"auto"===c&&l+n>o)&&(l-=n-i),this._wrapperElm.style.top=`${l}px`,this._wrapperElm.style.left=`${h}px`}reset(e,t=!0,i=!1){const s=e??this._defaultTextValue??"";this._textareaElm&&(this._defaultTextValue=s,this._textareaElm.value=s,this._currentLengthElm.textContent=s.length),this._isValueTouched=!1;const n=this.args.compositeEditorOptions;if(n&&t){const e=!i;this.handleChangeOnCompositeEditor(null,n,"user",e)}}save(){const e=this.validate(),t=e?.valid??!1;this.hasAutoCommitEdit&&t?this.grid.getEditorLock().commitCurrentEdit():this.args.commitChanges()}serializeValue(){return this._textareaElm.value}validate(e,t){return this.args.compositeEditorOptions&&this.applyInputUsabilityState(),this.disabled?{valid:!0,msg:""}:Ra(void 0!==t?t:this._textareaElm?.value,{editorArgs:this.args,errorMessage:this.columnEditor.errorMessage,minLength:this.columnEditor.minLength,maxLength:this.columnEditor.maxLength,operatorConditionalType:this.columnEditor.operatorConditionalType,required:!this.args?.compositeEditorOptions&&this.columnEditor.required,validator:this.validator})}applyInputUsabilityState(){const e=this.grid.getActiveCell(),t=this.grid.onBeforeEditCell.notify({...e,item:this.dataContext,column:this.args.column,grid:this.grid,target:"composite",compositeEditorOptions:this.args.compositeEditorOptions}).getReturnValue();this.disable(!1===t)}handleKeyDown(e){const t=e.key;this._isValueTouched=!0,this.args.compositeEditorOptions||("Enter"===t&&e.ctrlKey||e.ctrlKey&&"S"===e.key.toUpperCase()?(e.preventDefault(),this.save()):"Escape"===t?(e.preventDefault(),this.cancel()):"Tab"===t&&e.shiftKey?(e.preventDefault(),this.args&&this.grid&&this.grid.navigatePrev()):"Tab"===t&&(e.preventDefault(),this.args&&this.grid&&this.grid.navigateNext()))}handleOnInputChange(e){const t=this.args.compositeEditorOptions,i=this.columnEditor?.maxLength;let s=!1;if(i&&(s=this.truncateText(this._textareaElm,i)),s)this._currentLengthElm.textContent=`${i}`;else{const t="paste"===e.type?e.clipboardData.getData("text"):e.target.value;this._currentLengthElm.textContent=`${t.length}`}if(t){const i=this.gridOptions?.editorTypingDebounce??500;window.clearTimeout(this._timer),this._timer=window.setTimeout((()=>this.handleChangeOnCompositeEditor(e,t)),i)}}handleChangeOnCompositeEditor(e,t,i="user",s=!1){const n=this.grid.getActiveCell(),r=this.args.column,o=this.columnDef?.id??"",a=this.dataContext,l=this.grid,h=this.serializeValue();this.validate().valid&&this.applyValue(this.dataContext,h),this.applyValue(t.formValues,h);const c=this.gridOptions?.compositeEditorOptions?.excludeDisabledFieldFormValues??!1;(s||this.disabled&&c&&t.formValues.hasOwnProperty(o))&&delete t.formValues[o],l.onCompositeEditorChange.notify({...n,item:a,grid:l,column:r,formValues:t.formValues,editors:t.editors,triggeredBy:i},new bs(e))}truncateText(e,t){const i=e.value+"";return i.length>t&&(e.value=i.substring(0,t),!0)}},multipleSelect:class extends Na{constructor(e,t=0){super(e,!0,t),this.args=e,this.delayOpening=t}},password:class extends Ma{constructor(e){super(e,"password"),this.args=e}},singleSelect:class extends Na{constructor(e,t=0){super(e,!1,t),this.args=e,this.delayOpening=t}},slider:class{constructor(e){if(this.args=e,this._defaultValue=0,this._isValueTouched=!1,this._sliderNumberElm=null,this.disabled=!1,!e)throw new Error("[Slickgrid-Universal] Something is wrong with this grid, an Editor must always have valid arguments.");this.grid=e.grid,this.gridOptions=this.grid.getOptions()||{},this._bindEventService=new Wt,this.init()}get columnDef(){return this.args.column}get columnEditor(){return this.columnDef?.editor??{}}get dataContext(){return this.args.item}get editorDomElement(){return this._editorElm}get editorInputDomElement(){return this._inputElm}get editorOptions(){return{...this.gridOptions.defaultEditorOptions?.slider,...this.columnEditor?.editorOptions}}get hasAutoCommitEdit(){return this.gridOptions.autoCommitEdit??!1}get sliderOptions(){return this._sliderOptions}get validator(){return this.columnEditor.validator??this.columnDef?.validator}init(){if(this._cellContainerElm=this.args?.container,this._cellContainerElm&&this.columnDef){const e=this.args.compositeEditorOptions;this._editorElm=this.buildDomElement(),e||this.focus(),this._cellContainerElm.appendChild(this._editorElm),this._bindEventService.bind(this._sliderTrackElm,["click","mouseup"],this.sliderTrackClicked.bind(this)),this._bindEventService.bind(this._inputElm,["change","mouseup","touchend"],this.handleChangeEvent.bind(this)),this._bindEventService.bind(this._inputElm,["input","change"],this.handleChangeSliderNumber.bind(this))}}cancel(){this._inputElm&&(this._inputElm.value=`${this._originalValue}`),this.args.cancelChanges()}destroy(){this._bindEventService.unbindAll(),this._inputElm?.remove(),this._editorElm?.remove(),this._sliderTrackElm?.remove()}disable(e=!0){const t=this.disabled;if(this.disabled=e,this._inputElm)if(e){this._inputElm.disabled=!0;const i=this.getValue();t!==e&&this.args?.compositeEditorOptions&&""!==i&&this.reset(0,!0,!0)}else this._inputElm.disabled=!1}focus(){this.grid.focus(),this._inputElm?.focus()}show(){this.args?.compositeEditorOptions&&this.applyInputUsabilityState()}getValue(){return this._inputElm?.value??""}setValue(e,t=!1,i=!0){if(this._inputElm&&(this._inputElm.value=`${e}`),this._sliderNumberElm&&(this._sliderNumberElm.textContent=`${e}`),t){this.applyValue(this.args.item,this.serializeValue());const e=this.args.compositeEditorOptions;e&&i&&this.handleChangeOnCompositeEditor(null,e,"system")}}applyValue(e,t){const i=this.columnDef?.field??"";if(void 0!==i){const s=i?.indexOf(".")>0,n=this.validate(void 0,t),r=n&&n.valid?t:"";s?Ue(e,this.columnEditor.complexObjectPath??i??"",r):e&&(e[i]=r)}}isValueChanged(){const e=this._inputElm?.value??"";return!(""===e&&void 0===this._originalValue)&&+e!==this._originalValue}isValueTouched(){return this._isValueTouched}loadValue(e){const t=this.columnDef?.field??"";if(e&&void 0!==t){let i=t?.indexOf(".")>0?U(e,t):e.hasOwnProperty(t)?e[t]:this._defaultValue;""!==i&&null!=i||(i=this._defaultValue),this._originalValue=+i,this._inputElm&&(this._inputElm.value=`${i}`,this._inputElm.title=`${i}`),this._sliderNumberElm&&(this._sliderNumberElm.textContent=`${i}`)}this.updateTrackFilledColorWhenEnabled()}reset(e,t=!0,i=!1){const s=e??this._originalValue??0;this._inputElm&&(this._inputElm.value=`${s}`),this._sliderNumberElm&&(this._sliderNumberElm.textContent=`${s}`),this._isValueTouched=!1;const n=this.args.compositeEditorOptions;if(n&&t){const e=!i;this.handleChangeOnCompositeEditor(null,n,"user",e)}}save(){const e=this.validate(),t=e&&e.valid||!1;this.hasAutoCommitEdit&&t?this.grid.getEditorLock().commitCurrentEdit():this.args.commitChanges()}serializeValue(){const e=this._inputElm?.value??"";return""!==e?parseInt(e,10):this._originalValue}validate(e,t){return this.args.compositeEditorOptions&&this.applyInputUsabilityState(),this.disabled?{valid:!0,msg:""}:function(e,t){const i=t.required,s=t.minValue,n=t.maxValue,r=t.errorMessage,o={"{{minValue}}":s,"{{maxValue}}":n};return t.validator?t.validator(e,t.editorArgs):i&&""===e?{valid:!1,msg:r||y.VALIDATION_REQUIRED_FIELD}:void 0!==s&&void 0!==n&&null!==e&&(e<s||e>n)?{valid:!1,msg:r||y.VALIDATION_EDITOR_NUMBER_BETWEEN.replace(/{{minValue}}|{{maxValue}}/gi,(e=>o[e]))}:{valid:!0,msg:null}}(void 0!==t?t:this._inputElm?.value,{editorArgs:this.args,errorMessage:this.columnEditor.errorMessage,minValue:this.columnEditor.minValue,maxValue:this.columnEditor.maxValue,required:!this.args?.compositeEditorOptions&&this.columnEditor.required,validator:this.validator})}buildDomElement(){const e=this.columnDef?.id??"",t=this.columnEditor.title??"",i=+(this.columnEditor.minValue??y.SLIDER_DEFAULT_MIN_VALUE),s=+(this.columnEditor.maxValue??y.SLIDER_DEFAULT_MAX_VALUE),n=+(this.columnEditor.valueStep??y.SLIDER_DEFAULT_STEP),r=this.editorOptions.sliderStartValue??i;this._defaultValue=+r,this._sliderTrackElm=ie("div",{className:"slider-track"}),this._inputElm=ie("input",{type:"range",title:t,defaultValue:`${r}`,value:`${r}`,min:`${i}`,max:`${s}`,step:`${this.columnEditor.valueStep??y.SLIDER_DEFAULT_STEP}`,ariaLabel:this.columnEditor.ariaLabel??`${Ke(e+"")} Slider Editor`,className:`slider-editor-input editor-${e}`});const o=ie("div",{className:"slider-container slider-editor"}),a=ie("div",{className:"slider-input-container slider-editor"});if(a.appendChild(this._sliderTrackElm),a.appendChild(this._inputElm),o.appendChild(a),!this.editorOptions.hideSliderNumber){o.classList.add("input-group");const e=ie("div",{className:"input-group-addon input-group-append slider-value"});this._sliderNumberElm=ie("span",{className:"input-group-text",textContent:`${r}`}),e.appendChild(this._sliderNumberElm),o.appendChild(e)}return this._sliderOptions={minValue:i,maxValue:s,step:n},o}applyInputUsabilityState(){const e=this.grid.getActiveCell(),t=this.grid.onBeforeEditCell.notify({...e,item:this.dataContext,column:this.args.column,grid:this.grid,target:"composite",compositeEditorOptions:this.args.compositeEditorOptions}).getReturnValue();this.disable(!1===t)}handleChangeEvent(e){this._isValueTouched=!0;const t=this.args.compositeEditorOptions;t?this.handleChangeOnCompositeEditor(e,t):this.save()}handleChangeSliderNumber(e){const t=e.target?.value??"";""!==t&&(!this.editorOptions.hideSliderNumber&&this._sliderNumberElm&&(this._sliderNumberElm.textContent=t),this._inputElm.title=t,this.args?.compositeEditorOptions||this.grid.onMouseEnter.notify({column:this.columnDef,grid:this.grid},new bs(e))),this.updateTrackFilledColorWhenEnabled()}handleChangeOnCompositeEditor(e,t,i="user",s=!1){const n=this.grid.getActiveCell(),r=this.args.column,o=this.columnDef?.id??"",a=this.dataContext,l=this.grid,h=this.serializeValue();this.validate().valid&&this.applyValue(this.dataContext,h),this.applyValue(t.formValues,h);const c=this.gridOptions?.compositeEditorOptions?.excludeDisabledFieldFormValues??!1;(s||this.disabled&&c&&t.formValues.hasOwnProperty(o))&&delete t.formValues[o],l.onCompositeEditorChange.notify({...n,item:a,grid:l,column:r,formValues:t.formValues,editors:t.editors,triggeredBy:i},new bs(e))}sliderTrackClicked(e){e.preventDefault();const t=100*(e.offsetX+0)/this._sliderTrackElm.offsetWidth;this._inputElm&&(this._inputElm.value=`${t}`,this._inputElm.dispatchEvent(new Event("change")))}updateTrackFilledColorWhenEnabled(){if(this.editorOptions.enableSliderTrackColoring&&this._inputElm){const e=0,t=(+this.getValue()-+this._inputElm.min)/(this.sliderOptions?.maxValue??0-+this._inputElm.min)*100,i="linear-gradient(to right, %b %p1, %c %p1, %c %p2, %b %p2)".replace(/%b/g,"#eee").replace(/%c/g,this.editorOptions?.sliderTrackFilledColor??"var(--slick-slider-filter-thumb-color, #86bff8)").replace(/%p1/g,`${e}%`).replace(/%p2/g,`${t}%`);this._sliderTrackElm.style.background=i,this._sliderOptions.sliderTrackBackground=i}}},text:Ma},Ba=(e,t,i)=>{if(Array.isArray(i)&&i.length>0){const e=i.join(", ");return ie("span",{title:e,textContent:e})}return i},Ha=(e,t,i,s,n)=>{if(!s)return"";const r=s.params||{},o=r?.complexField??r?.complexFieldLabel??s.field;if(!o)throw new Error("For the Formatters.complexObject to work properly, you need to tell it which property of the complex object to use.\n      There are 3 ways to provide it:\n      1- via the generic \"params\" with a \"complexField\" property on your Column Definition, example: this.columnDefs = [{ id: 'user', field: 'user', params: { complexField: 'user.firstName' } }]\n      2- via the generic \"params\" with a \"complexField\" and a \"labelKey\" property on your Column Definition, example: this.columnDefs = [{ id: 'user', field: 'user', labelKey: 'firstName', params: { complexField: 'user' } }]\n      3- via the field name that includes a dot notation, example: this.columnDefs = [{ id: 'user', field: 'user.firstName'}] ");if(s.labelKey&&n.hasOwnProperty(o))return n[o]?.[s.labelKey];if("string"==typeof o&&o.indexOf(".")>0){let e=o.split(".").reduce(((e,t)=>e?.hasOwnProperty(t)?e[t]:""),n);return null!=e&&("object"!=typeof e||0!==Object.entries(e).length||e instanceof Date)||(e=""),e}return i},za={arrayObjectToCsv:(e,t,i,s,n)=>{const r=s&&s.params||{},o=r.propertyNames,a=r?.includeTitle??!0;let l=r.dataContextProperty;if(l||(l=s?.field?.split(".")[0]||""),!o||!Array.isArray(o)||!l)throw new Error('Formatters.arrayObjectToCsv requires you to pass an array of "propertyNames" (declared in "params") that you want to pull the data from.\n      For example, if we have an array of user objects that have the property of firstName & lastName then we need to pass in your column definition:: { params: { propertyNames: [\'firtName\'] }}.\n      Optionally, you can also pass the "dataContextProperty" if you wish to run this on another completely different field of the dataContext object.');if(n[l]&&Array.isArray(n[l])&&Array.isArray(n[l])&&n[l].length>0){const e=[];n[l].forEach((t=>{const i=[];o.forEach((e=>{i.push(t[e])})),e.push(i.join(" "))}));const t=e.join(", "),i=ie("span",{textContent:t});return a&&(i.title=t),i}return i},arrayToCsv:Ba,checkmarkMaterial:(e,t,i)=>{let s=!1;const n=ze(i);return n&&(i=+i),(!0===i||n&&+i>0||"string"==typeof i&&i.length>0&&"false"!==i.toLowerCase()&&"0"!==i)&&(s=!0),s?ie("i",{className:"mdi mdi-18px mdi-check checkmark-icon",ariaHidden:"true"}):""},complex:Ha,complexObject:Ha,collection:(e,t,i,s,n,r)=>{if(!(i&&s&&s.params&&s.params.collection&&s.params.collection.length))return i;const{params:o,params:{collection:a}}=s,l=o.customStructure?o.customStructure.label:"label",h=o.customStructure?o.customStructure.value:"value";return Array.isArray(i)?Ba(0,0,i.map((e=>J(a,(t=>t[h]===e))[l]))):J(a,(e=>e[h]===i))[l]||""},collectionEditor:(e,t,i,s,n,r)=>{if(!(i&&s&&s.editor&&s.editor.collection&&s.editor.collection.length))return i;const{editor:o,editor:{collection:a}}=s,l=o.customStructure?o.customStructure.label:"label",h=o.customStructure?o.customStructure.value:"value";return Array.isArray(i)?a.every((e=>"string"==typeof e))?Ba(0,0,i.map((e=>J(a,(t=>t===e))))):Ba(0,0,i.map((e=>J(a,(t=>t[h]===e))[l]))):J(a,(e=>e[h]===i))[l]||""},currency:(e,t,i,s,n,r)=>{const{currencyPrefix:o,currencySuffix:a,minDecimal:l,maxDecimal:h,numberPrefix:c,numberSuffix:d,decimalSeparator:u,thousandSeparator:p,wrapNegativeNumber:m}=uo(s,r,"decimal","cell");return ze(i)?`${c}${V(i,l,h,m,o,a,u,p)}${d}`:i},dateIso:mo(E.dateIso,"-"),dateTimeIso:mo(E.dateTimeIso,"-"),dateTimeShortIso:mo(E.dateTimeShortIso,"-"),dateTimeIsoAmPm:mo(E.dateTimeIsoAmPm,"-"),dateTimeIsoAM_PM:mo(E.dateTimeIsoAM_PM,"-"),dateEuro:mo(E.dateEuro,"/"),dateEuroShort:mo(E.dateEuroShort,"/"),dateTimeEuro:mo(E.dateTimeEuro,"/"),dateTimeEuroShort:mo(E.dateTimeEuroShort,"/"),dateTimeShortEuro:mo(E.dateTimeShortEuro,"/"),dateTimeEuroAmPm:mo(E.dateTimeEuroAmPm,"/"),dateTimeEuroAM_PM:mo(E.dateTimeEuroAM_PM,"/"),dateTimeEuroShortAmPm:mo(E.dateTimeEuroShortAmPm,"/"),dateTimeEuroShortAM_PM:mo(E.dateTimeEuroShortAM_PM,"/"),dateUs:mo(E.dateUs,"/"),dateTimeUs:mo(E.dateTimeUs,"/"),dateTimeShortUs:mo(E.dateTimeShortUs,"/"),dateTimeUsAmPm:mo(E.dateTimeUsAmPm,"/"),dateTimeUsAM_PM:mo(E.dateTimeUsAM_PM,"/"),dateTimeUsShort:mo(E.dateTimeUsShort,"/"),dateTimeUsShortAmPm:mo(E.dateTimeUsShortAmPm,"/"),dateTimeUsShortAM_PM:mo(E.dateTimeUsShortAM_PM,"/"),dateUsShort:mo(E.dateUsShort,"/"),dateUtc:mo(E.dateUtc,"-"),decimal:(e,t,i,s,n,r)=>{const{minDecimal:o,maxDecimal:a,numberPrefix:l,numberSuffix:h,decimalSeparator:c,thousandSeparator:d,wrapNegativeNumber:u}=uo(s,r,"decimal","cell");return ze(i)?V(i,o,a,u,l,h,c,d):i},dollar:(e,t,i,s,n,r)=>{const{minDecimal:o,maxDecimal:a,decimalSeparator:l,thousandSeparator:h,wrapNegativeNumber:c}=uo(s,r,"currency","cell");return ze(i)?V(i,o,a,c,"$","",l,h):i},dollarColored:(e,t,i,s,n,r)=>{const{minDecimal:o,maxDecimal:a,decimalSeparator:l,thousandSeparator:h,wrapNegativeNumber:c}=uo(s,r,"currency","cell");if(ze(i)){const e=i>=0?"green":"red",t=ie("span",{ariaHidden:"true",textContent:V(i,o,a,c,"$","",l,h)});return t.style.color=e,t}return i},dollarColoredBold:(e,t,i,s,n,r)=>{const{minDecimal:o,maxDecimal:a,decimalSeparator:l,thousandSeparator:h,wrapNegativeNumber:c}=uo(s,r,"currency","cell");if(ze(i)){const e=i>=0?"green":"red",t=ie("span",{ariaHidden:"true",textContent:V(i,o,a,c,"$","",l,h)});return t.style.color=e,t.style.fontWeight="bold",t}return i},hyperlink:(e,t,i,s,n,r)=>{const o=s&&s.params||{};let a=o.hyperlinkText?o.hyperlinkText:i;a=r.sanitizeHtmlString(a);let l=o.hyperlinkUrl?o.hyperlinkUrl:i;l=r.sanitizeHtmlString(l);const h=l.match(/^(http|ftp|https):\/\/[\w\-_]+(\.[\w\-_]+)+([\w\-.,@?^=%&amp;:/~+#]*[\w\-@?^=%&amp;/~+#])?/i);return h&&Array.isArray(h)&&h.length>0?ie("a",{href:h[0],textContent:a}):i},icon:(e,t,i,s)=>{const n=s?.params??{},r=n.iconCssClass||n.icon||n.formatterIcon;if(!r)throw new Error('[Slickgrid-Universal] When using `Formatters.icon`, you must provide the "iconCssClass" via the generic "params". (e.g.: `{ formatter: Formatters.icon, params: { iconCssClass: "mdi mdi-magnify" }}`');return ie("i",{className:r,ariaHidden:"true",title:n.title||null})},iconBoolean:(e,t,i,s)=>{const n=(s?.params||{}).cssClass;if(!n)throw new Error('[Slickgrid-Universal] When using `Formatters.iconBoolean`, you must provide You must provide the "cssClass", e.g.: { formatter: Formatters.iconBoolean, params: { cssClass: "mdi mdi-check" }}');let r=!1;const o=!isNaN(i);return(!0===i||o&&parseFloat(i)>0||!o&&"string"==typeof i&&"false"!==i.toLowerCase()&&"0"!==i)&&(r=!0),r?ie("i",{className:n,ariaHidden:"true"}):""},mask:(e,t,i,s,n,r)=>{const o=(s.params||{}).mask;if(!o)throw new Error('You must provide a "mask" via the generic "params" options (e.g.: { formatter: Formatters.mask, params: { mask: \'000-000\' }}');if(i){let e=0;const t=i.toString(),s=r.getOptions()||{},n=s?.preventDocumentFragmentUsage?document.createElement("span"):new DocumentFragment;return n.textContent=o.replace(/[09A]/gi,(()=>t[e++]||"")),n}return i},multiple:ho,percent:(e,t,i,s,n,r)=>{const{minDecimal:o,maxDecimal:a,decimalSeparator:l,thousandSeparator:h,wrapNegativeNumber:c}=uo(s,r,"percent","cell");return ze(i)?V(100*i,o,a,c,"","%",l,h):i},percentComplete:(e,t,i,s,n,r)=>{const{minDecimal:o,maxDecimal:a,decimalSeparator:l,thousandSeparator:h,wrapNegativeNumber:c}=uo(s,r,"percent","cell");if(ze(i)){const e=i<50?"red":"green",t=V(i,o,a,c,"","%",l,h);return ie("span",{textContent:i>100?"100%":t,style:{color:e}})}return i},percentCompleteBar:(e,t,i)=>{if(!ze(i))return"";let s="",n=parseFloat(i);return n>100&&(n=100),s=n<30?"red":n<70?"silver":"green",ie("span",{className:"percent-complete-bar",title:`${n}%`,style:{background:s,width:`${n}%`}})},percentCompleteBarWithText:(e,t,i)=>{if(!ze(i))return"";let s="",n=parseFloat(i);return n>100&&(n=100),s=n<30?"red":n<70?"silver":"green",ie("div",{className:"percent-complete-bar-with-text",title:`${n}%`,textContent:`${n}%`,style:{background:s,width:`${n}%`}})},percentSymbol:(e,t,i,s,n,r)=>{const{minDecimal:o,maxDecimal:a,decimalSeparator:l,thousandSeparator:h,wrapNegativeNumber:c}=uo(s,r,"percent","cell");return ze(i)?V(i,o,a,c,"","%",l,h):i},progressBar:(e,t,i)=>{if(!ze(i))return"";let s="",n=parseFloat(i);n>100&&(n=100),s=n<30?"danger":n<70?"warning":"success";const r=ie("div",{className:"progress"});return r.appendChild(ie("div",{className:`progress-bar progress-bar-${s} bg-${s}`,role:"progressbar",ariaValueNow:String(n),ariaValueMin:"0",ariaValueMax:"100",textContent:`${n}%`,style:{minWidth:"2em",width:`${n}%`}})),r},translate:(e,t,i,s,n,r)=>{const o=(r?.getOptions()??{}).translater||s&&s.params&&s.params.translater;if(!o||"function"!=typeof o.translate)throw new Error('"Formatters.translate" requires the Translate Service to be provided as a Grid Options "translater" (or "i18n" depending on which framework you use).\n    For example: this.gridOptions = { enableTranslate: true, translater: this.translateService }');return null!=i&&"string"!=typeof i&&(i+=""),i?o.translate(i):""},translateBoolean:(e,t,i,s,n,r)=>{const o=(r?.getOptions()??{}).translater||s&&s.params&&s.params.translater;if(!o||"function"!=typeof o.translate)throw new Error('"Formatters.translateBoolean" requires the Translate Service to be provided as a Grid Options "translater" (or "i18n" depending on which framework you use).\n    For example: this.gridOptions = { enableTranslate: true, translater: this.translateService }');return null!=i&&"string"!=typeof i&&(i+=""),i?o.translate(i.toUpperCase()):""},tree:(e,t,i,s,n,r)=>{const o=r.getOptions(),a=o?.treeDataOptions,l=a?.indentMarginLeft??15,h=a?.collapsedPropName??y.treeDataProperties.COLLAPSED_PROP,c=a?.hasChildrenPropName??y.treeDataProperties.HAS_CHILDREN_PROP,d=a?.levelPropName??y.treeDataProperties.TREE_LEVEL_PROP;let u=i;if(u=W(s,n,i),null==u||void 0===n)return"";if(!n.hasOwnProperty(d))throw new Error('[Slickgrid-Universal] You must provide valid "treeDataOptions" in your Grid Options, however it seems that we could not find any tree level info on the current item datacontext row.');const p=n?.[d]??0,m=document.createElement("span");m.style.display="inline-block",m.style.width=l*p+"px";const f=`slick-tree-level-${p}`;let g="";n[c]&&(g=n?.[h]?"collapsed":"expanded"),a?.titleFormatter&&(u=fo(a.titleFormatter,e,t,s,n,r));const _=ie("div",{className:`slick-group-toggle ${g}`.trim(),ariaExpanded:String("expanded"===g)}),v=ie("span",{className:"slick-tree-title"});r.applyHtmlCode(v,u),v.setAttribute("level",p);const b=o?.preventDocumentFragmentUsage?document.createElement("span"):new DocumentFragment;return b.appendChild(m),b.appendChild(_),b.appendChild(v),{addClasses:f,html:b}},treeParseTotals:(e,t,i,s,n,r)=>{const o=r.getOptions(),a=o?.treeDataOptions?.hasChildrenPropName??y.treeDataProperties.HAS_CHILDREN_PROP,{groupTotalsFormatter:l,treeTotalsFormatter:h,params:c}=s;if(!l&&!h)throw new Error('[Slickgrid-Universal] When using Formatters.treeParseTotals, you must provide a total formatter via "groupTotalsFormatter" or "treeTotalsFormatter".');if(n[a]&&n?.__treeTotals&&(l||h))return(h??l)(n?.__treeTotals,s,r);if(c.formatters){let o=i;for(const l of c.formatters)n[a]||n?.__treeTotals||"function"!=typeof l||(o=l(e,t,o,s,n,r)||i);return o}return i},treeExport:(e,t,i,s,n,r)=>{const o=r.getOptions(),a=o?.treeDataOptions,l=a?.collapsedPropName??y.treeDataProperties.COLLAPSED_PROP,h=a?.hasChildrenPropName??y.treeDataProperties.HAS_CHILDREN_PROP,c=a?.levelPropName??y.treeDataProperties.TREE_LEVEL_PROP,d=a?.exportIndentMarginLeft??5,u=a?.exportIndentationLeadingChar??".",p=a?.exportIndentationLeadingSpaceCount??3,m=o?.excelExportOptions?.groupCollapsedSymbol??"â®",f=o?.excelExportOptions?.groupExpandedSymbol??"â®";let g=i;if(g=W(s,n,i),null==g||void 0===n)return"";if(!n.hasOwnProperty(c))throw new Error('[Slickgrid-Universal] You must provide valid "treeDataOptions" in your Grid Options, however it seems that we could not find any tree level info on the current item datacontext row.');const _=n?.[c]??0;let v="",b=0;n[h]?(v=n?.[l]?m:f,b=0===_?0:d*_):b=d*(0===_?0:_+1);const C=ke(b);return a?.titleFormatter&&(g=fo(a.titleFormatter,e,t,s,n,r)),g=`${0===_&&v?"":0===_?`${u}${ke(p)}`:u}${C}${v} ${g}`,st(g)}},$a={avgTotals:(e,t,i)=>{const s=t.field??"";let n=e.avg?.[s];const r=t?.params;let o=r?.groupFormatterPrefix||"";const a=r?.groupFormatterSuffix||"",{minDecimal:l,maxDecimal:h,decimalSeparator:c,thousandSeparator:d,wrapNegativeNumber:u}=uo(t,i,"regular","group");if(ze(n)){if(n<0){if(n=Math.abs(n),u)return isNaN(l)&&isNaN(h)?`${o}(${Q(Math.round(n),d)})${a}`:`${o}(${$(n,l,h,c,d)})${a}`;o+="-"}return isNaN(l)&&isNaN(h)?`${o}${Q(Math.round(n),d)}${a}`:`${o}${$(n,l,h,c,d)}${a}`}return""},avgTotalsCurrency:(e,t,i)=>{const s=t.field??"",n=e.avg?.[s],r=t?.params,o=r?.groupFormatterPrefix||"",a=r?.groupFormatterSuffix||"",l=r?.groupFormatterCurrencyPrefix||"",h=r?.groupFormatterCurrencySuffix||"",{minDecimal:c,maxDecimal:d,decimalSeparator:u,thousandSeparator:p,wrapNegativeNumber:m}=uo(t,i,"currency","group");return ze(n)?`${o}${V(n,c,d,m,l,h,u,p)}${a}`:""},avgTotalsDollar:(e,t,i)=>{const s=t.field??"",n=e.avg?.[s],r=t?.params,o=r?.groupFormatterPrefix||"",a=r?.groupFormatterSuffix||"",{minDecimal:l,maxDecimal:h,decimalSeparator:c,thousandSeparator:d,wrapNegativeNumber:u}=uo(t,i,"currency","group");return ze(n)?`${o}${V(n,l,h,u,"$","",c,d)}${a}`:""},avgTotalsPercentage:(e,t,i)=>{const s=t.field??"";let n=e.avg?.[s];const r=t?.params;let o=r?.groupFormatterPrefix||"";const a=r?.groupFormatterSuffix||"",{minDecimal:l,maxDecimal:h,decimalSeparator:c,thousandSeparator:d,wrapNegativeNumber:u}=uo(t,i,"percent","group");if(ze(n)){if(n<0){if(n=Math.abs(n),u)return isNaN(l)&&isNaN(h)?`${o}(${Q(Math.round(n),d)}%)${a}`:`${o}(${$(n,l,h,c,d)}%)${a}`;o+="-"}return isNaN(l)&&isNaN(h)?`${o}${Q(Math.round(n),d)}%${a}`:`${o}${$(n,l,h,c,d)}%${a}`}return""},maxTotals:(e,t,i)=>{const s=t.field??"",n=e.max?.[s],r=t?.params,o=r?.groupFormatterPrefix||"",a=r?.groupFormatterSuffix||"",{minDecimal:l,maxDecimal:h,decimalSeparator:c,thousandSeparator:d,wrapNegativeNumber:u}=uo(t,i,"regular","group");return ze(n)?`${o}${V(n,l,h,u,"","",c,d)}${a}`:""},minTotals:(e,t,i)=>{const s=t.field??"",n=e.min?.[s],r=t?.params,o=r?.groupFormatterPrefix||"",a=r?.groupFormatterSuffix||"",{minDecimal:l,maxDecimal:h,decimalSeparator:c,thousandSeparator:d,wrapNegativeNumber:u}=uo(t,i,"regular","group");return ze(n)?`${o}${V(n,l,h,u,"","",c,d)}${a}`:""},sumTotals:(e,t,i)=>{const s=t.field??"",n=e.sum?.[s],r=t?.params,o=r?.groupFormatterPrefix||"",a=r?.groupFormatterSuffix||"",{minDecimal:l,maxDecimal:h,decimalSeparator:c,thousandSeparator:d,wrapNegativeNumber:u}=uo(t,i,"regular","group");return ze(n)?`${o}${V(n,l,h,u,"","",c,d)}${a}`:""},sumTotalsBold:(e,t,i)=>{const s=t.field??"",n=e.sum?.[s],r=t?.params,o=r?.groupFormatterPrefix||"",a=r?.groupFormatterSuffix||"",{minDecimal:l,maxDecimal:h,decimalSeparator:c,thousandSeparator:d,wrapNegativeNumber:u}=uo(t,i,"regular","group");return ze(n)?ie("span",{style:{fontWeight:"bold"},textContent:`${o}${V(n,l,h,u,"","",c,d)}${a}`}):""},sumTotalsColored:(e,t,i)=>{const s=t.field??"",n=e.sum?.[s],r=t?.params,o=r?.groupFormatterPrefix||"",a=r?.groupFormatterSuffix||"",{minDecimal:l,maxDecimal:h,decimalSeparator:c,thousandSeparator:d,wrapNegativeNumber:u}=uo(t,i,"regular","group");return ze(n)?ie("span",{style:{color:n>=0?"green":"red"},textContent:`${o}${V(n,l,h,u,"","",c,d)}${a}`}):""},sumTotalsCurrency:(e,t,i)=>{const s=t.field??"",n=e.sum?.[s],r=t?.params,o=r?.groupFormatterPrefix||"",a=r?.groupFormatterSuffix||"",l=r?.groupFormatterCurrencyPrefix||"",h=r?.groupFormatterCurrencySuffix||"",{minDecimal:c,maxDecimal:d,decimalSeparator:u,thousandSeparator:p,wrapNegativeNumber:m}=uo(t,i,"currency","group");return ze(n)?`${o}${V(n,c,d,m,l,h,u,p)}${a}`:""},sumTotalsCurrencyColored:(e,t,i)=>{const s=t.field??"",n=e.sum?.[s],r=t?.params,o=r?.groupFormatterPrefix||"",a=r?.groupFormatterSuffix||"",l=r?.groupFormatterCurrencyPrefix||"",h=r?.groupFormatterCurrencySuffix||"",{minDecimal:c,maxDecimal:d,decimalSeparator:u,thousandSeparator:p,wrapNegativeNumber:m}=uo(t,i,"currency","group");return ze(n)?ie("span",{style:{color:n>=0?"green":"red"},textContent:`${o}${V(n,c,d,m,l,h,u,p)}${a}`}):""},sumTotalsDollar:(e,t,i)=>{const s=t.field??"",n=e.sum?.[s],r=t?.params,o=r?.groupFormatterPrefix||"",a=r?.groupFormatterSuffix||"",{minDecimal:l,maxDecimal:h,decimalSeparator:c,thousandSeparator:d,wrapNegativeNumber:u}=uo(t,i,"currency","group");return ze(n)?`${o}${V(n,l,h,u,"$","",c,d)}${a}`:""},sumTotalsDollarBold:(e,t,i)=>{const s=t.field??"",n=e.sum?.[s],r=t?.params,o=r?.groupFormatterPrefix||"",a=r?.groupFormatterSuffix||"",{minDecimal:l,maxDecimal:h,decimalSeparator:c,thousandSeparator:d,wrapNegativeNumber:u}=uo(t,i,"currency","group");return ze(n)?ie("span",{style:{fontWeight:"bold"},textContent:`${o}${V(n,l,h,u,"$","",c,d)}${a}`}):""},sumTotalsDollarColored:(e,t,i)=>{const s=t.field??"",n=e.sum?.[s],r=t?.params,o=r?.groupFormatterPrefix||"",a=r?.groupFormatterSuffix||"",{minDecimal:l,maxDecimal:h,decimalSeparator:c,thousandSeparator:d,wrapNegativeNumber:u}=uo(t,i,"currency","group");return ze(n)?ie("span",{style:{color:n>=0?"green":"red"},textContent:`${o}${V(n,l,h,u,"$","",c,d)}${a}`}):""},sumTotalsDollarColoredBold:(e,t,i)=>{const s=t.field??"",n=e.sum?.[s],r=t?.params,o=r?.groupFormatterPrefix||"",a=r?.groupFormatterSuffix||"",{minDecimal:l,maxDecimal:h,decimalSeparator:c,thousandSeparator:d,wrapNegativeNumber:u}=uo(t,i,"currency","group");return ze(n)?ie("span",{style:{color:n>=0?"green":"red",fontWeight:"bold"},textContent:`${o}${V(n,l,h,u,"$","",c,d)}${a}`}):""}};class Va{constructor(){this.options=Ia}}const Wa={...e,...t,...n,...o,...r,deepAssign:De};class Ua{constructor(e){this._value=null,this._boundedEventWithListeners=[],this._elementBindings=[],this._binding=e,this._property=e.property||"",this._elementBindings=[],e.property&&e.variable&&(e.variable.hasOwnProperty(e.property)||e.property in e.variable)?this._value=e.variable[e.property]:this._value=e.variable,"object"==typeof e.variable&&Object.defineProperty(e.variable,e.property,{get:this.valueGetter.bind(this),set:this.valueSetter.bind(this)})}get boundedEventWithListeners(){return this._boundedEventWithListeners}get elementBindings(){return this._elementBindings}get property(){return this._property}dispose(){this.unbindAll(),this._boundedEventWithListeners=[],this._elementBindings=[]}valueGetter(){return this._value}valueSetter(e){if(this._value=e,Array.isArray(this._elementBindings))for(const t of this._elementBindings)t?.element&&t?.attribute&&(t.element[t.attribute]=e)}bind(e,t,i,s){return e&&e.forEach?e.forEach((e=>this.bindSingleElement(e,t,i,s))):e&&this.bindSingleElement(e,t,i,s),this}unbind(e,t,i,s,n){if(e){e.removeEventListener(t,i,s);const r=this._boundedEventWithListeners.findIndex((e=>e.uid===n));r>=0&&this._boundedEventWithListeners.splice(r,1)}}unbindAll(){let e=this._boundedEventWithListeners.pop();for(;e;){const{element:t,eventName:i,listener:s,uid:n}=e;this.unbind(t,i,s,void 0,n),e=this._boundedEventWithListeners.pop()}this._boundedEventWithListeners=[]}bindSingleElement(e,t,i,s){const n={element:e,attribute:t};if(e){if(i){const r=()=>{let i=e[t];if(this.hasData(i)&&"number"===e?.type&&(i=+i),this.valueSetter(i),(this._binding.variable.hasOwnProperty(this._binding.property)||this._binding.property in this._binding.variable)&&(this._binding.variable[this._binding.property]=this.valueGetter()),"function"==typeof s)return s(this.valueGetter())};n.event=i,n.listener=r,e.addEventListener(i,r),this._boundedEventWithListeners.push({element:e,eventName:i,listener:r,uid:this.generateUuidV4()})}this._elementBindings.push(n),e[t]=this._value}}generateUuidV4(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(e=>{const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}hasData(e){return null!=e&&""!==e}}class ja{constructor(){this._isPreviouslyShown=!1,this._warningLeftElement=null,this._warningRightElement=null}get gridOptions(){return this._grid?.getOptions()??{}}init(e,t){this._grid=e,this._translaterService=t.get("TranslaterService")}dispose(){this._warningLeftElement?.remove(),this._warningRightElement?.remove(),this._warningLeftElement=null,this._warningRightElement=null}showEmptyDataMessage(e=!0,t){if(!this._grid||!this.gridOptions||this._isPreviouslyShown===e)return!1;this._isPreviouslyShown=e;const i=this._grid.getUID(),s={message:"No data to display.",...this.gridOptions.emptyDataWarning,...t},n=s?.className??"slick-empty-data-warning";this._warningLeftElement=document.querySelector(`.${i} .${n}`);const r=document.querySelector(`.${i} .grid-canvas.grid-canvas-left`),o=document.querySelector(`.${i} .grid-canvas.grid-canvas-right`),a=s.leftViewportMarginLeft??0,l=s.rightViewportMarginLeft??0,h=s.frozenLeftViewportMarginLeft??0,c=s.frozenRightViewportMarginLeft??0,d=void 0!==this.gridOptions?.frozenColumn&&this.gridOptions.frozenColumn>=0,u="string"==typeof a?a:`${a}px`,p="string"==typeof l?l:`${l}px`;if(this.gridOptions.autoHeight){const t=document.querySelector(`.${i} .slick-pane.slick-pane-top.slick-pane-left`);if(t&&t.style&&r&&r.style){const i=parseInt(t.style.height,10)||0,s=this.gridOptions?.rowHeight??0,n=this.gridOptions.enableFiltering?this.gridOptions?.headerRowHeight??0:0,o=this.gridOptions.createPreHeaderPanel?this.gridOptions?.preHeaderPanelHeight??0:0;if(e){let e=null!==i&&i<100?i:100;e+=n+o,t.style.minHeight=`${e}px`,r.style.minHeight=`${s}px`}}}let m=s.message;if(this.gridOptions.enableTranslate&&this._translaterService&&s?.messageKey&&(m=this._translaterService.translate(s.messageKey)),!this._warningLeftElement&&r&&o&&(this._warningLeftElement=document.createElement("div"),this._warningLeftElement.classList.add(...se(n)),this._warningLeftElement.classList.add("left"),this._grid.applyHtmlCode(this._warningLeftElement,m),this._warningRightElement=this._warningLeftElement.cloneNode(!0),this._warningRightElement.classList.add("right"),o.appendChild(this._warningRightElement),r.appendChild(this._warningLeftElement)),this._warningLeftElement){let t=e?"flex":"none";d&&e&&(t=s.hideFrozenLeftWarning?"none":"flex"),this._warningLeftElement.style.display=t;const i="string"==typeof h?h:`${h}px`;this._warningLeftElement.style.marginLeft=d?i:u}if(this._warningRightElement){let t=e?"flex":"none";d&&e&&(t=s.hideFrozenRightWarning?"none":"flex"),this._warningRightElement.style.display=t;const i="string"==typeof c?c:`${c}px`;this._warningRightElement.style.marginLeft=d?i:p}return e}}class Ga{constructor(){this._observers=[],this._querySelectorPrefix=""}get querySelectorPrefix(){return this._querySelectorPrefix||""}set querySelectorPrefix(e){this._querySelectorPrefix=e}get observers(){return this._observers}dispose(){let e=this._observers.pop();for(;e;)e.dispose(),e=this._observers.pop();this._observers=[]}addElementBinding(e,t,i,s,n,r){const o=document.querySelectorAll(`${this.querySelectorPrefix}${i}`);let a=this._observers.find((t=>t.property===e));a||(a=new Ua({variable:e,property:t})),Array.isArray(n)?n.forEach((e=>a?.bind(o,s,e,r))):a?.bind(o,s,n,r),this._observers.push(a)}bindEventHandler(e,t,i,s){document.querySelectorAll(`${this.querySelectorPrefix}${e}`).forEach((e=>{e?.addEventListener&&e.addEventListener(t,i,s)}))}setElementAttributeValue(e,t,i){document.querySelectorAll(`${this.querySelectorPrefix}${e}`).forEach((e=>{e.textContent="",e&&t in e&&(e[t]=i)}))}}class qa{constructor(){this._enableTranslate=!1,this._subscriptions=[],this.currentPagination={},this.firstButtonClasses="",this.lastButtonClasses="",this.prevButtonClasses="",this.nextButtonClasses="",this.textItemsPerPage="items per page",this.textItems="items",this.textOf="of",this.textPage="Page",this._bindingHelper=new Ga,this._bindingEventService=new Wt}get availablePageSizes(){return this._paginationService.availablePageSizes||[]}get dataFrom(){return this._paginationService.dataFrom}get dataTo(){return this._paginationService.dataTo}get itemsPerPage(){return this._paginationService.itemsPerPage}set itemsPerPage(e){this._paginationService.changeItemPerPage(e)}get pageCount(){return this._paginationService.pageCount}get pageNumber(){return this._paginationService.pageNumber}get gridOptions(){return this._grid?.getOptions()??{}}get gridUid(){return this._grid?.getUID()||""}get locales(){return this.gridOptions?.locales??y.locales}get totalItems(){return this._paginationService.totalItems}get isLeftPaginationDisabled(){return 1===this.pageNumber||0===this.totalItems}get isRightPaginationDisabled(){return this.pageNumber===this.pageCount||0===this.totalItems}init(e,t,i,s){if(this._grid=e,this._pubSubService=i,this._translaterService=s,this._paginationService=t,this.currentPagination=t.getFullPagination(),this._bindingHelper.querySelectorPrefix=this.gridUid?`.${this.gridUid} `:"",this._enableTranslate=this.gridOptions?.enableTranslate??!1,this._enableTranslate&&(!this._translaterService||!this._translaterService.translate))throw new Error('[Slickgrid-Universal] requires a Translate Service to be installed and configured when the grid option "enableTranslate" is enabled.');if(this.translatePaginationTexts(),this._enableTranslate&&this._pubSubService?.subscribe){const e=this._translaterService?.eventName??"onLanguageChange";this._subscriptions.push(this._pubSubService.subscribe(e,(()=>this.translatePaginationTexts())))}this._subscriptions.push(this._pubSubService.subscribe("onPaginationRefreshed",(e=>{Object.keys(e).forEach((t=>this.currentPagination[t]=e[t])),this.updatePageButtonsUsability(),this._spanInfoFromToElm?.style&&(this._spanInfoFromToElm.style.display=0===this.currentPagination.totalItems?"none":"")})),this._pubSubService.subscribe("onPaginationSetCursorBased",(()=>{this.disposeDom(),this.renderPagination(this._gridContainerElm)})))}dispose(){this._pubSubService.unsubscribeAll(this._subscriptions),this.disposeDom()}disposeDom(){this._bindingEventService.unbindAll(),this._bindingHelper.dispose(),this._paginationElement.remove()}renderPagination(e){this._gridContainerElm=e;const t=this.createPaginationContainer(),i=ie("div",{className:"slick-pagination-nav"}),s=ie("nav",{ariaLabel:"Page navigation"}),n=ie("ul",{className:"pagination"});this._seekFirstElm=ie("li",{className:"page-item seek-first"},n),this._seekFirstElm.appendChild(ie("a",{className:"page-link icon-seek-first",ariaLabel:"First Page",role:"button"})),this._seekPrevElm=ie("li",{className:"page-item seek-prev"},n),this._seekPrevElm.appendChild(ie("a",{className:"page-link icon-seek-prev",ariaLabel:"Previous Page",role:"button"})),s.appendChild(n);const r=this.createPageNumberSection(),o=ie("nav",{ariaLabel:"Page navigation"}),a=ie("ul",{className:"pagination"});this._seekNextElm=ie("li",{className:"page-item seek-next"},a),this._seekNextElm.appendChild(ie("a",{className:"page-link icon-seek-next",ariaLabel:"Next Page",role:"button"})),this._seekEndElm=ie("li",{className:"page-item seek-end"},a),this._seekEndElm.appendChild(ie("a",{className:"page-link icon-seek-end",ariaLabel:"Last Page",role:"button"})),o.appendChild(a),t.appendChild(i),i.appendChild(s),i.appendChild(r),i.appendChild(o);const l=this.createPaginationSettingsSection();t.appendChild(i),t.appendChild(l),this._paginationElement.appendChild(t),e?.appendChild&&this._paginationElement&&e.appendChild(this._paginationElement),this.renderPageSizes(),this.addBindings(),this.addEventListeners(),this.updatePageButtonsUsability()}renderPageSizes(){if(this._itemPerPageElm&&Array.isArray(this.availablePageSizes))for(const e of this.availablePageSizes)this._itemPerPageElm.appendChild(ie("option",{value:`${e}`,text:`${e}`}))}addBindings(){this._bindingHelper.addElementBinding(this,"firstButtonClasses","li.page-item.seek-first","className"),this._bindingHelper.addElementBinding(this,"prevButtonClasses","li.page-item.seek-prev","className"),this._bindingHelper.addElementBinding(this,"lastButtonClasses","li.page-item.seek-end","className"),this._bindingHelper.addElementBinding(this,"nextButtonClasses","li.page-item.seek-next","className"),this._bindingHelper.addElementBinding(this.currentPagination,"dataFrom","span.item-from","textContent"),this._bindingHelper.addElementBinding(this.currentPagination,"dataTo","span.item-to","textContent"),this._bindingHelper.addElementBinding(this.currentPagination,"totalItems","span.total-items","textContent"),this._bindingHelper.addElementBinding(this.currentPagination,"pageCount","span.page-count","textContent"),this._bindingHelper.addElementBinding(this.currentPagination,"pageSize","select.items-per-page","value"),this._paginationService.isCursorBased?this._bindingHelper.addElementBinding(this.currentPagination,"pageNumber","span.page-number","textContent"):this._bindingHelper.addElementBinding(this.currentPagination,"pageNumber","input.page-number","value","change",this.changeToCurrentPage.bind(this)),this._bindingHelper.addElementBinding(this,"textItems","span.text-items","textContent"),this._bindingHelper.addElementBinding(this,"textItemsPerPage","span.text-item-per-page","textContent"),this._bindingHelper.addElementBinding(this,"textOf","span.text-of","textContent"),this._bindingHelper.addElementBinding(this,"textPage","span.text-page","textContent")}addEventListeners(){this._bindingEventService.bind(this._seekFirstElm,"click",this.changeToFirstPage.bind(this)),this._bindingEventService.bind(this._seekEndElm,"click",this.changeToLastPage.bind(this)),this._bindingEventService.bind(this._seekNextElm,"click",this.changeToNextPage.bind(this)),this._bindingEventService.bind(this._seekPrevElm,"click",this.changeToPreviousPage.bind(this)),this._bindingEventService.bind(this._itemPerPageElm,"change",this.updateItemsPerPage.bind(this))}changeToFirstPage(e){this.isLeftPaginationDisabled||this._paginationService.goToFirstPage(e)}changeToLastPage(e){this.isRightPaginationDisabled||this._paginationService.goToLastPage(e)}changeToNextPage(e){this.isRightPaginationDisabled||this._paginationService.goToNextPage(e)}changeToPreviousPage(e){this.isLeftPaginationDisabled||this._paginationService.goToPreviousPage(e)}changeToCurrentPage(e){this._paginationService.goToPageNumber(+e)}updateItemsPerPage(e){this.itemsPerPage=+(e?.target?.value??0)}translatePaginationTexts(){if(this._enableTranslate&&this._translaterService?.translate){const e=j(this.gridOptions);this.textItemsPerPage=this._translaterService.translate(`${e}ITEMS_PER_PAGE`),this.textItems=this._translaterService.translate(`${e}ITEMS`),this.textOf=this._translaterService.translate(`${e}OF`),this.textPage=this._translaterService.translate(`${e}PAGE`)}else this.locales&&(this.textItemsPerPage=this.locales.TEXT_ITEMS_PER_PAGE||"TEXT_ITEMS_PER_PAGE",this.textItems=this.locales.TEXT_ITEMS||"TEXT_ITEMS",this.textOf=this.locales.TEXT_OF||"TEXT_OF",this.textPage=this.locales.TEXT_PAGE||"TEXT_PAGE")}createPaginationContainer(){const e=ie("div",{id:"pager",className:`slick-pagination-container ${this.gridUid} pager`,style:{width:"100%"}}),t=ie("div",{className:"slick-pagination"});return e.appendChild(t),this._paginationElement=e,t}createPageNumberSection(){const e=ie("div",{className:"slick-page-number"});return ie("span",{className:"text-page",textContent:"Page"},e),e.appendChild(document.createTextNode(" ")),this._paginationService.isCursorBased?ie("span",{className:"page-number",ariaLabel:"Page Number",dataset:{test:"page-number-label"},textContent:"1"},e):ie("input",{type:"text",className:"form-control page-number",ariaLabel:"Page Number",value:"1",size:1,dataset:{test:"page-number-input"}},e),e.appendChild(document.createTextNode(" ")),ie("span",{className:"text-of",textContent:"of"},e),e.appendChild(document.createTextNode(" ")),ie("span",{className:"page-count",dataset:{test:"page-count"}},e),e}createPaginationSettingsSection(){const e=ie("span",{className:"slick-pagination-settings"});this._itemPerPageElm=ie("select",{id:"items-per-page-label",ariaLabel:"Items per Page",className:"items-per-page"},e),e.appendChild(document.createTextNode(" ")),ie("span",{className:"text-item-per-page",textContent:"items per page"},e),e.appendChild(document.createTextNode(", "));const t=ie("span",{className:"slick-pagination-count"},e);this._spanInfoFromToElm=ie("span",{className:"page-info-from-to"},t),ie("span",{className:"item-from",ariaLabel:"Page Item From",dataset:{test:"item-from"}},this._spanInfoFromToElm),this._spanInfoFromToElm.appendChild(document.createTextNode("-")),ie("span",{className:"item-to",ariaLabel:"Page Item To",dataset:{test:"item-to"}},this._spanInfoFromToElm),this._spanInfoFromToElm.appendChild(document.createTextNode(" ")),ie("span",{className:"text-of",textContent:"of"},this._spanInfoFromToElm),this._spanInfoFromToElm.appendChild(document.createTextNode(" "));const i=ie("span",{className:"page-info-total-items"},t);return ie("span",{className:"total-items",ariaLabel:"Total Items",dataset:{test:"total-items"}},i),i.appendChild(document.createTextNode(" ")),ie("span",{className:"text-items",textContent:"items"},i),i.appendChild(document.createTextNode(" ")),e}updatePageButtonsUsability(){this.firstButtonClasses=this.isLeftPaginationDisabled?"page-item seek-first disabled":"page-item seek-first",this.prevButtonClasses=this.isLeftPaginationDisabled?"page-item seek-prev disabled":"page-item seek-prev",this.lastButtonClasses=this.isRightPaginationDisabled?"page-item seek-end disabled":"page-item seek-end",this.nextButtonClasses=this.isRightPaginationDisabled?"page-item seek-next disabled":"page-item seek-next"}}class Ka{get eventHandler(){return this._eventHandler}get gridUid(){return this.grid?.getUID()??""}get gridUidSelector(){return this.gridUid?`.${this.gridUid}`:""}get gridOptions(){return this.grid?.getOptions()??{}}get locales(){return this.gridOptions?.locales??y.locales}set metrics(e){this.renderMetrics(e)}get leftFooterText(){return document.querySelector(`.slick-custom-footer${this.gridUidSelector} .left-footer`)?.textContent??""}set leftFooterText(e){this.renderLeftFooterText(e)}get rightFooterText(){return document.querySelector(`.slick-custom-footer${this.gridUidSelector} .right-footer`)?.textContent??""}set rightFooterText(e){this.renderRightFooterText(e)}constructor(e,t,i,s){if(this.grid=e,this.customFooterOptions=t,this.pubSubService=i,this.translaterService=s,this._enableTranslate=!1,this._isLeftFooterOriginallyEmpty=!0,this._isLeftFooterDisplayingSelectionRowCount=!1,this._isRightFooterOriginallyEmpty=!0,this._selectedRowCount=0,this._subscriptions=[],this._bindingHelper=new Ga,this._bindingHelper.querySelectorPrefix=`.${this.gridUid} `,this._eventHandler=new Cs,this._enableTranslate=this.gridOptions?.enableTranslate??!1,this._isLeftFooterOriginallyEmpty=!this.gridOptions.customFooterOptions?.leftFooterText,this._isRightFooterOriginallyEmpty=!this.gridOptions.customFooterOptions?.rightFooterText,this.registerOnSelectedRowsChangedWhenEnabled(t),this._enableTranslate&&(!this.translaterService||!this.translaterService.translate))throw new Error('[Slickgrid-Universal] requires a Translate Service to be installed and configured when the grid option "enableTranslate" is enabled.');if(this.translateCustomFooterTexts(),this._enableTranslate&&this.pubSubService?.subscribe){const e=this.translaterService?.eventName??"onLanguageChange";this._subscriptions.push(this.pubSubService.subscribe(e,(()=>this.translateCustomFooterTexts())))}}dispose(){this._eventHandler.unsubscribeAll(),this.pubSubService.unsubscribeAll(this._subscriptions),this._bindingHelper.dispose(),this._footerElement?.remove()}renderFooter(e){this.translateCustomFooterTexts(),this.createFooterContainer(e)}renderMetrics(e){const t=e?.endTime?Dt(e.endTime,this.customFooterOptions.dateFormat,"en-US"):"";this._bindingHelper.setElementAttributeValue("span.last-update-timestamp","textContent",t),this._bindingHelper.setElementAttributeValue("span.item-count","textContent",e.itemCount),this._bindingHelper.setElementAttributeValue("span.total-count","textContent",e.totalItemCount),this.customFooterOptions.metricTexts?.lastUpdate&&this._bindingHelper.addElementBinding(this.customFooterOptions.metricTexts,"lastUpdate","span.text-last-update","textContent"),this._bindingHelper.addElementBinding(this.customFooterOptions.metricTexts,"items","span.text-items","textContent"),this._bindingHelper.addElementBinding(this.customFooterOptions.metricTexts,"of","span.text-of","textContent")}renderLeftFooterText(e){this._bindingHelper.setElementAttributeValue("div.left-footer","textContent",e)}renderRightFooterText(e){this._bindingHelper.setElementAttributeValue("div.right-footer","textContent",e)}translateCustomFooterTexts(){if(this.gridOptions.enableTranslate&&this.translaterService?.translate){this.customFooterOptions.metricTexts=this.customFooterOptions.metricTexts||{};for(const e of Object.keys(this.customFooterOptions.metricTexts))if(e.lastIndexOf("Key")>0){const t=e.substring(0,e.lastIndexOf("Key"));this.customFooterOptions.metricTexts[t]=this.translaterService.translate(this.customFooterOptions.metricTexts[e]||" ")}this._isLeftFooterDisplayingSelectionRowCount&&(this.leftFooterText=`${this._selectedRowCount} ${this.customFooterOptions.metricTexts.itemsSelected}`)}else this.locales&&(this.customFooterOptions.metricTexts=this.customFooterOptions.metricTexts||{},this.customFooterOptions.metricTexts.lastUpdate=this.customFooterOptions.metricTexts.lastUpdate||this.locales?.TEXT_LAST_UPDATE||"TEXT_LAST_UPDATE",this.customFooterOptions.metricTexts.items=this.customFooterOptions.metricTexts.items||this.locales?.TEXT_ITEMS||"TEXT_ITEMS",this.customFooterOptions.metricTexts.itemsSelected=this.customFooterOptions.metricTexts.itemsSelected||this.locales?.TEXT_ITEMS_SELECTED||"TEXT_ITEMS_SELECTED",this.customFooterOptions.metricTexts.of=this.customFooterOptions.metricTexts.of||this.locales?.TEXT_OF||"TEXT_OF")}createFooterContainer(e){const t=ie("div",{className:`slick-custom-footer ${this.gridUid}`,style:{width:"100%",height:`${this.customFooterOptions.footerHeight||20}px`}}),i=ie("div",{className:`left-footer ${this.customFooterOptions.leftContainerClass}`});this.grid.applyHtmlCode(i,this.customFooterOptions.leftFooterText),t.appendChild(i),t.appendChild(this.createFooterRightContainer()),this._footerElement=t,e?.appendChild&&this._footerElement&&e.appendChild(this._footerElement)}createFooterRightContainer(){const e=ie("div",{className:`right-footer ${this.customFooterOptions.rightContainerClass||""}`});if(this._isRightFooterOriginallyEmpty){if(!this.customFooterOptions.hideMetrics){e.classList.add("metrics");const t=ie("span",{className:"timestamp"},e);if(!this.customFooterOptions.hideLastUpdateTimestamp){const e=this.createFooterLastUpdate();e&&t.appendChild(e)}e.appendChild(ie("span",{className:"item-count",textContent:`${this.metrics?.itemCount??"0"}`})),this.customFooterOptions.hideTotalItemCount||(e.appendChild(document.createTextNode("\r\n")),e.appendChild(ie("span",{className:"text-of",textContent:` ${this.customFooterOptions.metricTexts?.of??"of"} `})),e.appendChild(document.createTextNode("\r\n")),e.appendChild(ie("span",{className:"total-count",textContent:`${this.metrics?.totalItemCount??"0"}`}))),e.appendChild(document.createTextNode("\r\n")),e.appendChild(ie("span",{className:"text-items",textContent:` ${this.customFooterOptions.metricTexts?.items??"items"} `}))}}else this.grid.applyHtmlCode(e,this.customFooterOptions.rightFooterText);return e}createFooterLastUpdate(){const e=this.customFooterOptions?.metricTexts?.lastUpdate??"Last Update",t=this.metrics?.endTime?Dt(this.metrics?.endTime,this.customFooterOptions.dateFormat,"en-US"):"",i=ie("span");return i.appendChild(ie("span",{className:"text-last-update",textContent:e})),i.appendChild(document.createTextNode("\r\n")),i.appendChild(ie("span",{className:"last-update-timestamp",textContent:t})),i.appendChild(ie("span",{className:"separator",textContent:` ${this.customFooterOptions.metricSeparator||""} `})),i}registerOnSelectedRowsChangedWhenEnabled(e){if((this.gridOptions.enableCheckboxSelector||this.gridOptions.enableRowSelection)&&e&&!e.hideRowSelectionCount&&this._isLeftFooterOriginallyEmpty){this._isLeftFooterDisplayingSelectionRowCount=!0;const t=e.metricTexts?.itemsSelected??this.locales?.TEXT_ITEMS_SELECTED??"TEXT_ITEMS_SELECTED";e.leftFooterText=`0 ${t}`,this._eventHandler.subscribe(this.grid.onSelectedRowsChanged,((t,i)=>{this._selectedRowCount=i.rows.length;const s=e.metricTexts?.itemsSelected??this.locales?.TEXT_ITEMS_SELECTED??"TEXT_ITEMS_SELECTED";this.leftFooterText=`${this._selectedRowCount} ${s}`}))}}}class Ya{constructor(){this.dependencies=[]}get(e){const t=this.dependencies.find((t=>t.key===e));return t?.instance?t.instance:null}dispose(){this.dependencies=[]}registerInstance(e,t){this.dependencies.some((t=>t.key===e))||this.dependencies.push({key:e,instance:t})}}const Xa={GridBundle:class{get backendService(){return this.gridOptions.backendServiceApi?.service}get eventHandler(){return this._eventHandler}get columnDefinitions(){return this._columnDefinitions||[]}set columnDefinitions(e){this._columnDefinitions=e,this._slickgridInitialized&&this.updateColumnDefinitionsList(this._columnDefinitions),e.length>0&&this.copyColumnWidthsReference(e)}get dataset(){return this.dataView?.getItems()||[]}set dataset(e){const t=this._currentDatasetLength,i=jt(e,this.dataset||[]);let s=this._gridOptions?.enableDeepCopyDatasetOnPageLoad?Te(!0,[],e):e;this.slickGrid&&this.gridOptions?.enableTreeData&&Array.isArray(e)&&(e.length>0||e.length!==t||!i)&&(this._isDatasetHierarchicalInitialized=!1,s=this.sortTreeDataset(e,!i)),this.refreshGridData(s||[]),this._currentDatasetLength=(e||[]).length,this.slickGrid&&this.gridOptions.autoFitColumnsOnFirstLoad&&0===t&&!this._isAutosizeColsCalled&&(this.slickGrid.autosizeColumns(),this._isAutosizeColsCalled=!0),this.suggestDateParsingWhenHelpful()}get datasetHierarchical(){return this.sharedService.hierarchicalDataset}set datasetHierarchical(e){const t=jt(e,this.sharedService.hierarchicalDataset||[]),i=this._currentDatasetLength;this.sharedService.hierarchicalDataset=e,e&&this.columnDefinitions&&this.filterService?.clearFilters&&this.filterService.clearFilters(),this.dataView&&e&&this.slickGrid&&this.sortService?.processTreeDataInitialSort&&(this.sortService.processTreeDataInitialSort(),queueMicrotask((()=>{const e=this.dataView?.getItemCount()??0;e>0&&(e!==i||!t)&&this.filterService.refreshTreeDataFilters()}))),this._isDatasetHierarchicalInitialized=!0}set eventPubSubService(e){this._eventPubSubService=e}set isDatasetHierarchicalInitialized(e){this._isDatasetHierarchicalInitialized=e}get gridOptions(){return this._gridOptions||{}}set gridOptions(e){let t;t=this.slickGrid?.getOptions?Te(!0,{},this.slickGrid.getOptions(),e):this.mergeGridOptions(e),this.sharedService?.gridOptions&&this.slickGrid?.setOptions&&(this.sharedService.gridOptions=t,this.slickGrid.setOptions(t,!1,!0),this.slickGrid.reRenderColumns(!0)),this.setDarkMode(e.darkMode),this._gridOptions=t}get paginationOptions(){return this._paginationOptions}set paginationOptions(e){e&&this._paginationOptions?this._paginationOptions={...this._paginationOptions,...e}:this._paginationOptions=e,this.gridOptions.pagination=this._paginationOptions,this.paginationService.updateTotalItems(e?.totalItems??0,!0)}get isDatasetInitialized(){return this._isDatasetInitialized}set isDatasetInitialized(e){this._isDatasetInitialized=e}get isGridInitialized(){return this._isGridInitialized}get instances(){return this._slickerGridInstances}get extensions(){return this._extensions}get registeredResources(){return this._registeredResources}constructor(e,t,i,s,n,r){if(this._currentDatasetLength=0,this._darkMode=!1,this._hideHeaderRowAfterPageLoad=!1,this._isAutosizeColsCalled=!1,this._isDatasetInitialized=!1,this._isDatasetHierarchicalInitialized=!1,this._isGridInitialized=!1,this._isLocalGrid=!0,this._isPaginationInitialized=!1,this._registeredResources=[],this._scrollEndCalled=!1,this._slickgridInitialized=!1,this.customDataView=!1,this.totalItems=0,this.subscriptions=[],this.showPagination=!1,!e||0!==e.querySelectorAll(".slickgrid-container").length)return;e.classList.add("grid-pane"),this._gridParentContainerElm=e,this._gridContainerElm=document.createElement("div"),this._gridContainerElm.classList.add("slickgrid-container"),e.appendChild(this._gridContainerElm),this._hideHeaderRowAfterPageLoad=!1===i?.showHeaderRow,this._columnDefinitions=t||[],this._columnDefinitions.length>0&&this.copyColumnWidthsReference(this._columnDefinitions),this._registeredResources=i?.externalResources||[],this._gridOptions=this.mergeGridOptions(i||{});const o=!!this._gridOptions?.enableDeepCopyDatasetOnPageLoad;this._gridOptions.darkMode&&this.setDarkMode(!0),this.universalContainerService=r?.universalContainerService??new Ya,this.translaterService=r?.translaterService??this._gridOptions?.translater,this._eventPubSubService=r?.eventPubSubService??new $t(e),this._eventPubSubService.eventNamingStyle=this._gridOptions?.eventNamingStyle??zt.camelCase;const a=new Va;this.backendUtilityService=r?.backendUtilityService??new g,this.gridEventService=r?.gridEventService??new $o,this.sharedService=r?.sharedService??new Go,this.collectionService=r?.collectionService??new gs(this.translaterService),this.extensionUtility=r?.extensionUtility??new vs(this.sharedService,this.backendUtilityService,this.translaterService),this.filterFactory=new ka(a,this.translaterService,this.collectionService),this.filterService=r?.filterService??new Mo(this.filterFactory,this._eventPubSubService,this.sharedService,this.backendUtilityService),this.resizerService=r?.resizerService??new jo(this._eventPubSubService),this.sortService=r?.sortService??new qo(this.collectionService,this.sharedService,this._eventPubSubService,this.backendUtilityService),this.treeDataService=r?.treeDataService??new Ko(this._eventPubSubService,this.sharedService,this.sortService),this.paginationService=r?.paginationService??new Uo(this._eventPubSubService,this.sharedService,this.backendUtilityService),this.extensionService=r?.extensionService??new ko(this.extensionUtility,this.filterService,this._eventPubSubService,this.sharedService,this.sortService,this.treeDataService,this.translaterService,(()=>this.gridService)),this.gridStateService=r?.gridStateService??new Vo(this.extensionService,this.filterService,this._eventPubSubService,this.sharedService,this.sortService,this.treeDataService),this.gridService=r?.gridService??new zo(this.gridStateService,this.filterService,this._eventPubSubService,this.paginationService,this.sharedService,this.sortService,this.treeDataService),this.headerGroupingService=r?.headerGroupingService??new Wo(this.extensionUtility),n&&(this.sharedService.hierarchicalDataset=(o?Te(!0,[],n):n)||[]);const l=new Cs;this.universalContainerService.registerInstance("PubSubService",this._eventPubSubService),this.universalContainerService.registerInstance("EventPubSubService",this._eventPubSubService),this.universalContainerService.registerInstance("ExtensionUtility",this.extensionUtility),this.universalContainerService.registerInstance("FilterService",this.filterService),this.universalContainerService.registerInstance("CollectionService",this.collectionService),this.universalContainerService.registerInstance("ExtensionService",this.extensionService),this.universalContainerService.registerInstance("GridEventService",this.gridEventService),this.universalContainerService.registerInstance("GridService",this.gridService),this.universalContainerService.registerInstance("GridStateService",this.gridStateService),this.universalContainerService.registerInstance("HeaderGroupingService",this.headerGroupingService),this.universalContainerService.registerInstance("PaginationService",this.paginationService),this.universalContainerService.registerInstance("ResizerService",this.resizerService),this.universalContainerService.registerInstance("SharedService",this.sharedService),this.universalContainerService.registerInstance("SortService",this.sortService),this.universalContainerService.registerInstance("TranslaterService",this.translaterService),this.universalContainerService.registerInstance("TreeDataService",this.treeDataService),this.initialization(this._gridContainerElm,l,s)}emptyGridContainerElm(){const e=this.gridOptions?.gridContainerId??"grid1";re(document.querySelector(`#${e}`))}dispose(e=!1){if(this._eventPubSubService?.publish("onBeforeGridDestroy",this.slickGrid),this._eventHandler?.unsubscribeAll(),this._eventPubSubService?.publish("onAfterGridDestroyed",!0),this.extensionService?.dispose(),this.filterService?.dispose(),this.gridEventService?.dispose(),this.gridService?.dispose(),this.gridStateService?.dispose(),this.headerGroupingService?.dispose(),this.paginationService?.dispose(),this.resizerService?.dispose(),this.sortService?.dispose(),this.treeDataService?.dispose(),this.universalContainerService?.dispose(),this.backendService?.dispose?.(),this.disposeExternalResources(),this.slickFooter?.dispose(),this.slickEmptyWarning?.dispose(),this.paginationComponent?.dispose(),ee(this.subscriptions),this._eventPubSubService?.unsubscribeAll(),this.dataView?.setItems([]),"function"==typeof this.dataView?.destroy&&this.dataView?.destroy(),this.slickGrid?.destroy(!0),this.slickGrid=null,re(this._gridContainerElm),re(this._gridParentContainerElm),this._gridContainerElm?.remove(),this._gridParentContainerElm?.remove(),this.backendServiceApi){for(const e of Object.keys(this.backendServiceApi))this.backendServiceApi[e]=null;this.backendServiceApi=void 0}for(const e of Object.keys(this.columnDefinitions))this.columnDefinitions[e]=null;for(const e of Object.keys(this.sharedService))this.sharedService[e]=null;this.datasetHierarchical=void 0,this._columnDefinitions=[],e&&this.emptyGridContainerElm(),this._eventPubSubService?.dispose(),this._slickerGridInstances=null}disposeExternalResources(){if(Array.isArray(this._registeredResources))for(;this._registeredResources.length>0;){const e=this._registeredResources.pop();e?.dispose&&e.dispose()}this._registeredResources=[]}initialization(e,t,i){if(this.gridOptions&&(void 0!==this.gridOptions.frozenRow&&this.gridOptions.frozenRow>=0||void 0!==this.gridOptions.frozenColumn&&this.gridOptions.frozenColumn>=0)&&void 0===this.gridOptions.enableMouseWheelScrollHandler&&(this.gridOptions.enableMouseWheelScrollHandler=!0),this._gridContainerElm=e,this._eventPubSubService.publish("onBeforeGridCreate",!0),this._isAutosizeColsCalled=!1,this._eventHandler=t,this._gridOptions=this.mergeGridOptions(this._gridOptions||{}),this.backendServiceApi=this._gridOptions?.backendServiceApi,this._isLocalGrid=!this.backendServiceApi,this._eventPubSubService.eventNamingStyle=this._gridOptions?.eventNamingStyle??zt.camelCase,this._paginationOptions=this.gridOptions?.pagination,this._gridOptions.backendServiceApi&&!this._gridOptions.backendServiceApi?.disableInternalPostProcess&&this.createBackendApiInternalPostProcessCallback(this._gridOptions),!this.customDataView){const e=this._gridOptions?.dataView?.inlineFilters??!1;let t={...this._gridOptions.dataView,inlineFilters:e};(this.gridOptions.draggableGrouping||this.gridOptions.enableGrouping)&&(this.groupItemMetadataProvider=new ks,this.sharedService.groupItemMetadataProvider=this.groupItemMetadataProvider,t={...t,groupItemMetadataProvider:this.groupItemMetadataProvider}),this.dataView=new Is(t,this._eventPubSubService),this._eventPubSubService.publish("onDataviewCreated",this.dataView)}this.preRegisterResources(),this._columnDefinitions=this.loadSlickGridEditors(this._columnDefinitions||[]),this._gridOptions?.autoAddCustomEditorFormatter&&co(this._columnDefinitions,this._gridOptions.autoAddCustomEditorFormatter),this.sharedService.allColumns=this._columnDefinitions,this.sharedService.visibleColumns=this._columnDefinitions,this.extensionService.createExtensionsBeforeGridCreation(this._columnDefinitions,this._gridOptions),this.gridOptions.presets?.pinning&&(this.gridOptions={...this.gridOptions,...this.gridOptions.presets.pinning}),this.slickGrid=new Nr(e,this.dataView,this._columnDefinitions,this._gridOptions,this._eventPubSubService),this.sharedService.dataView=this.dataView,this.sharedService.slickGrid=this.slickGrid,this.sharedService.gridContainerElement=this._gridContainerElm,this.groupItemMetadataProvider&&this.slickGrid.registerPlugin(this.groupItemMetadataProvider),this.extensionService.bindDifferentExtensions(),this.bindDifferentHooks(this.slickGrid,this._gridOptions,this.dataView),this._slickgridInitialized=!0;const s=this._gridOptions?.frozenColumn??-1;s>=0&&s<=this._columnDefinitions.length&&this._columnDefinitions.length>0&&(this.sharedService.frozenVisibleColumnId=this._columnDefinitions[s]?.id??""),this.registerResources(),this.slickGrid.init(),this.resizerService.init(this.slickGrid,this._gridParentContainerElm),!this.gridOptions.enablePagination&&this.gridOptions.showCustomFooter&&this.gridOptions.customFooterOptions&&(this.slickFooter=new Ka(this.slickGrid,this.gridOptions.customFooterOptions,this._eventPubSubService,this.translaterService),this.slickFooter.renderFooter(this._gridParentContainerElm)),i=i||[];const n=this.gridOptions?.enableTreeData?this.sortTreeDataset(i):i;if(this.dataView&&(this.dataView.beginUpdate(),this.dataView.setItems(n,this._gridOptions.datasetIdPropertyName),this._currentDatasetLength=i.length,this.dataView.endUpdate()),this.slickGrid?.getSelectionModel()&&this._gridOptions?.dataView?.hasOwnProperty("syncGridSelection")){let e=!1;this._gridOptions.backendServiceApi&&this._gridOptions.dataView.hasOwnProperty("syncGridSelectionWithBackendService")&&(e=this._gridOptions.dataView.syncGridSelectionWithBackendService);const t=this._gridOptions.dataView.syncGridSelection;if("boolean"==typeof t){let i=t;this._isLocalGrid||(i=t&&e),this.dataView?.syncGridSelection(this.slickGrid,i)}else"object"==typeof t&&this.dataView?.syncGridSelection(this.slickGrid,t.preserveHidden,t.preserveHiddenOnSelectionChange)}(this.dataView?.getLength()??0)>0?(this._isDatasetInitialized||!this._gridOptions.enableCheckboxSelector&&!this._gridOptions.enableRowSelection||this.loadRowSelectionPresetWhenExists(),this.loadFilterPresetsWhenDatasetInitialized(),this._isDatasetInitialized=!0):this.displayEmptyDataWarning(!0),this._hideHeaderRowAfterPageLoad&&(this.showHeaderRow(!1),this.sharedService.hideHeaderRowAfterPageLoad=this._hideHeaderRowAfterPageLoad),this.gridEventService.bindOnBeforeEditCell(this.slickGrid),this.gridEventService.bindOnCellChange(this.slickGrid),this.gridEventService.bindOnClick(this.slickGrid),this.gridOptions?.backendServiceApi&&this.bindBackendCallbackFunctions(this.gridOptions),this._eventPubSubService.publish("onGridCreated",this.slickGrid),this.customDataView||this.executeAfterDataviewCreated(this.gridOptions),this.bindResizeHook(this.slickGrid,this.gridOptions),this.gridOptions?.enablePagination&&this._isLocalGrid&&(this.showPagination=!0,this.loadLocalGridPagination(this.dataset)),this._slickerGridInstances={dataView:this.dataView,slickGrid:this.slickGrid,dispose:this.dispose.bind(this),backendService:this.backendService,eventPubSubService:this._eventPubSubService,filterService:this.filterService,gridEventService:this.gridEventService,gridStateService:this.gridStateService,gridService:this.gridService,groupingService:this.headerGroupingService,headerGroupingService:this.headerGroupingService,extensionService:this.extensionService,extensionUtility:this.extensionUtility,paginationService:this.paginationService,resizerService:this.resizerService,sortService:this.sortService,treeDataService:this.treeDataService},this._extensions=this.extensionService?.extensionList,this._eventPubSubService.publish("onSlickerGridCreated",this.instances),this._isGridInitialized=!0,this.suggestDateParsingWhenHelpful()}hasBackendInfiniteScroll(){return!!this.backendService?.options?.infiniteScroll}mergeGridOptions(e){const t=Te(!0,{},Ia,e);return t.enableFiltering&&!t.showHeaderRow&&(t.showHeaderRow=t.enableFiltering),t?.pagination&&(e.enablePagination||e.backendServiceApi)&&e.pagination&&Array.isArray(e.pagination.pageSizes)&&(t.pagination.pageSizes=e.pagination.pageSizes),this.sharedService&&!t.enableFiltering&&t.enablePagination&&this._isLocalGrid&&(t.enableFiltering=!0,t.showHeaderRow=!1,this._hideHeaderRowAfterPageLoad=!0,this.sharedService.hideHeaderRowAfterPageLoad=!0),t}createBackendApiInternalPostProcessCallback(e){const t=e?.backendServiceApi;if(t?.service){const e=t.service;"function"==typeof e.getDatasetName&&(t.internalPostProcess=i=>{const s=t&&e&&"function"==typeof e.getDatasetName?e.getDatasetName():"";if(i&&i.data&&i.data[s]){const e=i.data[s].hasOwnProperty("nodes")?i.data[s].nodes:i.data[s],t=i.data[s].hasOwnProperty("totalCount")?i.data[s].totalCount:i.data[s].length;this.refreshGridData(e,t||0)}})}}bindDifferentHooks(e,t,i){if(t.enableTranslate&&this.translaterService?.addPubSubMessaging&&this.translaterService.addPubSubMessaging(this._eventPubSubService),t.enableTranslate&&this.extensionService.translateAllExtensions(),this.subscriptions.push(this._eventPubSubService.subscribe("onLanguageChange",(e=>{t.enableTranslate&&(this.extensionService.translateAllExtensions(e.language),(t.createPreHeaderPanel&&t.createTopHeaderPanel||t.createPreHeaderPanel&&!t.enableDraggableGrouping)&&this.headerGroupingService.translateHeaderGrouping())}))),t.backendServiceApi){const e=t.backendServiceApi;e?.service?.init&&e.service.init(e.options,t.pagination,this.slickGrid,this.sharedService)}i&&e&&(t.enableFiltering&&(this.filterService.init(e),t.backendServiceApi&&!t.backendServiceApi.useLocalFiltering?this.filterService.bindBackendOnFilter(e):this.filterService.bindLocalOnFilter(e)),t.enableSorting&&(t.backendServiceApi&&!t.backendServiceApi.useLocalSorting?this.sortService.bindBackendOnSort(e):this.sortService.bindLocalOnSort(e)),this._eventHandler.subscribe(i.onRowCountChanged,(()=>{e.invalidate(),this.handleOnItemCountChanged(this.dataView?.getFilteredItemCount()||0,this.dataView?.getItemCount()??0)})),this._eventHandler.subscribe(i.onSetItemsCalled,((e,t)=>{this.sharedService.isItemsDateParsed=!1,this.handleOnItemCountChanged(this.dataView?.getFilteredItemCount()||0,t.itemCount),t.itemCount>0&&(this.gridOptions.autosizeColumnsByCellContentOnFirstLoad||this.gridOptions.enableAutoResizeColumnsByCellContent)&&this.resizerService.resizeColumnsByCellContent(!this.gridOptions?.resizeByContentOnlyOnFirstLoad)})),t?.enableFiltering&&!t.enableRowDetailView&&this._eventHandler.subscribe(i.onRowsChanged,((t,{calledOnRowCountChanged:i,rows:s})=>{if(!i&&Array.isArray(s)){const t=e.getRenderedRange();s.filter((e=>e>=t.top&&e<=t.bottom)).forEach((t=>e.updateRow(t))),e.render()}})),this._eventHandler.subscribe(e.onColumnsReordered,((e,t)=>{this.sharedService.hasColumnsReordered=!0,this.sharedService.visibleColumns=t.impactedColumns})),this._eventHandler.subscribe(e.onSetOptions,((e,t)=>{t.optionsBefore.darkMode!==t.optionsAfter.darkMode&&this.setDarkMode(t.optionsAfter.darkMode)})),this.loadColumnPresetsWhenDatasetInitialized(),this.loadFilterPresetsWhenDatasetInitialized()),t?.colspanCallback&&i?.getItem&&i?.getItemMetadata&&(i.getItemMetadata=e=>{let s=null;return t.colspanCallback&&(s=t.colspanCallback(i.getItem(e))),s})}bindBackendCallbackFunctions(e){const t=e.backendServiceApi,i=t?.service,s=i?.options??{},n=!!s&&(!s?.hasOwnProperty("executeProcessCommandOnInit")||s.executeProcessCommandOnInit);if(i){if(e?.presets){if(i.updateFilters&&Array.isArray(e.presets.filters)&&e.presets.filters.length>0&&i.updateFilters(e.presets.filters,!0),i.updateSorters&&Array.isArray(e.presets.sorters)&&e.presets.sorters.length>0){const t=this._gridOptions?.multiColumnSort?e.presets.sorters:e.presets.sorters.slice(0,1);i.updateSorters(void 0,t)}if(i.updatePagination&&e.presets.pagination&&!this.hasBackendInfiniteScroll()){const{pageNumber:t,pageSize:s}=e.presets.pagination;i.updatePagination(t,s)}}else{const e=this.filterService.getColumnFilters();e&&i.updateFilters&&i.updateFilters(e,!1)}if(t&&i&&(t.onInit||n)){const e="function"==typeof i.buildQuery?i.buildQuery():"",s=n?t.process?.(e)??null:t.onInit?.(e)??null;queueMicrotask((()=>{const e=this.backendUtilityService,i=new Date;t.preProcess&&t.preProcess();const n=this.gridOptions?.pagination?.totalItems??0;s instanceof Promise?s.then((s=>e.executeBackendProcessesCallback(i,s,t,n))).catch((i=>e.onBackendError(i,t))):s&&this.rxjs?.isObservable(s)&&this.subscriptions.push(s.subscribe((s=>e.executeBackendProcessesCallback(i,s,t,n)),(i=>e.onBackendError(i,t))))}))}t.service.options?.infiniteScroll&&this.addBackendInfiniteScrollCallback()}}addBackendInfiniteScrollCallback(){if(this.slickGrid&&this.gridOptions.backendServiceApi&&this.hasBackendInfiniteScroll()&&!this.gridOptions.backendServiceApi?.onScrollEnd){const e=()=>{this.backendUtilityService.setInfiniteScrollBottomHit(!0),this.paginationService.goToNextPage().then((e=>{e||this.backendUtilityService.setInfiniteScrollBottomHit(!1)}))};this.gridOptions.backendServiceApi.onScrollEnd=e,this._eventHandler.subscribe(this.slickGrid.onScroll,((t,i)=>{const s=i.grid.getViewportNode();["mousewheel","scroll"].includes(i.triggeredBy||"")&&this.paginationService?.totalItems&&i.scrollTop>0&&Math.ceil(s.offsetHeight+i.scrollTop)>=i.scrollHeight&&(this._scrollEndCalled||(e(),this._scrollEndCalled=!0))}));const t=this.gridOptions.backendServiceApi.postProcess;this.gridOptions.backendServiceApi.postProcess=e=>{this._scrollEndCalled=!1,t&&t(e)}}}bindResizeHook(e,t){if(t.autoFitColumnsOnFirstLoad&&t.autosizeColumnsByCellContentOnFirstLoad||t.enableAutoSizeColumns&&t.enableAutoResizeColumnsByCellContent)throw new Error('[Slickgrid-Universal] You cannot enable both autosize/fit viewport & resize by content, you must choose which resize technique to use. You can enable these 2 options ("autoFitColumnsOnFirstLoad" and "enableAutoSizeColumns") OR these other 2 options ("autosizeColumnsByCellContentOnFirstLoad" and "enableAutoResizeColumnsByCellContent").');t.gridHeight||t.gridWidth?this.resizerService.resizeGrid(0,{height:t.gridHeight,width:t.gridWidth}):this.resizerService.resizeGrid(),e&&t?.enableAutoResize&&t.autoFitColumnsOnFirstLoad&&t.enableAutoSizeColumns&&!this._isAutosizeColsCalled&&(e.autosizeColumns(),this._isAutosizeColsCalled=!0)}executeAfterDataviewCreated(e){if(e.enableSorting&&e.presets&&Array.isArray(e.presets.sorters)){const t=this._gridOptions?.multiColumnSort?e.presets.sorters:e.presets.sorters.slice(0,1);this.sortService.loadGridSorters(t)}}paginationChanged(e){const t=this.gridStateService?.needToPreserveRowSelection()??!1;this.slickGrid&&!t&&this._gridOptions?.backendServiceApi&&(this.gridOptions.enableRowSelection||this.gridOptions.enableCheckboxSelector)&&this.slickGrid.setSelectedRows([]);const{pageNumber:i,pageSize:s}=e;this.sharedService&&void 0!==s&&void 0!==i&&(this.sharedService.currentPagination={pageNumber:i,pageSize:s}),this._eventPubSubService.publish("onGridStateChanged",{change:{newValues:{pageNumber:i,pageSize:s},type:O.pagination},gridState:this.gridStateService.getCurrentGridState()})}refreshGridData(e,t){if(this.slickGrid&&this._gridOptions){if(this._gridOptions.enableEmptyDataWarningMessage&&Array.isArray(e)){const i=t||e.length;this.displayEmptyDataWarning(i<1)}if(Array.isArray(e)&&this.slickGrid&&this.dataView?.setItems){if(this.dataView.setItems(e,this._gridOptions.datasetIdPropertyName),this._gridOptions.backendServiceApi||this._gridOptions.enableTreeData||this.dataView.reSort(),e.length>0&&(this._isDatasetInitialized||(this.loadFilterPresetsWhenDatasetInitialized(),this._gridOptions.enableCheckboxSelector&&this.loadRowSelectionPresetWhenExists()),this._isDatasetInitialized=!0),e&&this.slickGrid.invalidate(),this.showPagination=!(!this._gridOptions||!(this._gridOptions.enablePagination||this._gridOptions.backendServiceApi&&void 0===this._gridOptions.enablePagination)),this._paginationOptions&&this._gridOptions?.pagination&&this._gridOptions?.backendServiceApi){const e=this.setPaginationOptionsWhenPresetDefined(this._gridOptions,this._paginationOptions),i=void 0!==t?t:this._gridOptions?.pagination?.totalItems;void 0!==i&&i!==this.totalItems&&(this.totalItems=+i),this._isPaginationInitialized?this.paginationService.updateTotalItems(this.totalItems):this.initializePaginationService(e)}if(this.slickGrid&&this._gridOptions.enableAutoResize){const e=this._gridOptions.autoResize&&this._gridOptions.autoResize.delay;this.resizerService.resizeGrid(e||10)}}}}updateColumnDefinitionsList(e){this.slickGrid&&this._gridOptions&&Array.isArray(e)&&(e=this.loadSlickGridEditors(e),this._gridOptions.autoAddCustomEditorFormatter&&co(e,this._gridOptions.autoAddCustomEditorFormatter),this._gridOptions.enableTranslate?this.extensionService.translateColumnHeaders(void 0,e):this.extensionService.renderColumnHeaders(e,!0),this.slickGrid&&this._gridOptions?.enableAutoSizeColumns?this.slickGrid.autosizeColumns():this._gridOptions?.enableAutoResizeColumnsByCellContent&&this.resizerService?.resizeColumnsByCellContent&&this.resizerService.resizeColumnsByCellContent())}showHeaderRow(e=!0){return this.slickGrid?.setHeaderRowVisibility(e),this.slickGrid&&!0===e&&this._isGridInitialized&&this.slickGrid.setColumns(this.columnDefinitions),e}setData(e,t=!1){t&&(this._isAutosizeColsCalled=!1,this._currentDatasetLength=0),this.dataset=e||[]}setPaginationOptionsWhenPresetDefined(e,t){return e.presets?.pagination&&t&&!this._isPaginationInitialized&&(this.hasBackendInfiniteScroll()?console.warn("[Slickgrid-Universal] `presets.pagination` is not supported with Infinite Scroll, reverting to first page."):(t.pageSize=e.presets.pagination.pageSize,t.pageNumber=e.presets.pagination.pageNumber)),t}setDarkMode(e=!1){e?this._gridParentContainerElm.classList.add("slick-dark-mode"):this._gridParentContainerElm.classList.remove("slick-dark-mode")}copyColumnWidthsReference(e){e.forEach((e=>e.originalWidth=e.width))}displayEmptyDataWarning(e=!0){this.gridOptions.enableEmptyDataWarningMessage&&this.slickEmptyWarning?.showEmptyDataMessage(e)}handleOnItemCountChanged(e,t){this._currentDatasetLength=t,this.metrics={startTime:new Date,endTime:new Date,itemCount:e,totalItemCount:t},this.slickFooter&&(this.slickFooter.metrics=this.metrics),this._isLocalGrid&&this._gridOptions?.enableEmptyDataWarningMessage&&this.displayEmptyDataWarning(0===e)}initializePaginationService(e){this.slickGrid&&this.gridOptions&&(this.paginationData={gridOptions:this.gridOptions,paginationService:this.paginationService},this.paginationService.totalItems=this.totalItems,this.paginationService.init(this.slickGrid,e,this.backendServiceApi),this.subscriptions.push(this._eventPubSubService.subscribe("onPaginationChanged",(e=>this.paginationChanged(e))),this._eventPubSubService.subscribe("onPaginationVisibilityChanged",(e=>{this.showPagination=e?.visible??!1,this.gridOptions?.backendServiceApi&&this.backendUtilityService?.refreshBackendDataset(this.gridOptions),this.renderPagination(this.showPagination)}))),this.renderPagination(),this._isPaginationInitialized=!0)}renderPagination(e=!0){if(this.slickGrid&&this._gridOptions?.enablePagination&&!this._isPaginationInitialized&&e){const e=this.gridOptions.customPaginationComponent??qa;this.paginationComponent=new e,this.paginationComponent.init(this.slickGrid,this.paginationService,this._eventPubSubService,this.translaterService),this.paginationComponent.renderPagination(this._gridParentContainerElm),this._isPaginationInitialized=!0}else e||(this.paginationComponent?.dispose(),this._isPaginationInitialized=!1)}loadEditorCollectionAsync(e){if(e?.editor){const t=e.editor.collectionAsync;e.editor.disabled=!0,t instanceof Promise?t.then((t=>{Array.isArray(t)?this.updateEditorCollection(e,t):t?.status>=200&&t.status<300&&"function"==typeof t.json?t.bodyUsed?console.warn("[SlickGrid-Universal] The response body passed to collectionAsync was already read.Either pass the dataset from the Response or clone the response first using response.clone()"):t.json().then((t=>this.updateEditorCollection(e,t))):t?.content&&this.updateEditorCollection(e,t.content)})):this.rxjs?.isObservable(t)&&queueMicrotask((()=>{this.subscriptions.push(t.subscribe((t=>this.updateEditorCollection(e,t))))}))}}insertDynamicPresetColumns(e,t){if(this._columnDefinitions){const i=this._columnDefinitions.findIndex((t=>t.id===e));if(i>=0){const s=this._columnDefinitions[i];s?.id!==e||t.some((t=>t.id===e))||(i>0?t.splice(i,0,s):t.unshift(s))}}}loadColumnPresetsWhenDatasetInitialized(){if(this.slickGrid&&this.gridOptions.presets&&Array.isArray(this.gridOptions.presets.columns)&&this.gridOptions.presets.columns.length>0){const e=this.gridStateService.getAssociatedGridColumns(this.slickGrid,this.gridOptions.presets.columns);if(e&&Array.isArray(e)&&e.length>0&&Array.isArray(this._columnDefinitions)){if(this.gridOptions.enableRowMoveManager){const t=this.gridOptions?.rowMoveManager?.columnId??"_move";this.insertDynamicPresetColumns(t,e)}if(this.gridOptions.enableCheckboxSelector){const t=this.gridOptions?.checkboxSelector?.columnId??"_checkbox_selector";this.insertDynamicPresetColumns(t,e)}if(this.gridOptions.enableRowDetailView){const t=this.gridOptions?.rowDetailView?.columnId??"_detail_selector";this.insertDynamicPresetColumns(t,e)}e.forEach((e=>e.originalWidth=e.width)),this.slickGrid.setColumns(e),this.sharedService.visibleColumns=e}}}loadFilterPresetsWhenDatasetInitialized(){this.gridOptions&&!this.customDataView&&this.gridOptions.presets&&(Array.isArray(this.gridOptions.presets.filters)||Array.isArray(this.gridOptions.presets?.treeData?.toggledItems))&&this.filterService.populateColumnFilterSearchTermPresets(this.gridOptions.presets?.filters||[])}loadLocalGridPagination(e){if(this.gridOptions&&this._paginationOptions){if(this.totalItems=Array.isArray(e)?e.length:0,this._paginationOptions&&this.dataView?.getPagingInfo){const e=this.dataView.getPagingInfo();e?.hasOwnProperty("totalRows")&&this._paginationOptions.totalItems!==e.totalRows&&(this.totalItems=e?.totalRows||0)}this._paginationOptions.totalItems=this.totalItems;const t=this.setPaginationOptionsWhenPresetDefined(this.gridOptions,this._paginationOptions);this.initializePaginationService(t)}}loadRowSelectionPresetWhenExists(){const e=this.gridOptions?.presets,t=this.slickGrid?.getSelectionModel(),i=this.gridOptions&&(this.gridOptions.enableCheckboxSelector||this.gridOptions.enableRowSelection);if(this.slickGrid&&this.dataView&&i&&t&&e?.rowSelection&&(Array.isArray(e.rowSelection.gridRowIndexes)||Array.isArray(e.rowSelection.dataContextIds))){let t=e.rowSelection.dataContextIds,i=e.rowSelection.gridRowIndexes;Array.isArray(t)&&t.length>0?i=this.dataView.mapIdsToRows(t)||[]:Array.isArray(i)&&i.length>0&&(t=this.dataView.mapRowsToIds(i)||[]),this.slickGrid&&Array.isArray(i)&&(this.slickGrid.setSelectedRows(i),this.dataView.setSelectedIds(t||[],{isRowBeingAdded:!0,shouldTriggerEvent:!1,applyRowSelectionToGrid:!0}))}}registerExternalResources(e,t=!1){t&&this.disposeExternalResources(),e.forEach((e=>this._registeredResources.push(e))),this.initializeExternalResources(e)}resetExternalResources(){this._registeredResources=[]}preRegisterResources(){if(Array.isArray(this._registeredResources))for(const e of this._registeredResources)"RxJsResource"===e?.className&&this.registerRxJsResource(e)}initializeExternalResources(e){if(Array.isArray(e))for(const t of e)this.slickGrid&&"function"==typeof t.init&&t.init(this.slickGrid,this.universalContainerService)}registerResources(){Array.isArray(this._registeredResources)&&(this.sharedService.externalRegisteredResources=this._registeredResources),this._registeredResources.push(this.gridService,this.gridStateService),(this.gridOptions.createPreHeaderPanel&&this.gridOptions.createTopHeaderPanel||this.gridOptions.createPreHeaderPanel&&!this.gridOptions.enableDraggableGrouping)&&this._registeredResources.push(this.headerGroupingService),this.gridOptions.enableTreeData&&this._registeredResources.push(this.treeDataService),this.gridOptions.enableTranslate&&this.extensionService.translateColumnHeaders(),this.slickEmptyWarning=new ja,this._registeredResources.push(this.slickEmptyWarning),this.initializeExternalResources(this._registeredResources)}registerRxJsResource(e){this.rxjs=e,this.backendUtilityService.addRxJsResource(this.rxjs),this.filterFactory.addRxJsResource(this.rxjs),this.filterService.addRxJsResource(this.rxjs),this.sortService.addRxJsResource(this.rxjs),this.paginationService.addRxJsResource(this.rxjs),this.universalContainerService.registerInstance("RxJsFacade",this.rxjs),this.universalContainerService.registerInstance("RxJsResource",this.rxjs)}sortTreeDataset(e,t=!1){const i=this._currentDatasetLength;let s,n=[];return this._isDatasetHierarchicalInitialized&&this.datasetHierarchical?(s=this.treeDataService.sortHierarchicalDataset(this.datasetHierarchical),n=s.flat):Array.isArray(e)&&e.length>0&&(s=this.treeDataService.convertFlatParentChildToTreeDatasetAndSort(e,this._columnDefinitions||[],this.gridOptions),this.sharedService.hierarchicalDataset=s.hierarchical,n=s.flat),e.length>0&&(t||e.length!==i)&&this.filterService.refreshTreeDataFilters(n),n}loadSlickGridEditors(e){const t=Array.isArray(e)?e:[];return t.some((e=>`${e.id}`.includes(".")))&&console.error('[Slickgrid-Universal] Make sure that none of your Column Definition "id" property includes a dot in its name because that will cause some problems with the Editors. For example if your column definition "field" property is "user.firstName" then use "firstName" as the column "id".'),t.map((e=>(e.editor?.collectionAsync&&this.loadEditorCollectionAsync(e),{...e,editorClass:e.editor?.model})))}suggestDateParsingWhenHelpful(){!this.gridOptions.silenceWarnings&&this.dataView&&this.dataView.getItemCount()>1e4&&!this.gridOptions.preParseDateColumns&&this.slickGrid?.getColumns().some((e=>q(e.type)))&&console.warn("[Slickgrid-Universal] For getting better perf, we suggest you enable the `preParseDateColumns` grid option, for more info visit => https://ghiscoding.gitbook.io/slickgrid-universal/column-functionalities/sorting#pre-parse-date-columns-for-better-perf")}updateEditorCollection(e,t){if(this.slickGrid&&e.editor){e.editor.collection=t,e.editor.disabled=!1;const i=this.slickGrid.getCellEditor();i?.disable&&i?.renderDomElement&&("function"==typeof i.destroy&&i.destroy(),i.disable(!1),i.renderDomElement(t))}}},Aggregators:Da,BindingService:Ua,Editors:Fa,Enums:s,Filters:Oa,Formatters:za,GroupTotalFormatters:$a,SortComparers:Bt,Utilities:Wa};"undefined"!=typeof window&&(window.Slicker=Xa);var Za=i(744);const Qa=Symbol.for("Dexie"),Ja=globalThis[Qa]||(globalThis[Qa]=Za);if(Za.semVer!==Ja.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${Za.semVer} and ${Ja.semVer}`);const{liveQuery:el,mergeRanges:tl,rangesOverlap:il,RangeSet:sl,cmp:nl,Entity:rl,PropModSymbol:ol,PropModification:al,replacePrefix:ll,add:hl,remove:cl}=Ja,dl=Ja;var ul="top",pl="bottom",ml="right",fl="left",gl="auto",_l=[ul,pl,ml,fl],vl="start",bl="end",yl="clippingParents",Cl="viewport",wl="popper",Sl="reference",El=_l.reduce((function(e,t){return e.concat([t+"-"+vl,t+"-"+bl])}),[]),xl=[].concat(_l,[gl]).reduce((function(e,t){return e.concat([t,t+"-"+vl,t+"-"+bl])}),[]),Tl="beforeRead",Ol="read",kl="afterRead",Il="beforeMain",Al="main",Dl="afterMain",Rl="beforeWrite",Pl="write",Ll="afterWrite",Ml=[Tl,Ol,kl,Il,Al,Dl,Rl,Pl,Ll];function Nl(e){return e?(e.nodeName||"").toLowerCase():null}function Fl(e){if(null==e)return window;if("[object Window]"!==e.toString()){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function Bl(e){return e instanceof Fl(e).Element||e instanceof Element}function Hl(e){return e instanceof Fl(e).HTMLElement||e instanceof HTMLElement}function zl(e){return"undefined"!=typeof ShadowRoot&&(e instanceof Fl(e).ShadowRoot||e instanceof ShadowRoot)}const $l={name:"applyStyles",enabled:!0,phase:"write",fn:function(e){var t=e.state;Object.keys(t.elements).forEach((function(e){var i=t.styles[e]||{},s=t.attributes[e]||{},n=t.elements[e];Hl(n)&&Nl(n)&&(Object.assign(n.style,i),Object.keys(s).forEach((function(e){var t=s[e];!1===t?n.removeAttribute(e):n.setAttribute(e,!0===t?"":t)})))}))},effect:function(e){var t=e.state,i={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,i.popper),t.styles=i,t.elements.arrow&&Object.assign(t.elements.arrow.style,i.arrow),function(){Object.keys(t.elements).forEach((function(e){var s=t.elements[e],n=t.attributes[e]||{},r=Object.keys(t.styles.hasOwnProperty(e)?t.styles[e]:i[e]).reduce((function(e,t){return e[t]="",e}),{});Hl(s)&&Nl(s)&&(Object.assign(s.style,r),Object.keys(n).forEach((function(e){s.removeAttribute(e)})))}))}},requires:["computeStyles"]};function Vl(e){return e.split("-")[0]}var Wl=Math.max,Ul=Math.min,jl=Math.round;function Gl(){var e=navigator.userAgentData;return null!=e&&e.brands&&Array.isArray(e.brands)?e.brands.map((function(e){return e.brand+"/"+e.version})).join(" "):navigator.userAgent}function ql(){return!/^((?!chrome|android).)*safari/i.test(Gl())}function Kl(e,t,i){void 0===t&&(t=!1),void 0===i&&(i=!1);var s=e.getBoundingClientRect(),n=1,r=1;t&&Hl(e)&&(n=e.offsetWidth>0&&jl(s.width)/e.offsetWidth||1,r=e.offsetHeight>0&&jl(s.height)/e.offsetHeight||1);var o=(Bl(e)?Fl(e):window).visualViewport,a=!ql()&&i,l=(s.left+(a&&o?o.offsetLeft:0))/n,h=(s.top+(a&&o?o.offsetTop:0))/r,c=s.width/n,d=s.height/r;return{width:c,height:d,top:h,right:l+c,bottom:h+d,left:l,x:l,y:h}}function Yl(e){var t=Kl(e),i=e.offsetWidth,s=e.offsetHeight;return Math.abs(t.width-i)<=1&&(i=t.width),Math.abs(t.height-s)<=1&&(s=t.height),{x:e.offsetLeft,y:e.offsetTop,width:i,height:s}}function Xl(e,t){var i=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(i&&zl(i)){var s=t;do{if(s&&e.isSameNode(s))return!0;s=s.parentNode||s.host}while(s)}return!1}function Zl(e){return Fl(e).getComputedStyle(e)}function Ql(e){return["table","td","th"].indexOf(Nl(e))>=0}function Jl(e){return((Bl(e)?e.ownerDocument:e.document)||window.document).documentElement}function eh(e){return"html"===Nl(e)?e:e.assignedSlot||e.parentNode||(zl(e)?e.host:null)||Jl(e)}function th(e){return Hl(e)&&"fixed"!==Zl(e).position?e.offsetParent:null}function ih(e){for(var t=Fl(e),i=th(e);i&&Ql(i)&&"static"===Zl(i).position;)i=th(i);return i&&("html"===Nl(i)||"body"===Nl(i)&&"static"===Zl(i).position)?t:i||function(e){var t=/firefox/i.test(Gl());if(/Trident/i.test(Gl())&&Hl(e)&&"fixed"===Zl(e).position)return null;var i=eh(e);for(zl(i)&&(i=i.host);Hl(i)&&["html","body"].indexOf(Nl(i))<0;){var s=Zl(i);if("none"!==s.transform||"none"!==s.perspective||"paint"===s.contain||-1!==["transform","perspective"].indexOf(s.willChange)||t&&"filter"===s.willChange||t&&s.filter&&"none"!==s.filter)return i;i=i.parentNode}return null}(e)||t}function sh(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function nh(e,t,i){return Wl(e,Ul(t,i))}function rh(e){return Object.assign({},{top:0,right:0,bottom:0,left:0},e)}function oh(e,t){return t.reduce((function(t,i){return t[i]=e,t}),{})}const ah={name:"arrow",enabled:!0,phase:"main",fn:function(e){var t,i=e.state,s=e.name,n=e.options,r=i.elements.arrow,o=i.modifiersData.popperOffsets,a=Vl(i.placement),l=sh(a),h=[fl,ml].indexOf(a)>=0?"height":"width";if(r&&o){var c=function(e,t){return rh("number"!=typeof(e="function"==typeof e?e(Object.assign({},t.rects,{placement:t.placement})):e)?e:oh(e,_l))}(n.padding,i),d=Yl(r),u="y"===l?ul:fl,p="y"===l?pl:ml,m=i.rects.reference[h]+i.rects.reference[l]-o[l]-i.rects.popper[h],f=o[l]-i.rects.reference[l],g=ih(r),_=g?"y"===l?g.clientHeight||0:g.clientWidth||0:0,v=m/2-f/2,b=c[u],y=_-d[h]-c[p],C=_/2-d[h]/2+v,w=nh(b,C,y),S=l;i.modifiersData[s]=((t={})[S]=w,t.centerOffset=w-C,t)}},effect:function(e){var t=e.state,i=e.options.element,s=void 0===i?"[data-popper-arrow]":i;null!=s&&("string"!=typeof s||(s=t.elements.popper.querySelector(s)))&&Xl(t.elements.popper,s)&&(t.elements.arrow=s)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function lh(e){return e.split("-")[1]}var hh={top:"auto",right:"auto",bottom:"auto",left:"auto"};function ch(e){var t,i=e.popper,s=e.popperRect,n=e.placement,r=e.variation,o=e.offsets,a=e.position,l=e.gpuAcceleration,h=e.adaptive,c=e.roundOffsets,d=e.isFixed,u=o.x,p=void 0===u?0:u,m=o.y,f=void 0===m?0:m,g="function"==typeof c?c({x:p,y:f}):{x:p,y:f};p=g.x,f=g.y;var _=o.hasOwnProperty("x"),v=o.hasOwnProperty("y"),b=fl,y=ul,C=window;if(h){var w=ih(i),S="clientHeight",E="clientWidth";w===Fl(i)&&"static"!==Zl(w=Jl(i)).position&&"absolute"===a&&(S="scrollHeight",E="scrollWidth"),(n===ul||(n===fl||n===ml)&&r===bl)&&(y=pl,f-=(d&&w===C&&C.visualViewport?C.visualViewport.height:w[S])-s.height,f*=l?1:-1),n!==fl&&(n!==ul&&n!==pl||r!==bl)||(b=ml,p-=(d&&w===C&&C.visualViewport?C.visualViewport.width:w[E])-s.width,p*=l?1:-1)}var x,T=Object.assign({position:a},h&&hh),O=!0===c?function(e,t){var i=e.x,s=e.y,n=t.devicePixelRatio||1;return{x:jl(i*n)/n||0,y:jl(s*n)/n||0}}({x:p,y:f},Fl(i)):{x:p,y:f};return p=O.x,f=O.y,l?Object.assign({},T,((x={})[y]=v?"0":"",x[b]=_?"0":"",x.transform=(C.devicePixelRatio||1)<=1?"translate("+p+"px, "+f+"px)":"translate3d("+p+"px, "+f+"px, 0)",x)):Object.assign({},T,((t={})[y]=v?f+"px":"",t[b]=_?p+"px":"",t.transform="",t))}const dh={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(e){var t=e.state,i=e.options,s=i.gpuAcceleration,n=void 0===s||s,r=i.adaptive,o=void 0===r||r,a=i.roundOffsets,l=void 0===a||a,h={placement:Vl(t.placement),variation:lh(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:n,isFixed:"fixed"===t.options.strategy};null!=t.modifiersData.popperOffsets&&(t.styles.popper=Object.assign({},t.styles.popper,ch(Object.assign({},h,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:o,roundOffsets:l})))),null!=t.modifiersData.arrow&&(t.styles.arrow=Object.assign({},t.styles.arrow,ch(Object.assign({},h,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})},data:{}};var uh={passive:!0};const ph={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(e){var t=e.state,i=e.instance,s=e.options,n=s.scroll,r=void 0===n||n,o=s.resize,a=void 0===o||o,l=Fl(t.elements.popper),h=[].concat(t.scrollParents.reference,t.scrollParents.popper);return r&&h.forEach((function(e){e.addEventListener("scroll",i.update,uh)})),a&&l.addEventListener("resize",i.update,uh),function(){r&&h.forEach((function(e){e.removeEventListener("scroll",i.update,uh)})),a&&l.removeEventListener("resize",i.update,uh)}},data:{}};var mh={left:"right",right:"left",bottom:"top",top:"bottom"};function fh(e){return e.replace(/left|right|bottom|top/g,(function(e){return mh[e]}))}var gh={start:"end",end:"start"};function _h(e){return e.replace(/start|end/g,(function(e){return gh[e]}))}function vh(e){var t=Fl(e);return{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function bh(e){return Kl(Jl(e)).left+vh(e).scrollLeft}function yh(e){var t=Zl(e),i=t.overflow,s=t.overflowX,n=t.overflowY;return/auto|scroll|overlay|hidden/.test(i+n+s)}function Ch(e){return["html","body","#document"].indexOf(Nl(e))>=0?e.ownerDocument.body:Hl(e)&&yh(e)?e:Ch(eh(e))}function wh(e,t){var i;void 0===t&&(t=[]);var s=Ch(e),n=s===(null==(i=e.ownerDocument)?void 0:i.body),r=Fl(s),o=n?[r].concat(r.visualViewport||[],yh(s)?s:[]):s,a=t.concat(o);return n?a:a.concat(wh(eh(o)))}function Sh(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function Eh(e,t,i){return t===Cl?Sh(function(e,t){var i=Fl(e),s=Jl(e),n=i.visualViewport,r=s.clientWidth,o=s.clientHeight,a=0,l=0;if(n){r=n.width,o=n.height;var h=ql();(h||!h&&"fixed"===t)&&(a=n.offsetLeft,l=n.offsetTop)}return{width:r,height:o,x:a+bh(e),y:l}}(e,i)):Bl(t)?function(e,t){var i=Kl(e,!1,"fixed"===t);return i.top=i.top+e.clientTop,i.left=i.left+e.clientLeft,i.bottom=i.top+e.clientHeight,i.right=i.left+e.clientWidth,i.width=e.clientWidth,i.height=e.clientHeight,i.x=i.left,i.y=i.top,i}(t,i):Sh(function(e){var t,i=Jl(e),s=vh(e),n=null==(t=e.ownerDocument)?void 0:t.body,r=Wl(i.scrollWidth,i.clientWidth,n?n.scrollWidth:0,n?n.clientWidth:0),o=Wl(i.scrollHeight,i.clientHeight,n?n.scrollHeight:0,n?n.clientHeight:0),a=-s.scrollLeft+bh(e),l=-s.scrollTop;return"rtl"===Zl(n||i).direction&&(a+=Wl(i.clientWidth,n?n.clientWidth:0)-r),{width:r,height:o,x:a,y:l}}(Jl(e)))}function xh(e){var t,i=e.reference,s=e.element,n=e.placement,r=n?Vl(n):null,o=n?lh(n):null,a=i.x+i.width/2-s.width/2,l=i.y+i.height/2-s.height/2;switch(r){case ul:t={x:a,y:i.y-s.height};break;case pl:t={x:a,y:i.y+i.height};break;case ml:t={x:i.x+i.width,y:l};break;case fl:t={x:i.x-s.width,y:l};break;default:t={x:i.x,y:i.y}}var h=r?sh(r):null;if(null!=h){var c="y"===h?"height":"width";switch(o){case vl:t[h]=t[h]-(i[c]/2-s[c]/2);break;case bl:t[h]=t[h]+(i[c]/2-s[c]/2)}}return t}function Th(e,t){void 0===t&&(t={});var i=t,s=i.placement,n=void 0===s?e.placement:s,r=i.strategy,o=void 0===r?e.strategy:r,a=i.boundary,l=void 0===a?yl:a,h=i.rootBoundary,c=void 0===h?Cl:h,d=i.elementContext,u=void 0===d?wl:d,p=i.altBoundary,m=void 0!==p&&p,f=i.padding,g=void 0===f?0:f,_=rh("number"!=typeof g?g:oh(g,_l)),v=u===wl?Sl:wl,b=e.rects.popper,y=e.elements[m?v:u],C=function(e,t,i,s){var n="clippingParents"===t?function(e){var t=wh(eh(e)),i=["absolute","fixed"].indexOf(Zl(e).position)>=0&&Hl(e)?ih(e):e;return Bl(i)?t.filter((function(e){return Bl(e)&&Xl(e,i)&&"body"!==Nl(e)})):[]}(e):[].concat(t),r=[].concat(n,[i]),o=r[0],a=r.reduce((function(t,i){var n=Eh(e,i,s);return t.top=Wl(n.top,t.top),t.right=Ul(n.right,t.right),t.bottom=Ul(n.bottom,t.bottom),t.left=Wl(n.left,t.left),t}),Eh(e,o,s));return a.width=a.right-a.left,a.height=a.bottom-a.top,a.x=a.left,a.y=a.top,a}(Bl(y)?y:y.contextElement||Jl(e.elements.popper),l,c,o),w=Kl(e.elements.reference),S=xh({reference:w,element:b,strategy:"absolute",placement:n}),E=Sh(Object.assign({},b,S)),x=u===wl?E:w,T={top:C.top-x.top+_.top,bottom:x.bottom-C.bottom+_.bottom,left:C.left-x.left+_.left,right:x.right-C.right+_.right},O=e.modifiersData.offset;if(u===wl&&O){var k=O[n];Object.keys(T).forEach((function(e){var t=[ml,pl].indexOf(e)>=0?1:-1,i=[ul,pl].indexOf(e)>=0?"y":"x";T[e]+=k[i]*t}))}return T}const Oh={name:"flip",enabled:!0,phase:"main",fn:function(e){var t=e.state,i=e.options,s=e.name;if(!t.modifiersData[s]._skip){for(var n=i.mainAxis,r=void 0===n||n,o=i.altAxis,a=void 0===o||o,l=i.fallbackPlacements,h=i.padding,c=i.boundary,d=i.rootBoundary,u=i.altBoundary,p=i.flipVariations,m=void 0===p||p,f=i.allowedAutoPlacements,g=t.options.placement,_=Vl(g),v=l||(_!==g&&m?function(e){if(Vl(e)===gl)return[];var t=fh(e);return[_h(e),t,_h(t)]}(g):[fh(g)]),b=[g].concat(v).reduce((function(e,i){return e.concat(Vl(i)===gl?function(e,t){void 0===t&&(t={});var i=t,s=i.placement,n=i.boundary,r=i.rootBoundary,o=i.padding,a=i.flipVariations,l=i.allowedAutoPlacements,h=void 0===l?xl:l,c=lh(s),d=c?a?El:El.filter((function(e){return lh(e)===c})):_l,u=d.filter((function(e){return h.indexOf(e)>=0}));0===u.length&&(u=d);var p=u.reduce((function(t,i){return t[i]=Th(e,{placement:i,boundary:n,rootBoundary:r,padding:o})[Vl(i)],t}),{});return Object.keys(p).sort((function(e,t){return p[e]-p[t]}))}(t,{placement:i,boundary:c,rootBoundary:d,padding:h,flipVariations:m,allowedAutoPlacements:f}):i)}),[]),y=t.rects.reference,C=t.rects.popper,w=new Map,S=!0,E=b[0],x=0;x<b.length;x++){var T=b[x],O=Vl(T),k=lh(T)===vl,I=[ul,pl].indexOf(O)>=0,A=I?"width":"height",D=Th(t,{placement:T,boundary:c,rootBoundary:d,altBoundary:u,padding:h}),R=I?k?ml:fl:k?pl:ul;y[A]>C[A]&&(R=fh(R));var P=fh(R),L=[];if(r&&L.push(D[O]<=0),a&&L.push(D[R]<=0,D[P]<=0),L.every((function(e){return e}))){E=T,S=!1;break}w.set(T,L)}if(S)for(var M=function(e){var t=b.find((function(t){var i=w.get(t);if(i)return i.slice(0,e).every((function(e){return e}))}));if(t)return E=t,"break"},N=m?3:1;N>0&&"break"!==M(N);N--);t.placement!==E&&(t.modifiersData[s]._skip=!0,t.placement=E,t.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function kh(e,t,i){return void 0===i&&(i={x:0,y:0}),{top:e.top-t.height-i.y,right:e.right-t.width+i.x,bottom:e.bottom-t.height+i.y,left:e.left-t.width-i.x}}function Ih(e){return[ul,ml,pl,fl].some((function(t){return e[t]>=0}))}const Ah={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(e){var t=e.state,i=e.name,s=t.rects.reference,n=t.rects.popper,r=t.modifiersData.preventOverflow,o=Th(t,{elementContext:"reference"}),a=Th(t,{altBoundary:!0}),l=kh(o,s),h=kh(a,n,r),c=Ih(l),d=Ih(h);t.modifiersData[i]={referenceClippingOffsets:l,popperEscapeOffsets:h,isReferenceHidden:c,hasPopperEscaped:d},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":c,"data-popper-escaped":d})}},Dh={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(e){var t=e.state,i=e.options,s=e.name,n=i.offset,r=void 0===n?[0,0]:n,o=xl.reduce((function(e,i){return e[i]=function(e,t,i){var s=Vl(e),n=[fl,ul].indexOf(s)>=0?-1:1,r="function"==typeof i?i(Object.assign({},t,{placement:e})):i,o=r[0],a=r[1];return o=o||0,a=(a||0)*n,[fl,ml].indexOf(s)>=0?{x:a,y:o}:{x:o,y:a}}(i,t.rects,r),e}),{}),a=o[t.placement],l=a.x,h=a.y;null!=t.modifiersData.popperOffsets&&(t.modifiersData.popperOffsets.x+=l,t.modifiersData.popperOffsets.y+=h),t.modifiersData[s]=o}},Rh={name:"popperOffsets",enabled:!0,phase:"read",fn:function(e){var t=e.state,i=e.name;t.modifiersData[i]=xh({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})},data:{}},Ph={name:"preventOverflow",enabled:!0,phase:"main",fn:function(e){var t=e.state,i=e.options,s=e.name,n=i.mainAxis,r=void 0===n||n,o=i.altAxis,a=void 0!==o&&o,l=i.boundary,h=i.rootBoundary,c=i.altBoundary,d=i.padding,u=i.tether,p=void 0===u||u,m=i.tetherOffset,f=void 0===m?0:m,g=Th(t,{boundary:l,rootBoundary:h,padding:d,altBoundary:c}),_=Vl(t.placement),v=lh(t.placement),b=!v,y=sh(_),C="x"===y?"y":"x",w=t.modifiersData.popperOffsets,S=t.rects.reference,E=t.rects.popper,x="function"==typeof f?f(Object.assign({},t.rects,{placement:t.placement})):f,T="number"==typeof x?{mainAxis:x,altAxis:x}:Object.assign({mainAxis:0,altAxis:0},x),O=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,k={x:0,y:0};if(w){if(r){var I,A="y"===y?ul:fl,D="y"===y?pl:ml,R="y"===y?"height":"width",P=w[y],L=P+g[A],M=P-g[D],N=p?-E[R]/2:0,F=v===vl?S[R]:E[R],B=v===vl?-E[R]:-S[R],H=t.elements.arrow,z=p&&H?Yl(H):{width:0,height:0},$=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},V=$[A],W=$[D],U=nh(0,S[R],z[R]),j=b?S[R]/2-N-U-V-T.mainAxis:F-U-V-T.mainAxis,G=b?-S[R]/2+N+U+W+T.mainAxis:B+U+W+T.mainAxis,q=t.elements.arrow&&ih(t.elements.arrow),K=q?"y"===y?q.clientTop||0:q.clientLeft||0:0,Y=null!=(I=null==O?void 0:O[y])?I:0,X=P+G-Y,Z=nh(p?Ul(L,P+j-Y-K):L,P,p?Wl(M,X):M);w[y]=Z,k[y]=Z-P}if(a){var Q,J="x"===y?ul:fl,ee="x"===y?pl:ml,te=w[C],ie="y"===C?"height":"width",se=te+g[J],ne=te-g[ee],re=-1!==[ul,fl].indexOf(_),oe=null!=(Q=null==O?void 0:O[C])?Q:0,ae=re?se:te-S[ie]-E[ie]-oe+T.altAxis,le=re?te+S[ie]+E[ie]-oe-T.altAxis:ne,he=p&&re?function(e,t,i){var s=nh(e,t,i);return s>i?i:s}(ae,te,le):nh(p?ae:se,te,p?le:ne);w[C]=he,k[C]=he-te}t.modifiersData[s]=k}},requiresIfExists:["offset"]};function Lh(e,t,i){void 0===i&&(i=!1);var s,n,r=Hl(t),o=Hl(t)&&function(e){var t=e.getBoundingClientRect(),i=jl(t.width)/e.offsetWidth||1,s=jl(t.height)/e.offsetHeight||1;return 1!==i||1!==s}(t),a=Jl(t),l=Kl(e,o,i),h={scrollLeft:0,scrollTop:0},c={x:0,y:0};return(r||!r&&!i)&&(("body"!==Nl(t)||yh(a))&&(h=(s=t)!==Fl(s)&&Hl(s)?{scrollLeft:(n=s).scrollLeft,scrollTop:n.scrollTop}:vh(s)),Hl(t)?((c=Kl(t,!0)).x+=t.clientLeft,c.y+=t.clientTop):a&&(c.x=bh(a))),{x:l.left+h.scrollLeft-c.x,y:l.top+h.scrollTop-c.y,width:l.width,height:l.height}}function Mh(e){var t=new Map,i=new Set,s=[];function n(e){i.add(e.name),[].concat(e.requires||[],e.requiresIfExists||[]).forEach((function(e){if(!i.has(e)){var s=t.get(e);s&&n(s)}})),s.push(e)}return e.forEach((function(e){t.set(e.name,e)})),e.forEach((function(e){i.has(e.name)||n(e)})),s}var Nh={placement:"bottom",modifiers:[],strategy:"absolute"};function Fh(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return!t.some((function(e){return!(e&&"function"==typeof e.getBoundingClientRect)}))}function Bh(e){void 0===e&&(e={});var t=e,i=t.defaultModifiers,s=void 0===i?[]:i,n=t.defaultOptions,r=void 0===n?Nh:n;return function(e,t,i){void 0===i&&(i=r);var n,o,a={placement:"bottom",orderedModifiers:[],options:Object.assign({},Nh,r),modifiersData:{},elements:{reference:e,popper:t},attributes:{},styles:{}},l=[],h=!1,c={state:a,setOptions:function(i){var n="function"==typeof i?i(a.options):i;d(),a.options=Object.assign({},r,a.options,n),a.scrollParents={reference:Bl(e)?wh(e):e.contextElement?wh(e.contextElement):[],popper:wh(t)};var o,h,u=function(e){var t=Mh(e);return Ml.reduce((function(e,i){return e.concat(t.filter((function(e){return e.phase===i})))}),[])}((o=[].concat(s,a.options.modifiers),h=o.reduce((function(e,t){var i=e[t.name];return e[t.name]=i?Object.assign({},i,t,{options:Object.assign({},i.options,t.options),data:Object.assign({},i.data,t.data)}):t,e}),{}),Object.keys(h).map((function(e){return h[e]}))));return a.orderedModifiers=u.filter((function(e){return e.enabled})),a.orderedModifiers.forEach((function(e){var t=e.name,i=e.options,s=void 0===i?{}:i,n=e.effect;if("function"==typeof n){var r=n({state:a,name:t,instance:c,options:s});l.push(r||function(){})}})),c.update()},forceUpdate:function(){if(!h){var e=a.elements,t=e.reference,i=e.popper;if(Fh(t,i)){a.rects={reference:Lh(t,ih(i),"fixed"===a.options.strategy),popper:Yl(i)},a.reset=!1,a.placement=a.options.placement,a.orderedModifiers.forEach((function(e){return a.modifiersData[e.name]=Object.assign({},e.data)}));for(var s=0;s<a.orderedModifiers.length;s++)if(!0!==a.reset){var n=a.orderedModifiers[s],r=n.fn,o=n.options,l=void 0===o?{}:o,d=n.name;"function"==typeof r&&(a=r({state:a,options:l,name:d,instance:c})||a)}else a.reset=!1,s=-1}}},update:(n=function(){return new Promise((function(e){c.forceUpdate(),e(a)}))},function(){return o||(o=new Promise((function(e){Promise.resolve().then((function(){o=void 0,e(n())}))}))),o}),destroy:function(){d(),h=!0}};if(!Fh(e,t))return c;function d(){l.forEach((function(e){return e()})),l=[]}return c.setOptions(i).then((function(e){!h&&i.onFirstUpdate&&i.onFirstUpdate(e)})),c}}var Hh=Bh(),zh=Bh({defaultModifiers:[ph,Rh,dh,$l,Dh,Oh,Ph,ah,Ah]}),$h=Bh({defaultModifiers:[ph,Rh,dh,$l]});const Vh="transitionend",Wh=e=>{let t=e.getAttribute("data-bs-target");if(!t||"#"===t){let i=e.getAttribute("href");if(!i||!i.includes("#")&&!i.startsWith("."))return null;i.includes("#")&&!i.startsWith("#")&&(i=`#${i.split("#")[1]}`),t=i&&"#"!==i?i.trim():null}return t},Uh=e=>{const t=Wh(e);return t&&document.querySelector(t)?t:null},jh=e=>{const t=Wh(e);return t?document.querySelector(t):null},Gh=e=>{e.dispatchEvent(new Event(Vh))},qh=e=>!(!e||"object"!=typeof e)&&(void 0!==e.jquery&&(e=e[0]),void 0!==e.nodeType),Kh=e=>qh(e)?e.jquery?e[0]:e:"string"==typeof e&&e.length>0?document.querySelector(e):null,Yh=e=>{if(!qh(e)||0===e.getClientRects().length)return!1;const t="visible"===getComputedStyle(e).getPropertyValue("visibility"),i=e.closest("details:not([open])");if(!i)return t;if(i!==e){const t=e.closest("summary");if(t&&t.parentNode!==i)return!1;if(null===t)return!1}return t},Xh=e=>!e||e.nodeType!==Node.ELEMENT_NODE||!!e.classList.contains("disabled")||(void 0!==e.disabled?e.disabled:e.hasAttribute("disabled")&&"false"!==e.getAttribute("disabled")),Zh=e=>{if(!document.documentElement.attachShadow)return null;if("function"==typeof e.getRootNode){const t=e.getRootNode();return t instanceof ShadowRoot?t:null}return e instanceof ShadowRoot?e:e.parentNode?Zh(e.parentNode):null},Qh=()=>{},Jh=e=>{e.offsetHeight},ec=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,tc=[],ic=()=>"rtl"===document.documentElement.dir,sc=e=>{var t;t=()=>{const t=ec();if(t){const i=e.NAME,s=t.fn[i];t.fn[i]=e.jQueryInterface,t.fn[i].Constructor=e,t.fn[i].noConflict=()=>(t.fn[i]=s,e.jQueryInterface)}},"loading"===document.readyState?(tc.length||document.addEventListener("DOMContentLoaded",(()=>{for(const e of tc)e()})),tc.push(t)):t()},nc=e=>{"function"==typeof e&&e()},rc=(e,t,i=!0)=>{if(!i)return void nc(e);const s=(e=>{if(!e)return 0;let{transitionDuration:t,transitionDelay:i}=window.getComputedStyle(e);const s=Number.parseFloat(t),n=Number.parseFloat(i);return s||n?(t=t.split(",")[0],i=i.split(",")[0],1e3*(Number.parseFloat(t)+Number.parseFloat(i))):0})(t)+5;let n=!1;const r=({target:i})=>{i===t&&(n=!0,t.removeEventListener(Vh,r),nc(e))};t.addEventListener(Vh,r),setTimeout((()=>{n||Gh(t)}),s)},oc=(e,t,i,s)=>{const n=e.length;let r=e.indexOf(t);return-1===r?!i&&s?e[n-1]:e[0]:(r+=i?1:-1,s&&(r=(r+n)%n),e[Math.max(0,Math.min(r,n-1))])},ac=/[^.]*(?=\..*)\.|.*/,lc=/\..*/,hc=/::\d+$/,cc={};let dc=1;const uc={mouseenter:"mouseover",mouseleave:"mouseout"},pc=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function mc(e,t){return t&&`${t}::${dc++}`||e.uidEvent||dc++}function fc(e){const t=mc(e);return e.uidEvent=t,cc[t]=cc[t]||{},cc[t]}function gc(e,t,i=null){return Object.values(e).find((e=>e.callable===t&&e.delegationSelector===i))}function _c(e,t,i){const s="string"==typeof t,n=s?i:t||i;let r=Cc(e);return pc.has(r)||(r=e),[s,n,r]}function vc(e,t,i,s,n){if("string"!=typeof t||!e)return;let[r,o,a]=_c(t,i,s);if(t in uc){const e=e=>function(t){if(!t.relatedTarget||t.relatedTarget!==t.delegateTarget&&!t.delegateTarget.contains(t.relatedTarget))return e.call(this,t)};o=e(o)}const l=fc(e),h=l[a]||(l[a]={}),c=gc(h,o,r?i:null);if(c)return void(c.oneOff=c.oneOff&&n);const d=mc(o,t.replace(ac,"")),u=r?function(e,t,i){return function s(n){const r=e.querySelectorAll(t);for(let{target:o}=n;o&&o!==this;o=o.parentNode)for(const a of r)if(a===o)return Sc(n,{delegateTarget:o}),s.oneOff&&wc.off(e,n.type,t,i),i.apply(o,[n])}}(e,i,o):function(e,t){return function i(s){return Sc(s,{delegateTarget:e}),i.oneOff&&wc.off(e,s.type,t),t.apply(e,[s])}}(e,o);u.delegationSelector=r?i:null,u.callable=o,u.oneOff=n,u.uidEvent=d,h[d]=u,e.addEventListener(a,u,r)}function bc(e,t,i,s,n){const r=gc(t[i],s,n);r&&(e.removeEventListener(i,r,Boolean(n)),delete t[i][r.uidEvent])}function yc(e,t,i,s){const n=t[i]||{};for(const r of Object.keys(n))if(r.includes(s)){const s=n[r];bc(e,t,i,s.callable,s.delegationSelector)}}function Cc(e){return e=e.replace(lc,""),uc[e]||e}const wc={on(e,t,i,s){vc(e,t,i,s,!1)},one(e,t,i,s){vc(e,t,i,s,!0)},off(e,t,i,s){if("string"!=typeof t||!e)return;const[n,r,o]=_c(t,i,s),a=o!==t,l=fc(e),h=l[o]||{},c=t.startsWith(".");if(void 0===r){if(c)for(const i of Object.keys(l))yc(e,l,i,t.slice(1));for(const i of Object.keys(h)){const s=i.replace(hc,"");if(!a||t.includes(s)){const t=h[i];bc(e,l,o,t.callable,t.delegationSelector)}}}else{if(!Object.keys(h).length)return;bc(e,l,o,r,n?i:null)}},trigger(e,t,i){if("string"!=typeof t||!e)return null;const s=ec();let n=null,r=!0,o=!0,a=!1;t!==Cc(t)&&s&&(n=s.Event(t,i),s(e).trigger(n),r=!n.isPropagationStopped(),o=!n.isImmediatePropagationStopped(),a=n.isDefaultPrevented());let l=new Event(t,{bubbles:r,cancelable:!0});return l=Sc(l,i),a&&l.preventDefault(),o&&e.dispatchEvent(l),l.defaultPrevented&&n&&n.preventDefault(),l}};function Sc(e,t){for(const[i,s]of Object.entries(t||{}))try{e[i]=s}catch(t){Object.defineProperty(e,i,{configurable:!0,get:()=>s})}return e}const Ec=new Map,xc={set(e,t,i){Ec.has(e)||Ec.set(e,new Map);const s=Ec.get(e);s.has(t)||0===s.size?s.set(t,i):console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(s.keys())[0]}.`)},get:(e,t)=>Ec.has(e)&&Ec.get(e).get(t)||null,remove(e,t){if(!Ec.has(e))return;const i=Ec.get(e);i.delete(t),0===i.size&&Ec.delete(e)}};function Tc(e){if("true"===e)return!0;if("false"===e)return!1;if(e===Number(e).toString())return Number(e);if(""===e||"null"===e)return null;if("string"!=typeof e)return e;try{return JSON.parse(decodeURIComponent(e))}catch(t){return e}}function Oc(e){return e.replace(/[A-Z]/g,(e=>`-${e.toLowerCase()}`))}const kc={setDataAttribute(e,t,i){e.setAttribute(`data-bs-${Oc(t)}`,i)},removeDataAttribute(e,t){e.removeAttribute(`data-bs-${Oc(t)}`)},getDataAttributes(e){if(!e)return{};const t={},i=Object.keys(e.dataset).filter((e=>e.startsWith("bs")&&!e.startsWith("bsConfig")));for(const s of i){let i=s.replace(/^bs/,"");i=i.charAt(0).toLowerCase()+i.slice(1,i.length),t[i]=Tc(e.dataset[s])}return t},getDataAttribute:(e,t)=>Tc(e.getAttribute(`data-bs-${Oc(t)}`))};class Ic{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(e){return e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e}_mergeConfigObj(e,t){const i=qh(t)?kc.getDataAttribute(t,"config"):{};return{...this.constructor.Default,..."object"==typeof i?i:{},...qh(t)?kc.getDataAttributes(t):{},..."object"==typeof e?e:{}}}_typeCheckConfig(e,t=this.constructor.DefaultType){for(const s of Object.keys(t)){const n=t[s],r=e[s],o=qh(r)?"element":null==(i=r)?`${i}`:Object.prototype.toString.call(i).match(/\s([a-z]+)/i)[1].toLowerCase();if(!new RegExp(n).test(o))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${s}" provided type "${o}" but expected type "${n}".`)}var i}}class Ac extends Ic{constructor(e,t){super(),(e=Kh(e))&&(this._element=e,this._config=this._getConfig(t),xc.set(this._element,this.constructor.DATA_KEY,this))}dispose(){xc.remove(this._element,this.constructor.DATA_KEY),wc.off(this._element,this.constructor.EVENT_KEY);for(const e of Object.getOwnPropertyNames(this))this[e]=null}_queueCallback(e,t,i=!0){rc(e,t,i)}_getConfig(e){return e=this._mergeConfigObj(e,this._element),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}static getInstance(e){return xc.get(Kh(e),this.DATA_KEY)}static getOrCreateInstance(e,t={}){return this.getInstance(e)||new this(e,"object"==typeof t?t:null)}static get VERSION(){return"5.2.3"}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(e){return`${e}${this.EVENT_KEY}`}}const Dc=(e,t="hide")=>{const i=`click.dismiss${e.EVENT_KEY}`,s=e.NAME;wc.on(document,i,`[data-bs-dismiss="${s}"]`,(function(i){if(["A","AREA"].includes(this.tagName)&&i.preventDefault(),Xh(this))return;const n=jh(this)||this.closest(`.${s}`);e.getOrCreateInstance(n)[t]()}))},Rc=".bs.alert",Pc=`close${Rc}`,Lc=`closed${Rc}`;class Mc extends Ac{static get NAME(){return"alert"}close(){if(wc.trigger(this._element,Pc).defaultPrevented)return;this._element.classList.remove("show");const e=this._element.classList.contains("fade");this._queueCallback((()=>this._destroyElement()),this._element,e)}_destroyElement(){this._element.remove(),wc.trigger(this._element,Lc),this.dispose()}static jQueryInterface(e){return this.each((function(){const t=Mc.getOrCreateInstance(this);if("string"==typeof e){if(void 0===t[e]||e.startsWith("_")||"constructor"===e)throw new TypeError(`No method named "${e}"`);t[e](this)}}))}}Dc(Mc,"close"),sc(Mc);const Nc='[data-bs-toggle="button"]';class Fc extends Ac{static get NAME(){return"button"}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle("active"))}static jQueryInterface(e){return this.each((function(){const t=Fc.getOrCreateInstance(this);"toggle"===e&&t[e]()}))}}wc.on(document,"click.bs.button.data-api",Nc,(e=>{e.preventDefault();const t=e.target.closest(Nc);Fc.getOrCreateInstance(t).toggle()})),sc(Fc);const Bc={find:(e,t=document.documentElement)=>[].concat(...Element.prototype.querySelectorAll.call(t,e)),findOne:(e,t=document.documentElement)=>Element.prototype.querySelector.call(t,e),children:(e,t)=>[].concat(...e.children).filter((e=>e.matches(t))),parents(e,t){const i=[];let s=e.parentNode.closest(t);for(;s;)i.push(s),s=s.parentNode.closest(t);return i},prev(e,t){let i=e.previousElementSibling;for(;i;){if(i.matches(t))return[i];i=i.previousElementSibling}return[]},next(e,t){let i=e.nextElementSibling;for(;i;){if(i.matches(t))return[i];i=i.nextElementSibling}return[]},focusableChildren(e){const t=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map((e=>`${e}:not([tabindex^="-"])`)).join(",");return this.find(t,e).filter((e=>!Xh(e)&&Yh(e)))}},Hc=".bs.swipe",zc=`touchstart${Hc}`,$c=`touchmove${Hc}`,Vc=`touchend${Hc}`,Wc=`pointerdown${Hc}`,Uc=`pointerup${Hc}`,jc={endCallback:null,leftCallback:null,rightCallback:null},Gc={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class qc extends Ic{constructor(e,t){super(),this._element=e,e&&qc.isSupported()&&(this._config=this._getConfig(t),this._deltaX=0,this._supportPointerEvents=Boolean(window.PointerEvent),this._initEvents())}static get Default(){return jc}static get DefaultType(){return Gc}static get NAME(){return"swipe"}dispose(){wc.off(this._element,Hc)}_start(e){this._supportPointerEvents?this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX):this._deltaX=e.touches[0].clientX}_end(e){this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX-this._deltaX),this._handleSwipe(),nc(this._config.endCallback)}_move(e){this._deltaX=e.touches&&e.touches.length>1?0:e.touches[0].clientX-this._deltaX}_handleSwipe(){const e=Math.abs(this._deltaX);if(e<=40)return;const t=e/this._deltaX;this._deltaX=0,t&&nc(t>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(wc.on(this._element,Wc,(e=>this._start(e))),wc.on(this._element,Uc,(e=>this._end(e))),this._element.classList.add("pointer-event")):(wc.on(this._element,zc,(e=>this._start(e))),wc.on(this._element,$c,(e=>this._move(e))),wc.on(this._element,Vc,(e=>this._end(e))))}_eventIsPointerPenTouch(e){return this._supportPointerEvents&&("pen"===e.pointerType||"touch"===e.pointerType)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const Kc=".bs.carousel",Yc=".data-api",Xc="ArrowLeft",Zc="ArrowRight",Qc="next",Jc="prev",ed="left",td="right",id=`slide${Kc}`,sd=`slid${Kc}`,nd=`keydown${Kc}`,rd=`mouseenter${Kc}`,od=`mouseleave${Kc}`,ad=`dragstart${Kc}`,ld=`load${Kc}${Yc}`,hd=`click${Kc}${Yc}`,cd="carousel",dd="active",ud=".active",pd=".carousel-item",md=ud+pd,fd={[Xc]:td,[Zc]:ed},gd={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},_d={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class vd extends Ac{constructor(e,t){super(e,t),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=Bc.findOne(".carousel-indicators",this._element),this._addEventListeners(),this._config.ride===cd&&this.cycle()}static get Default(){return gd}static get DefaultType(){return _d}static get NAME(){return"carousel"}next(){this._slide(Qc)}nextWhenVisible(){!document.hidden&&Yh(this._element)&&this.next()}prev(){this._slide(Jc)}pause(){this._isSliding&&Gh(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval((()=>this.nextWhenVisible()),this._config.interval)}_maybeEnableCycle(){this._config.ride&&(this._isSliding?wc.one(this._element,sd,(()=>this.cycle())):this.cycle())}to(e){const t=this._getItems();if(e>t.length-1||e<0)return;if(this._isSliding)return void wc.one(this._element,sd,(()=>this.to(e)));const i=this._getItemIndex(this._getActive());if(i===e)return;const s=e>i?Qc:Jc;this._slide(s,t[e])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(e){return e.defaultInterval=e.interval,e}_addEventListeners(){this._config.keyboard&&wc.on(this._element,nd,(e=>this._keydown(e))),"hover"===this._config.pause&&(wc.on(this._element,rd,(()=>this.pause())),wc.on(this._element,od,(()=>this._maybeEnableCycle()))),this._config.touch&&qc.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const e of Bc.find(".carousel-item img",this._element))wc.on(e,ad,(e=>e.preventDefault()));const e={leftCallback:()=>this._slide(this._directionToOrder(ed)),rightCallback:()=>this._slide(this._directionToOrder(td)),endCallback:()=>{"hover"===this._config.pause&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout((()=>this._maybeEnableCycle()),500+this._config.interval))}};this._swipeHelper=new qc(this._element,e)}_keydown(e){if(/input|textarea/i.test(e.target.tagName))return;const t=fd[e.key];t&&(e.preventDefault(),this._slide(this._directionToOrder(t)))}_getItemIndex(e){return this._getItems().indexOf(e)}_setActiveIndicatorElement(e){if(!this._indicatorsElement)return;const t=Bc.findOne(ud,this._indicatorsElement);t.classList.remove(dd),t.removeAttribute("aria-current");const i=Bc.findOne(`[data-bs-slide-to="${e}"]`,this._indicatorsElement);i&&(i.classList.add(dd),i.setAttribute("aria-current","true"))}_updateInterval(){const e=this._activeElement||this._getActive();if(!e)return;const t=Number.parseInt(e.getAttribute("data-bs-interval"),10);this._config.interval=t||this._config.defaultInterval}_slide(e,t=null){if(this._isSliding)return;const i=this._getActive(),s=e===Qc,n=t||oc(this._getItems(),i,s,this._config.wrap);if(n===i)return;const r=this._getItemIndex(n),o=t=>wc.trigger(this._element,t,{relatedTarget:n,direction:this._orderToDirection(e),from:this._getItemIndex(i),to:r});if(o(id).defaultPrevented)return;if(!i||!n)return;const a=Boolean(this._interval);this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(r),this._activeElement=n;const l=s?"carousel-item-start":"carousel-item-end",h=s?"carousel-item-next":"carousel-item-prev";n.classList.add(h),Jh(n),i.classList.add(l),n.classList.add(l),this._queueCallback((()=>{n.classList.remove(l,h),n.classList.add(dd),i.classList.remove(dd,h,l),this._isSliding=!1,o(sd)}),i,this._isAnimated()),a&&this.cycle()}_isAnimated(){return this._element.classList.contains("slide")}_getActive(){return Bc.findOne(md,this._element)}_getItems(){return Bc.find(pd,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(e){return ic()?e===ed?Jc:Qc:e===ed?Qc:Jc}_orderToDirection(e){return ic()?e===Jc?ed:td:e===Jc?td:ed}static jQueryInterface(e){return this.each((function(){const t=vd.getOrCreateInstance(this,e);if("number"!=typeof e){if("string"==typeof e){if(void 0===t[e]||e.startsWith("_")||"constructor"===e)throw new TypeError(`No method named "${e}"`);t[e]()}}else t.to(e)}))}}wc.on(document,hd,"[data-bs-slide], [data-bs-slide-to]",(function(e){const t=jh(this);if(!t||!t.classList.contains(cd))return;e.preventDefault();const i=vd.getOrCreateInstance(t),s=this.getAttribute("data-bs-slide-to");return s?(i.to(s),void i._maybeEnableCycle()):"next"===kc.getDataAttribute(this,"slide")?(i.next(),void i._maybeEnableCycle()):(i.prev(),void i._maybeEnableCycle())})),wc.on(window,ld,(()=>{const e=Bc.find('[data-bs-ride="carousel"]');for(const t of e)vd.getOrCreateInstance(t)})),sc(vd);const bd=".bs.collapse",yd=`show${bd}`,Cd=`shown${bd}`,wd=`hide${bd}`,Sd=`hidden${bd}`,Ed=`click${bd}.data-api`,xd="show",Td="collapse",Od="collapsing",kd=`:scope .${Td} .${Td}`,Id='[data-bs-toggle="collapse"]',Ad={parent:null,toggle:!0},Dd={parent:"(null|element)",toggle:"boolean"};class Rd extends Ac{constructor(e,t){super(e,t),this._isTransitioning=!1,this._triggerArray=[];const i=Bc.find(Id);for(const e of i){const t=Uh(e),i=Bc.find(t).filter((e=>e===this._element));null!==t&&i.length&&this._triggerArray.push(e)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return Ad}static get DefaultType(){return Dd}static get NAME(){return"collapse"}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let e=[];if(this._config.parent&&(e=this._getFirstLevelChildren(".collapse.show, .collapse.collapsing").filter((e=>e!==this._element)).map((e=>Rd.getOrCreateInstance(e,{toggle:!1})))),e.length&&e[0]._isTransitioning)return;if(wc.trigger(this._element,yd).defaultPrevented)return;for(const t of e)t.hide();const t=this._getDimension();this._element.classList.remove(Td),this._element.classList.add(Od),this._element.style[t]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const i=`scroll${t[0].toUpperCase()+t.slice(1)}`;this._queueCallback((()=>{this._isTransitioning=!1,this._element.classList.remove(Od),this._element.classList.add(Td,xd),this._element.style[t]="",wc.trigger(this._element,Cd)}),this._element,!0),this._element.style[t]=`${this._element[i]}px`}hide(){if(this._isTransitioning||!this._isShown())return;if(wc.trigger(this._element,wd).defaultPrevented)return;const e=this._getDimension();this._element.style[e]=`${this._element.getBoundingClientRect()[e]}px`,Jh(this._element),this._element.classList.add(Od),this._element.classList.remove(Td,xd);for(const e of this._triggerArray){const t=jh(e);t&&!this._isShown(t)&&this._addAriaAndCollapsedClass([e],!1)}this._isTransitioning=!0,this._element.style[e]="",this._queueCallback((()=>{this._isTransitioning=!1,this._element.classList.remove(Od),this._element.classList.add(Td),wc.trigger(this._element,Sd)}),this._element,!0)}_isShown(e=this._element){return e.classList.contains(xd)}_configAfterMerge(e){return e.toggle=Boolean(e.toggle),e.parent=Kh(e.parent),e}_getDimension(){return this._element.classList.contains("collapse-horizontal")?"width":"height"}_initializeChildren(){if(!this._config.parent)return;const e=this._getFirstLevelChildren(Id);for(const t of e){const e=jh(t);e&&this._addAriaAndCollapsedClass([t],this._isShown(e))}}_getFirstLevelChildren(e){const t=Bc.find(kd,this._config.parent);return Bc.find(e,this._config.parent).filter((e=>!t.includes(e)))}_addAriaAndCollapsedClass(e,t){if(e.length)for(const i of e)i.classList.toggle("collapsed",!t),i.setAttribute("aria-expanded",t)}static jQueryInterface(e){const t={};return"string"==typeof e&&/show|hide/.test(e)&&(t.toggle=!1),this.each((function(){const i=Rd.getOrCreateInstance(this,t);if("string"==typeof e){if(void 0===i[e])throw new TypeError(`No method named "${e}"`);i[e]()}}))}}wc.on(document,Ed,Id,(function(e){("A"===e.target.tagName||e.delegateTarget&&"A"===e.delegateTarget.tagName)&&e.preventDefault();const t=Uh(this),i=Bc.find(t);for(const e of i)Rd.getOrCreateInstance(e,{toggle:!1}).toggle()})),sc(Rd);const Pd="dropdown",Ld=".bs.dropdown",Md=".data-api",Nd="ArrowUp",Fd="ArrowDown",Bd=`hide${Ld}`,Hd=`hidden${Ld}`,zd=`show${Ld}`,$d=`shown${Ld}`,Vd=`click${Ld}${Md}`,Wd=`keydown${Ld}${Md}`,Ud=`keyup${Ld}${Md}`,jd="show",Gd='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',qd=`${Gd}.${jd}`,Kd=".dropdown-menu",Yd=ic()?"top-end":"top-start",Xd=ic()?"top-start":"top-end",Zd=ic()?"bottom-end":"bottom-start",Qd=ic()?"bottom-start":"bottom-end",Jd=ic()?"left-start":"right-start",eu=ic()?"right-start":"left-start",tu={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},iu={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class su extends Ac{constructor(e,t){super(e,t),this._popper=null,this._parent=this._element.parentNode,this._menu=Bc.next(this._element,Kd)[0]||Bc.prev(this._element,Kd)[0]||Bc.findOne(Kd,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return tu}static get DefaultType(){return iu}static get NAME(){return Pd}toggle(){return this._isShown()?this.hide():this.show()}show(){if(Xh(this._element)||this._isShown())return;const e={relatedTarget:this._element};if(!wc.trigger(this._element,zd,e).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(".navbar-nav"))for(const e of[].concat(...document.body.children))wc.on(e,"mouseover",Qh);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(jd),this._element.classList.add(jd),wc.trigger(this._element,$d,e)}}hide(){if(Xh(this._element)||!this._isShown())return;const e={relatedTarget:this._element};this._completeHide(e)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(e){if(!wc.trigger(this._element,Bd,e).defaultPrevented){if("ontouchstart"in document.documentElement)for(const e of[].concat(...document.body.children))wc.off(e,"mouseover",Qh);this._popper&&this._popper.destroy(),this._menu.classList.remove(jd),this._element.classList.remove(jd),this._element.setAttribute("aria-expanded","false"),kc.removeDataAttribute(this._menu,"popper"),wc.trigger(this._element,Hd,e)}}_getConfig(e){if("object"==typeof(e=super._getConfig(e)).reference&&!qh(e.reference)&&"function"!=typeof e.reference.getBoundingClientRect)throw new TypeError(`${Pd.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return e}_createPopper(){let e=this._element;"parent"===this._config.reference?e=this._parent:qh(this._config.reference)?e=Kh(this._config.reference):"object"==typeof this._config.reference&&(e=this._config.reference);const t=this._getPopperConfig();this._popper=zh(e,this._menu,t)}_isShown(){return this._menu.classList.contains(jd)}_getPlacement(){const e=this._parent;if(e.classList.contains("dropend"))return Jd;if(e.classList.contains("dropstart"))return eu;if(e.classList.contains("dropup-center"))return"top";if(e.classList.contains("dropdown-center"))return"bottom";const t="end"===getComputedStyle(this._menu).getPropertyValue("--bs-position").trim();return e.classList.contains("dropup")?t?Xd:Yd:t?Qd:Zd}_detectNavbar(){return null!==this._element.closest(".navbar")}_getOffset(){const{offset:e}=this._config;return"string"==typeof e?e.split(",").map((e=>Number.parseInt(e,10))):"function"==typeof e?t=>e(t,this._element):e}_getPopperConfig(){const e={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||"static"===this._config.display)&&(kc.setDataAttribute(this._menu,"popper","static"),e.modifiers=[{name:"applyStyles",enabled:!1}]),{...e,..."function"==typeof this._config.popperConfig?this._config.popperConfig(e):this._config.popperConfig}}_selectMenuItem({key:e,target:t}){const i=Bc.find(".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",this._menu).filter((e=>Yh(e)));i.length&&oc(i,t,e===Fd,!i.includes(t)).focus()}static jQueryInterface(e){return this.each((function(){const t=su.getOrCreateInstance(this,e);if("string"==typeof e){if(void 0===t[e])throw new TypeError(`No method named "${e}"`);t[e]()}}))}static clearMenus(e){if(2===e.button||"keyup"===e.type&&"Tab"!==e.key)return;const t=Bc.find(qd);for(const i of t){const t=su.getInstance(i);if(!t||!1===t._config.autoClose)continue;const s=e.composedPath(),n=s.includes(t._menu);if(s.includes(t._element)||"inside"===t._config.autoClose&&!n||"outside"===t._config.autoClose&&n)continue;if(t._menu.contains(e.target)&&("keyup"===e.type&&"Tab"===e.key||/input|select|option|textarea|form/i.test(e.target.tagName)))continue;const r={relatedTarget:t._element};"click"===e.type&&(r.clickEvent=e),t._completeHide(r)}}static dataApiKeydownHandler(e){const t=/input|textarea/i.test(e.target.tagName),i="Escape"===e.key,s=[Nd,Fd].includes(e.key);if(!s&&!i)return;if(t&&!i)return;e.preventDefault();const n=this.matches(Gd)?this:Bc.prev(this,Gd)[0]||Bc.next(this,Gd)[0]||Bc.findOne(Gd,e.delegateTarget.parentNode),r=su.getOrCreateInstance(n);if(s)return e.stopPropagation(),r.show(),void r._selectMenuItem(e);r._isShown()&&(e.stopPropagation(),r.hide(),n.focus())}}wc.on(document,Wd,Gd,su.dataApiKeydownHandler),wc.on(document,Wd,Kd,su.dataApiKeydownHandler),wc.on(document,Vd,su.clearMenus),wc.on(document,Ud,su.clearMenus),wc.on(document,Vd,Gd,(function(e){e.preventDefault(),su.getOrCreateInstance(this).toggle()})),sc(su);const nu=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",ru=".sticky-top",ou="padding-right",au="margin-right";class lu{constructor(){this._element=document.body}getWidth(){const e=document.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}hide(){const e=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,ou,(t=>t+e)),this._setElementAttributes(nu,ou,(t=>t+e)),this._setElementAttributes(ru,au,(t=>t-e))}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,ou),this._resetElementAttributes(nu,ou),this._resetElementAttributes(ru,au)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(e,t,i){const s=this.getWidth();this._applyManipulationCallback(e,(e=>{if(e!==this._element&&window.innerWidth>e.clientWidth+s)return;this._saveInitialAttribute(e,t);const n=window.getComputedStyle(e).getPropertyValue(t);e.style.setProperty(t,`${i(Number.parseFloat(n))}px`)}))}_saveInitialAttribute(e,t){const i=e.style.getPropertyValue(t);i&&kc.setDataAttribute(e,t,i)}_resetElementAttributes(e,t){this._applyManipulationCallback(e,(e=>{const i=kc.getDataAttribute(e,t);null!==i?(kc.removeDataAttribute(e,t),e.style.setProperty(t,i)):e.style.removeProperty(t)}))}_applyManipulationCallback(e,t){if(qh(e))t(e);else for(const i of Bc.find(e,this._element))t(i)}}const hu="backdrop",cu="show",du=`mousedown.bs.${hu}`,uu={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},pu={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class mu extends Ic{constructor(e){super(),this._config=this._getConfig(e),this._isAppended=!1,this._element=null}static get Default(){return uu}static get DefaultType(){return pu}static get NAME(){return hu}show(e){if(!this._config.isVisible)return void nc(e);this._append();const t=this._getElement();this._config.isAnimated&&Jh(t),t.classList.add(cu),this._emulateAnimation((()=>{nc(e)}))}hide(e){this._config.isVisible?(this._getElement().classList.remove(cu),this._emulateAnimation((()=>{this.dispose(),nc(e)}))):nc(e)}dispose(){this._isAppended&&(wc.off(this._element,du),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const e=document.createElement("div");e.className=this._config.className,this._config.isAnimated&&e.classList.add("fade"),this._element=e}return this._element}_configAfterMerge(e){return e.rootElement=Kh(e.rootElement),e}_append(){if(this._isAppended)return;const e=this._getElement();this._config.rootElement.append(e),wc.on(e,du,(()=>{nc(this._config.clickCallback)})),this._isAppended=!0}_emulateAnimation(e){rc(e,this._getElement(),this._config.isAnimated)}}const fu=".bs.focustrap",gu=`focusin${fu}`,_u=`keydown.tab${fu}`,vu="backward",bu={autofocus:!0,trapElement:null},yu={autofocus:"boolean",trapElement:"element"};class Cu extends Ic{constructor(e){super(),this._config=this._getConfig(e),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return bu}static get DefaultType(){return yu}static get NAME(){return"focustrap"}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),wc.off(document,fu),wc.on(document,gu,(e=>this._handleFocusin(e))),wc.on(document,_u,(e=>this._handleKeydown(e))),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,wc.off(document,fu))}_handleFocusin(e){const{trapElement:t}=this._config;if(e.target===document||e.target===t||t.contains(e.target))return;const i=Bc.focusableChildren(t);0===i.length?t.focus():this._lastTabNavDirection===vu?i[i.length-1].focus():i[0].focus()}_handleKeydown(e){"Tab"===e.key&&(this._lastTabNavDirection=e.shiftKey?vu:"forward")}}const wu=".bs.modal",Su=`hide${wu}`,Eu=`hidePrevented${wu}`,xu=`hidden${wu}`,Tu=`show${wu}`,Ou=`shown${wu}`,ku=`resize${wu}`,Iu=`click.dismiss${wu}`,Au=`mousedown.dismiss${wu}`,Du=`keydown.dismiss${wu}`,Ru=`click${wu}.data-api`,Pu="modal-open",Lu="show",Mu="modal-static",Nu={backdrop:!0,focus:!0,keyboard:!0},Fu={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class Bu extends Ac{constructor(e,t){super(e,t),this._dialog=Bc.findOne(".modal-dialog",this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new lu,this._addEventListeners()}static get Default(){return Nu}static get DefaultType(){return Fu}static get NAME(){return"modal"}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){this._isShown||this._isTransitioning||wc.trigger(this._element,Tu,{relatedTarget:e}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(Pu),this._adjustDialog(),this._backdrop.show((()=>this._showElement(e))))}hide(){this._isShown&&!this._isTransitioning&&(wc.trigger(this._element,Su).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(Lu),this._queueCallback((()=>this._hideModal()),this._element,this._isAnimated())))}dispose(){for(const e of[window,this._dialog])wc.off(e,wu);this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new mu({isVisible:Boolean(this._config.backdrop),isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new Cu({trapElement:this._element})}_showElement(e){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const t=Bc.findOne(".modal-body",this._dialog);t&&(t.scrollTop=0),Jh(this._element),this._element.classList.add(Lu),this._queueCallback((()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,wc.trigger(this._element,Ou,{relatedTarget:e})}),this._dialog,this._isAnimated())}_addEventListeners(){wc.on(this._element,Du,(e=>{if("Escape"===e.key)return this._config.keyboard?(e.preventDefault(),void this.hide()):void this._triggerBackdropTransition()})),wc.on(window,ku,(()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()})),wc.on(this._element,Au,(e=>{wc.one(this._element,Iu,(t=>{this._element===e.target&&this._element===t.target&&("static"!==this._config.backdrop?this._config.backdrop&&this.hide():this._triggerBackdropTransition())}))}))}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide((()=>{document.body.classList.remove(Pu),this._resetAdjustments(),this._scrollBar.reset(),wc.trigger(this._element,xu)}))}_isAnimated(){return this._element.classList.contains("fade")}_triggerBackdropTransition(){if(wc.trigger(this._element,Eu).defaultPrevented)return;const e=this._element.scrollHeight>document.documentElement.clientHeight,t=this._element.style.overflowY;"hidden"===t||this._element.classList.contains(Mu)||(e||(this._element.style.overflowY="hidden"),this._element.classList.add(Mu),this._queueCallback((()=>{this._element.classList.remove(Mu),this._queueCallback((()=>{this._element.style.overflowY=t}),this._dialog)}),this._dialog),this._element.focus())}_adjustDialog(){const e=this._element.scrollHeight>document.documentElement.clientHeight,t=this._scrollBar.getWidth(),i=t>0;if(i&&!e){const e=ic()?"paddingLeft":"paddingRight";this._element.style[e]=`${t}px`}if(!i&&e){const e=ic()?"paddingRight":"paddingLeft";this._element.style[e]=`${t}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(e,t){return this.each((function(){const i=Bu.getOrCreateInstance(this,e);if("string"==typeof e){if(void 0===i[e])throw new TypeError(`No method named "${e}"`);i[e](t)}}))}}wc.on(document,Ru,'[data-bs-toggle="modal"]',(function(e){const t=jh(this);["A","AREA"].includes(this.tagName)&&e.preventDefault(),wc.one(t,Tu,(e=>{e.defaultPrevented||wc.one(t,xu,(()=>{Yh(this)&&this.focus()}))}));const i=Bc.findOne(".modal.show");i&&Bu.getInstance(i).hide(),Bu.getOrCreateInstance(t).toggle(this)})),Dc(Bu),sc(Bu);const Hu=".bs.offcanvas",zu=".data-api",$u=`load${Hu}${zu}`,Vu="show",Wu="showing",Uu="hiding",ju=".offcanvas.show",Gu=`show${Hu}`,qu=`shown${Hu}`,Ku=`hide${Hu}`,Yu=`hidePrevented${Hu}`,Xu=`hidden${Hu}`,Zu=`resize${Hu}`,Qu=`click${Hu}${zu}`,Ju=`keydown.dismiss${Hu}`,ep={backdrop:!0,keyboard:!0,scroll:!1},tp={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class ip extends Ac{constructor(e,t){super(e,t),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return ep}static get DefaultType(){return tp}static get NAME(){return"offcanvas"}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){this._isShown||wc.trigger(this._element,Gu,{relatedTarget:e}).defaultPrevented||(this._isShown=!0,this._backdrop.show(),this._config.scroll||(new lu).hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(Wu),this._queueCallback((()=>{this._config.scroll&&!this._config.backdrop||this._focustrap.activate(),this._element.classList.add(Vu),this._element.classList.remove(Wu),wc.trigger(this._element,qu,{relatedTarget:e})}),this._element,!0))}hide(){this._isShown&&(wc.trigger(this._element,Ku).defaultPrevented||(this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(Uu),this._backdrop.hide(),this._queueCallback((()=>{this._element.classList.remove(Vu,Uu),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||(new lu).reset(),wc.trigger(this._element,Xu)}),this._element,!0)))}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const e=Boolean(this._config.backdrop);return new mu({className:"offcanvas-backdrop",isVisible:e,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:e?()=>{"static"!==this._config.backdrop?this.hide():wc.trigger(this._element,Yu)}:null})}_initializeFocusTrap(){return new Cu({trapElement:this._element})}_addEventListeners(){wc.on(this._element,Ju,(e=>{"Escape"===e.key&&(this._config.keyboard?this.hide():wc.trigger(this._element,Yu))}))}static jQueryInterface(e){return this.each((function(){const t=ip.getOrCreateInstance(this,e);if("string"==typeof e){if(void 0===t[e]||e.startsWith("_")||"constructor"===e)throw new TypeError(`No method named "${e}"`);t[e](this)}}))}}wc.on(document,Qu,'[data-bs-toggle="offcanvas"]',(function(e){const t=jh(this);if(["A","AREA"].includes(this.tagName)&&e.preventDefault(),Xh(this))return;wc.one(t,Xu,(()=>{Yh(this)&&this.focus()}));const i=Bc.findOne(ju);i&&i!==t&&ip.getInstance(i).hide(),ip.getOrCreateInstance(t).toggle(this)})),wc.on(window,$u,(()=>{for(const e of Bc.find(ju))ip.getOrCreateInstance(e).show()})),wc.on(window,Zu,(()=>{for(const e of Bc.find("[aria-modal][class*=show][class*=offcanvas-]"))"fixed"!==getComputedStyle(e).position&&ip.getOrCreateInstance(e).hide()})),Dc(ip),sc(ip);const sp=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),np=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^#&/:?]*(?:[#/?]|$))/i,rp=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[\d+/a-z]+=*$/i,op=(e,t)=>{const i=e.nodeName.toLowerCase();return t.includes(i)?!sp.has(i)||Boolean(np.test(e.nodeValue)||rp.test(e.nodeValue)):t.filter((e=>e instanceof RegExp)).some((e=>e.test(i)))},ap={"*":["class","dir","id","lang","role",/^aria-[\w-]*$/i],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],div:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},lp={allowList:ap,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},hp={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},cp={entry:"(string|element|function|null)",selector:"(string|element)"};class dp extends Ic{constructor(e){super(),this._config=this._getConfig(e)}static get Default(){return lp}static get DefaultType(){return hp}static get NAME(){return"TemplateFactory"}getContent(){return Object.values(this._config.content).map((e=>this._resolvePossibleFunction(e))).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(e){return this._checkContent(e),this._config.content={...this._config.content,...e},this}toHtml(){const e=document.createElement("div");e.innerHTML=this._maybeSanitize(this._config.template);for(const[t,i]of Object.entries(this._config.content))this._setContent(e,i,t);const t=e.children[0],i=this._resolvePossibleFunction(this._config.extraClass);return i&&t.classList.add(...i.split(" ")),t}_typeCheckConfig(e){super._typeCheckConfig(e),this._checkContent(e.content)}_checkContent(e){for(const[t,i]of Object.entries(e))super._typeCheckConfig({selector:t,entry:i},cp)}_setContent(e,t,i){const s=Bc.findOne(i,e);s&&((t=this._resolvePossibleFunction(t))?qh(t)?this._putElementInTemplate(Kh(t),s):this._config.html?s.innerHTML=this._maybeSanitize(t):s.textContent=t:s.remove())}_maybeSanitize(e){return this._config.sanitize?function(e,t,i){if(!e.length)return e;if(i&&"function"==typeof i)return i(e);const s=(new window.DOMParser).parseFromString(e,"text/html"),n=[].concat(...s.body.querySelectorAll("*"));for(const e of n){const i=e.nodeName.toLowerCase();if(!Object.keys(t).includes(i)){e.remove();continue}const s=[].concat(...e.attributes),n=[].concat(t["*"]||[],t[i]||[]);for(const t of s)op(t,n)||e.removeAttribute(t.nodeName)}return s.body.innerHTML}(e,this._config.allowList,this._config.sanitizeFn):e}_resolvePossibleFunction(e){return"function"==typeof e?e(this):e}_putElementInTemplate(e,t){if(this._config.html)return t.innerHTML="",void t.append(e);t.textContent=e.textContent}}const up=new Set(["sanitize","allowList","sanitizeFn"]),pp="fade",mp="show",fp=".tooltip-inner",gp=".modal",_p="hide.bs.modal",vp="hover",bp="focus",yp={AUTO:"auto",TOP:"top",RIGHT:ic()?"left":"right",BOTTOM:"bottom",LEFT:ic()?"right":"left"},Cp={allowList:ap,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,0],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},wp={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class Sp extends Ac{constructor(e,t){super(e,t),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return Cp}static get DefaultType(){return wp}static get NAME(){return"tooltip"}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){this._isEnabled&&(this._activeTrigger.click=!this._activeTrigger.click,this._isShown()?this._leave():this._enter())}dispose(){clearTimeout(this._timeout),wc.off(this._element.closest(gp),_p,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if("none"===this._element.style.display)throw new Error("Please use show on visible elements");if(!this._isWithContent()||!this._isEnabled)return;const e=wc.trigger(this._element,this.constructor.eventName("show")),t=(Zh(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(e.defaultPrevented||!t)return;this._disposePopper();const i=this._getTipElement();this._element.setAttribute("aria-describedby",i.getAttribute("id"));const{container:s}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(s.append(i),wc.trigger(this._element,this.constructor.eventName("inserted"))),this._popper=this._createPopper(i),i.classList.add(mp),"ontouchstart"in document.documentElement)for(const e of[].concat(...document.body.children))wc.on(e,"mouseover",Qh);this._queueCallback((()=>{wc.trigger(this._element,this.constructor.eventName("shown")),!1===this._isHovered&&this._leave(),this._isHovered=!1}),this.tip,this._isAnimated())}hide(){if(this._isShown()&&!wc.trigger(this._element,this.constructor.eventName("hide")).defaultPrevented){if(this._getTipElement().classList.remove(mp),"ontouchstart"in document.documentElement)for(const e of[].concat(...document.body.children))wc.off(e,"mouseover",Qh);this._activeTrigger.click=!1,this._activeTrigger[bp]=!1,this._activeTrigger[vp]=!1,this._isHovered=null,this._queueCallback((()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),wc.trigger(this._element,this.constructor.eventName("hidden")))}),this.tip,this._isAnimated())}}update(){this._popper&&this._popper.update()}_isWithContent(){return Boolean(this._getTitle())}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(e){const t=this._getTemplateFactory(e).toHtml();if(!t)return null;t.classList.remove(pp,mp),t.classList.add(`bs-${this.constructor.NAME}-auto`);const i=(e=>{do{e+=Math.floor(1e6*Math.random())}while(document.getElementById(e));return e})(this.constructor.NAME).toString();return t.setAttribute("id",i),this._isAnimated()&&t.classList.add(pp),t}setContent(e){this._newContent=e,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(e){return this._templateFactory?this._templateFactory.changeContent(e):this._templateFactory=new dp({...this._config,content:e,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[fp]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(e){return this.constructor.getOrCreateInstance(e.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(pp)}_isShown(){return this.tip&&this.tip.classList.contains(mp)}_createPopper(e){const t="function"==typeof this._config.placement?this._config.placement.call(this,e,this._element):this._config.placement,i=yp[t.toUpperCase()];return zh(this._element,e,this._getPopperConfig(i))}_getOffset(){const{offset:e}=this._config;return"string"==typeof e?e.split(",").map((e=>Number.parseInt(e,10))):"function"==typeof e?t=>e(t,this._element):e}_resolvePossibleFunction(e){return"function"==typeof e?e.call(this._element):e}_getPopperConfig(e){const t={placement:e,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:e=>{this._getTipElement().setAttribute("data-popper-placement",e.state.placement)}}]};return{...t,..."function"==typeof this._config.popperConfig?this._config.popperConfig(t):this._config.popperConfig}}_setListeners(){const e=this._config.trigger.split(" ");for(const t of e)if("click"===t)wc.on(this._element,this.constructor.eventName("click"),this._config.selector,(e=>{this._initializeOnDelegatedTarget(e).toggle()}));else if("manual"!==t){const e=t===vp?this.constructor.eventName("mouseenter"):this.constructor.eventName("focusin"),i=t===vp?this.constructor.eventName("mouseleave"):this.constructor.eventName("focusout");wc.on(this._element,e,this._config.selector,(e=>{const t=this._initializeOnDelegatedTarget(e);t._activeTrigger["focusin"===e.type?bp:vp]=!0,t._enter()})),wc.on(this._element,i,this._config.selector,(e=>{const t=this._initializeOnDelegatedTarget(e);t._activeTrigger["focusout"===e.type?bp:vp]=t._element.contains(e.relatedTarget),t._leave()}))}this._hideModalHandler=()=>{this._element&&this.hide()},wc.on(this._element.closest(gp),_p,this._hideModalHandler)}_fixTitle(){const e=this._element.getAttribute("title");e&&(this._element.getAttribute("aria-label")||this._element.textContent.trim()||this._element.setAttribute("aria-label",e),this._element.setAttribute("data-bs-original-title",e),this._element.removeAttribute("title"))}_enter(){this._isShown()||this._isHovered?this._isHovered=!0:(this._isHovered=!0,this._setTimeout((()=>{this._isHovered&&this.show()}),this._config.delay.show))}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout((()=>{this._isHovered||this.hide()}),this._config.delay.hide))}_setTimeout(e,t){clearTimeout(this._timeout),this._timeout=setTimeout(e,t)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(e){const t=kc.getDataAttributes(this._element);for(const e of Object.keys(t))up.has(e)&&delete t[e];return e={...t,..."object"==typeof e&&e?e:{}},e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e.container=!1===e.container?document.body:Kh(e.container),"number"==typeof e.delay&&(e.delay={show:e.delay,hide:e.delay}),"number"==typeof e.title&&(e.title=e.title.toString()),"number"==typeof e.content&&(e.content=e.content.toString()),e}_getDelegateConfig(){const e={};for(const t in this._config)this.constructor.Default[t]!==this._config[t]&&(e[t]=this._config[t]);return e.selector=!1,e.trigger="manual",e}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(e){return this.each((function(){const t=Sp.getOrCreateInstance(this,e);if("string"==typeof e){if(void 0===t[e])throw new TypeError(`No method named "${e}"`);t[e]()}}))}}sc(Sp);const Ep=".popover-header",xp=".popover-body",Tp={...Sp.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},Op={...Sp.DefaultType,content:"(null|string|element|function)"};class kp extends Sp{static get Default(){return Tp}static get DefaultType(){return Op}static get NAME(){return"popover"}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{[Ep]:this._getTitle(),[xp]:this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(e){return this.each((function(){const t=kp.getOrCreateInstance(this,e);if("string"==typeof e){if(void 0===t[e])throw new TypeError(`No method named "${e}"`);t[e]()}}))}}sc(kp);const Ip=".bs.scrollspy",Ap=`activate${Ip}`,Dp=`click${Ip}`,Rp=`load${Ip}.data-api`,Pp="active",Lp="[href]",Mp=".nav-link",Np=`${Mp}, .nav-item > ${Mp}, .list-group-item`,Fp={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},Bp={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class Hp extends Ac{constructor(e,t){super(e,t),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement="visible"===getComputedStyle(this._element).overflowY?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return Fp}static get DefaultType(){return Bp}static get NAME(){return"scrollspy"}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const e of this._observableSections.values())this._observer.observe(e)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(e){return e.target=Kh(e.target)||document.body,e.rootMargin=e.offset?`${e.offset}px 0px -30%`:e.rootMargin,"string"==typeof e.threshold&&(e.threshold=e.threshold.split(",").map((e=>Number.parseFloat(e)))),e}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(wc.off(this._config.target,Dp),wc.on(this._config.target,Dp,Lp,(e=>{const t=this._observableSections.get(e.target.hash);if(t){e.preventDefault();const i=this._rootElement||window,s=t.offsetTop-this._element.offsetTop;if(i.scrollTo)return void i.scrollTo({top:s,behavior:"smooth"});i.scrollTop=s}})))}_getNewObserver(){const e={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver((e=>this._observerCallback(e)),e)}_observerCallback(e){const t=e=>this._targetLinks.get(`#${e.target.id}`),i=e=>{this._previousScrollData.visibleEntryTop=e.target.offsetTop,this._process(t(e))},s=(this._rootElement||document.documentElement).scrollTop,n=s>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=s;for(const r of e){if(!r.isIntersecting){this._activeTarget=null,this._clearActiveClass(t(r));continue}const e=r.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(n&&e){if(i(r),!s)return}else n||e||i(r)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const e=Bc.find(Lp,this._config.target);for(const t of e){if(!t.hash||Xh(t))continue;const e=Bc.findOne(t.hash,this._element);Yh(e)&&(this._targetLinks.set(t.hash,t),this._observableSections.set(t.hash,e))}}_process(e){this._activeTarget!==e&&(this._clearActiveClass(this._config.target),this._activeTarget=e,e.classList.add(Pp),this._activateParents(e),wc.trigger(this._element,Ap,{relatedTarget:e}))}_activateParents(e){if(e.classList.contains("dropdown-item"))Bc.findOne(".dropdown-toggle",e.closest(".dropdown")).classList.add(Pp);else for(const t of Bc.parents(e,".nav, .list-group"))for(const e of Bc.prev(t,Np))e.classList.add(Pp)}_clearActiveClass(e){e.classList.remove(Pp);const t=Bc.find(`${Lp}.${Pp}`,e);for(const e of t)e.classList.remove(Pp)}static jQueryInterface(e){return this.each((function(){const t=Hp.getOrCreateInstance(this,e);if("string"==typeof e){if(void 0===t[e]||e.startsWith("_")||"constructor"===e)throw new TypeError(`No method named "${e}"`);t[e]()}}))}}wc.on(window,Rp,(()=>{for(const e of Bc.find('[data-bs-spy="scroll"]'))Hp.getOrCreateInstance(e)})),sc(Hp);const zp=".bs.tab",$p=`hide${zp}`,Vp=`hidden${zp}`,Wp=`show${zp}`,Up=`shown${zp}`,jp=`click${zp}`,Gp=`keydown${zp}`,qp=`load${zp}`,Kp="ArrowLeft",Yp="ArrowRight",Xp="ArrowUp",Zp="ArrowDown",Qp="active",Jp="fade",em="show",tm=":not(.dropdown-toggle)",im='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',sm=`.nav-link${tm}, .list-group-item${tm}, [role="tab"]${tm}, ${im}`,nm=`.${Qp}[data-bs-toggle="tab"], .${Qp}[data-bs-toggle="pill"], .${Qp}[data-bs-toggle="list"]`;class rm extends Ac{constructor(e){super(e),this._parent=this._element.closest('.list-group, .nav, [role="tablist"]'),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),wc.on(this._element,Gp,(e=>this._keydown(e))))}static get NAME(){return"tab"}show(){const e=this._element;if(this._elemIsActive(e))return;const t=this._getActiveElem(),i=t?wc.trigger(t,$p,{relatedTarget:e}):null;wc.trigger(e,Wp,{relatedTarget:t}).defaultPrevented||i&&i.defaultPrevented||(this._deactivate(t,e),this._activate(e,t))}_activate(e,t){e&&(e.classList.add(Qp),this._activate(jh(e)),this._queueCallback((()=>{"tab"===e.getAttribute("role")?(e.removeAttribute("tabindex"),e.setAttribute("aria-selected",!0),this._toggleDropDown(e,!0),wc.trigger(e,Up,{relatedTarget:t})):e.classList.add(em)}),e,e.classList.contains(Jp)))}_deactivate(e,t){e&&(e.classList.remove(Qp),e.blur(),this._deactivate(jh(e)),this._queueCallback((()=>{"tab"===e.getAttribute("role")?(e.setAttribute("aria-selected",!1),e.setAttribute("tabindex","-1"),this._toggleDropDown(e,!1),wc.trigger(e,Vp,{relatedTarget:t})):e.classList.remove(em)}),e,e.classList.contains(Jp)))}_keydown(e){if(![Kp,Yp,Xp,Zp].includes(e.key))return;e.stopPropagation(),e.preventDefault();const t=[Yp,Zp].includes(e.key),i=oc(this._getChildren().filter((e=>!Xh(e))),e.target,t,!0);i&&(i.focus({preventScroll:!0}),rm.getOrCreateInstance(i).show())}_getChildren(){return Bc.find(sm,this._parent)}_getActiveElem(){return this._getChildren().find((e=>this._elemIsActive(e)))||null}_setInitialAttributes(e,t){this._setAttributeIfNotExists(e,"role","tablist");for(const e of t)this._setInitialAttributesOnChild(e)}_setInitialAttributesOnChild(e){e=this._getInnerElement(e);const t=this._elemIsActive(e),i=this._getOuterElement(e);e.setAttribute("aria-selected",t),i!==e&&this._setAttributeIfNotExists(i,"role","presentation"),t||e.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(e,"role","tab"),this._setInitialAttributesOnTargetPanel(e)}_setInitialAttributesOnTargetPanel(e){const t=jh(e);t&&(this._setAttributeIfNotExists(t,"role","tabpanel"),e.id&&this._setAttributeIfNotExists(t,"aria-labelledby",`#${e.id}`))}_toggleDropDown(e,t){const i=this._getOuterElement(e);if(!i.classList.contains("dropdown"))return;const s=(e,s)=>{const n=Bc.findOne(e,i);n&&n.classList.toggle(s,t)};s(".dropdown-toggle",Qp),s(".dropdown-menu",em),i.setAttribute("aria-expanded",t)}_setAttributeIfNotExists(e,t,i){e.hasAttribute(t)||e.setAttribute(t,i)}_elemIsActive(e){return e.classList.contains(Qp)}_getInnerElement(e){return e.matches(sm)?e:Bc.findOne(sm,e)}_getOuterElement(e){return e.closest(".nav-item, .list-group-item")||e}static jQueryInterface(e){return this.each((function(){const t=rm.getOrCreateInstance(this);if("string"==typeof e){if(void 0===t[e]||e.startsWith("_")||"constructor"===e)throw new TypeError(`No method named "${e}"`);t[e]()}}))}}wc.on(document,jp,im,(function(e){["A","AREA"].includes(this.tagName)&&e.preventDefault(),Xh(this)||rm.getOrCreateInstance(this).show()})),wc.on(window,qp,(()=>{for(const e of Bc.find(nm))rm.getOrCreateInstance(e)})),sc(rm);const om=".bs.toast",am=`mouseover${om}`,lm=`mouseout${om}`,hm=`focusin${om}`,cm=`focusout${om}`,dm=`hide${om}`,um=`hidden${om}`,pm=`show${om}`,mm=`shown${om}`,fm="hide",gm="show",_m="showing",vm={animation:"boolean",autohide:"boolean",delay:"number"},bm={animation:!0,autohide:!0,delay:5e3};class ym extends Ac{constructor(e,t){super(e,t),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return bm}static get DefaultType(){return vm}static get NAME(){return"toast"}show(){wc.trigger(this._element,pm).defaultPrevented||(this._clearTimeout(),this._config.animation&&this._element.classList.add("fade"),this._element.classList.remove(fm),Jh(this._element),this._element.classList.add(gm,_m),this._queueCallback((()=>{this._element.classList.remove(_m),wc.trigger(this._element,mm),this._maybeScheduleHide()}),this._element,this._config.animation))}hide(){this.isShown()&&(wc.trigger(this._element,dm).defaultPrevented||(this._element.classList.add(_m),this._queueCallback((()=>{this._element.classList.add(fm),this._element.classList.remove(_m,gm),wc.trigger(this._element,um)}),this._element,this._config.animation)))}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(gm),super.dispose()}isShown(){return this._element.classList.contains(gm)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout((()=>{this.hide()}),this._config.delay)))}_onInteraction(e,t){switch(e.type){case"mouseover":case"mouseout":this._hasMouseInteraction=t;break;case"focusin":case"focusout":this._hasKeyboardInteraction=t}if(t)return void this._clearTimeout();const i=e.relatedTarget;this._element===i||this._element.contains(i)||this._maybeScheduleHide()}_setListeners(){wc.on(this._element,am,(e=>this._onInteraction(e,!0))),wc.on(this._element,lm,(e=>this._onInteraction(e,!1))),wc.on(this._element,hm,(e=>this._onInteraction(e,!0))),wc.on(this._element,cm,(e=>this._onInteraction(e,!1)))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(e){return this.each((function(){const t=ym.getOrCreateInstance(this,e);if("string"==typeof e){if(void 0===t[e])throw new TypeError(`No method named "${e}"`);t[e](this)}}))}}Dc(ym),sc(ym);var Cm=i(692),wm=i.n(Cm),Sm=i(677).getCompleteRBlock,Em=i(816).getCurrentWord,xm=i(680).extractFunctionCallInfo,Tm=i(188).getActiveParameter,Om=i(34).GoldenLayout,km=i(668),Im=i(140),Am=i(965),Dm={getCompleteRBlock:Sm,getCurrentWord:Em,extractFunctionCallInfo:xm,getActiveParameter:Tm,GoldenLayout:Om,pako:km,Terminal:c.Terminal,FitAddon:d.FitAddon,download:Im,DOMPurify:p(),Mustache:Am,DiffMatchPatch:f(),Slicker:Xa,Dexie:dl,$:wm()};"undefined"!=typeof window&&(window.ide_functions=Dm,window.bootstrap=l)})()})();